uint64_t sub_100154820(unsigned int a1, _DWORD *a2)
{
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  unsigned int v14;
  unsigned int v15;
  uint64_t v16;
  char *v17;
  unsigned __int16 v18;
  uint64_t v19;
  void v21[2];

  if (*a2 != 1) {
    return 2701;
  }
  v21[0] = 0;
  v21[1] = 0;
  v3 = sub_10026314C((uint64_t)v21, 0xFuLL);
  if (!v3)
  {
    if (*(unsigned char *)(qword_100A04128 + 1513))
    {
      if (*(unsigned char *)(qword_100A04128 + 1519)) {
        v11 = 5;
      }
      else {
        v11 = 1;
      }
    }
    else
    {
      v11 = 0;
    }
    v12 = sub_1002639B0((uint64_t)v21, (uint64_t)"\r\n+CREG: 1,%d\r\n", v4, v5, v6, v7, v8, v9, v11);
    if (v12)
    {
      v13 = v12;
      sub_10026319C((uint64_t)v21);
      v14 = a1;
      v15 = 25;
      v16 = v13;
    }
    else
    {
      v17 = (char *)sub_1002639DC((uint64_t)v21);
      v18 = strlen(v17);
      v16 = sub_10014F934(a1, 25, v17, v18, 1);
      if (v16)
      {
        v14 = a1;
        v15 = 25;
      }
      else
      {
        v19 = sub_10014FD40(a1, 0, v16);
        if (!v19) {
          return 412;
        }
        v16 = v19;
        v14 = a1;
        v15 = 1;
      }
    }
    sub_100152814(v14, v15, v16);
    return 412;
  }
  v10 = v3;
  sub_100152814(a1, 0x19u, v3);
  return v10;
}

uint64_t sub_100154948(int a1)
{
  uint64_t v1 = 0;
  while (*(unsigned __int16 *)(qword_100A04128 + v1) != a1)
  {
    v1 += 184;
    if (v1 == 1472) {
      return 1802;
    }
  }
  uint64_t v4 = 0;
  uint64_t v5 = 0;
  uint64_t v6 = 0;
  if ((*(_WORD *)(qword_100A04128 + 1508) & 0x200) == 0) {
    return 2701;
  }
  uint64_t v3 = qword_100A04128 + v1;
  if ((*(_WORD *)(v3 + 86) & 0x80) == 0) {
    return 2701;
  }
  LODWORD(v4) = 4;
  WORD2(v4) = a1;
  LODWORD(v5) = *(_DWORD *)(v3 + 164);
  (*(void (**)(uint64_t *))(qword_100A04128 + 1480))(&v4);
  return 412;
}

uint64_t sub_1001549E4(unsigned int a1, uint64_t a2)
{
  uint64_t v3 = 0;
  uint64_t v4 = 0;
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t v22 = 0;
  while (*(unsigned __int16 *)(qword_100A04128 + v3) != a1)
  {
    ++v4;
    v3 += 184;
    if (v4 == 8) {
      goto LABEL_6;
    }
  }
  if (v4 == 8)
  {
LABEL_6:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Device not connected", v5, v6, v7, v8, v9, v10, v11, v19);
      v12 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    return 1802;
  }
  if ((*(_WORD *)(qword_100A04128 + 1508) & 0x200) == 0 || (*(_WORD *)(qword_100A04128 + v3 + 86) & 0x80) == 0) {
    return 2701;
  }
  v14 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
  int v15 = sub_100262F1C(v14);
  if (v15 != *(_DWORD *)(qword_100A04128 + v3 + 164))
  {
    sub_100152D7C(v4, 1810);
    return 2701;
  }
  int v16 = v15;
  sub_10014FD40(a1, 0, 0);
  uint64_t v17 = qword_100A04128;
  uint64_t v18 = *(unsigned int *)(qword_100A04128 + v3 + 172);
  if (v18)
  {
    sub_100026DB4(v18);
    uint64_t v17 = qword_100A04128;
    *(_DWORD *)(qword_100A04128 + v3 + 172) = 0;
  }
  if (*(unsigned char *)(v17 + v3 + 168))
  {
    *(unsigned char *)(v17 + v3 + 168) = 0;
    LODWORD(v20) = 27;
    WORD2(v20) = a1;
    LODWORD(v21) = v16;
    (*(void (**)(uint64_t *))(v17 + 1480))(&v20);
  }
  return 412;
}

uint64_t sub_100154B60(unsigned int a1, uint64_t a2)
{
  uint64_t v4 = -1472;
  while (*(unsigned __int16 *)(qword_100A04128 + v4 + 1472) != a1)
  {
    v4 += 184;
    if (!v4)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Device not connected", v11, v12, v13, v14, v15, v16, v17, v21);
        uint64_t v18 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      return 1802;
    }
  }
  uint64_t v5 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
  if (!v5) {
    goto LABEL_35;
  }
  uint64_t v6 = v5;
  unsigned int v7 = 0;
  do
  {
    if (v7 <= 6)
    {
      switch(v7)
      {
        case 0u:
          if (sub_100262F5C(v6, "1"))
          {
            if (!sub_100262F5C(v6, "0")) {
              *(unsigned char *)(qword_100A04128 + v4 + 1648) = 0;
            }
          }
          else
          {
            *(unsigned char *)(qword_100A04128 + v4 + 1648) = 1;
          }
          break;
        case 3u:
          if (sub_100262F5C(v6, "1"))
          {
            if (!sub_100262F5C(v6, "0")) {
              *(unsigned char *)(qword_100A04128 + v4 + 1651) = 0;
            }
          }
          else
          {
            *(unsigned char *)(qword_100A04128 + v4 + 1651) = 1;
          }
          break;
        case 4u:
          if (sub_100262F5C(v6, "1"))
          {
            if (!sub_100262F5C(v6, "0")) {
              *(unsigned char *)(qword_100A04128 + v4 + 1649) = 0;
            }
          }
          else
          {
            *(unsigned char *)(qword_100A04128 + v4 + 1649) = 1;
          }
          break;
        case 5u:
          if (sub_100262F5C(v6, "1"))
          {
            if (!sub_100262F5C(v6, "0")) {
              *(unsigned char *)(qword_100A04128 + v4 + 1650) = 0;
            }
          }
          else
          {
            *(unsigned char *)(qword_100A04128 + v4 + 1650) = 1;
          }
          break;
        default:
          break;
      }
    }
    unsigned int v8 = v7 + 1;
    uint64_t v9 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
    uint64_t v6 = v9;
    if (!v9) {
      break;
    }
  }
  while (v7++ < 0x13);
  if (v9 && v8 == 20)
  {
    sub_10014FD40(a1, 1811, 0);
  }
  else
  {
LABEL_35:
    uint64_t v20 = sub_10014FD40(a1, 0, 0);
    if (v20) {
      sub_100152814(a1, 1u, v20);
    }
  }
  return 412;
}

uint64_t sub_100154E10(unsigned int a1, uint64_t a2)
{
  for (uint64_t i = 0; i != 1472; i += 184)
  {
    if (*(unsigned __int16 *)(qword_100A04128 + i) == a1)
    {
      if ((*(_WORD *)(qword_100A04128 + 1508) & 0x400) == 0)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received unsupported AT+BIND command", v14, v15, v16, v17, v18, v19, v20, v41);
          uint64_t v21 = sub_100050B4C(0x10u);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
        return 2701;
      }
      if ((*(_WORD *)(qword_100A04128 + i + 86) & 0x100) == 0)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Device doesn't support HF indicators. AT+BIND command is invalid", v22, v23, v24, v25, v26, v27, v28, v41);
          v29 = sub_100050B4C(0x10u);
          if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
      }
      int v30 = *(_DWORD *)a2;
      if (*(_DWORD *)a2)
      {
        if (v30 != 1)
        {
          if (v30 != 2) {
            return 2701;
          }
          v31 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
          if (v31)
          {
            char v32 = 0;
            char v33 = 1;
            do
            {
              char v34 = v32;
              int v35 = *v31;
              if (v35 == 50)
              {
                *(unsigned char *)(qword_100A04128 + i + 181) = 1;
              }
              else
              {
                if (v35 != 49) {
                  return 134;
                }
                *(unsigned char *)(qword_100A04128 + i + 180) = 1;
              }
              v31 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
              char v36 = (v31 != 0) & v33;
              char v32 = 1;
              char v33 = 0;
            }
            while ((v36 & 1) != 0);
            if (v31 == 0 || (v34 & 1) == 0) {
              goto LABEL_34;
            }
            sub_10014FD40(a1, 114, 0);
            return 412;
          }
LABEL_34:
          uint64_t v40 = sub_10014FD40(a1, 0, 0);
          if (v40) {
            sub_100152814(a1, 1u, v40);
          }
          return 412;
        }
        sub_10014F934(a1, 27, "\r\n+BIND:1,1\r\n", 0xDuLL, 0);
        v37 = "\r\n+BIND:2,1\r\n";
        unsigned int v38 = a1;
        size_t v39 = 13;
      }
      else
      {
        v37 = "\r\n+BIND:(1,2)\r\n";
        unsigned int v38 = a1;
        size_t v39 = 15;
      }
      sub_10014F934(v38, 27, v37, v39, 0);
      goto LABEL_34;
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Device not connected", v5, v6, v7, v8, v9, v10, v11, v41);
    uint64_t v12 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  return 1802;
}

uint64_t sub_10015509C(int a1, uint64_t a2)
{
  __int16 v3 = a1;
  for (uint64_t i = 0; i != 1472; i += 184)
  {
    if (*(unsigned __int16 *)(qword_100A04128 + i) == a1)
    {
      uint64_t v61 = 0;
      unint64_t v62 = 0;
      uint64_t v63 = 0;
      if ((*(_WORD *)(qword_100A04128 + 1508) & 0x400) == 0)
      {
        if (!sub_100058654()) {
          return 2701;
        }
        sub_100056E24((uint64_t)"Received unsupported AT+BIEV command", v14, v15, v16, v17, v18, v19, v20, v60);
        uint64_t v21 = sub_100050B4C(0x10u);
        if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          return 2701;
        }
        goto LABEL_21;
      }
      if ((*(_WORD *)(qword_100A04128 + i + 86) & 0x100) == 0)
      {
        if (!sub_100058654()) {
          return 2701;
        }
        sub_100056E24((uint64_t)"Device doesn't support HF indicators. AT+BIEV command is invalid", v22, v23, v24, v25, v26, v27, v28, v60);
        v29 = sub_100050B4C(0x10u);
        if (!os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
          return 2701;
        }
        goto LABEL_21;
      }
      int v30 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
      unsigned int v31 = sub_100262F1C(v30);
      if (v31 - 3 <= 0xFFFFFFFD)
      {
        if (!sub_100058654()) {
          return 2701;
        }
        sub_100056E24((uint64_t)"Invalid anum received", v32, v33, v34, v35, v36, v37, v38, v60);
        size_t v39 = sub_100050B4C(0x10u);
        if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          return 2701;
        }
        goto LABEL_21;
      }
      uint64_t v40 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
      unsigned int v41 = sub_100262F1C(v40);
      if (v31 == 1)
      {
        uint64_t v42 = qword_100A04128;
        if (*(unsigned char *)(qword_100A04128 + i + 180)) {
          BOOL v51 = v41 >= 2;
        }
        else {
          BOOL v51 = 0;
        }
        if (v51)
        {
          if (!sub_100058654()) {
            return 2701;
          }
          sub_100056E24((uint64_t)"Invalid value received for enhanced safety HF indicator", v52, v53, v54, v55, v56, v57, v58, v60);
          v59 = sub_100050B4C(0x10u);
          if (!os_log_type_enabled(v59, OS_LOG_TYPE_ERROR)) {
            return 2701;
          }
LABEL_21:
          sub_100745764();
          return 2701;
        }
      }
      else if (v31 == 2)
      {
        uint64_t v42 = qword_100A04128;
        if (*(unsigned char *)(qword_100A04128 + i + 181) && v41 >= 0x65)
        {
          if (!sub_100058654()) {
            return 2701;
          }
          sub_100056E24((uint64_t)"Invalid value received for battery level HF indicator", v43, v44, v45, v46, v47, v48, v49, v60);
          v50 = sub_100050B4C(0x10u);
          if (!os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
            return 2701;
          }
          goto LABEL_21;
        }
      }
      else
      {
        uint64_t v42 = qword_100A04128;
      }
      LODWORD(v61) = 29;
      WORD2(v61) = v3;
      unint64_t v62 = __PAIR64__(v41, v31);
      (*(void (**)(uint64_t *))(v42 + 1480))(&v61);
      return 412;
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Device not connected", v5, v6, v7, v8, v9, v10, v11, v60);
    uint64_t v12 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  return 1802;
}

uint64_t sub_100155354(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = (unsigned __int8 **)(a2 + 24);
  uint64_t v5 = sub_100131318(a2, (unsigned __int8 **)(a2 + 24), 0);
  uint64_t v6 = atoi((const char *)v5);
  if (v6 == 2)
  {
    uint64_t v14 = sub_100131318(a2, v4, 0);
    uint64_t v15 = atoi((const char *)v14);
    if (v15 == 1)
    {
      uint64_t v12 = 0;
    }
    else
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid +HAOS close parameter:%d", v24, v25, v26, v27, v28, v29, v30, v15);
        unsigned int v31 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      uint64_t v12 = 2701;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"disableAoSEmptyPacketReports - hfpHandle:%d", v32, v33, v34, v35, v36, v37, v38, a1);
      size_t v39 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
      {
        LODWORD(buf) = 136446210;
        *(void *)((char *)&buf + 4) = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v39, OS_LOG_TYPE_DEFAULT, " %{public}s", (uint8_t *)&buf, 0xCu);
      }
    }
    uint64_t v40 = 0;
    while (*(unsigned __int16 *)(qword_100A04128 + v40) != a1)
    {
      v40 += 184;
      if (v40 == 1472)
      {
        uint64_t v41 = 0;
        goto LABEL_33;
      }
    }
    uint64_t v41 = qword_100A04128 + v40 + 80;
LABEL_33:
    *(void *)&long long buf = 0;
    sub_10017E2D4(v41, (uint64_t *)&buf);
    sub_1001FEFFC();
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"exitAdvancedSniff - hfpHandle:%d", v50, v51, v52, v53, v54, v55, v56, a1);
      uint64_t v57 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v58 = sub_100050714();
        LODWORD(buf) = 136446210;
        *(void *)((char *)&buf + 4) = v58;
        _os_log_impl((void *)&_mh_execute_header, v57, OS_LOG_TYPE_DEFAULT, " %{public}s", (uint8_t *)&buf, 0xCu);
      }
    }
    uint64_t v59 = 0;
    while (*(unsigned __int16 *)(qword_100A04128 + v59) != a1)
    {
      v59 += 184;
      if (v59 == 1472)
      {
        uint64_t v60 = 0;
        goto LABEL_41;
      }
    }
    uint64_t v60 = qword_100A04128 + v59 + 80;
LABEL_41:
    *(void *)&long long buf = 0;
    sub_10017E2D4(v60, (uint64_t *)&buf);
    sub_1001FEDCC();
  }
  else if (v6 == 1)
  {
    uint64_t v7 = sub_100131318(a2, v4, 0);
    long long buf = 0uLL;
    uint64_t v68 = 0;
    WORD2(buf) = a1;
    uint64_t v8 = atoi((const char *)v7);
    if (v8 == 1)
    {
      int v65 = 0;
      uint64_t v66 = 0;
      uint64_t v64 = (unsigned __int16)a1;
      int v63 = 30;
      (*(void (**)(int *))(qword_100A04128 + 1480))(&v63);
      int v13 = 0;
      uint64_t v12 = 0;
    }
    else if (v8)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid +HAOS setup parameter:%d", v42, v43, v44, v45, v46, v47, v48, v8);
        uint64_t v49 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      int v13 = 0;
      uint64_t v12 = 2701;
    }
    else
    {
      uint64_t v9 = 0;
      LODWORD(buf) = 1;
      uint64_t v10 = (unsigned __int16 *)qword_100A04128;
      do
      {
        int v11 = *v10;
        v10 += 92;
        if (v11 == a1) {
          break;
        }
        ++v9;
      }
      while (v9 != 8);
      *((void *)&buf + 1) = qword_100A04128 + 184 * v9 + 80;
      LODWORD(v68) = 1802;
      sub_1001568B4(a1, 0);
      uint64_t v12 = 0;
      int v13 = 122;
    }
    LODWORD(buf) = 5;
    DWORD2(buf) = v13;
    (*(void (**)(long long *))(qword_100A04128 + 1480))(&buf);
    sub_1001568B4(a1, 3);
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid +HAOS command:%d", v16, v17, v18, v19, v20, v21, v22, v6);
      uint64_t v23 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v12 = 2701;
  }
  uint64_t v61 = sub_10014FCB0(a1, v12);
  if (v61) {
    sub_100152814(a1, 1u, v61);
  }
  return 412;
}

void sub_10015579C(__int16 a1)
{
  uint64_t v10 = 0;
  WORD2(v10) = a1;
  v11[1] = &v10;
  v11[0] = (const void *)8;
  if (sub_100026DA8((uint64_t)sub_100155838, v11, 0) && sub_100058654())
  {
    sub_100056E24((uint64_t)"Failed to register with dispatcher!\n", v1, v2, v3, v4, v5, v6, v7, v9);
    uint64_t v8 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
}

uint64_t sub_100155838(uint64_t a1)
{
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t v1 = *(int **)(a1 + 8);
  int v2 = *v1;
  int v3 = *((unsigned __int16 *)v1 + 2);
  uint64_t v4 = qword_100A04128;
  uint64_t v5 = -1472;
  while (*(unsigned __int16 *)(qword_100A04128 + v5 + 1472) != v3)
  {
    v5 += 184;
    if (!v5) {
      goto LABEL_8;
    }
  }
  uint64_t v6 = *(unsigned int *)(qword_100A04128 + v5 + 1480);
  if (v6)
  {
    sub_100026DB4(v6);
    uint64_t v4 = qword_100A04128;
    *(_DWORD *)(qword_100A04128 + v5 + 1480) = 0;
  }
  uint64_t v7 = v4 + v5;
  *(unsigned char *)(v7 + 1484) = 0;
  *(_DWORD *)(v7 + 1476) = v2;
  uint64_t v10 = v4 + v5 + 1552;
LABEL_8:
  LODWORD(v11) = v2;
  WORD2(v9) = v3;
  LODWORD(v9) = 1;
  return (*(uint64_t (**)(uint64_t *))(v4 + 1480))(&v9);
}

BOOL sub_1001558F0()
{
  return dword_100A197F0 && *(unsigned char *)(qword_100A04130 + 401) != 0;
}

void sub_100155920(char a1)
{
  if (!dword_100A197F0) {
    sub_10025B8C0();
  }
  *(unsigned char *)(qword_100A04130 + 401) = a1;
}

uint64_t sub_100155960(uint64_t a1, _DWORD *a2, unsigned int a3, uint64_t a4, unsigned int a5, unsigned int a6)
{
  if (!a1 || !a4)
  {
    sub_10025B8C0();
    return 101;
  }
  if (dword_100A197F0) {
    return 140;
  }
  uint64_t v14 = (char *)sub_10010CE48(0x198uLL);
  qword_100A04130 = (uint64_t)v14;
  if (!v14) {
    return 106;
  }
  uint64_t v15 = 0;
  uint64_t v27 = 0;
  uint64_t v28 = 0;
  uint64_t v26 = 0;
  uint64_t v23 = 0;
  uint64_t v24 = 0;
  uint64_t v22 = 0;
  long long v29 = 0u;
  long long v30 = 0u;
  do
  {
    *(_WORD *)&v14[v15] = -1;
    v15 += 48;
  }
  while (v15 != 384);
  uint64_t v16 = (unsigned char *)sub_10025B218(0x10u);
  uint64_t v17 = qword_100A04130;
  uint64_t v18 = (unsigned char *)(qword_100A04130 + 400);
  *(unsigned char *)(qword_100A04130 + 400) = *v16;
  *(_WORD *)(v17 + 402) = a5;
  *(_WORD *)(v17 + 404) = a6;
  uint64_t v7 = sub_100245A8C((uint64_t)sub_100155BCC, (uint64_t)off_10099C950, a5, a6, v18, (uint64_t)&unk_10099C978);
  if (v7)
  {
LABEL_13:
    sub_100023010((void *)qword_100A04130);
    qword_100A04130 = 0;
    return v7;
  }
  byte_100A04138 = 1;
  dword_100A04140 = *(unsigned __int8 *)(qword_100A04130 + 400);
  word_100A0413A = 1;
  byte_100A04148 = 1;
  word_100A0414A = 1;
  dword_100A04150 = (a3 >> 5) & 1;
  byte_100A04158 = 1;
  word_100A0415A = 2;
  dword_100A04160 = a3 & 0x1F | (32 * ((a3 >> 9) & 1));
  *(void *)&long long v29 = &unk_10099C9A8;
  WORD4(v29) = 5;
  *(void *)&long long v30 = *(void *)a1;
  WORD4(v30) = *(_WORD *)(a1 + 8);
  uint64_t v25 = &unk_10099CA20;
  LOWORD(v26) = 5;
  uint64_t v27 = v30;
  LOWORD(v28) = WORD4(v30);
  uint64_t v21 = &unk_10099CA98;
  LOWORD(v22) = 5;
  uint64_t v23 = v30;
  LOWORD(v24) = WORD4(v30);
  uint64_t v19 = sub_10024E258((uint64_t)&v29, (int *)(qword_100A04130 + 388));
  uint64_t v20 = qword_100A04130;
  if (v19)
  {
    uint64_t v7 = v19;
    sub_100245D68(*(unsigned __int8 *)(qword_100A04130 + 400));
    goto LABEL_13;
  }
  *(void *)(qword_100A04130 + 392) = a4;
  sub_10024E564(*(unsigned int *)(v20 + 388), (uint64_t)&v25);
  sub_10024E564(*(unsigned int *)(qword_100A04130 + 388), (uint64_t)&v21);
  if (a2) {
    *a2 = *(_DWORD *)(qword_100A04130 + 388);
  }
  sub_1001F8154((uint64_t)sub_100155D38);
  sub_100185350(6291456);
  uint64_t v7 = 0;
  dword_100A197F0 = 1;
  return v7;
}

uint64_t sub_100155BCC(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int a4)
{
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  uint64_t v28 = 0;
  uint64_t v6 = 16;
  while (*(_DWORD *)(qword_100A04130 + v6) != *(_DWORD *)a1
       || *(unsigned __int16 *)(qword_100A04130 + v6 + 4) != *(unsigned __int16 *)(a1 + 4))
  {
    v6 += 48;
    if (v6 == 400)
    {
      unsigned int v8 = sub_1001565A8(a1, 2, a4);
      if (v8 != 8)
      {
        WORD2(v26) = a4;
        uint64_t v27 = qword_100A04130 + 48 * v8 + 16;
        LODWORD(v26) = 0;
        return (*(uint64_t (**)(uint64_t *))(qword_100A04130 + 392))(&v26);
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"ERROR : We are out of connection slots. %d", v9, v10, v11, v12, v13, v14, v15, 8);
        uint64_t v16 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          goto LABEL_16;
        }
      }
      return sub_1002463C0((uint64_t)sub_1001561FC, a4, 0);
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"ERROR : We are already connected to this device %:", v18, v19, v20, v21, v22, v23, v24, a1);
    uint64_t v25 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
LABEL_16:
    }
      sub_100745764();
  }
  return sub_1002463C0((uint64_t)sub_1001561FC, a4, 0);
}

void sub_100155D38(uint64_t a1, int a2, int a3)
{
  if (dword_100A197F0)
  {
    uint64_t v4 = sub_100197864(a2);
    unsigned __int16 v30 = 0;
    int v29 = 0;
    sub_10017E37C((uint64_t)v4, (uint64_t)&v29);
    uint64_t v5 = 0;
    uint64_t v6 = qword_100A04130 + 16;
    do
    {
      if (*(_DWORD *)v6 == v29 && *(unsigned __int16 *)(v6 + 4) == v30) {
        break;
      }
      ++v5;
      v6 += 48;
    }
    while (v5 != 8);
    uint64_t v16 = v5;
    int v17 = *(_DWORD *)(qword_100A04130 + 48 * v5 + 32);
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"AdvancedSniffModeChangeCB - deviceID:%d mode:%d mediaState:%s", v18, v19, v20, v21, v22, v23, v24, v16);
      uint64_t v25 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v26 = sub_100050714();
        int buf = 136446210;
        *(void *)buf_4 = v26;
        _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", (uint8_t *)&buf, 0xCu);
      }
    }
    if (!a3 && v17 == 4)
    {
      unsigned __int16 v27 = *(_WORD *)(qword_100A04130 + 48 * v16);
      sub_1001568B4(v27, 0);
      *(_WORD *)&buf_4[2] = 0;
      *(void *)&buf_4[4] = 0;
      uint64_t v33 = 0;
      *(_WORD *)buf_4 = v27;
      int buf = 6;
      (*(void (**)(int *))(qword_100A04130 + 392))(&buf);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"AdvancedSniffModeChangeCB - VSE has fired but module is not initialized", v8, v9, v10, v11, v12, v13, v14, v28);
    uint64_t v15 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100155F38()
{
  if (!dword_100A197F0) {
    return 408;
  }
  if (*(unsigned char *)(qword_100A04130 + 384)) {
    return 141;
  }
  uint64_t result = sub_100245D68(*(unsigned __int8 *)(qword_100A04130 + 400));
  if (!result)
  {
    sub_100185404(6291456);
    sub_10024E448(*(_DWORD *)(qword_100A04130 + 388));
    uint64_t v1 = (void *)qword_100A04130;
    *(void *)(qword_100A04130 + 392) = 0;
    sub_100023010(v1);
    uint64_t result = 0;
    qword_100A04130 = 0;
    dword_100A197F0 = 0;
  }
  return result;
}

uint64_t sub_100155FBC(unsigned int a1, int a2)
{
  if (!dword_100A197F0) {
    return 408;
  }
  uint64_t v4 = 0;
  while (*(unsigned __int16 *)(qword_100A04130 + v4) != a1)
  {
    v4 += 48;
    if (v4 == 384)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Could not find addr for device %d", v5, v6, v7, v8, v9, v10, v11, a1);
        uint64_t v12 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      sub_100156160(a1);
      return 1802;
    }
  }
  unsigned int v13 = sub_100156160(a1);
  if (v13 == 8) {
    return 1802;
  }
  unsigned int v15 = v13;
  if (*(unsigned char *)(qword_100A04130 + 48 * v13 + 28) != 2) {
    return 408;
  }
  if (a2)
  {
    uint64_t v14 = sub_1002463C0((uint64_t)sub_1001561FC, a1, 1);
    if (v14)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_RFCOMM_Accept failed: %! %d\n", v16, v17, v18, v19, v20, v21, v22, v14);
        uint64_t v23 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      sub_100156408(v15);
    }
    return v14;
  }
  uint64_t v25 = sub_1002463C0((uint64_t)sub_1001561FC, a1, 0);
  sub_100156408(v15);
  return v25;
}

uint64_t sub_100156160(unsigned int a1)
{
  uint64_t v2 = 0;
  int v3 = (unsigned __int16 *)qword_100A04130;
  while (1)
  {
    int v4 = *v3;
    v3 += 24;
    if (v4 == a1) {
      break;
    }
    if (++v2 == 8)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Could not find link handle for device %d", v5, v6, v7, v8, v9, v10, v11, a1);
        uint64_t v12 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      LOBYTE(v2) = 8;
      return v2;
    }
  }
  return v2;
}

void sub_1001561FC(uint64_t a1, unsigned __int16 a2, uint64_t a3)
{
  unsigned int v6 = sub_100156160(a1);
  if (v6 != 8)
  {
    unsigned int v7 = v6;
    unsigned int v8 = v6;
    if (*(unsigned __int16 *)(qword_100A04130 + 48 * v6) == a1)
    {
      if (a3)
      {
        int v27 = (unsigned __int16)a1;
        int v29 = a3;
        uint64_t v28 = qword_100A04130 + 48 * sub_100156160(a1) + 16;
        int v30 = a2;
        int v26 = 1;
        (*(void (**)(int *))(qword_100A04130 + 392))(&v26);
        sub_100156408(v7);
      }
      else
      {
        int v17 = sub_1001893B4((uint64_t)off_10099CB10, qword_100A04130 + 48 * v6 + 16);
        if (v17)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Could not register sco for link %d : %!", v18, v19, v20, v21, v22, v23, v24, a1);
            uint64_t v25 = sub_100050B4C(0x10u);
            if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
              sub_100745764();
            }
          }
          *(_DWORD *)(qword_100A04130 + 48 * v8 + 4) = 1817;
          sub_100246730(a1, 1817);
        }
        else
        {
          *(unsigned char *)(qword_100A04130 + 48 * v8 + 28) = 3;
        }
        int v27 = (unsigned __int16)a1;
        int v29 = v17;
        uint64_t v28 = qword_100A04130 + 48 * sub_100156160(a1) + 16;
        int v30 = a2;
        int v26 = 1;
        (*(void (**)(int *))(qword_100A04130 + 392))(&v26);
      }
    }
    else
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Links do not match... %!", v9, v10, v11, v12, v13, v14, v15, a3);
        uint64_t v16 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      *(_DWORD *)(qword_100A04130 + 48 * v8 + 4) = 1816;
      sub_100246730(a1, 1816);
    }
  }
}

double sub_100156408(unsigned int a1)
{
  uint64_t v2 = sub_1001895A8(qword_100A04130 + 48 * a1 + 16);
  if (v2)
  {
    uint64_t v3 = v2;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DeregisterScoApplicationByAddr failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  uint64_t v12 = qword_100A04130;
  uint64_t v13 = (_OWORD *)(qword_100A04130 + 48 * a1);
  double result = 0.0;
  *uint64_t v13 = 0u;
  v13[1] = 0u;
  v13[2] = 0u;
  *(_WORD *)uint64_t v13 = -1;
  --*(unsigned char *)(v12 + 384);
  return result;
}

uint64_t sub_1001564C8(uint64_t a1, char a2)
{
  if (!dword_100A197F0) {
    return 1804;
  }
  if (a1)
  {
    if (*(unsigned char *)(qword_100A04130 + 384) == 8) {
      return 133;
    }
    unsigned int v4 = sub_1001565A8(a1, 1, 0);
    if (v4 == 8)
    {
      return 133;
    }
    else
    {
      unsigned int v7 = v4;
      uint64_t v5 = sub_1002460C8((uint64_t)sub_1001561FC, off_10099C950, a1, a2, 0x3FAu, 0, (_WORD *)(qword_100A04130 + 48 * v4), (uint64_t)&unk_10099C978);
      if (v5) {
        sub_100156408(v7);
      }
    }
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
  return v5;
}

uint64_t sub_1001565A8(uint64_t a1, char a2, __int16 a3)
{
  uint64_t v4 = 0;
  for (uint64_t i = 0; i != 8; ++i)
  {
    if (*(__int16 *)(qword_100A04130 + v4) == -1)
    {
      uint64_t v6 = qword_100A04130 + v4;
      if (!*(_DWORD *)(qword_100A04130 + v4 + 16) && *(_WORD *)(qword_100A04130 + v4 + 20) == 0)
      {
        int v16 = *(_DWORD *)a1;
        *(_WORD *)(v6 + 20) = *(_WORD *)(a1 + 4);
        *(_DWORD *)(v6 + 16) = v16;
        uint64_t v17 = qword_100A04130;
        uint64_t v18 = qword_100A04130 + v4;
        *(_WORD *)uint64_t v18 = a3;
        *(unsigned char *)(v18 + 28) = a2;
        ++*(unsigned char *)(v17 + 384);
        return i;
      }
    }
    v4 += 48;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Could not create raw device addr %:, state %d", v8, v9, v10, v11, v12, v13, v14, a1);
    uint64_t v15 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  LOBYTE(i) = 8;
  return i;
}

uint64_t sub_1001566A8(unsigned int a1, int a2)
{
  if (!dword_100A197F0) {
    return 408;
  }
  unsigned int v3 = sub_100156160(a1);
  if (v3 == 8) {
    return 1802;
  }
  uint64_t v4 = qword_100A04130;
  uint64_t v5 = qword_100A04130 + 48 * v3;
  int v8 = *(unsigned __int8 *)(v5 + 28);
  uint64_t v6 = (unsigned char *)(v5 + 28);
  int v7 = v8;
  if ((v8 - 4) < 2) {
    return 116;
  }
  if (v7 != 3) {
    return 1802;
  }
  *uint64_t v6 = 4;
  *(_DWORD *)(v4 + 48 * v3 + 4) = a2;

  return sub_100157414(v3, a2);
}

uint64_t sub_100156758(unsigned int a1, int a2)
{
  if (!dword_100A197F0) {
    return 408;
  }
  unsigned int v3 = sub_100156160(a1);
  if (v3 == 8) {
    return 1802;
  }
  if (*(_DWORD *)(qword_100A04130 + 48 * v3 + 32) != 1) {
    return 1807;
  }
  uint64_t v5 = 3 * v3;
  LODWORD(result) = sub_10018A98C(qword_100A04130 + 48 * v3 + 16, a2);
  BOOL v6 = result == 0;
  BOOL v7 = (a2 & v6) == 0;
  if ((a2 & v6) != 0) {
    int v8 = 2;
  }
  else {
    int v8 = 0;
  }
  if (v7) {
    uint64_t result = result;
  }
  else {
    uint64_t result = 0;
  }
  *(_DWORD *)(qword_100A04130 + 16 * v5 + 32) = v8;
  return result;
}

uint64_t sub_10015680C(unsigned int a1)
{
  if (!dword_100A197F0) {
    return 408;
  }
  unsigned int v1 = sub_100156160(a1);
  if (v1 == 8 || *(unsigned char *)(qword_100A04130 + 48 * v1 + 28) != 3) {
    return 1802;
  }
  unsigned int v2 = v1;
  if (*(_DWORD *)(qword_100A04130 + 48 * v1 + 32)) {
    return 1806;
  }
  uint64_t result = sub_100189744(qword_100A04130 + 48 * v1 + 16);
  if (!result) {
    *(_DWORD *)(qword_100A04130 + 48 * v2 + 32) = 2;
  }
  return result;
}

uint64_t sub_1001568B4(uint64_t a1, int a2)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HandsfreeAG_SetAoSMediaState - handle:%d mediaState:%s", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      int v16 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  unsigned int v12 = sub_100156160(a1);
  if (v12 == 8) {
    return 1802;
  }
  unsigned int v14 = v12;
  uint64_t result = 0;
  *(_DWORD *)(qword_100A04130 + 48 * v14 + 32) = a2;
  return result;
}

uint64_t sub_1001569D8(unsigned int a1)
{
  return *(unsigned int *)(qword_100A04130 + 48 * sub_100156160(a1) + 32);
}

uint64_t sub_100156A04(unsigned int a1)
{
  if (!dword_100A197F0) {
    return 408;
  }
  unsigned int v2 = sub_100156160(a1);
  if (v2 == 8) {
    return 1802;
  }
  unsigned int v4 = v2;
  int v5 = *(_DWORD *)(qword_100A04130 + 48 * v2 + 32);
  if (v5 == 3)
  {
    BOOL v7 = sub_100151C60(a1);
    uint64_t v8 = qword_100A04130 + 48 * v4;
    if (v7)
    {
      if (*(_DWORD *)(v8 + 32) == 4)
      {
        uint64_t result = sub_100058654();
        if (result)
        {
          sub_100056E24((uint64_t)"Trying to close HAOS while another request is in flight", v9, v10, v11, v12, v13, v14, v15, v17);
          int v16 = sub_100050B4C(0x10u);
          uint64_t result = os_log_type_enabled(v16, OS_LOG_TYPE_ERROR);
          if (result)
          {
            sub_100744F6C();
            uint64_t result = 0;
          }
        }
      }
      else
      {
        uint64_t result = sub_1001519B4(a1);
        if (result) {
          return result;
        }
      }
    }
    else
    {
      uint64_t result = sub_1001896B4(*(void *)(v8 + 8));
      if (result) {
        return result;
      }
    }
    int v6 = 4;
  }
  else
  {
    if (v5 != 2) {
      return 1807;
    }
    LODWORD(result) = sub_10018B7C0(qword_100A04130 + 48 * v2 + 16);
    int v6 = 0;
    if (result == 1301) {
      uint64_t result = 1807;
    }
    else {
      uint64_t result = result;
    }
  }
  *(_DWORD *)(qword_100A04130 + 48 * v4 + 32) = v6;
  return result;
}

BOOL sub_100156B44(unsigned int a1)
{
  if (dword_100A197F0 && (unsigned int v1 = sub_100156160(a1), v1 != 8)) {
    return *(_DWORD *)(qword_100A04130 + 48 * v1 + 32) == 3;
  }
  else {
    return 0;
  }
}

uint64_t sub_100156B98(unsigned int a1, uint64_t a2, char *a3, size_t a4)
{
  if (!dword_100A197F0) {
    return 408;
  }
  if (!a2)
  {
    sub_10025B8C0();
    return 101;
  }
  unsigned int v8 = sub_100156160(a1);
  if (v8 == 8) {
    return 1802;
  }
  if (*(unsigned char *)(qword_100A04130 + 48 * v8 + 28) != 3) {
    return 408;
  }
  unsigned int v10 = v8;
  if (*(void *)(qword_100A04130 + 48 * v8 + 40)) {
    return 118;
  }
  uint64_t result = sub_1002460BC((uint64_t)sub_100156C7C, a1, a3, a4);
  if (!result) {
    *(void *)(qword_100A04130 + 48 * v10 + 40) = a2;
  }
  return result;
}

uint64_t sub_100156C7C(uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (qword_100A04130)
  {
    uint64_t v7 = result;
    uint64_t result = sub_100156160(result);
    if (result != 8)
    {
      uint64_t v8 = qword_100A04130 + 48 * result;
      uint64_t v11 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t))(v8 + 40);
      unsigned int v10 = (void *)(v8 + 40);
      uint64_t v9 = v11;
      if (v11)
      {
        *unsigned int v10 = 0;
        return v9(v7, a2, a3, a4);
      }
    }
  }
  return result;
}

uint64_t sub_100156D1C(uint64_t a1)
{
  if (*(unsigned char *)(a1 + 2) != 1) {
    sub_10025B8C0();
  }
  uint64_t v2 = 0;
  while (*(void *)(qword_100A04130 + v2 + 8) != a1)
  {
    v2 += 48;
    if (v2 == 384) {
      goto LABEL_8;
    }
  }
  uint64_t result = *(unsigned __int16 *)(qword_100A04130 + v2);
  if (*(_WORD *)(qword_100A04130 + v2)) {
    return result;
  }
LABEL_8:
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"Could not find sco hfp handle for sco hci connection handle %d", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = sub_100050B4C(0x10u);
    uint64_t result = os_log_type_enabled(v11, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100745764();
      return 0;
    }
  }
  return result;
}

uint64_t sub_100156DD0(uint64_t a1)
{
  if (*(unsigned char *)(a1 + 2)) {
    sub_10025B8C0();
  }
  uint64_t v2 = 0;
  while (*(_DWORD *)(qword_100A04130 + v2 + 16) != *(_DWORD *)(a1 + 48)
       || *(unsigned __int16 *)(qword_100A04130 + v2 + 20) != *(unsigned __int16 *)(a1 + 52))
  {
    v2 += 48;
    if (v2 == 384) {
      goto LABEL_11;
    }
  }
  uint64_t result = *(unsigned __int16 *)(qword_100A04130 + v2);
  if (*(_WORD *)(qword_100A04130 + v2)) {
    return result;
  }
LABEL_11:
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"Could not find sco hfp handle for sco hci connection handle %d", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x10u);
    uint64_t result = os_log_type_enabled(v12, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100745764();
      return 0;
    }
  }
  return result;
}

uint64_t sub_100156E90()
{
  return *(unsigned __int16 *)(qword_100A04130 + 402);
}

uint64_t sub_100156EA0(uint64_t a1, char a2, _WORD *a3, _WORD *a4, int a5)
{
  if (!dword_100A197F0) {
    return 1804;
  }
  if (a1)
  {
    if (*(unsigned char *)(qword_100A04130 + 384) == 8) {
      return 133;
    }
    unsigned int v10 = sub_1001565A8(a1, 1, 0);
    if (v10 == 8) {
      return 133;
    }
    unsigned int v12 = v10;
    uint64_t v13 = sub_100246928((uint64_t)sub_1001561FC, (uint64_t)off_10099C950, a1, a2, *(unsigned __int16 *)(qword_100A04130 + 402), 0, (_WORD *)(qword_100A04130 + 48 * v10), a3, (uint64_t)&unk_10099C978, a5);
    if (v13)
    {
      uint64_t v11 = v13;
      sub_100156408(v12);
      return v11;
    }
    int v15 = *(unsigned __int16 *)(qword_100A04130 + 48 * v12);
    *a4 = v15;
    if (sub_100151D10(v15, a1) == 255)
    {
      return 133;
    }
    else
    {
      uint64_t v11 = sub_1001893B4((uint64_t)off_10099CB10, qword_100A04130 + 48 * v12 + 16);
      if (v11)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Could not register sco for link", v16, v17, v18, v19, v20, v21, v22, v24);
          uint64_t v23 = sub_100050B4C(0x10u);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
      }
      else
      {
        *(unsigned char *)(qword_100A04130 + 48 * v12 + 28) = 3;
      }
    }
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
  return v11;
}

void sub_100157054(uint64_t a1, unsigned int a2)
{
  if (dword_100A197F0)
  {
    sub_1001895A8(a1);
    uint64_t v4 = 0;
    uint64_t v5 = qword_100A04130 + 16;
    while (*(_DWORD *)v5 != *(_DWORD *)a1 || *(unsigned __int16 *)(v5 + 4) != *(unsigned __int16 *)(a1 + 4))
    {
      ++v4;
      v5 += 48;
      if (v4 == 8) {
        goto LABEL_15;
      }
    }
    if (v4 != 8) {
      sub_100156408(v4);
    }
LABEL_15:
    sub_100246CFC(a1, a2);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HandsfreeRaw_FastConnect_DestroyChannel Handsfree AG service not started!", v7, v8, v9, v10, v11, v12, v13, v15);
    uint64_t v14 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
}

uint64_t sub_100157144(unsigned int a1, int a2)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"HANDSFREE RFCOMM_ReleaseInd, link=%d, reason=%!", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = sub_100050B4C(0x10u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v15 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t result = sub_100156160(a1);
  if (result != 8)
  {
    uint64_t v13 = qword_100A04130 + 48 * result;
    *(unsigned char *)(v13 + 28) = 0;
    *(_DWORD *)(v13 + 4) = a2;
    return sub_100157414(result, a2);
  }
  return result;
}

void sub_100157248(unsigned int a1, uint64_t a2, int a3)
{
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  uint64_t v28 = 0;
  unsigned int v6 = sub_100156160(a1);
  if (v6 == 8)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Ignoring received data, we are not connected to this device ... %d", v7, v8, v9, v10, v11, v12, v13, 8);
      uint64_t v14 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
LABEL_14:
      }
        sub_100745764();
    }
  }
  else
  {
    unsigned int v15 = v6;
    if ((*(unsigned char *)(qword_100A04130 + 48 * v6 + 28) & 0xFE) == 4)
    {
      if (sub_100058654())
      {
        unint64_t v23 = *(char *)(qword_100A04130 + 48 * v15 + 28);
        uint64_t v24 = v23 > 5 ? "UNKNOWN" : off_10099CBC0[v23];
        sub_100056E24((uint64_t)"Ignoring received data while in state %s", v16, v17, v18, v19, v20, v21, v22, (uint64_t)v24);
        uint64_t v25 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          goto LABEL_14;
        }
      }
    }
    else if (a3 == 3)
    {
      strcpy(v29, "\r\nAT+OK\r\n");
      sub_1002460BC((uint64_t)sub_100156C7C, a1, v29, 0xAuLL);
    }
    else
    {
      LODWORD(v26) = 7;
      WORD2(v26) = a1;
      uint64_t v27 = a2;
      LOWORD(v28) = a3;
      (*(void (**)(uint64_t *))(qword_100A04130 + 392))(&v26);
    }
  }
}

uint64_t sub_100157414(unsigned int a1, int a2)
{
  uint64_t v42 = 0;
  uint64_t v43 = 0;
  uint64_t v44 = 0;
  uint64_t v4 = qword_100A04130;
  if ((*(_DWORD *)(qword_100A04130 + 48 * a1 + 32) | 4) == 4)
  {
    uint64_t v6 = 0;
  }
  else
  {
    uint64_t v6 = sub_1001896B4(*(void *)(qword_100A04130 + 48 * a1 + 8));
    if (v6)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"ScoDisconnect failed - %!, setting as disconnected, State %d\n", v7, v8, v9, v10, v11, v12, v13, v6);
        uint64_t v14 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      int v15 = 0;
    }
    else
    {
      int v15 = 4;
    }
    uint64_t v4 = qword_100A04130;
    *(_DWORD *)(qword_100A04130 + 48 * a1 + 32) = v15;
  }
  if (*(unsigned char *)(v4 + 48 * a1 + 28)) {
    BOOL v16 = *(unsigned char *)(v4 + 48 * a1 + 28) == 5;
  }
  else {
    BOOL v16 = 1;
  }
  if (!v16)
  {
    uint64_t v28 = sub_100246730(*(unsigned __int16 *)(v4 + 48 * a1), a2);
    uint64_t v6 = v28;
    if (!v28)
    {
      uint64_t v4 = qword_100A04130;
      *(unsigned char *)(qword_100A04130 + 48 * a1 + 28) = 4;
      goto LABEL_17;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"RFCOMM_Disconnect failed - %!, forcing disconnect!, state %d\n", v29, v30, v31, v32, v33, v34, v35, v6);
      uint64_t v36 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    goto LABEL_16;
  }
  if (v6)
  {
LABEL_16:
    sub_1001576D0(a1);
    uint64_t v4 = qword_100A04130;
  }
LABEL_17:
  if (*(_DWORD *)(v4 + 48 * a1 + 32) || *(unsigned char *)(v4 + 48 * a1 + 28))
  {
    uint64_t v17 = v4 + 48 * a1;
    int v19 = *(_DWORD *)(v17 + 24);
    uint64_t v18 = (int *)(v17 + 24);
    if (!v19)
    {
      v41[1] = (const void *)(v4 + 48 * a1);
      v41[0] = (const void *)2;
      uint64_t v6 = sub_1000268E4((uint64_t)sub_100157780, v41, 50, v18);
      if (v6)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Register disconnect timeout handler failed %!\n", v20, v21, v22, v23, v24, v25, v26, v6);
          uint64_t v27 = sub_100050B4C(0x10u);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
      }
    }
  }
  else
  {
    uint64_t v37 = *(unsigned int *)(v4 + 48 * a1 + 24);
    if (v37)
    {
      sub_100026DB4(v37);
      uint64_t v4 = qword_100A04130;
      *(_DWORD *)(qword_100A04130 + 48 * a1 + 24) = 0;
    }
    uint64_t v38 = *(void (**)(uint64_t *))(v4 + 392);
    if (v38)
    {
      uint64_t v39 = v4 + 48 * a1;
      WORD2(v42) = *(_WORD *)v39;
      LODWORD(v42) = 2;
      LODWORD(v43) = *(_DWORD *)(v39 + 4);
      v38(&v42);
    }
    sub_100156408(a1);
  }
  return v6;
}

void sub_1001576D0(unsigned int a1)
{
  uint64_t v2 = qword_100A04130 + 48 * a1;
  *(unsigned char *)(v2 + 28) = 5;
  uint64_t v3 = sub_10017C380(v2 + 16);
  if (v3)
  {
    uint64_t v4 = v3;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"ForceDisconnect failed - %!, assuming already disconnected\n", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = sub_100050B4C(0x10u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    *(unsigned char *)(qword_100A04130 + 48 * a1 + 28) = 0;
  }
}

uint64_t sub_100157780(uint64_t a1)
{
  uint64_t result = sub_100156160(**(unsigned __int16 **)(a1 + 8));
  if (result != 8)
  {
    uint64_t v2 = result;
    *(_DWORD *)(qword_100A04130 + 48 * result + 24) = 0;
    sub_1001576D0(result);
    *(_DWORD *)(qword_100A04130 + 48 * v2 + 4) = 1814;
    return sub_100157414(v2, 1814);
  }
  return result;
}

uint64_t sub_10015780C(uint64_t result, uint64_t a2, uint64_t a3)
{
  unsigned __int8 v3 = 0;
  uint64_t v4 = qword_100A04130;
  uint64_t v5 = -384;
  while (*(_DWORD *)(qword_100A04130 + v5 + 400) != *(_DWORD *)a3
       || *(unsigned __int16 *)(qword_100A04130 + v5 + 404) != *(unsigned __int16 *)(a3 + 4))
  {
    ++v3;
    v5 += 48;
    if (!v5) {
      return result;
    }
  }
  if (v3 != 8)
  {
    uint64_t v12 = 0;
    uint64_t v13 = 0;
    uint64_t v14 = 0;
    uint64_t v7 = qword_100A04130 + v5;
    if (result)
    {
      if (*(_DWORD *)(v7 + 416) == 3) {
        return result;
      }
      *(_DWORD *)(v7 + 416) = 0;
    }
    else
    {
      *(void *)(v7 + 392) = a2;
      *(_DWORD *)(v7 + 416) = 3;
    }
    LODWORD(v12) = 5;
    WORD2(v12) = *(_WORD *)(v4 + v5 + 384);
    LODWORD(v13) = result;
    uint64_t result = (*(uint64_t (**)(uint64_t *))(v4 + 392))(&v12);
    unsigned int v8 = *(unsigned __int8 *)(qword_100A04130 + v5 + 412);
    BOOL v9 = v8 > 5;
    int v10 = (1 << v8) & 0x31;
    if (!v9 && v10 != 0) {
      return sub_100157414(v3, *(_DWORD *)(qword_100A04130 + v5 + 388));
    }
  }
  return result;
}

void sub_10015790C(int a1, uint64_t a2)
{
  if (*(unsigned char *)(a2 + 2) != 1) {
    sub_10025B8C0();
  }
  unsigned __int8 v4 = 0;
  uint64_t v28 = 0;
  uint64_t v29 = 0;
  uint64_t v30 = 0;
  uint64_t v5 = qword_100A04130;
  uint64_t v6 = -384;
  while (*(void *)(qword_100A04130 + v6 + 392) != a2)
  {
    ++v4;
    v6 += 48;
    if (!v6)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Could not find sco handle for device %d", v7, v8, v9, v10, v11, v12, v13, a2);
        uint64_t v14 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
LABEL_8:
          sub_100745764();
          return;
        }
      }
      return;
    }
  }
  if (v4 != 8)
  {
    if (a1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"SCO disconnect failed for handle %d, %!", v15, v16, v17, v18, v19, v20, v21, *(unsigned __int16 *)(qword_100A04130 + v6 + 384));
        uint64_t v22 = sub_100050B4C(0x10u);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          goto LABEL_8;
        }
      }
    }
    else
    {
      uint64_t v23 = qword_100A04130 + v6;
      *(_DWORD *)(v23 + 416) = 0;
      *(void *)(v23 + 392) = 0;
      LODWORD(v28) = 6;
      WORD2(v28) = *(_WORD *)(v5 + v6 + 384);
      LODWORD(v29) = 0;
      (*(void (**)(uint64_t *))(v5 + 392))(&v28);
      unsigned int v24 = *(unsigned __int8 *)(qword_100A04130 + v6 + 412);
      BOOL v25 = v24 > 5;
      int v26 = (1 << v24) & 0x31;
      if (!v25 && v26 != 0) {
        sub_100157414(v4, *(_DWORD *)(qword_100A04130 + v6 + 388));
      }
    }
  }
}

uint64_t sub_100157A94(uint64_t a1)
{
  uint64_t v1 = 0;
  uint64_t v2 = qword_100A04130;
  while (*(_DWORD *)(qword_100A04130 + v1 + 16) != *(_DWORD *)a1
       || *(unsigned __int16 *)(qword_100A04130 + v1 + 20) != *(unsigned __int16 *)(a1 + 4))
  {
    v1 += 48;
    if (v1 == 384) {
      goto LABEL_11;
    }
  }
  uint64_t v6 = 0;
  uint64_t v7 = 0;
  uint64_t v8 = 0;
  uint64_t v4 = qword_100A04130 + v1;
  if (*(unsigned char *)(qword_100A04130 + v1 + 28) == 3 && (*(_DWORD *)(v4 + 32) | 2) == 2)
  {
    *(_DWORD *)(v4 + 32) = 1;
    LODWORD(v6) = 3;
    LODWORD(v7) = 1;
    WORD2(v6) = *(_WORD *)(v2 + v1);
    return (*(uint64_t (**)(uint64_t *))(v2 + 392))(&v6);
  }
LABEL_11:

  return sub_10018A98C(a1, 0);
}

uint64_t sub_100157B64(char *a1, uint64_t a2, _WORD *a3)
{
  uint64_t v3 = 22;
  if (a1 && a3)
  {
    if (a2)
    {
      LOWORD(v4) = *a3;
      do
      {
        char v5 = *a1++;
        int v4 = word_1007B9668[(v5 ^ v4)] ^ ((unsigned __int16)(v4 & 0xFF00) >> 8);
        *a3 = v4;
        --a2;
      }
      while (a2);
    }
    return 0;
  }
  return v3;
}

uint64_t sub_100157BB0(int a1)
{
  uint64_t v1 = sub_100157C18(a1);
  uint64_t v4 = v1;
  if (!v1) {
    sub_10025B8C0();
  }
  v3[1] = &v4;
  v3[0] = (const void *)8;
  return sub_1000268E4((uint64_t)sub_100157C70, v3, 30, (int *)(v1 + 200));
}

uint64_t sub_100157C18(int a1)
{
  uint64_t result = 0;
  if (a1 && dword_100A19804)
  {
    uint64_t v3 = *(unsigned __int8 *)(qword_100A04168 + 36);
    if (*(unsigned char *)(qword_100A04168 + 36))
    {
      for (uint64_t result = *(void *)qword_100A04168;
            !*(_DWORD *)(result + 196) || *(unsigned __int16 *)(result + 192) != a1;
            result += 216)
      {
        if (!--v3) {
          return 0;
        }
      }
    }
    else
    {
      return 0;
    }
  }
  return result;
}

void sub_100157C70(uint64_t a1)
{
  uint64_t v1 = **(void **)(a1 + 8);
  if (sub_100058654()
    && (sub_100056E24((uint64_t)"Didn't get transaction response within timeout period", v2, v3, v4, v5, v6, v7, v8, v19),
        uint64_t v9 = sub_100050B4C(0x15u),
        os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)))
  {
    sub_100744F6C();
    if (v1)
    {
LABEL_4:
      *(_DWORD *)(v1 + 200) = 0;
      uint64_t v10 = *(void (**)(uint64_t))(*(void *)(qword_100A04168 + 8) + 40);
      if (v10) {
        v10(v1);
      }
      return;
    }
  }
  else if (v1)
  {
    goto LABEL_4;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Invalid HID host handle in transaction timeout", v11, v12, v13, v14, v15, v16, v17, v19);
    uint64_t v18 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100157D3C(unsigned int a1)
{
  uint64_t v2 = sub_100157C18(a1);
  if (v2)
  {
    uint64_t v3 = v2;
    uint64_t v4 = *(unsigned int *)(v2 + 200);
    if (v4)
    {
      sub_100026DB4(v4);
      *(_DWORD *)(v3 + 200) = 0;
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"CancelTransactionTimeout called on invalid handle %d", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

double sub_100157DCC(uint64_t a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  if (!*(_DWORD *)(a1 + 196)) {
    sub_10025B8C0();
  }
  if (*(_DWORD *)(a1 + 200)) {
    sub_100157D3C(*(unsigned __int16 *)(a1 + 192));
  }
  *(void *)(a1 + 208) = 0;
  double result = 0.0;
  *(_OWORD *)(a1 + 176) = 0u;
  *(_OWORD *)(a1 + 192) = 0u;
  *(_OWORD *)(a1 + 144) = 0u;
  *(_OWORD *)(a1 + 160) = 0u;
  *(_OWORD *)(a1 + 112) = 0u;
  *(_OWORD *)(a1 + 128) = 0u;
  *(_OWORD *)(a1 + 80) = 0u;
  *(_OWORD *)(a1 + 96) = 0u;
  *(_OWORD *)(a1 + 48) = 0u;
  *(_OWORD *)(a1 + 64) = 0u;
  *(_OWORD *)(a1 + 16) = 0u;
  *(_OWORD *)(a1 + 32) = 0u;
  *(_OWORD *)a1 = 0u;
  --*(unsigned char *)(qword_100A04168 + 37);
  return result;
}

uint64_t sub_100157E48(uint64_t a1)
{
  uint64_t result = 0;
  if (a1 && dword_100A19804)
  {
    uint64_t v3 = *(unsigned __int8 *)(qword_100A04168 + 36);
    if (*(unsigned char *)(qword_100A04168 + 36))
    {
      for (uint64_t result = *(void *)qword_100A04168; ; result += 216)
      {
        if (*(_DWORD *)(result + 196))
        {
          if (*(_DWORD *)a1 == *(_DWORD *)result && *(unsigned __int16 *)(a1 + 4) == *(unsigned __int16 *)(result + 4)) {
            break;
          }
        }
        if (!--v3) {
          return 0;
        }
      }
    }
    else
    {
      return 0;
    }
  }
  return result;
}

uint64_t sub_100157EB0(int a1)
{
  uint64_t result = 0;
  if (a1 && dword_100A19804)
  {
    uint64_t v3 = *(unsigned __int8 *)(qword_100A04168 + 36);
    if (*(unsigned char *)(qword_100A04168 + 36))
    {
      for (uint64_t result = *(void *)qword_100A04168;
            *(unsigned __int16 *)(result + 16) != a1 && *(unsigned __int16 *)(result + 104) != a1;
            result += 216)
      {
        if (!--v3) {
          return 0;
        }
      }
    }
    else
    {
      return 0;
    }
  }
  return result;
}

uint64_t sub_100157F0C(int a1, int a2)
{
  uint64_t v3 = sub_100157C18(a1);
  uint64_t v4 = v3 + 104;
  uint64_t v5 = v3 + 16;
  if (a2 != 17) {
    uint64_t v5 = 0;
  }
  if (a2 != 19) {
    uint64_t v4 = v5;
  }
  if (v3) {
    return v4;
  }
  else {
    return 0;
  }
}

uint64_t sub_100157F50(void *a1, unsigned int a2, void *a3)
{
  if (dword_100A19804) {
    return 119;
  }
  if (!a1)
  {
    sub_10025B8C0();
    return 101;
  }
  if (!*a1 || !a1[1] || !a1[2] || !a1[3] || !a1[4])
  {
    sub_10025B8C0();
    if (!*a1) {
      return 101;
    }
  }
  if (!a1[1] || !a1[2] || !a1[3] || !a1[4]) {
    return 101;
  }
  uint64_t v7 = sub_10010CE48(0x28uLL);
  qword_100A04168 = (uint64_t)v7;
  if (!v7) {
    return 106;
  }
  v7[37] = 0;
  v7[36] = a2;
  uint64_t v8 = sub_10010CE48(216 * a2);
  uint64_t v9 = qword_100A04168;
  *(void *)qword_100A04168 = v8;
  *(void *)(v9 + 8) = a1;
  if (v8)
  {
    uint64_t v10 = sub_1001E5FF0(17, (uint64_t)sub_100158168);
    if (v10)
    {
      uint64_t v3 = v10;
      if (!sub_100058654()) {
        goto LABEL_25;
      }
      sub_100056E24((uint64_t)"Couldn't regster OI_PSM_HID_CONTROL: %!", v11, v12, v13, v14, v15, v16, v17, v3);
      uint64_t v18 = sub_100050B4C(0x15u);
      if (!os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        goto LABEL_25;
      }
    }
    else
    {
      uint64_t v3 = sub_1001E5FF0(19, (uint64_t)sub_10015826C);
      if (!v3)
      {
        dword_100A19804 = 1;
        *a3 = qword_100A04168;
        return v3;
      }
      if (!sub_100058654()) {
        goto LABEL_25;
      }
      sub_100056E24((uint64_t)"Couldn't regster OI_PSM_HID_INTERRUPT: %!", v20, v21, v22, v23, v24, v25, v26, v3);
      uint64_t v27 = sub_100050B4C(0x15u);
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        goto LABEL_25;
      }
    }
    sub_100744F6C();
  }
  else
  {
    uint64_t v3 = 106;
  }
LABEL_25:
  if (*(void *)qword_100A04168)
  {
    sub_100023010(*(void **)qword_100A04168);
    *(void *)qword_100A04168 = 0;
  }
  sub_1001E61E4(17);
  sub_1001E61E4(19);
  if (qword_100A04168)
  {
    sub_100023010((void *)qword_100A04168);
    qword_100A04168 = 0;
  }
  return v3;
}

void sub_100158168(int a1, uint64_t a2, uint64_t a3)
{
  uint64_t v8 = 0;
  if (a1 != 17) {
    sub_10025B8C0();
  }
  if (dword_100A19804 || (sub_10025B8C0(), dword_100A19804))
  {
    int v5 = sub_100158588(a2, 0, (uint64_t)&v8);
    uint64_t v6 = v8;
    if (v5)
    {
      if (v8) {
        uint64_t v7 = *(void *)(v8 + 24);
      }
      else {
        uint64_t v7 = 0;
      }
      sub_1001E0320((uint64_t)sub_1001586E8, (uint64_t)sub_100158900, (uint64_t)sub_100158A3C, a3, v7, 0, (uint64_t)&unk_1007B9868);
    }
    else
    {
      *(_WORD *)(v8 + 192) = a3;
      *(_WORD *)(v6 + 16) = a3;
      *(_DWORD *)(v6 + 40) = 1;
      *(unsigned char *)(v6 + 96) = 0;
      *(unsigned char *)(v6 + 7) = 0;
      (**(void (***)(uint64_t, uint64_t))(qword_100A04168 + 8))(a2, a3);
    }
  }
}

void sub_10015826C(int a1, uint64_t a2, unsigned int a3)
{
  if (a1 != 19) {
    sub_10025B8C0();
  }
  if (dword_100A19804 || (sub_10025B8C0(), dword_100A19804))
  {
    uint64_t v5 = sub_100157E48(a2);
    if (v5)
    {
      if ((*(_DWORD *)(v5 + 40) - 1) < 2)
      {
        *(_WORD *)(v5 + 104) = a3;
        int v6 = 1;
        *(_DWORD *)(v5 + 128) = 1;
        uint64_t v7 = *(void *)(v5 + 112);
LABEL_15:
        sub_1001E0320((uint64_t)sub_100159634, (uint64_t)sub_100159784, (uint64_t)sub_100158A3C, a3, v7, v6, (uint64_t)&unk_1007B9868);
        return;
      }
      if (!sub_100058654()
        || (sub_100056E24((uint64_t)"Control channel must be connected first. Refusing.", v16, v17, v18, v19, v20, v21, v22, v24), uint64_t v23 = sub_100050B4C(0x15u), !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
      {
LABEL_14:
        int v6 = 0;
        uint64_t v7 = 0;
        goto LABEL_15;
      }
    }
    else
    {
      if (!sub_100058654()) {
        goto LABEL_14;
      }
      sub_100056E24((uint64_t)"No connection associated with this BDADDR.", v8, v9, v10, v11, v12, v13, v14, v24);
      uint64_t v15 = sub_100050B4C(0x15u);
      if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        goto LABEL_14;
      }
    }
    sub_100744F6C();
    goto LABEL_14;
  }
}

uint64_t sub_1001583B8()
{
  if (!dword_100A19804) {
    return 121;
  }
  if (*(unsigned char *)(qword_100A04168 + 37)) {
    return 141;
  }
  uint64_t result = sub_1001E61E4(17);
  if (!result)
  {
    uint64_t result = sub_1001E61E4(19);
    if (!result)
    {
      uint64_t v1 = qword_100A04168;
      *(void *)(qword_100A04168 + 8) = 0;
      *(unsigned char *)(v1 + 36) = 0;
      if (*(void *)v1)
      {
        sub_100023010(*(void **)v1);
        uint64_t v1 = qword_100A04168;
        *(void *)qword_100A04168 = 0;
      }
      sub_100023010((void *)v1);
      uint64_t result = 0;
      qword_100A04168 = 0;
      dword_100A19804 = 0;
    }
  }
  return result;
}

uint64_t sub_100158450(uint64_t a1, uint64_t *a2, _WORD *a3, void *a4)
{
  if (!dword_100A19804) {
    return 408;
  }
  uint64_t v17 = 0;
  uint64_t v8 = sub_100158588(a1, 1, (uint64_t)&v17);
  if (!v8)
  {
    if (a2)
    {
      uint64_t v9 = v17;
      uint64_t v10 = *a2;
      uint64_t v11 = a2[1];
      *(void *)(v17 + 24) = *a2;
      *(void *)(v9 + 32) = v11;
      *(void *)(v9 + 112) = a2[2];
    }
    else
    {
      uint64_t v10 = 0;
      uint64_t v11 = 0;
      uint64_t v9 = v17;
      *(void *)(v17 + 112) = 0;
      *(void *)(v9 + 24) = 0;
      *(void *)(v9 + 32) = 0;
    }
    *(void *)(v9 + 120) = v11;
    if (a4) {
      uint64_t v12 = a4;
    }
    else {
      uint64_t v12 = &unk_1007B9868;
    }
    uint64_t v8 = sub_1001DF7BC((uint64_t)sub_1001586E8, (uint64_t)sub_100158900, (uint64_t)sub_100158A3C, 17, v9, v10, (_WORD *)(v9 + 16), (uint64_t)v12);
    uint64_t v13 = v17;
    if (v8)
    {
      sub_100157DCC(v17);
    }
    else
    {
      __int16 v14 = *(_WORD *)(v17 + 16);
      *(_WORD *)(v17 + 192) = v14;
      *(_DWORD *)(v13 + 40) = 1;
      *(_DWORD *)(v13 + 196) = 1;
      *a3 = v14;
      uint64_t v15 = sub_100197A30(a1);
      uint64_t v8 = 0;
      if (v15) {
        *(unsigned char *)(v15 + 256) = 0;
      }
    }
  }
  return v8;
}

uint64_t sub_100158588(uint64_t a1, char a2, uint64_t a3)
{
  if (!a3) {
    sub_10025B8C0();
  }
  uint64_t v6 = qword_100A04168;
  uint64_t v7 = *(unsigned __int8 *)(qword_100A04168 + 36);
  if (*(unsigned char *)(qword_100A04168 + 36))
  {
    uint64_t v8 = 0;
    uint64_t v9 = *(void *)qword_100A04168;
    do
    {
      uint64_t v10 = v9;
      if (*(_DWORD *)(v9 + 196))
      {
        BOOL v11 = *(_DWORD *)a1 == *(_DWORD *)v9 && *(unsigned __int16 *)(a1 + 4) == *(unsigned __int16 *)(v9 + 4);
        uint64_t v10 = v8;
        if (v11)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"A connection to %: already exists", v22, v23, v24, v25, v26, v27, v28, a1);
            uint64_t v29 = sub_100050B4C(0x15u);
            if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
          return 133;
        }
      }
      v9 += 216;
      uint64_t v8 = v10;
      --v7;
    }
    while (v7);
    if (!v10) {
      goto LABEL_13;
    }
    uint64_t result = 0;
    *(void *)a3 = v10;
    ++*(unsigned char *)(v6 + 37);
    *(_DWORD *)(v10 + 196) = 1;
    int v13 = *(_DWORD *)a1;
    *(_WORD *)(v10 + 4) = *(_WORD *)(a1 + 4);
    *(_DWORD *)uint64_t v10 = v13;
    *(unsigned char *)(*(void *)a3 + 6) = a2;
  }
  else
  {
LABEL_13:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Too many connections. Refusing connection allocation request.", v14, v15, v16, v17, v18, v19, v20, v30);
      uint64_t v21 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 104;
  }
  return result;
}

void sub_1001586E8(int a1, __int16 a2, __int16 a3, uint64_t a4)
{
  if (!dword_100A19804)
  {
    sub_10025B8C0();
    if (!dword_100A19804) {
      return;
    }
  }
  uint64_t v8 = sub_100157EB0(a1);
  if (!v8)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"Unexpected L2cap connection confirmation", v19, v20, v21, v22, v23, v24, v25, v35);
    uint64_t v26 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_11:
    sub_100744F6C();
    return;
  }
  uint64_t v9 = v8;
  if (a4)
  {
    uint64_t v10 = *(unsigned __int16 *)(v8 + 192);
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"L2capControlConnectCfm: %!", v11, v12, v13, v14, v15, v16, v17, a4);
      uint64_t v18 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    (*(void (**)(uint64_t, uint64_t))(*(void *)(qword_100A04168 + 8) + 8))(v10, a4);
    sub_100157DCC(v9);
    return;
  }
  if (*(_DWORD *)(v8 + 40) != 1)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"Unexpected L2cap connection confirmation", v27, v28, v29, v30, v31, v32, v33, v35);
    uint64_t v34 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_11;
  }
  *(_DWORD *)(v8 + 40) = 2;
  *(_WORD *)(v8 + 44) = a2;
  *(_WORD *)(v8 + 46) = a3;
  if (*(unsigned char *)(v8 + 6))
  {
    if (sub_1001DF7BC((uint64_t)sub_100159634, (uint64_t)sub_100159784, (uint64_t)sub_100158A3C, 19, v8, *(void *)(v8 + 112), (_WORD *)(v8 + 104), (uint64_t)&unk_1007B9868))
    {
      *(_DWORD *)(v9 + 196) = 5;
      sub_100159890(v9, 436);
    }
    else
    {
      *(void *)(v9 + 128) = 1;
    }
  }
}

void sub_100158900(int a1, uint64_t a2)
{
  if (!dword_100A19804)
  {
    sub_10025B8C0();
    if (!dword_100A19804) {
      return;
    }
  }
  uint64_t v4 = sub_100157EB0(a1);
  if (v4)
  {
    uint64_t v5 = v4;
    if ((*(_DWORD *)(v4 + 196) | 4) == 5)
    {
      (*(void (**)(void, uint64_t))(*(void *)(qword_100A04168 + 8) + 8))(*(unsigned __int16 *)(v4 + 192), 2603);
LABEL_6:
      sub_100157DCC(v5);
      return;
    }
    if (!*(_DWORD *)(v4 + 128))
    {
      (*(void (**)(void, uint64_t))(*(void *)(qword_100A04168 + 8) + 16))(*(unsigned __int16 *)(v4 + 192), a2);
      goto LABEL_6;
    }
    *(_WORD *)(v4 + 16) = 0;
    *(void *)(v4 + 40) = 0;
    sub_100158D8C(v4, a2);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Unexpected L2cap disconnect indication", v6, v7, v8, v9, v10, v11, v12, v14);
    uint64_t v13 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100158A3C(uint64_t a1, unsigned __int8 *a2, unsigned int a3, uint64_t a4, uint64_t a5)
{
  if (!dword_100A19804)
  {
    sub_10025B8C0();
    if (!dword_100A19804) {
      return;
    }
  }
  uint64_t v9 = sub_100157EB0(a1);
  if (!v9)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"Unexpected L2capRecvDataInd", v18, v19, v20, v21, v22, v23, v24, v43);
    uint64_t v25 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_22;
  }
  if (!a3)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"0 bytes received", v26, v27, v28, v29, v30, v31, v32, v43);
    uint64_t v33 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_22;
  }
  uint64_t v10 = (unsigned __int16 *)v9;
  unsigned int v11 = *(unsigned __int16 *)(v9 + 44);
  if (v11 < a3)
  {
    sub_10025B8C0();
    unsigned int v11 = v10[22];
  }
  unsigned int v13 = *a2;
  uint64_t v12 = a2 + 1;
  uint64_t v14 = v13 >> 4;
  uint64_t v15 = v13 & 0xF;
  if (v10[8] != a1)
  {
    if (v10[52] == a1)
    {
      BOOL v16 = v11 > a3;
      uint64_t v17 = *(void (**)(uint64_t, uint64_t, uint64_t, unsigned __int8 *, void, BOOL, uint64_t))(*(void *)(qword_100A04168 + 8) + 32);
      goto LABEL_17;
    }
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"recvDataInd cid (%d) doesn't match control (%d) or interrupt (%d)", v35, v36, v37, v38, v39, v40, v41, a1);
    uint64_t v42 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_22:
    sub_100744F6C();
    return;
  }
  BOOL v16 = v11 > a3;
  uint64_t v17 = *(void (**)(uint64_t, uint64_t, uint64_t, unsigned __int8 *, void, BOOL, uint64_t))(*(void *)(qword_100A04168 + 8) + 24);
LABEL_17:
  uint64_t v34 = v10[96];

  v17(v34, v14, v15, v12, (unsigned __int16)(a3 - 1), v16, a5);
}

uint64_t sub_100158C28(int a1, uint64_t a2, void *a3, int a4)
{
  if (!dword_100A19804) {
    return 408;
  }
  uint64_t v7 = (int8x16_t *)sub_100157C18(a1);
  if (!v7) {
    return 414;
  }
  uint64_t v8 = (uint64_t)v7;
  if (a2)
  {
    uint64_t v9 = *(void *)a2;
    int8x16_t v10 = *(int8x16_t *)(a2 + 8);
  }
  else
  {
    uint64_t v9 = 0;
    int8x16_t v10 = 0uLL;
  }
  v7[1].i64[1] = v9;
  v7[2].i64[0] = v10.i64[0];
  v7[7] = vextq_s8(v10, v10, 8uLL);
  if (a3) {
    uint64_t v12 = a3;
  }
  else {
    uint64_t v12 = &unk_1007B9868;
  }
  uint64_t v13 = sub_1001E0320((uint64_t)sub_1001586E8, (uint64_t)sub_100158900, (uint64_t)sub_100158A3C, v7[1].u16[0], v9, a4, (uint64_t)v12);
  uint64_t v11 = v13;
  if (a4 && !v13 || (sub_100157DCC(v8), !v11))
  {
    uint64_t v14 = sub_100197A30(v8);
    uint64_t v11 = 0;
    if (v14) {
      *(unsigned char *)(v14 + 256) = 0;
    }
  }
  return v11;
}

uint64_t sub_100158D28(int a1)
{
  if (!dword_100A19804) {
    return 408;
  }
  uint64_t v1 = sub_100157C18(a1);
  if (!v1) {
    return 414;
  }
  if (*(_DWORD *)(v1 + 196) != 2) {
    return 122;
  }
  *(_DWORD *)(v1 + 196) = 4;
  sub_100158D8C(v1, 436);
  return 0;
}

void sub_100158D8C(uint64_t a1, uint64_t a2)
{
  unsigned int v3 = *(unsigned __int16 *)(a1 + 104);
  if (*(_WORD *)(a1 + 104))
  {
    *(_DWORD *)(a1 + 128) = 4;
    sub_10015992C((uint64_t)sub_100159784, v3, a2);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"DoInterruptDisconnect called on connection with cid 0", v4, v5, v6, v7, v8, v9, v10, v12);
    uint64_t v11 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100158E28(uint64_t a1, unsigned int a2, int a3, char a4, char a5)
{
  if (!dword_100A19804) {
    return 408;
  }
  if (!sub_100157C18(a2)) {
    return 414;
  }
  uint64_t v10 = sub_10025C1E0(0);
  if (!v10) {
    return 106;
  }
  uint64_t v11 = v10;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"SendSimple on handle 0x%x for channel 0x%x transtype 0x%x transparam 0x%x", v12, v13, v14, v15, v16, v17, v18, a2);
    uint64_t v19 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_INFO))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v31 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v19, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v20 = sub_100158FE4(a1, a2, a3, a4, a5, (uint64_t)v11);
  if (v20)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"SendSimple failed on handle 0x%x with status %!", v21, v22, v23, v24, v25, v26, v27, a2);
      uint64_t v28 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10025C53C(v11);
  }
  return v20;
}

uint64_t sub_100158FE4(uint64_t a1, unsigned int a2, int a3, char a4, char a5, uint64_t a6)
{
  if (!dword_100A19804) {
    return 408;
  }
  if (!a6)
  {
    sub_10025B8C0();
    return 101;
  }
  uint64_t v12 = sub_100157C18(a2);
  if (!v12) {
    return 414;
  }
  int v13 = *(_DWORD *)(v12 + 196);
  if (v13 != 2)
  {
    if (v13 != 4)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"connection isn't in connected state", v14, v15, v16, v17, v18, v19, v20, v49);
        uint64_t v21 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    return 122;
  }
  if (a3 != 19)
  {
    if (a3 == 17)
    {
      uint64_t v24 = v12 + 16;
      goto LABEL_19;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"channel must be OI_PSM_HID_INTERRUPT or OI_PSM_HID_CONTROL", v33, v34, v35, v36, v37, v38, v39, v49);
      uint64_t v40 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 101;
  }
  uint64_t v24 = v12 + 104;
LABEL_19:
  if (*(void *)(v24 + 72))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"SendMbuf busy for handle 0x%x", v25, v26, v27, v28, v29, v30, v31, a2);
      uint64_t v32 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 410;
  }
  else
  {
    *(void *)(v24 + 72) = a6;
    *(void *)(v24 + 48) = a1;
    *(unsigned char *)(v24 + 57) = a4;
    *(unsigned char *)(v24 + 58) = a5;
    uint64_t v22 = sub_100159444((unsigned __int16 *)v24, 1);
    if (v22)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"SendFragment failed for handle 0x%x with status %!", v41, v42, v43, v44, v45, v46, v47, a2);
        uint64_t v48 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      *(void *)(v24 + 72) = 0;
    }
  }
  return v22;
}

uint64_t sub_1001591F0(uint64_t a1, unsigned int a2, int a3, char a4, char a5, char *a6, size_t a7)
{
  if (!dword_100A19804) {
    return 408;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Endpoint SendData(sendCfm=0x%08x, handle=0x%x, chan=%d, transType=0x%1x, transParam=0x%1x, len=%d)", v14, v15, v16, v17, v18, v19, v20, a1);
    uint64_t v21 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_INFO))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v46 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v22 = sub_100157C18(a2);
  if (!v22) {
    return 414;
  }
  if (a3 == 19)
  {
    uint64_t v23 = v22 + 104;
LABEL_12:
    uint64_t v25 = sub_10025C6D8(a6, a7, 2);
    if (!v25) {
      return 106;
    }
    uint64_t v26 = v25;
    uint64_t v24 = sub_100158FE4(a1, a2, a3, a4, a5, (uint64_t)v25);
    if (v24)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Endpoint SendByte failed on handle 0x%x with status %!", v27, v28, v29, v30, v31, v32, v33, a2);
        uint64_t v34 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      *(void *)(v23 + 32) = 0;
      *(_WORD *)(v23 + 40) = 0;
      sub_10025C53C(v26);
    }
    else
    {
      *(void *)(v23 + 32) = a6;
      *(_WORD *)(v23 + 40) = a7;
    }
    return v24;
  }
  if (a3 == 17)
  {
    uint64_t v23 = v22 + 16;
    goto LABEL_12;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"channel must be OI_PSM_HID_INTERRUPT or OI_PSM_HID_CONTROL", v35, v36, v37, v38, v39, v40, v41, v44);
    uint64_t v42 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 101;
}

uint64_t sub_100159444(unsigned __int16 *a1, int a2)
{
  uint64_t v4 = *((void *)a1 + 9);
  if (a2) {
    sub_10025C9FC(v4, (unsigned __int16)(a1[15] - 1));
  }
  else {
    sub_10025CA4C(v4, (unsigned __int16)(a1[15] - 1));
  }
  unsigned __int16 v5 = *(_WORD *)(*((void *)a1 + 9) + 4) + 1;
  unsigned int v6 = a1[15];
  if (v6 < v5)
  {
    sub_10025B8C0();
    unsigned int v6 = a1[15];
  }
  *((unsigned char *)a1 + 56) = v6 != v5;
  uint64_t v7 = (unsigned __int8 *)sub_10025C1E0(2u);
  if (!v7) {
    return 106;
  }
  uint64_t v8 = v7;
  if (a2) {
    char v9 = 16 * *((unsigned char *)a1 + 57);
  }
  else {
    char v9 = -80;
  }
  *((unsigned char *)a1 + 59) = a1[29] & 0xF | v9;
  uint64_t v10 = sub_100022798(v7, (char *)a1 + 59, 1uLL, 2u);
  if (v10
    || (uint64_t v10 = sub_10025C92C(v8, *((void *)a1 + 9)), v10)
    || (*((void *)v8 + 1) = a1,
        uint64_t v10 = ((uint64_t (*)(void (*)(int, void *, uint64_t, uint64_t), void, void, unsigned __int8 *, void))loc_1001DE1A4)(sub_100159568, *a1, 0, v8, 0), v10))
  {
    sub_10025C53C(v8);
  }
  return v10;
}

void sub_100159568(int a1, void *a2, uint64_t a3, uint64_t a4)
{
  if (!a2) {
    sub_10025B8C0();
  }
  uint64_t v7 = (unsigned __int16 *)a2[1];
  sub_10025C53C(a2);
  if (!v7) {
    sub_10025B8C0();
  }
  if (*v7 != a1) {
    sub_10025B8C0();
  }
  int v8 = *((unsigned __int8 *)v7 + 56);
  if (!a4 && !*((unsigned char *)v7 + 56)) {
    a4 = sub_100159444(v7, 0);
  }
  if (v8) {
    BOOL v9 = 0;
  }
  else {
    BOOL v9 = a4 == 0;
  }
  if (!v9)
  {
    uint64_t v10 = (void *)*((void *)v7 + 9);
    *((void *)v7 + 9) = 0;
    uint64_t v11 = (void (*)(unsigned __int16 *, void *, uint64_t))*((void *)v7 + 6);
    if (v11) {
      v11(v7, v10, a4);
    }
    if (v10)
    {
      sub_10025C53C(v10);
    }
  }
}

void sub_100159634(int a1, __int16 a2, __int16 a3, uint64_t a4)
{
  if (dword_100A19804 || (sub_10025B8C0(), dword_100A19804))
  {
    uint64_t v8 = sub_100157EB0(a1);
    if (v8 && (uint64_t v9 = v8, *(_DWORD *)(v8 + 128) == 1))
    {
      uint64_t v10 = *(unsigned __int16 *)(v8 + 192);
      if (a4)
      {
        (*(void (**)(uint64_t, uint64_t))(*(void *)(qword_100A04168 + 8) + 8))(v10, a4);
        sub_100157DCC(v9);
      }
      else
      {
        *(_DWORD *)(v9 + 196) = 2;
        *(_DWORD *)(v9 + 128) = 2;
        *(_WORD *)(v9 + 132) = a2;
        *(_WORD *)(v9 + 134) = a3;
        *(unsigned char *)(v9 + 8) = 1;
        uint64_t v19 = *(void (**)(uint64_t, void))(*(void *)(qword_100A04168 + 8) + 8);
        v19(v10, 0);
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unexpected L2cap connection confirmation", v11, v12, v13, v14, v15, v16, v17, v20);
      uint64_t v18 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

double sub_100159784(int a1, uint64_t a2)
{
  if (dword_100A19804 || (sub_10025B8C0(), dword_100A19804))
  {
    uint64_t v5 = sub_100157EB0(a1);
    if (v5)
    {
      uint64_t v6 = v5;
      *(_WORD *)(v5 + 104) = 0;
      *(void *)(v5 + 128) = 0;
      if (*(_DWORD *)(v5 + 196) == 4) {
        sub_100159890(v5, a2);
      }
      else {
        *(_DWORD *)(v5 + 196) = 4;
      }
      if (!*(_DWORD *)(v6 + 40))
      {
        (*(void (**)(void, uint64_t))(*(void *)(qword_100A04168 + 8) + 16))(*(unsigned __int16 *)(v6 + 192), a2);
        return sub_100157DCC(v6);
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unexpected L2cap disconnect indication", v7, v8, v9, v10, v11, v12, v13, v15);
      uint64_t v14 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  return result;
}

void sub_100159890(uint64_t a1, uint64_t a2)
{
  unsigned int v3 = *(unsigned __int16 *)(a1 + 16);
  if (*(_WORD *)(a1 + 16))
  {
    *(_DWORD *)(a1 + 40) = 4;
    sub_10015992C((uint64_t)sub_100158900, v3, a2);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"DoInterruptDisconnect called on connection with cid 0", v4, v5, v6, v7, v8, v9, v10, v12);
    uint64_t v11 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10015992C(uint64_t a1, unsigned int a2, uint64_t a3)
{
  unsigned __int16 v3 = a2;
  int v5 = sub_1001E121C(a2, a3);
  if (v5)
  {
    uint64_t v16 = a1;
    int v17 = v3;
    int v18 = v5;
    v19[1] = &v16;
    v19[0] = (const void *)16;
    uint64_t v6 = sub_100026DA8((uint64_t)sub_1001599EC, v19, 0);
    if (v6)
    {
      uint64_t v7 = v6;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed: %!\n", v8, v9, v10, v11, v12, v13, v14, v7);
        uint64_t v15 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
}

uint64_t sub_1001599EC(uint64_t a1)
{
  return (**(uint64_t (***)(void, void))(a1 + 8))(*(unsigned __int16 *)(*(void *)(a1 + 8) + 8), *(unsigned int *)(*(void *)(a1 + 8) + 12));
}

uint64_t sub_100159A00(unsigned int *a1, void *a2)
{
  if (!a1 || !a2)
  {
    sub_10025B8C0();
    return 101;
  }
  if (!*a2 || !a2[1] || !a2[2] || !a2[3])
  {
    sub_10025B8C0();
    if (!*a2) {
      return 101;
    }
  }
  if (!a2[1] || !a2[2] || !a2[3]) {
    return 101;
  }
  uint64_t v24 = 0;
  uint64_t result = sub_100157F50(off_10099CBF0, *a1, &v24);
  if (!result)
  {
    qword_100A04170 = (uint64_t)a2;
    uint64_t result = _os_feature_enabled_impl();
    if (result)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Registering for modeChangedCB", v5, v6, v7, v8, v9, v10, v11, v23);
        uint64_t v12 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_INFO))
        {
          uint64_t v13 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v26 = v13;
          _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
        }
      }
      uint64_t result = sub_10018246C((uint64_t)sub_100159BBC, 0);
      if (result)
      {
        uint64_t v14 = result;
        uint64_t result = sub_100058654();
        if (result)
        {
          sub_100056E24((uint64_t)"Error registering for modeChangedCB: %d", v15, v16, v17, v18, v19, v20, v21, v14);
          uint64_t v22 = sub_100050B4C(0x15u);
          uint64_t result = os_log_type_enabled(v22, OS_LOG_TYPE_ERROR);
          if (result)
          {
            sub_100744F6C();
            return 0;
          }
        }
      }
    }
  }
  return result;
}

void sub_100159BBC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!_os_feature_enabled_impl()) {
    return;
  }
  if (!a2)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"modeChangedCB : NULL address", v32, v33, v34, v35, v36, v37, v38, v56);
    uint64_t v39 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_25:
    sub_100744F6C();
    return;
  }
  uint64_t v7 = sub_100197A30(a2);
  if (!v7)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"modeChangedCB : The connection is gone.", v40, v41, v42, v43, v44, v45, v46, v56);
    uint64_t v47 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_25;
  }
  uint64_t v8 = v7;
  uint64_t v9 = sub_100157E48(a2);
  if (v9)
  {
    if (a3 == 2)
    {
      uint64_t v10 = v9;
      uint64_t v11 = *(unsigned __int16 *)(v8 + 136);
      HIDWORD(v13) = -1431655765 * v11;
      LODWORD(v13) = -1431655765 * v11;
      unsigned int v12 = v13 >> 2;
      BOOL v16 = v11 == 18 || v12 < 0x15555556 || v11 > 0x40;
      if (sub_100058654())
      {
        sub_10025B48C(a2, v17, v18, v19, v20, v21, v22, v23);
        sub_100056E24((uint64_t)"SniffInterval %d for %s previous: %s (%d)", v24, v25, v26, v27, v28, v29, v30, v11);
        uint64_t v31 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_INFO))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v58 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
        }
      }
      if (v11)
      {
        if (v16)
        {
          if (*(unsigned char *)(v10 + 211))
          {
            if (!*(unsigned char *)(v10 + 210))
            {
              *(unsigned char *)(v10 + 211) = 0;
              (*(void (**)(uint64_t, uint64_t, void))(qword_100A04170 + 120))(a2, a4, 0);
            }
          }
        }
        else if (!*(unsigned char *)(v10 + 211) && !*(unsigned char *)(v10 + 210))
        {
          *(unsigned char *)(v10 + 211) = 1;
          (*(void (**)(uint64_t, uint64_t, uint64_t))(qword_100A04170 + 120))(a2, a4, 1);
        }
        *(unsigned char *)(v10 + 210) = 1;
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Sniff interval should never be 0 when in sniff mode.", v48, v49, v50, v51, v52, v53, v54, v56);
        uint64_t v55 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    (*(void (**)(uint64_t, uint64_t, uint64_t))(qword_100A04170 + 128))(a2, a4, a3);
  }
}

uint64_t sub_100159E84()
{
  if (_os_feature_enabled_impl())
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unregistering the modeChangedCB", v0, v1, v2, v3, v4, v5, v6, v19);
      uint64_t v7 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v7, OS_LOG_TYPE_INFO))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v21 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v8 = sub_10018247C((uint64_t)sub_100159BBC);
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to unregister modeChangedCB with error: %d", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  return sub_1001583B8();
}

uint64_t sub_100159FBC(uint64_t a1, uint64_t *a2, _WORD *a3, void *a4)
{
  if (dword_100A19804) {
    return sub_100158450(a1, a2, a3, a4);
  }
  else {
    return 2601;
  }
}

uint64_t sub_100159FE0(uint64_t a1, unsigned int a2, uint64_t a3)
{
  uint64_t v6 = sub_100157C18(a1);
  if (!v6) {
    return 414;
  }
  uint64_t v7 = v6;
  if (*(unsigned char *)(v6 + 73))
  {
    if (!sub_100058654()) {
      goto LABEL_18;
    }
    sub_100056E24((uint64_t)"Send HID control - returning busy due for handle 0x%x to transtype %d controlop %s", v8, v9, v10, v11, v12, v13, v14, a1);
    uint64_t v23 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_18;
    }
    goto LABEL_17;
  }
  if (*(unsigned char *)(v6 + 76))
  {
    if (!sub_100058654()) {
      goto LABEL_18;
    }
    sub_100056E24((uint64_t)"Send HID control - returning busy for handle 0x%x due to pendingControlOp %s controlop %s", v16, v17, v18, v19, v20, v21, v22, a1);
    uint64_t v23 = sub_100050B4C(0x15u);
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_18;
    }
LABEL_17:
    *(_DWORD *)int buf = 136446210;
    uint64_t v47 = sub_100050714();
    _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
LABEL_18:
    if (a2 == 5) {
      *(unsigned char *)(v7 + 77) |= 0x20u;
    }
    return 118;
  }
  uint64_t v24 = sub_10025C1E0(0);
  if (!v24) {
    return 106;
  }
  uint64_t v25 = v24;
  uint64_t v15 = sub_100158FE4((uint64_t)sub_10015A344, a1, 17, 1, a2, (uint64_t)v24);
  if (v15)
  {
    if (sub_100058654())
    {
      uint64_t v33 = a2 > 5 ? "??" : off_10099CC20[(char)a2];
      sub_100056E24((uint64_t)"SendHidControl failed for op %s with status %!", v26, v27, v28, v29, v30, v31, v32, (uint64_t)v33);
      uint64_t v44 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    *(unsigned char *)(v7 + 76) = 0;
    *(void *)(v7 + 80) = 0;
    sub_10025C53C(v25);
  }
  else
  {
    *(unsigned char *)(v7 + 73) = 0;
    *(unsigned char *)(v7 + 76) = a2;
    *(void *)(v7 + 80) = a3;
    if (sub_100058654())
    {
      unint64_t v42 = *(char *)(v7 + 76);
      if (v42 > 5) {
        uint64_t v43 = "??";
      }
      else {
        uint64_t v43 = off_10099CC20[v42];
      }
      sub_100056E24((uint64_t)"SendHidControl with pendingControlOp %s", v35, v36, v37, v38, v39, v40, v41, (uint64_t)v43);
      uint64_t v45 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v45, OS_LOG_TYPE_INFO))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v47 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v45, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
      }
      return 0;
    }
  }
  return v15;
}

void sub_10015A344(unsigned __int16 *a1, uint64_t a2, uint64_t a3)
{
  if (a1)
  {
    uint64_t v5 = *((char *)a1 + 60);
    *((unsigned char *)a1 + 60) = 0;
    if (sub_100058654())
    {
      uint64_t v13 = v5 > 5 ? "??" : off_10099CC20[v5];
      sub_100056E24((uint64_t)"_SendHidControlCfm for pending control op %s with status %!", v6, v7, v8, v9, v10, v11, v12, (uint64_t)v13);
      uint64_t v22 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_INFO))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v27 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v23 = sub_100157EB0(*a1);
    if (v23)
    {
      uint64_t v24 = *(void (**)(void, void, uint64_t))(v23 + 80);
      if (v24) {
        v24(*(unsigned __int16 *)(v23 + 192), v5, a3);
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Send HID control - channel is invalid", v14, v15, v16, v17, v18, v19, v20, v25);
    uint64_t v21 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_10015A4A4(unsigned int a1, char a2, int a3, int a4)
{
  uint64_t v8 = sub_100157C18(a1);
  if (!v8) {
    return 414;
  }
  uint64_t v9 = v8;
  int v16 = 0;
  if (a3 == -1)
  {
    size_t v10 = 0;
  }
  else
  {
    LOBYTE(v16) = a3;
    size_t v10 = 1;
  }
  char v12 = a2 & 3;
  if (a4 != 0xFFFF)
  {
    *(_WORD *)((unint64_t)&v16 | v10) = a4;
    size_t v10 = v10 | 2;
    v12 |= 8u;
  }
  uint64_t v13 = sub_10025C6D8((char *)&v16, v10, 0);
  if (!v13) {
    return 106;
  }
  uint64_t v14 = v13;
  if (*(unsigned char *)(v9 + 73))
  {
    sub_10025C53C(v13);
    return 118;
  }
  else
  {
    *(unsigned char *)(v9 + 73) = 4;
    uint64_t v11 = sub_100158FE4(0, a1, 17, 4, v12, (uint64_t)v13);
    if (v11)
    {
      sub_10025C53C(v14);
      *(unsigned char *)(v9 + 73) = 0;
    }
    else
    {
      sub_100157BB0(a1);
    }
  }
  return v11;
}

uint64_t sub_10015A5BC(unsigned int a1, char a2, char *a3, size_t a4)
{
  uint64_t v8 = sub_100157C18(a1);
  if (!v8) {
    return 414;
  }
  uint64_t v9 = v8;
  if (*(unsigned char *)(v8 + 73)) {
    return 118;
  }
  *(unsigned char *)(v8 + 73) = 5;
  uint64_t result = sub_1001591F0((uint64_t)nullsub_99, a1, 17, 5, a2, a3, a4);
  if (result)
  {
    *(unsigned char *)(v9 + 73) = 0;
  }
  else
  {
    sub_100157BB0(a1);
    return 0;
  }
  return result;
}

uint64_t sub_10015A66C(unsigned int a1, char a2)
{
  uint64_t v4 = sub_100157C18(a1);
  if (!v4) {
    return 414;
  }
  uint64_t v5 = v4;
  if (*(unsigned char *)(v4 + 73)) {
    return 118;
  }
  *(unsigned char *)(v4 + 73) = 7;
  *(unsigned char *)(v4 + 9) = a2;
  uint64_t v6 = sub_100158E28(0, a1, 17, 7, a2);
  if (v6)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Set Protocol failed for handle %d with status %!", v7, v8, v9, v10, v11, v12, v13, v6);
      uint64_t v14 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    *(unsigned char *)(v5 + 73) = 0;
  }
  else
  {
    sub_100157BB0(a1);
  }
  return v6;
}

uint64_t sub_10015A748(unsigned int a1, char a2, char *a3, size_t a4)
{
  uint64_t v8 = (unsigned __int16 *)sub_100157F0C(a1, 19);
  if (!v8) {
    return 101;
  }
  uint64_t v9 = v8;
  uint64_t v10 = sub_100157EB0(*v8);
  if (!v10) {
    return 414;
  }
  uint64_t v11 = v10;
  if (*(unsigned char *)(v10 + 73)) {
    return 118;
  }
  uint64_t result = sub_1001591F0((uint64_t)sub_10015A808, a1, 19, 10, a2, a3, a4);
  if (result)
  {
    a3 = 0;
    LOWORD(a4) = 0;
    *(unsigned char *)(v11 + 73) = 0;
  }
  *((void *)v9 + 4) = a3;
  v9[20] = a4;
  return result;
}

void sub_10015A808(unsigned __int16 *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5 = sub_100157EB0(*a1);
  if (v5)
  {
    uint64_t v6 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A04170 + 88);
    if (v6)
    {
      uint64_t v7 = *(unsigned __int16 *)(v5 + 192);
      uint64_t v8 = *((void *)a1 + 4);
      uint64_t v9 = a1[20];
      v6(v7, v8, v9, a3);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Couldn't get endpoint handle in OutputReportSendDataCfm", v10, v11, v12, v13, v14, v15, v16, v18);
    uint64_t v17 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_10015A8B4()
{
  return (*(uint64_t (**)(void))qword_100A04170)();
}

uint64_t sub_10015A8C4(uint64_t a1, uint64_t a2)
{
  if (!a2) {
    sub_10015B3EC(a1);
  }
  uint64_t v4 = *(uint64_t (**)(uint64_t, uint64_t))(qword_100A04170 + 8);

  return v4(a1, a2);
}

uint64_t sub_10015A918(uint64_t a1, uint64_t a2)
{
  if (*(_DWORD *)(sub_100157C18(a1) + 196))
  {
    (*(void (**)(uint64_t, uint64_t))(qword_100A04170 + 16))(a1, a2);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"DisconnectInd received for connection that is already disconnected", v4, v5, v6, v7, v8, v9, v10, v14);
    uint64_t v11 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  uint64_t v12 = sub_100157C18(a1);
  if (!v12) {
    sub_10025B8C0();
  }
  uint64_t result = sub_100026DB4(*(unsigned int *)(v12 + 204));
  *(_DWORD *)(v12 + 204) = 0;
  return result;
}

void sub_10015A9C4(uint64_t a1, int a2, uint64_t a3, unsigned char *a4, uint64_t a5, uint64_t a6)
{
  uint64_t v12 = sub_100157C18(a1);
  if (!v12) {
    return;
  }
  uint64_t v13 = v12;
  sub_100157D3C(a1);
  if (a2 == 1 && a3 == 5)
  {
    uint64_t v14 = *(void (**)(uint64_t))(qword_100A04170 + 24);
    v14(a1);
    return;
  }
  if (!*(_DWORD *)(v13 + 204)) {
    sub_10015B3EC(a1);
  }
  int v15 = *(unsigned __int8 *)(v13 + 73);
  *(unsigned char *)(v13 + 73) = 0;
  switch(v15)
  {
    case 4:
      if ((a2 - 10) >= 2)
      {
        if (a2)
        {
          uint64_t v37 = *(void (**)(uint64_t, uint64_t, void, void, void, uint64_t, uint64_t))(qword_100A04170 + 32);
          if (!v37) {
            return;
          }
          uint64_t v39 = a1;
          uint64_t v38 = 14;
        }
        else
        {
          uint64_t v37 = *(void (**)(uint64_t, uint64_t, void, void, void, uint64_t, uint64_t))(qword_100A04170 + 32);
          if (!v37) {
            return;
          }
          if (a3) {
            uint64_t v38 = a3;
          }
          else {
            uint64_t v38 = 14;
          }
          uint64_t v39 = a1;
        }
        v37(v39, v38, 0, 0, 0, 1, 1);
      }
      else
      {
        uint64_t v16 = *(void (**)(uint64_t, void, uint64_t, unsigned char *, uint64_t, BOOL, uint64_t))(qword_100A04170 + 32);
        if (v16) {
          v16(a1, 0, a3 & 3, a4, a5, a2 == 10, a6);
        }
        if ((a6 & 1) == 0) {
          *(unsigned char *)(v13 + 73) = 4;
        }
      }
      return;
    case 5:
      uint64_t v25 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, void))(qword_100A04170 + 40);
      if (v25)
      {
        if (a2) {
          uint64_t v26 = 15;
        }
        else {
          uint64_t v26 = a3;
        }
        uint64_t v27 = *(void *)(v13 + 48);
        uint64_t v28 = *(unsigned __int16 *)(v13 + 56);
        v25(a1, v26, v27, v28, 0);
      }
      return;
    case 6:
      if (a2 != 10 || a5 != 1)
      {
        uint64_t v29 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A04170 + 48);
        if (a2) {
          goto LABEL_51;
        }
        goto LABEL_47;
      }
      *(unsigned char *)(v13 + 8) = *a4;
      uint64_t v29 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A04170 + 48);
      if (v29) {
        goto LABEL_34;
      }
      return;
    case 7:
      if (a2)
      {
        a3 = 15;
        char v30 = 1;
      }
      else
      {
        char v30 = *(unsigned char *)(v13 + 9);
      }
      *(unsigned char *)(v13 + 8) = v30;
      uint64_t v34 = *(void (**)(uint64_t, uint64_t, void))(qword_100A04170 + 56);
      if (v34)
      {
        uint64_t v36 = a1;
        uint64_t v35 = a3;
        goto LABEL_59;
      }
      return;
    case 8:
      if (a2 == 10 && a5 == 1)
      {
        uint64_t v29 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A04170 + 64);
        if (!v29) {
          return;
        }
LABEL_34:
        uint64_t v31 = *a4;
        uint64_t v32 = a1;
        uint64_t v33 = 0;
LABEL_49:
        uint64_t v40 = 0;
        goto LABEL_53;
      }
      uint64_t v29 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A04170 + 64);
      if (!a2)
      {
LABEL_47:
        if (!v29) {
          return;
        }
        uint64_t v32 = a1;
        uint64_t v31 = 0;
        uint64_t v33 = a3;
        goto LABEL_49;
      }
LABEL_51:
      if (!v29) {
        return;
      }
      uint64_t v32 = a1;
      uint64_t v31 = 0;
      uint64_t v33 = 15;
      uint64_t v40 = 411;
LABEL_53:
      v29(v32, v31, v33, v40);
      return;
    case 9:
      uint64_t v34 = *(void (**)(uint64_t, uint64_t, void))(qword_100A04170 + 72);
      if (v34)
      {
        if (a2) {
          uint64_t v35 = 15;
        }
        else {
          uint64_t v35 = a3;
        }
        uint64_t v36 = a1;
LABEL_59:
        v34(v36, v35, 0);
      }
      return;
    default:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"No transactions outstanding, ignoring packet from device", v17, v18, v19, v20, v21, v22, v23, v41);
        uint64_t v24 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return;
  }
}

void sub_10015AD74(uint64_t a1, int a2, int a3, unsigned __int8 *a4, uint64_t a5, uint64_t a6, uint64_t a7)
{
  uint64_t v14 = sub_100157C18(a1);
  if (v14)
  {
    if ((a2 - 12) > 0xFFFFFFFD)
    {
      if (a3 == 1)
      {
        uint64_t v31 = v14;
        if (*(_DWORD *)(v14 + 204)) {
          *(unsigned char *)(v14 + 208) = 1;
        }
        else {
          sub_10015B3EC(a1);
        }
        if (*(unsigned char *)(v31 + 8))
        {
          uint64_t v40 = *(void (**)(uint64_t, unsigned __int8 *, uint64_t, BOOL, uint64_t, uint64_t))(qword_100A04170 + 80);
          if (v40)
          {
            v40(a1, a4, a5, a2 == 10, a6, a7);
          }
          else if (sub_100058654())
          {
            sub_100056E24((uint64_t)"No report-protocol handler present. Ignoring.", v50, v51, v52, v53, v54, v55, v56, v96);
            uint64_t v57 = sub_100050B4C(0x15u);
            if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
              goto LABEL_14;
            }
          }
        }
        else if (a5)
        {
          if (a2 == 10 && (a6 & 1) != 0)
          {
            int v41 = *a4;
            if (v41 == 2)
            {
              if (a5 > 3)
              {
                v92 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A04170 + 104);
                if (v92)
                {
                  uint64_t v93 = a4[1];
                  uint64_t v94 = (char)a4[2];
                  uint64_t v95 = (char)a4[3];
                  v92(a1, v93, v94, v95);
                }
              }
              else if (sub_100058654())
              {
                sub_100056E24((uint64_t)"Boot-mode mouse report too short. Ignoring.", v74, v75, v76, v77, v78, v79, v80, v96);
                v81 = sub_100050B4C(0x15u);
                if (os_log_type_enabled(v81, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_14;
                }
              }
            }
            else if (v41 == 1)
            {
              if (a5 > 8)
              {
                v90 = *(void (**)(uint64_t, uint64_t, unsigned __int8 *))(qword_100A04170 + 96);
                if (v90)
                {
                  uint64_t v91 = a4[1];
                  v90(a1, v91, a4 + 3);
                }
              }
              else if (sub_100058654())
              {
                sub_100056E24((uint64_t)"Boot-mode keyboard report too short. Ignoring.", v42, v43, v44, v45, v46, v47, v48, v96);
                uint64_t v49 = sub_100050B4C(0x15u);
                if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_14;
                }
              }
            }
            else if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Received unknown boot protocol report ID %d", v82, v83, v84, v85, v86, v87, v88, *a4);
              v89 = sub_100050B4C(0x15u);
              if (os_log_type_enabled(v89, OS_LOG_TYPE_ERROR)) {
                goto LABEL_14;
              }
            }
          }
          else if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Received segmented boot report. Ignoring.", v66, v67, v68, v69, v70, v71, v72, v96);
            v73 = sub_100050B4C(0x15u);
            if (os_log_type_enabled(v73, OS_LOG_TYPE_ERROR)) {
              goto LABEL_14;
            }
          }
        }
        else if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received empty boot report. Ignoring.", v58, v59, v60, v61, v62, v63, v64, v96);
          int v65 = sub_100050B4C(0x15u);
          if (os_log_type_enabled(v65, OS_LOG_TYPE_ERROR)) {
            goto LABEL_14;
          }
        }
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Received non-input report type on interrupt endpoint. Ignoring.", v32, v33, v34, v35, v36, v37, v38, v96);
        uint64_t v39 = sub_100050B4C(0x15u);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          goto LABEL_14;
        }
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received non DATA/DATC transaction on interrupt endpoint. Ignoring.", v15, v16, v17, v18, v19, v20, v21, v96);
      uint64_t v22 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
LABEL_14:
      }
        sub_100744F6C();
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Unknown connection. Ignoring interrupt data.", v23, v24, v25, v26, v27, v28, v29, v96);
    char v30 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
      goto LABEL_14;
    }
  }
}

void sub_10015B178(uint64_t a1)
{
  if (a1)
  {
    uint64_t v1 = *(unsigned __int16 *)(a1 + 192);
    *(_DWORD *)(a1 + 200) = 0;
    int v2 = *(unsigned __int8 *)(a1 + 73);
    *(unsigned char *)(a1 + 73) = 0;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"HID Transaction Timeout - for handle 0x%x and previousTransType %d", v3, v4, v5, v6, v7, v8, v9, v1);
      uint64_t v10 = sub_100050B4C(0x15u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    switch(v2)
    {
      case 1:
        sub_100158D28(v1);
        break;
      case 4:
        uint64_t v27 = *(void (**)(uint64_t, uint64_t, void, void, void, uint64_t, uint64_t))(qword_100A04170 + 32);
        if (v27) {
          v27(v1, 15, 0, 0, 0, 1, 1);
        }
        break;
      case 5:
        uint64_t v28 = *(void (**)(uint64_t, uint64_t, void, void, uint64_t))(qword_100A04170 + 40);
        if (v28) {
          v28(v1, 15, 0, 0, 2604);
        }
        break;
      case 6:
        uint64_t v29 = *(void (**)(uint64_t, void, uint64_t, uint64_t))(qword_100A04170 + 48);
        if (v29) {
          goto LABEL_22;
        }
        break;
      case 7:
        char v30 = *(void (**)(uint64_t, uint64_t, uint64_t))(qword_100A04170 + 56);
        if (v30) {
          goto LABEL_24;
        }
        break;
      case 8:
        uint64_t v29 = *(void (**)(uint64_t, void, uint64_t, uint64_t))(qword_100A04170 + 64);
        if (v29) {
LABEL_22:
        }
          v29(v1, 0, 15, 2604);
        break;
      case 9:
        char v30 = *(void (**)(uint64_t, uint64_t, uint64_t))(qword_100A04170 + 72);
        if (v30) {
LABEL_24:
        }
          v30(v1, 15, 2604);
        break;
      case 10:
        uint64_t v31 = sub_100157F0C(v1, 19);
        if (v31)
        {
          uint64_t v32 = *(void (**)(uint64_t, void, void, uint64_t))(qword_100A04170 + 88);
          if (v32) {
            v32(v1, *(void *)(v31 + 32), *(unsigned __int16 *)(v31 + 40), 112);
          }
        }
        break;
      default:
        sub_100158D28(v1);
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"No transactions outstanding, disconnecting", v19, v20, v21, v22, v23, v24, v25, v33);
          uint64_t v26 = sub_100050B4C(0x15u);
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
            goto LABEL_9;
          }
        }
        break;
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Invalid HID host handle in transaction timeout", v11, v12, v13, v14, v15, v16, v17, v33);
    uint64_t v18 = sub_100050B4C(0x15u);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
LABEL_9:
    }
      sub_100744F6C();
  }
}

uint64_t sub_10015B3EC(int a1)
{
  __int16 v4 = a1;
  uint64_t v1 = sub_100157C18(a1);
  if (!v1) {
    sub_10025B8C0();
  }
  if (*(_DWORD *)(v1 + 204)) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)(v1 + 208)) {
    sub_10025B8C0();
  }
  v3[1] = &v4;
  v3[0] = (const void *)2;
  return sub_1000268E4((uint64_t)sub_10015B470, v3, 300, (int *)(v1 + 204));
}

uint64_t sub_10015B470(uint64_t a1)
{
  uint64_t v1 = **(unsigned __int16 **)(a1 + 8);
  uint64_t result = sub_100157C18(v1);
  if (result)
  {
    int v3 = *(unsigned __int8 *)(result + 208);
    *(_DWORD *)(result + 204) = 0;
    *(unsigned char *)(result + 208) = 0;
    if (v3)
    {
      return sub_10015B3EC(v1);
    }
    else
    {
      __int16 v4 = *(uint64_t (**)(uint64_t))(qword_100A04170 + 112);
      return v4(v1);
    }
  }
  return result;
}

uint64_t sub_10015B4FC(uint64_t a1)
{
  uint64_t v2 = 0;
  for (uint64_t i = 0; i != 7; ++i)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"getDevicePosFromAddress i: %d, inUse %d, addr: %:", v4, v5, v6, v7, v8, v9, v10, i);
      uint64_t v11 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v12 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v16 = v12;
        _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    if (*(unsigned char *)(qword_100A04178 + v2))
    {
      if (*(_DWORD *)a1 == *(_DWORD *)(qword_100A04178 + v2 + 1)
        && *(unsigned __int16 *)(a1 + 4) == *(unsigned __int16 *)(qword_100A04178 + v2 + 5))
      {
        break;
      }
    }
    v2 += 32;
  }
  return i;
}

uint64_t sub_10015B648(_WORD *a1)
{
  if (sub_10015B4FC((uint64_t)a1) != 7) {
    return 3450;
  }
  uint64_t v2 = sub_100022FE8(0xB0uLL);
  if (!v2) {
    return 106;
  }
  int v3 = v2;
  int v4 = *(_DWORD *)a1;
  *((_WORD *)v2 + 2) = a1[2];
  *uint64_t v2 = v4;
  v2[2] = 4403;
  uint64_t v5 = sub_10024B6B8((uint64_t)v2, 2, (uint64_t)sub_10015B76C);
  if (v5)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Error connecting to SDP %!", v6, v7, v8, v9, v10, v11, v12, v5);
      uint64_t v13 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_100023010(v3);
    if (v5 == 924 || v5 == 821)
    {
      v15[1] = a1;
      v15[0] = (const void *)6;
      return sub_1000268E4((uint64_t)sub_10015BB24, v15, 20, 0);
    }
  }
  return v5;
}

void sub_10015B76C(unsigned __int16 *a1, uint64_t a2)
{
  unsigned __int16 v57 = 0;
  if (a2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Error connecting to SDP %!", v4, v5, v6, v7, v8, v9, v10, a2);
      uint64_t v11 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_10074932C();
      }
    }
    goto LABEL_33;
  }
  byte_100A041E8 = 70;
  qword_100A041F8 = (uint64_t)&unk_1007B9898;
  word_100A041F0 = 16;
  qword_100A041D8 = (uint64_t)&byte_100A041E8;
  byte_100A041E0 = 1;
  uint64_t v56 = 0;
  if (sub_10017E2D4((uint64_t)a1, &v56))
  {
    int v12 = a1[83];
    if (a1[83]) {
      goto LABEL_7;
    }
LABEL_14:
    uint64_t v13 = sub_10018B988((uint64_t)a1, *((unsigned char *)a1 + 164), 0, (uint64_t)&qword_100A041D8, (uint64_t)sub_10015BFA8, (uint64_t)sub_10015C074, (uint64_t)sub_10015C0BC, &v57, (uint64_t)&unk_10099CC50);
    char v14 = 0;
    if (v13) {
      goto LABEL_8;
    }
    goto LABEL_15;
  }
  uint64_t v23 = sub_10024EA9C(v56);
  int v12 = a1[83];
  if (!a1[83] || v23 && *((_WORD *)v23 + 13) == 257) {
    goto LABEL_14;
  }
LABEL_7:
  uint64_t v13 = sub_10010A770((uint64_t)a1, v12, 0, (uint64_t)&qword_100A041D8, (uint64_t)sub_10015BFA8, (uint64_t)sub_10015C074, (uint64_t)sub_10015C0BC, &v57, (uint64_t)&unk_10099CC50);
  char v14 = 1;
  if (v13)
  {
LABEL_8:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Error connecting to the message notification service %!", v15, v16, v17, v18, v19, v20, v21, v13);
      uint64_t v22 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_10074932C();
      }
    }
    goto LABEL_33;
  }
LABEL_15:
  if (*(unsigned char *)(qword_100A04178 + 224) == 7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"No connection slots left", v24, v25, v26, v27, v28, v29, v30, v55);
      uint64_t v31 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    uint64_t v32 = 0;
    unsigned __int16 v33 = v57;
    while (1)
    {
      if (*(unsigned char *)(qword_100A04178 + v32))
      {
        uint64_t v34 = qword_100A04178 + v32;
        if (*(unsigned __int16 *)(qword_100A04178 + v32 + 8) == v57) {
          break;
        }
        int v35 = *(_DWORD *)(v34 + 1);
        int v36 = *(unsigned __int16 *)(v34 + 5);
        if (*(_DWORD *)a1 == v35 && a1[2] == v36) {
          break;
        }
      }
      v32 += 32;
      if (v32 == 224)
      {
        uint64_t v38 = 0;
        uint64_t v39 = (unsigned __int8 *)qword_100A04178;
        do
        {
          int v40 = *v39;
          v39 += 32;
          if (!v40) {
            break;
          }
          ++v38;
        }
        while (v38 != 7);
        uint64_t v41 = v38;
        uint64_t v42 = qword_100A04178 + 32 * v38;
        *(_OWORD *)uint64_t v42 = 0u;
        *(_OWORD *)(v42 + 16) = 0u;
        *(_WORD *)(v42 + 8) = v33;
        int v43 = *(_DWORD *)a1;
        *(_WORD *)(v42 + 5) = a1[2];
        *(_DWORD *)(v42 + 1) = v43;
        uint64_t v44 = qword_100A04178;
        uint64_t v45 = (unsigned char *)(qword_100A04178 + 32 * v38);
        *uint64_t v45 = 1;
        v45[24] = v14;
        ++*(unsigned char *)(v44 + 224);
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Created MNS Device with i: %d, inUse %d, addr: %:", v46, v47, v48, v49, v50, v51, v52, v41);
          uint64_t v53 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v54 = sub_100050714();
            *(_DWORD *)int buf = 136446210;
            uint64_t v59 = v54;
            _os_log_impl((void *)&_mh_execute_header, v53, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        break;
      }
    }
  }
LABEL_33:
  sub_100023010(a1);
}

uint64_t sub_10015BB24(uint64_t a1)
{
  uint64_t v1 = *(int **)(a1 + 8);
  __int16 v2 = *((_WORD *)v1 + 2);
  int v4 = *v1;
  __int16 v5 = v2;
  uint64_t result = sub_10015C270((uint64_t)&v4);
  if (result) {
    return sub_10015B648(&v4);
  }
  return result;
}

uint64_t sub_10015BB68(uint64_t a1)
{
  unsigned int v2 = sub_10015B4FC(a1);
  if (v2 == 7) {
    return 0;
  }
  uint64_t v3 = sub_100161D38(*(unsigned __int16 *)(qword_100A04178 + 32 * v2 + 8));
  if (v3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not disconnect MNS from %: : %!", v4, v5, v6, v7, v8, v9, v10, a1);
      uint64_t v11 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  return v3;
}

uint64_t sub_10015BC0C()
{
  qword_100A04178 = (uint64_t)sub_10010CE48(0xE8uLL);
  if (qword_100A04178) {
    return 0;
  }
  else {
    return 106;
  }
}

void sub_10015BC3C()
{
  qword_100A04178 = 0;
}

uint64_t sub_10015BC68(unsigned int *a1, void (*a2)(unint64_t, uint64_t), char a3, uint64_t a4, __int16 a5)
{
  unsigned int v10 = sub_10015B4FC((uint64_t)a1);
  __int16 v38 = 271;
  char v39 = a3;
  if (v10 == 7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid connection for address %:", v11, v12, v13, v14, v15, v16, v17, (uint64_t)a1);
      uint64_t v18 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    unint64_t v19 = *a1 | ((unint64_t)*((unsigned __int16 *)a1 + 2) << 32);
    uint64_t v20 = 122;
    uint64_t v21 = 122;
  }
  else
  {
    qword_100A04180 = (uint64_t)byte_100A04190;
    uint64_t v22 = v10;
    uint64_t v23 = qword_100A04178 + 32 * v10;
    int v24 = *(unsigned __int8 *)(v23 + 24);
    if (*(unsigned char *)(v23 + 24))
    {
      byte_100A04190[0] = -105;
      int v24 = 1;
      byte_100A04198 = 1;
    }
    uint64_t v25 = &byte_100A04190[24 * v24];
    *uint64_t v25 = 66;
    *((void *)v25 + 2) = "x-bt/MAP-event-report";
    *((_WORD *)v25 + 4) = 22;
    uint64_t v26 = &byte_100A04190[24 * (v24 + 1)];
    *uint64_t v26 = 76;
    *((void *)v26 + 2) = &v38;
    *((_WORD *)v26 + 4) = 3;
    uint64_t v27 = &byte_100A04190[24 * (v24 | 2)];
    *uint64_t v27 = 73;
    *((void *)v27 + 2) = a4;
    *((_WORD *)v27 + 4) = a5;
    byte_100A04188 = v24 + 3;
    uint64_t v28 = *(unsigned __int16 *)(v23 + 8);
    uint64_t v20 = sub_100160E78(*(unsigned __int16 *)(v23 + 8), (uint64_t)&qword_100A04180, (uint64_t)sub_10015BE5C, 0);
    if (!v20)
    {
      *(void *)(qword_100A04178 + 32 * v22 + 16) = a2;
      return v20;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"MAP MNS failed to send message on connection %d : %!", v29, v30, v31, v32, v33, v34, v35, v28);
      int v36 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    unint64_t v19 = *a1 | ((unint64_t)*((unsigned __int16 *)a1 + 2) << 32);
    uint64_t v21 = v20;
  }
  a2(v19, v21);
  return v20;
}

void sub_10015BE5C(unsigned int a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5 = 0;
  uint64_t v6 = (unsigned __int16 *)(qword_100A04178 + 8);
  while (!*((unsigned char *)v6 - 8) || *v6 != a1)
  {
    ++v5;
    v6 += 16;
    if (v5 == 7)
    {
      unsigned int v7 = 7;
      if (!a3) {
        goto LABEL_12;
      }
      goto LABEL_8;
    }
  }
  unsigned int v7 = v5;
  if (!a3) {
    goto LABEL_12;
  }
LABEL_8:
  if (a3 != 1701)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Server didn't ACK send for connection %d : %!", v8, v9, v10, v11, v12, v13, v14, a1);
      uint64_t v15 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
LABEL_12:
  if (v7 == 7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid connection ID %d", v16, v17, v18, v19, v20, v21, v22, a1);
      uint64_t v23 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    uint64_t v24 = qword_100A04178 + 32 * v7;
    uint64_t v25 = *(void (**)(unint64_t, uint64_t))(v24 + 16);
    if (v25) {
      v25(*(unsigned int *)(v24 + 1) | ((unint64_t)*(unsigned __int16 *)(v24 + 5) << 32), a3);
    }
  }
}

double sub_10015BFA8(int a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to connect to MNS : %!", v5, v6, v7, v8, v9, v10, v11, a3);
      uint64_t v13 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_10074932C();
      }
    }
    if (qword_100A04178)
    {
      uint64_t v14 = 0;
      while (!*(unsigned char *)(qword_100A04178 + v14) || *(unsigned __int16 *)(qword_100A04178 + v14 + 8) != a1)
      {
        v14 += 32;
        if (v14 == 224) {
          return result;
        }
      }
      return sub_10015C12C(a1);
    }
  }
  return result;
}

double sub_10015C074(int a1)
{
  if (qword_100A04178)
  {
    uint64_t v1 = 0;
    while (!*(unsigned char *)(qword_100A04178 + v1) || *(unsigned __int16 *)(qword_100A04178 + v1 + 8) != a1)
    {
      v1 += 32;
      if (v1 == 224) {
        return result;
      }
    }
    return sub_10015C12C(a1);
  }
  return result;
}

void sub_10015C0BC(unsigned int a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MNS AUTH required. Handle=%d", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

double sub_10015C12C(int a1)
{
  uint64_t v1 = 0;
  uint64_t v2 = (unsigned __int16 *)(qword_100A04178 + 8);
  while (!*((unsigned char *)v2 - 8) || *v2 != a1)
  {
    ++v1;
    v2 += 16;
    if (v1 == 7)
    {
      uint64_t v3 = 7;
      goto LABEL_7;
    }
  }
  uint64_t v3 = v1;
LABEL_7:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Deleting MNS Device at position i: %d, inUse %d, addr: %:", v4, v5, v6, v7, v8, v9, v10, v3);
    uint64_t v11 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v16 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (v3 == 7) {
    sub_10025B8C0();
  }
  uint64_t v12 = qword_100A04178;
  uint64_t v13 = (_OWORD *)(qword_100A04178 + 32 * v3);
  double result = 0.0;
  *uint64_t v13 = 0u;
  v13[1] = 0u;
  --*(unsigned char *)(v12 + 224);
  return result;
}

BOOL sub_10015C270(uint64_t a1)
{
  return sub_10015C290(a1) != 7;
}

uint64_t sub_10015C290(uint64_t a1)
{
  uint64_t v1 = 0;
  uint64_t v2 = qword_100A04200 + 9;
  do
  {
    if (*(unsigned char *)(v2 - 1))
    {
      if (*(_DWORD *)a1 == *(_DWORD *)v2 && *(unsigned __int16 *)(a1 + 4) == *(unsigned __int16 *)(v2 + 4)) {
        break;
      }
    }
    v2 += 32;
    ++v1;
  }
  while (v1 != 7);
  return v1;
}

uint64_t sub_10015C2DC(_OWORD *a1, uint64_t a2, uint64_t *a3, int a4, int a5)
{
  uint64_t v64 = 0;
  uint64_t v65 = 0;
  uint64_t v66 = 0;
  uint64_t v60 = 0;
  uint64_t v61 = 0;
  uint64_t v62 = 0;
  long long v58 = unk_10099CC80;
  qword_100A04200 = (uint64_t)sub_10010CE48(0x160uLL);
  if (qword_100A04200)
  {
    uint64_t v10 = sub_10015BC0C();
    if (v10)
    {
      uint64_t v11 = v10;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to register the MAP client %!", v12, v13, v14, v15, v16, v17, v18, v11);
        uint64_t v19 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return v11;
    }
    uint64_t v29 = qword_100A04200;
    *(unsigned char *)(qword_100A04200 + 4) = 2;
    uint64_t v30 = sub_10016334C((uint64_t)&v58, (uint64_t)off_10099CC90, 0, (unsigned char *)(v29 + 4), (uint64_t)&unk_10099CCB8);
    if (v30)
    {
      uint64_t v11 = v30;
      if (!sub_100058654()) {
        return v11;
      }
      sub_100056E24((uint64_t)"Failed to register the MAP OBEX server %!", v31, v32, v33, v34, v35, v36, v37, v11);
      __int16 v38 = sub_100050B4C(0x50u);
      if (!os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
        return v11;
      }
      goto LABEL_14;
    }
    uint64_t v39 = sub_100263D70((uint64_t)&v58, (uint64_t)off_10099CC90, 0, (_WORD *)(qword_100A04200 + 6), (uint64_t)&unk_10099CCB8, 1);
    if (v39)
    {
      uint64_t v11 = v39;
      if (!sub_100058654()) {
        return v11;
      }
      sub_100056E24((uint64_t)"Failed to register the MAP OBEX server %!", v40, v41, v42, v43, v44, v45, v46, v11);
      uint64_t v47 = sub_100050B4C(0x50u);
      if (!os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
        return v11;
      }
LABEL_14:
      sub_100744F6C();
      return v11;
    }
    byte_100A04208 = 1;
    word_100A0420A = 1;
    dword_100A04210 = *(unsigned __int8 *)(qword_100A04200 + 4);
    byte_100A04218 = 1;
    word_100A0421A = 1;
    dword_100A04220 = a5;
    byte_100A04228 = 1;
    word_100A0422A = 4;
    dword_100A04230 = a4;
    byte_100A04238 = 1;
    word_100A0423A = 2;
    dword_100A04240 = *(unsigned __int16 *)(qword_100A04200 + 6);
    uint64_t v63 = &unk_10099CCE8;
    LOWORD(v64) = 7;
    uint64_t v65 = *a3;
    LOWORD(v66) = *((_WORD *)a3 + 4);
    uint64_t v59 = &unk_10099CD90;
    LOWORD(v60) = 5;
    uint64_t v61 = v65;
    LOWORD(v62) = v66;
    uint64_t v11 = sub_10024E258((uint64_t)&v63, (int *)qword_100A04200);
    if (v11)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_SDPDB_AddServiceRecord failed: %!", v48, v49, v50, v51, v52, v53, v54, v11);
        uint64_t v55 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_1001637D0(*(unsigned __int8 *)(qword_100A04200 + 4));
    }
    else
    {
      sub_10024E564(*(unsigned int *)qword_100A04200, (uint64_t)&v59);
      uint64_t v56 = qword_100A04200;
      *(_OWORD *)(qword_100A04200 + 240) = *a1;
      *(_OWORD *)(v56 + 256) = *(_OWORD *)a2;
      *(_OWORD *)(v56 + 272) = *(_OWORD *)(a2 + 16);
      *(void *)(v56 + 288) = *(void *)(a2 + 32);
      *(_OWORD *)(v56 + 304) = *(_OWORD *)(a2 + 40);
      *(void *)(v56 + 296) = *(void *)(a2 + 56);
      *(_OWORD *)(v56 + 320) = *(_OWORD *)(a2 + 64);
      *(unsigned char *)(v56 + 344) = 0;
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to allocate memory for MAP server structure", v20, v21, v22, v23, v24, v25, v26, v57);
      uint64_t v27 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_1007493A8();
      }
    }
    return 106;
  }
  return v11;
}

void sub_10015C64C()
{
  if (qword_100A04200)
  {
    if (sub_1001637D0(*(unsigned __int8 *)(qword_100A04200 + 4)))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Error deregistering server", v0, v1, v2, v3, v4, v5, v6, v32);
        uint64_t v7 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    if (sub_100264110(*(unsigned __int16 *)(qword_100A04200 + 6)))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Error deregistering L2CAP server", v8, v9, v10, v11, v12, v13, v14, v32);
        uint64_t v15 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    if (sub_10024E448(*(_DWORD *)qword_100A04200) && sub_100058654())
    {
      sub_100056E24((uint64_t)"Error removing service record", v16, v17, v18, v19, v20, v21, v22, v32);
      uint64_t v23 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10015BC3C();
    sub_100023010((void *)qword_100A04200);
    qword_100A04200 = 0;
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MAP is not registered.", v24, v25, v26, v27, v28, v29, v30, v32);
    uint64_t v31 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_10015C7D4(unsigned int a1)
{
  __int16 v21 = 0;
  int v20 = 0;
  if (qword_100A04200)
  {
    if (sub_10015C8D4(a1) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v2, v3, v4, v5, v6, v7, v8, a1);
        uint64_t v9 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 3454;
    }
    else
    {
      if (!sub_1001147F0(a1, (uint64_t)&v20)) {
        sub_10015BB68((uint64_t)&v20);
      }
      return sub_1001148A0(a1);
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"MAP is not initialized", v11, v12, v13, v14, v15, v16, v17, v19);
      uint64_t v18 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 103;
  }
}

uint64_t sub_10015C8D4(unsigned int a1)
{
  if (qword_100A04200)
  {
    uint64_t v2 = 0;
    uint64_t v3 = (unsigned __int16 *)(qword_100A04200 + 16);
    while (!*((unsigned char *)v3 - 8) || *v3 != a1)
    {
      v3 += 16;
      if (++v2 == 7)
      {
        if (!sub_100058654()) {
          goto LABEL_12;
        }
        sub_100056E24((uint64_t)"Cannot retrieve device position for connectionId %d", v4, v5, v6, v7, v8, v9, v10, a1);
        uint64_t v11 = sub_100050B4C(0x50u);
        if (!os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          goto LABEL_12;
        }
        goto LABEL_11;
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"MAP server has been unregistered. Cannot retrieve device position for connectionId %d", v12, v13, v14, v15, v16, v17, v18, a1);
      uint64_t v19 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
LABEL_11:
      }
        sub_100744F6C();
    }
LABEL_12:
    LOBYTE(v2) = 7;
  }
  return v2;
}

uint64_t sub_10015C9CC(unsigned int a1, int a2)
{
  if (qword_100A04200)
  {
    if (sub_10015C8D4(a1) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v4, v5, v6, v7, v8, v9, v10, a1);
        uint64_t v11 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 3455;
    }
    else
    {
      if (a2)
      {
        int v21 = 0;
      }
      else
      {
        sub_10015CAE4(a1);
        int v21 = 1735;
      }
      return sub_100114014(a1, a2, v21);
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"MAP is not initialized", v13, v14, v15, v16, v17, v18, v19, v22);
      int v20 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 103;
  }
}

double sub_10015CAE4(unsigned int a1)
{
  unsigned int v1 = sub_10015C8D4(a1);
  if (v1 == 7) {
    sub_10025B8C0();
  }
  uint64_t v2 = qword_100A04200;
  uint64_t v3 = *(void **)(qword_100A04200 + 32 * v1 + 24);
  if (v3)
  {
    sub_10015ECC0(v3);
    uint64_t v2 = qword_100A04200;
  }
  sub_1002595D8(*(void **)(v2 + 32 * v1 + 32));
  uint64_t v4 = qword_100A04200;
  uint64_t v5 = qword_100A04200 + 32 * v1;
  double result = 0.0;
  *(_OWORD *)(v5 + 8) = 0u;
  *(_OWORD *)(v5 + 24) = 0u;
  --*(unsigned char *)(v4 + 232);
  return result;
}

void sub_10015CB60(unsigned int a1, uint64_t a2, unsigned __int16 a3)
{
  if (qword_100A04200)
  {
    unsigned int v6 = sub_10015C8D4(a1);
    if (v6 == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v7, v8, v9, v10, v11, v12, v13, a1);
        uint64_t v14 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
LABEL_5:
        }
          sub_100744F6C();
      }
    }
    else
    {
      v26[0] = a2;
      v26[1] = a3;
      uint64_t v23 = v6;
      int v24 = sub_100059E10(*(void *)(qword_100A04200 + 32 * v6 + 32));
      sub_100259764(*(void *)(qword_100A04200 + 32 * v23 + 32), (uint64_t)v26, 16);
      if (!v24) {
        sub_10015CC7C(a1);
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MAP is not initialized", v15, v16, v17, v18, v19, v20, v21, v25);
    uint64_t v22 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      goto LABEL_5;
    }
  }
}

void sub_10015CC7C(unsigned int a1)
{
  unsigned int v2 = sub_10015C8D4(a1);
  if (v2 == 7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid connection ID %d.", v3, v4, v5, v6, v7, v8, v9, a1);
      uint64_t v10 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    uint64_t v11 = v2;
    uint64_t v12 = sub_10025989C(*(void *)(qword_100A04200 + 32 * v2 + 32));
    uint64_t v13 = *(void *)v12;
    __int16 v14 = *(_WORD *)(v12 + 8);
    uint64_t v15 = (unsigned int *)(qword_100A04200 + 32 * v11 + 9);
    sub_10015BC68(v15, (void (*)(unint64_t, uint64_t))sub_100160344, 0, v13, v14);
  }
}

uint64_t sub_10015CD5C(unsigned int a1, uint64_t a2, __int16 a3, char a4, uint64_t a5)
{
  __int16 v42 = 278;
  char v43 = a4;
  if (qword_100A04200)
  {
    if (sub_10015C8D4(a1) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v9, v10, v11, v12, v13, v14, v15, a1);
        uint64_t v16 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 3457;
    }
    uint64_t v25 = &qword_100A04290;
    qword_100A04290 = (uint64_t)byte_100A04248;
    byte_100A04298 = 0;
    if (a5 || (char v26 = *(unsigned char *)(qword_100A04200 + 344), (v26 & 1) == 0))
    {
      if (a5)
      {
        uint64_t v25 = 0;
LABEL_18:
        uint64_t v30 = sub_100113A54(a1, (uint64_t)v25, a5);
        if (v30)
        {
          uint64_t v31 = v30;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Failed to send GET response %!", v32, v33, v34, v35, v36, v37, v38, v31);
            uint64_t v39 = sub_100050B4C(0x50u);
            if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
        return a5;
      }
      int v27 = 0;
    }
    else
    {
      byte_100A04248[0] = -105;
      int v27 = 1;
      byte_100A04250 = 1;
      *(unsigned char *)(qword_100A04200 + 344) = v26 & 0xFA | 4;
    }
    uint64_t v28 = &byte_100A04248[24 * v27];
    *uint64_t v28 = 76;
    *((void *)v28 + 2) = &v42;
    *((_WORD *)v28 + 4) = 3;
    uint64_t v29 = &byte_100A04248[24 * (v27 + 1)];
    char *v29 = 73;
    *((void *)v29 + 2) = a2;
    *((_WORD *)v29 + 4) = a3;
    byte_100A04298 = v27 | 2;
    goto LABEL_18;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MAP is not initialized", v17, v18, v19, v20, v21, v22, v23, v41);
    int v24 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 103;
}

uint64_t sub_10015CF50(unsigned int a1, char *a2, uint64_t a3)
{
  if (qword_100A04200)
  {
    if (sub_10015C8D4(a1) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v6, v7, v8, v9, v10, v11, v12, a1);
        uint64_t v13 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 3459;
    }
    uint64_t v22 = &qword_100A042E8;
    qword_100A042E8 = (uint64_t)byte_100A042A0;
    byte_100A042F0 = 0;
    if (a3 || (char v23 = *(unsigned char *)(qword_100A04200 + 344), (v23 & 1) == 0))
    {
      if (a3)
      {
        uint64_t v22 = 0;
LABEL_17:
        if (sub_100113D3C(a1, (uint64_t)v22, a3))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Failed to send PUT response %!", v28, v29, v30, v31, v32, v33, v34, a3);
            uint64_t v35 = sub_100050B4C(0x50u);
            if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
        return a3;
      }
    }
    else
    {
      byte_100A042A0[0] = -105;
      byte_100A042A8 = 1;
      byte_100A042F0 = 1;
      *(unsigned char *)(qword_100A04200 + 344) = v23 & 0xFA | 4;
    }
    memset(v38, 0, sizeof(v38));
    int v24 = strlen(a2);
    sub_100262A98((unsigned __int8 *)a2, v24, v38, 16);
    char v25 = byte_100A042F0;
    char v26 = &byte_100A042A0[24 * byte_100A042F0];
    *char v26 = 1;
    *((void *)v26 + 2) = v38;
    *((_WORD *)v26 + 4) = 16;
    int v27 = &byte_100A042A0[24 * (v25 + 1)];
    *int v27 = 73;
    *((void *)v27 + 2) = 0;
    *((_WORD *)v27 + 4) = 0;
    byte_100A042F0 = v25 + 2;
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MAP is not initialized", v14, v15, v16, v17, v18, v19, v20, v37);
    uint64_t v21 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 103;
}

uint64_t sub_10015D198(unsigned int a1, char a2, __int16 a3, uint64_t a4, int a5, char *__s)
{
  __int16 v43 = 269;
  char v44 = a2;
  __int16 v45 = 3865;
  qmemcpy(&v46, "YYYYMMDDTHHM", 12);
  HIDWORD(v46) = 307450701;
  char v47 = 2;
  char v48 = HIBYTE(a3);
  char v49 = a3;
  if (__s && strlen(__s) == 15)
  {
    *(void *)&long long v46 = *(void *)__s;
    *(void *)((char *)&v46 + 7) = *(void *)(__s + 7);
  }
  if (qword_100A04200)
  {
    if (sub_10015C8D4(a1) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v10, v11, v12, v13, v14, v15, v16, a1);
        uint64_t v17 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 3459;
    }
    else
    {
      qword_100A04340 = (uint64_t)byte_100A042F8;
      char v27 = *(unsigned char *)(qword_100A04200 + 344);
      if (v27)
      {
        byte_100A042F8[0] = -105;
        int v28 = 1;
        byte_100A04300 = 1;
        *(unsigned char *)(qword_100A04200 + 344) = v27 & 0xFA | 4;
      }
      else
      {
        int v28 = 0;
      }
      uint64_t v29 = &byte_100A042F8[24 * v28];
      char *v29 = 76;
      *((void *)v29 + 2) = &v43;
      *((_WORD *)v29 + 4) = 24;
      uint64_t v30 = &byte_100A042F8[24 * (v28 + 1)];
      *uint64_t v30 = 73;
      *((void *)v30 + 2) = a4;
      *((_WORD *)v30 + 4) = a5;
      char v31 = v28 | 2;
      if (a5) {
        BOOL v32 = a4 == 0;
      }
      else {
        BOOL v32 = 1;
      }
      if (v32) {
        char v31 = v28 + 1;
      }
      byte_100A04348 = v31;
      uint64_t v18 = sub_100113A54(a1, (uint64_t)&qword_100A04340, 0);
      if (v18)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Failed to send GET response %!", v33, v34, v35, v36, v37, v38, v39, v18);
          uint64_t v40 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"MAP is not initialized", v19, v20, v21, v22, v23, v24, v25, v42);
      char v26 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 103;
  }
  return v18;
}

uint64_t sub_10015D414(unsigned int a1, __int16 a2, uint64_t a3, __int16 a4)
{
  __int16 v38 = 529;
  char v39 = HIBYTE(a2);
  char v40 = a2;
  if (qword_100A04200)
  {
    if (sub_10015C8D4(a1) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %d.", v7, v8, v9, v10, v11, v12, v13, a1);
        uint64_t v14 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 3460;
    }
    else
    {
      qword_100A04398 = (uint64_t)byte_100A04350;
      char v24 = *(unsigned char *)(qword_100A04200 + 344);
      if (v24)
      {
        byte_100A04350[0] = -105;
        int v25 = 1;
        byte_100A04358 = 1;
        *(unsigned char *)(qword_100A04200 + 344) = v24 & 0xFA | 4;
      }
      else
      {
        int v25 = 0;
      }
      char v26 = &byte_100A04350[24 * v25];
      *char v26 = 76;
      *((void *)v26 + 2) = &v38;
      *((_WORD *)v26 + 4) = 4;
      char v27 = &byte_100A04350[24 * (v25 + 1)];
      *char v27 = 73;
      *((void *)v27 + 2) = a3;
      *((_WORD *)v27 + 4) = a4;
      byte_100A043A0 = v25 | 2;
      uint64_t v15 = sub_100113A54(a1, (uint64_t)&qword_100A04398, 0);
      if (v15)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Failed to send GET response %!", v28, v29, v30, v31, v32, v33, v34, v15);
          uint64_t v35 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"MAP is not initialized", v16, v17, v18, v19, v20, v21, v22, v37);
      uint64_t v23 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 103;
  }
  return v15;
}

void sub_10015D5F4(unsigned int a1, int a2)
{
  uint64_t v2 = sub_1001146F8(a1, a2);
  if (v2)
  {
    uint64_t v3 = v2;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Can't confirm SetPath %!", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_10015D668(unsigned int a1, int a2)
{
  uint64_t v2 = sub_100113D3C(a1, 0, a2);
  if (v2)
  {
    uint64_t v3 = v2;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not send SetMessageStatus response : %!", v4, v5, v6, v7, v8, v9, v10, v3);
      uint64_t v11 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_10015D6E4(unsigned int a1, int a2)
{
  qword_100A043C0 = (uint64_t)&byte_100A043A8;
  byte_100A043C8 = 0;
  if (!a2)
  {
    char v2 = *(unsigned char *)(qword_100A04200 + 344);
    if (v2)
    {
      byte_100A043A8 = -105;
      byte_100A043B0 = 1;
      byte_100A043C8 = 1;
      *(unsigned char *)(qword_100A04200 + 344) = v2 & 0xFA | 4;
    }
  }
  uint64_t v3 = sub_100113D3C(a1, (uint64_t)&qword_100A043C0, a2);
  if (v3)
  {
    uint64_t v4 = v3;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not send BT_MAP_SetNotificationFilter response : %!", v5, v6, v7, v8, v9, v10, v11, v4);
      uint64_t v12 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_10015D7B4(unsigned int a1, int a2)
{
  int v2 = 0;
  qword_100A04400 = (uint64_t)byte_100A043D0;
  if (!a2)
  {
    char v3 = *(unsigned char *)(qword_100A04200 + 344);
    if (v3)
    {
      byte_100A043D0[0] = -105;
      int v2 = 1;
      byte_100A043D8 = 1;
      *(unsigned char *)(qword_100A04200 + 344) = v3 & 0xFA | 4;
    }
  }
  uint64_t v4 = &byte_100A043D0[24 * v2];
  *uint64_t v4 = 73;
  *((void *)v4 + 2) = "Apple Inc.";
  *((_WORD *)v4 + 4) = 11;
  byte_100A04408 = v2 + 1;
  uint64_t v5 = sub_100113A54(a1, (uint64_t)&qword_100A04400, 0);
  if (v5)
  {
    uint64_t v6 = v5;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to send GET response %!", v7, v8, v9, v10, v11, v12, v13, v6);
      uint64_t v14 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_10015D8A4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  __int16 v60 = 0;
  int v59 = 0;
  if (sub_1001147F0(a1, (uint64_t)&v59))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to get client address", v8, v9, v10, v11, v12, v13, v14, v58);
      uint64_t v15 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    goto LABEL_30;
  }
  if (sub_10015C290((uint64_t)&v59) == 7)
  {
    if (*(unsigned char *)(qword_100A04200 + 232) == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"No connection slots left", v16, v17, v18, v19, v20, v21, v22, v58);
        uint64_t v23 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      uint64_t v32 = 0;
      while (1)
      {
        if (*(unsigned char *)(qword_100A04200 + v32 + 8))
        {
          if (*(unsigned __int16 *)(qword_100A04200 + v32 + 16) == a1) {
            break;
          }
          if (v59 == *(_DWORD *)(qword_100A04200 + v32 + 9) && v60 == *(_WORD *)(qword_100A04200 + v32 + 13)) {
            break;
          }
        }
        v32 += 32;
        if (v32 == 224)
        {
          uint64_t v34 = 0;
          uint64_t v35 = (unsigned __int8 *)(qword_100A04200 + 8);
          while (1)
          {
            int v36 = *v35;
            v35 += 32;
            if (!v36) {
              break;
            }
            if (++v34 == 7)
            {
              unsigned int v37 = 7;
              goto LABEL_26;
            }
          }
          unsigned int v37 = v34;
LABEL_26:
          uint64_t v38 = qword_100A04200 + 32 * v37;
          *(_OWORD *)(v38 + 8) = 0u;
          *(_OWORD *)(v38 + 24) = 0u;
          *(_WORD *)(v38 + 16) = a1;
          int v39 = v59;
          *(_WORD *)(v38 + 13) = v60;
          *(_DWORD *)(v38 + 9) = v39;
          *(unsigned char *)(qword_100A04200 + 32 * v37 + 8) = 1;
          char v40 = sub_10025959C((uint64_t)sub_10015E394, (uint64_t)sub_10015E3E0);
          uint64_t v41 = qword_100A04200;
          *(void *)(qword_100A04200 + 32 * v37 + 32) = v40;
          ++*(unsigned char *)(v41 + 232);
          if (v37 != 7)
          {
            (*(void (**)(int *, uint64_t, uint64_t, uint64_t, uint64_t))(v41 + 240))(&v59, a2, a3, a4, a1);
            return;
          }
          break;
        }
      }
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not create new device.", v42, v43, v44, v45, v46, v47, v48, v58);
      char v49 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
        goto LABEL_29;
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Device is already connected.", v24, v25, v26, v27, v28, v29, v30, v58);
    uint64_t v31 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
LABEL_29:
    }
      sub_100744F6C();
  }
LABEL_30:
  if (sub_100114014(a1, 0, 3451) && sub_100058654())
  {
    sub_100056E24((uint64_t)"Failed to inform client of connection failure", v50, v51, v52, v53, v54, v55, v56, v58);
    uint64_t v57 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

uint64_t sub_10015DB98(uint64_t a1)
{
  uint64_t result = sub_10015C8D4(a1);
  if (result != 7)
  {
    v3.n128_f64[0] = sub_10015CAE4(a1);
    uint64_t v4 = *(uint64_t (**)(uint64_t, void, __n128))(qword_100A04200 + 248);
    return v4(a1, 0, v3);
  }
  return result;
}

uint64_t sub_10015DBFC(uint64_t a1, uint64_t *a2, int a3)
{
  unsigned int v6 = sub_10015C8D4(a1);
  if (v6 >= 7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not get the device.", v7, v8, v9, v10, v11, v12, v13, v80);
      uint64_t v14 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 3452;
  }
  uint64_t v16 = v6;
  uint64_t v17 = *(void *)(qword_100A04200 + 32 * v6 + 24);
  if (a3 != 1752 && a3 != 1701)
  {
    uint64_t v15 = 0;
    goto LABEL_16;
  }
  if (a2 && !v17)
  {
    uint64_t v18 = sub_10010CE48(0x1B0uLL);
    if (!v18)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"ERROR : OI_STATUS_OUT_OF_MEMORY", v45, v46, v47, v48, v49, v50, v51, v80);
        uint64_t v52 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      uint64_t v15 = 106;
      goto LABEL_32;
    }
    uint64_t v17 = (uint64_t)v18;
    *uint64_t v18 = 2;
    uint64_t v19 = sub_10015E3E8(a2, (uint64_t)v18);
    if (v19)
    {
      uint64_t v15 = v19;
      if (!sub_100058654()) {
        goto LABEL_31;
      }
      sub_100056E24((uint64_t)"ERROR (parsing): %!", v20, v21, v22, v23, v24, v25, v26, v15);
      uint64_t v27 = sub_100050B4C(0x50u);
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        goto LABEL_31;
      }
      goto LABEL_30;
    }
    goto LABEL_48;
  }
  if (!a2 && v17)
  {
    if (*(unsigned char *)v17 != 2)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"ERROR : OI_OBEX_PRECONDITION_FAILED", v28, v29, v30, v31, v32, v33, v34, v80);
        uint64_t v35 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      uint64_t v15 = 1741;
      goto LABEL_31;
    }
    goto LABEL_48;
  }
  if (a2 && v17)
  {
    uint64_t v36 = sub_10015E3E8(a2, v17);
    if (v36)
    {
      uint64_t v15 = v36;
      if (!sub_100058654()) {
        goto LABEL_31;
      }
      sub_100056E24((uint64_t)"ERROR (parsing): %!", v37, v38, v39, v40, v41, v42, v43, v15);
      uint64_t v44 = sub_100050B4C(0x50u);
      if (!os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        goto LABEL_31;
      }
      goto LABEL_30;
    }
    if (a3 == 1752)
    {
      uint64_t v53 = sub_100113A54(a1, 0, 1701);
      if (!v53)
      {
LABEL_49:
        *(void *)(qword_100A04200 + 32 * v16 + 24) = v17;
        uint64_t v15 = sub_100113A54(a1, 0, 1701);
        if (!v15) {
          return v15;
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"ERROR (OI_OBEXSRV_GetResponse): %!", v62, v63, v64, v65, v66, v67, v68, v15);
          uint64_t v69 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
LABEL_16:
        if (v17)
        {
LABEL_31:
          sub_10015ECC0((void *)v17);
          *(void *)(qword_100A04200 + 32 * v16 + 24) = 0;
        }
LABEL_32:
        if ((*(unsigned char *)(qword_100A04200 + 344) & 4) != 0) {
          *(unsigned char *)(qword_100A04200 + 344) = 0;
        }
        return v15;
      }
      uint64_t v15 = v53;
      if (!sub_100058654()) {
        goto LABEL_31;
      }
      sub_100056E24((uint64_t)"ERROR (OI_OBEXSRV_GetResponse): %!", v54, v55, v56, v57, v58, v59, v60, v15);
      uint64_t v61 = sub_100050B4C(0x50u);
      if (!os_log_type_enabled(v61, OS_LOG_TYPE_ERROR)) {
        goto LABEL_31;
      }
LABEL_30:
      sub_100744F6C();
      goto LABEL_31;
    }
  }
  else if (!((unint64_t)a2 | v17))
  {
    if (a3 != 1701)
    {
      uint64_t v15 = 1741;
      goto LABEL_32;
    }
    if ((*(unsigned char *)(qword_100A04200 + 344) & 4) != 0) {
      sub_100113BE0(a1);
    }
    return 0;
  }
LABEL_48:
  if (a3 != 1701) {
    goto LABEL_49;
  }
  uint64_t v70 = *(void (**)(uint64_t, uint64_t))(v17 + 16);
  if (v70)
  {
    v70(v17, a1);
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"No function defined for this GET.", v71, v72, v73, v74, v75, v76, v77, v80);
      uint64_t v78 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_100113A54(a1, 0, 0);
  }
  sub_10015ECC0((void *)v17);
  uint64_t v15 = 0;
  *(void *)(qword_100A04200 + 32 * v16 + 24) = 0;
  return v15;
}

uint64_t sub_10015E040(uint64_t a1, uint64_t a2, int a3)
{
  unsigned int v6 = sub_10015C8D4(a1);
  if (v6 >= 7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not get the device.", v7, v8, v9, v10, v11, v12, v13, v41);
      uint64_t v14 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 3453;
  }
  uint64_t v15 = v6;
  uint64_t v16 = *(void **)(qword_100A04200 + 32 * v6 + 24);
  if (v16)
  {
    if (*(unsigned char *)v16 != 1)
    {
      a2 = 1741;
      goto LABEL_13;
    }
  }
  else
  {
    uint64_t v16 = sub_10010CE48(0x1B0uLL);
    *(unsigned char *)uint64_t v16 = 1;
  }
  if (!a2)
  {
LABEL_13:
    sub_10015ECC0(v16);
    uint64_t v18 = qword_100A04200;
    *(void *)(qword_100A04200 + 32 * v15 + 24) = 0;
    if ((*(unsigned char *)(v18 + 344) & 4) != 0) {
      *(unsigned char *)(v18 + 344) = 0;
    }
    return a2;
  }
  uint64_t v17 = sub_10015E3E8((uint64_t *)a2, (uint64_t)v16);
  if (v17)
  {
LABEL_12:
    a2 = v17;
    goto LABEL_13;
  }
  if (a3 != 1701)
  {
    uint64_t v24 = (uint64_t (*)(void *, uint64_t))v16[2];
    if (!v24)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"No function defined for this PUT.", v33, v34, v35, v36, v37, v38, v39, v41);
        uint64_t v40 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      a2 = 0;
      goto LABEL_13;
    }
    uint64_t v17 = v24(v16, a1);
    goto LABEL_12;
  }
  uint64_t v20 = qword_100A04200;
  *(void *)(qword_100A04200 + 32 * v15 + 24) = v16;
  char v21 = *(unsigned char *)(v20 + 344);
  if (v21)
  {
    uint64_t v23 = &qword_100A04440;
    qword_100A04440 = (uint64_t)&byte_100A04410;
    byte_100A04410 = -105;
    byte_100A04418 = 1;
    byte_100A04448 = 1;
    *(unsigned char *)(v20 + 344) = v21 & 0xFA | 4;
    unsigned int v22 = a1;
  }
  else
  {
    if ((*(unsigned char *)(v20 + 344) & 4) != 0) {
      return 0;
    }
    unsigned int v22 = a1;
    uint64_t v23 = 0;
  }
  a2 = sub_100113D3C(v22, (uint64_t)v23, 1701);
  if (a2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not send PUT response (continue) %!", v25, v26, v27, v28, v29, v30, v31, a2);
      uint64_t v32 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    goto LABEL_13;
  }
  return a2;
}

uint64_t sub_10015E270(uint64_t a1, unsigned __int16 *a2, uint64_t a3, char a4)
{
  uint64_t v8 = (char *)sub_100022FE8(0x100uLL);
  if (a4) {
    return 1735;
  }
  uint64_t v10 = v8;
  if (a2)
  {
    uint64_t v11 = sub_100262B48(*((void *)a2 + 1), *a2, v8, 256);
    if (v11)
    {
      uint64_t v12 = v11;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to get UTF8 string from UTF16 : %!", v13, v14, v15, v16, v17, v18, v19, v12);
        uint64_t v20 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      unsigned __int16 v21 = strlen(v10);
      (*(void (**)(uint64_t, char *, void, uint64_t, void))(qword_100A04200 + 288))(a1, v10, v21, a3, 0);
    }
  }
  else
  {
    (*(void (**)(uint64_t, const char *, void, uint64_t, void))(qword_100A04200 + 288))(a1, "", 0, a3, 0);
  }
  sub_100023010(v10);
  return 0;
}

void *sub_10015E394(uint64_t a1, uint64_t a2)
{
  size_t v4 = *(unsigned __int16 *)(a2 + 8);
  uint64_t v5 = sub_100022FE8(v4);
  *(void *)a1 = v5;
  uint64_t result = memmove(v5, *(const void **)a2, v4);
  *(_WORD *)(a1 + 8) = v4;
  return result;
}

void sub_10015E3E0(void **a1)
{
}

uint64_t sub_10015E3E8(uint64_t *a1, uint64_t a2)
{
  if (!*((unsigned char *)a1 + 8)) {
    return 0;
  }
  uint64_t v4 = 0;
  while (1)
  {
    uint64_t v5 = *a1;
    unsigned int v6 = *(unsigned __int8 *)(*a1 + 24 * v4);
    if (v6 <= 0x48)
    {
      switch(v6)
      {
        case 1u:
          if (!*(void *)(a2 + 8))
          {
            uint64_t v91 = v5 + 24 * v4;
            if (*(void *)(v91 + 16))
            {
              v92 = (unsigned __int16 *)(v91 + 8);
              if (*(_WORD *)(v91 + 8))
              {
                uint64_t v93 = sub_100022FE8(*(unsigned __int16 *)(v91 + 8));
                *(void *)(a2 + 8) = v93;
                if (!v93) {
                  return 106;
                }
                if (sub_100262B48(*((void *)v92 + 1), *v92, v93, *v92))
                {
                  sub_100023010(*(void **)(a2 + 8));
                  *(void *)(a2 + 8) = 0;
                }
              }
            }
            goto LABEL_113;
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Got 2 names. ignoring.", v71, v72, v73, v74, v75, v76, v77, v120);
            uint64_t v78 = sub_100050B4C(0x50u);
            if (os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
              goto LABEL_103;
            }
          }
          break;
        case 0x42u:
          if (*(void *)(a2 + 16))
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"2 Header types in this header.", v112, v113, v114, v115, v116, v117, v118, v120);
              v119 = sub_100050B4C(0x50u);
              if (os_log_type_enabled(v119, OS_LOG_TYPE_ERROR)) {
                sub_100744F6C();
              }
            }
            return 1720;
          }
          uint64_t v79 = v5 + 24 * v4 + 8;
          if (!*(_WORD *)v79 || !*(void *)(v79 + 8)) {
            return 1735;
          }
          uint64_t v80 = 0;
          while (1)
          {
            int v81 = strlen(*(const char **)(v79 + 8));
            if (!sub_100262E60(*(unsigned __int8 **)(v79 + 8), (unsigned __int8 *)(&off_10099CE08)[v80], v81))break; {
            v80 += 2;
            }
            if (v80 == 16) {
              goto LABEL_113;
            }
          }
          *(void *)(a2 + 16) = (&off_10099CE08)[v80 + 1];
          goto LABEL_113;
        case 0x48u:
          goto LABEL_79;
      }
      goto LABEL_113;
    }
    if (*(unsigned __int8 *)(*a1 + 24 * v4) > 0x96u)
    {
      if (v6 == 151)
      {
        if (*(unsigned char *)(v5 + 24 * v4 + 8) != 1) {
          goto LABEL_113;
        }
        uint64_t v63 = qword_100A04200;
        char v64 = *(unsigned char *)(qword_100A04200 + 344) | 1;
      }
      else
      {
        if (v6 != 152 || *(unsigned char *)(v5 + 24 * v4 + 8) != 1) {
          goto LABEL_113;
        }
        uint64_t v63 = qword_100A04200;
        char v64 = *(unsigned char *)(qword_100A04200 + 344) | 2;
      }
      *(unsigned char *)(v63 + 344) = v64;
      goto LABEL_113;
    }
    if (v6 == 73)
    {
      *(unsigned char *)(a2 + 426) = 1;
LABEL_79:
      uint64_t v65 = v5 + 24 * v4;
      unsigned int v68 = *(unsigned __int16 *)(v65 + 8);
      uint64_t v67 = (unsigned __int16 *)(v65 + 8);
      size_t v66 = v68;
      if (*(void *)(a2 + 416))
      {
        if (v66)
        {
          uint64_t v69 = (char *)sub_100022FE8(*(unsigned __int16 *)(a2 + 424) + v66);
          if (v69)
          {
            uint64_t v70 = v69;
            memmove(v69, *(const void **)(a2 + 416), *(unsigned __int16 *)(a2 + 424));
            memmove(&v70[*(unsigned __int16 *)(a2 + 424)], *((const void **)v67 + 1), *v67);
            sub_100023010(*(void **)(a2 + 416));
            *(_WORD *)(a2 + 424) += *v67;
            *(void *)(a2 + 416) = v70;
          }
        }
      }
      else if (v66)
      {
        *(_WORD *)(a2 + 424) = v66;
        uint64_t v82 = sub_100022FE8(v66);
        *(void *)(a2 + 416) = v82;
        if (v82)
        {
          memmove(v82, *(const void **)(v5 + 24 * v4 + 16), *(unsigned __int16 *)(a2 + 424));
        }
        else
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Could not store body length.", v94, v95, v96, v97, v98, v99, v100, v120);
            v101 = sub_100050B4C(0x50u);
            if (os_log_type_enabled(v101, OS_LOG_TYPE_ERROR))
            {
              v102 = sub_100050714();
              *(_DWORD *)int buf = 136446466;
              v124 = v102;
              __int16 v125 = 1024;
              int v126 = 0xFFFF;
              _os_log_error_impl((void *)&_mh_execute_header, v101, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }
          *(_WORD *)(a2 + 424) = 0;
        }
      }
      goto LABEL_113;
    }
    if (v6 == 76) {
      break;
    }
LABEL_113:
    if (++v4 >= (unint64_t)*((unsigned __int8 *)a1 + 8)) {
      return 0;
    }
  }
  uint64_t v7 = v5 + 24 * v4;
  unsigned int v10 = *(unsigned __int16 *)(v7 + 8);
  uint64_t v8 = v7 + 8;
  unsigned int v9 = v10;
  if (!v10)
  {
    if (!sub_100058654()) {
      goto LABEL_113;
    }
    sub_100056E24((uint64_t)"App Params = 0. Ignoring", v83, v84, v85, v86, v87, v88, v89, v120);
    uint64_t v78 = sub_100050B4C(0x50u);
    if (!os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
      goto LABEL_113;
    }
LABEL_103:
    v90 = sub_100050714();
    *(_DWORD *)int buf = 136446466;
    v124 = v90;
    __int16 v125 = 1024;
    int v126 = 0xFFFF;
    _os_log_error_impl((void *)&_mh_execute_header, v78, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
    goto LABEL_113;
  }
  uint64_t v11 = *(void *)(v8 + 8);
  if (!v11) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/map/map_server.c", 1123, "appParams->data");
  }
  char v122 = 0;
  uint64_t v121 = 0;
  uint64_t v12 = 0;
  int v13 = 0;
  while (1)
  {
LABEL_10:
    if (v9 <= (unsigned __int16)v13) {
      goto LABEL_113;
    }
    uint64_t v14 = (unsigned __int16)v13;
    uint64_t v15 = (unsigned __int16)v13 + 1;
    if (v9 <= (unsigned __int16)(v13 + 1))
    {
      int v16 = 1;
      int v13 = (unsigned __int16)v13 + 1;
    }
    else
    {
      int v16 = 0;
      v13 += 2;
      uint64_t v12 = *(unsigned __int8 *)(v11 + v15);
    }
    int v17 = *(unsigned __int8 *)(v11 + v14);
    if ((v17 - 42) >= 0xFFFFFFD7) {
      break;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unknown tag.", v18, v19, v20, v21, v22, v23, v24, v120);
      uint64_t v25 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
      {
        uint64_t v31 = sub_100050714();
        *(_DWORD *)int buf = 136446466;
        v124 = v31;
        __int16 v125 = 1024;
        int v126 = 0xFFFF;
        _os_log_error_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
      }
    }
    if (v9 <= (unsigned __int16)v15)
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/map/map_server.c");
      goto LABEL_116;
    }
    int v26 = v9 - (unsigned __int16)v13;
    BOOL v27 = v26 < (int)v12;
    if (v26 >= (int)v12) {
      int v28 = v12;
    }
    else {
      int v28 = 0;
    }
    v13 += v28;
    if (v27) {
      goto LABEL_116;
    }
  }
  uint64_t v29 = 0;
  uint64_t v30 = &byte_1007B98DA;
  while (2)
  {
    if (*(v30 - 2) == v17)
    {
      uint64_t v121 = *v30;
      if ((0x10000D8uLL >> v29)) {
        goto LABEL_32;
      }
LABEL_29:
      if (v121 == v12)
      {
        char v122 = 0;
        uint64_t v121 = v12;
        goto LABEL_33;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid size %d != %d.", v43, v44, v45, v46, v47, v48, v49, v121);
        uint64_t v50 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR))
        {
          uint64_t v62 = sub_100050714();
          *(_DWORD *)int buf = 136446466;
          v124 = v62;
          __int16 v125 = 1024;
          int v126 = 0xFFFF;
          _os_log_error_impl((void *)&_mh_execute_header, v50, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
        }
      }
      if (v9 <= (unsigned __int16)v15)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/map/map_server.c");
        int v51 = 0;
      }
      else
      {
        int v51 = v9 - (unsigned __int16)v13;
      }
      BOOL v60 = v51 < (int)v12;
      if (v51 >= (int)v12) {
        int v59 = v12;
      }
      else {
        int v59 = 0;
      }
      if (v60) {
        goto LABEL_116;
      }
      char v122 = 0;
LABEL_68:
      v13 += v59;
      if (!v16) {
        goto LABEL_10;
      }
      goto LABEL_116;
    }
    ++v29;
    v30 += 3;
    if (v29 != 27) {
      continue;
    }
    break;
  }
  if ((v122 & 1) == 0) {
    goto LABEL_29;
  }
LABEL_32:
  char v122 = 1;
LABEL_33:
  uint64_t v32 = sub_100022FE8(v12);
  if (!v32)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not allocate buffer of size %d.", v34, v35, v36, v37, v38, v39, v40, v12);
      uint64_t v41 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR))
      {
        uint64_t v61 = sub_100050714();
        *(_DWORD *)int buf = 136446466;
        v124 = v61;
        __int16 v125 = 1024;
        int v126 = 0xFFFF;
        _os_log_error_impl((void *)&_mh_execute_header, v41, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
      }
    }
    if (v9 <= (unsigned __int16)v15)
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/map/map_server.c");
      int v42 = 0;
    }
    else
    {
      int v42 = v9 - (unsigned __int16)v13;
    }
    BOOL v58 = v42 < (int)v12;
    if (v42 >= (int)v12) {
      int v59 = v12;
    }
    else {
      int v59 = 0;
    }
    if (v58) {
      goto LABEL_116;
    }
    goto LABEL_68;
  }
  if (v9 <= (unsigned __int16)v15)
  {
    uint64_t v52 = v32;
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/map/map_server.c");
    uint64_t v32 = v52;
    int v33 = 0;
  }
  else
  {
    int v33 = v9 - (unsigned __int16)v13;
  }
  if (v33 >= (int)v12)
  {
    if (v12)
    {
      uint64_t v53 = (char *)(v11 + (unsigned __int16)v13);
      uint64_t v54 = v32;
      do
      {
        char v55 = *v53++;
        *v54++ = v55;
      }
      while (v54 < &v32[v12]);
    }
    v13 += v12;
  }
  else
  {
    int v16 = 1;
  }
  unsigned __int8 v56 = *(unsigned char *)(a2 + 408);
  uint64_t v57 = a2 + 24 * v56;
  *(unsigned char *)(v57 + 24) = v17;
  *(void *)(v57 + 32) = v32;
  *(unsigned char *)(v57 + 40) = v12;
  *(unsigned char *)(a2 + 408) = v56 + 1;
  if (!v16) {
    goto LABEL_10;
  }
LABEL_116:
  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/map/map_server.c");
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MAP: Application parameters are corrupted", v104, v105, v106, v107, v108, v109, v110, v120);
    v111 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v111, OS_LOG_TYPE_ERROR)) {
      sub_100749428();
    }
  }
  return 1741;
}

void sub_10015ECC0(void *ptr)
{
  int v2 = (void *)ptr[1];
  if (v2) {
    sub_100023010(v2);
  }
  __n128 v3 = (void *)ptr[52];
  if (v3) {
    sub_100023010(v3);
  }
  if (*((unsigned char *)ptr + 408))
  {
    unint64_t v4 = 0;
    uint64_t v5 = (void **)(ptr + 4);
    do
    {
      unsigned int v6 = *v5;
      v5 += 3;
      sub_100023010(v6);
      ++v4;
    }
    while (v4 < *((unsigned __int8 *)ptr + 408));
  }
  *((_OWORD *)ptr + 25) = 0u;
  *((_OWORD *)ptr + 26) = 0u;
  *((_OWORD *)ptr + 23) = 0u;
  *((_OWORD *)ptr + 24) = 0u;
  *((_OWORD *)ptr + 21) = 0u;
  *((_OWORD *)ptr + 22) = 0u;
  *((_OWORD *)ptr + 19) = 0u;
  *((_OWORD *)ptr + 20) = 0u;
  *((_OWORD *)ptr + 17) = 0u;
  *((_OWORD *)ptr + 18) = 0u;
  *((_OWORD *)ptr + 15) = 0u;
  *((_OWORD *)ptr + 16) = 0u;
  *((_OWORD *)ptr + 13) = 0u;
  *((_OWORD *)ptr + 14) = 0u;
  *((_OWORD *)ptr + 11) = 0u;
  *((_OWORD *)ptr + 12) = 0u;
  *((_OWORD *)ptr + 9) = 0u;
  *((_OWORD *)ptr + 10) = 0u;
  *((_OWORD *)ptr + 7) = 0u;
  *((_OWORD *)ptr + 8) = 0u;
  *((_OWORD *)ptr + 5) = 0u;
  *((_OWORD *)ptr + 6) = 0u;
  *((_OWORD *)ptr + 3) = 0u;
  *((_OWORD *)ptr + 4) = 0u;
  *((_OWORD *)ptr + 1) = 0u;
  *((_OWORD *)ptr + 2) = 0u;
  *(_OWORD *)ptr = 0u;

  sub_100023010(ptr);
}

uint64_t sub_10015ED78(unsigned __int8 *a1, uint64_t a2)
{
  unsigned __int8 v46 = 0;
  __int16 v45 = 0;
  int v44 = 0;
  if (*a1 == 1)
  {
    if (a1[408])
    {
      unint64_t v4 = 0;
      uint64_t v5 = a1 + 24;
      do
      {
        if (*v5 == 14)
        {
          __memmove_chk();
        }
        else if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Unknown application parameter %d", v6, v7, v8, v9, v10, v11, v12, *v5);
          int v13 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
          {
            uint64_t v14 = sub_100050714();
            *(_DWORD *)int buf = 136446466;
            uint64_t v48 = v14;
            __int16 v49 = 1024;
            int v50 = 0xFFFF;
            _os_log_error_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
          }
        }
        ++v4;
        v5 += 24;
      }
      while (v4 < a1[408]);
    }
    uint64_t v24 = sub_100113D3C(a2, 0, 0);
    if (v24)
    {
      uint64_t v23 = v24;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Could not send PUT response : %!", v25, v26, v27, v28, v29, v30, v31, v23);
        uint64_t v32 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      uint64_t v33 = sub_1001147F0(a2, (uint64_t)&v44);
      if (v33)
      {
        uint64_t v23 = v33;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Could get address from connection %d : %!", v34, v35, v36, v37, v38, v39, v40, a2);
          uint64_t v41 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
      else
      {
        int v42 = *(void (**)(uint64_t, void))(qword_100A04200 + 320);
        if (v42) {
          v42(a2, v46);
        }
        if (v46)
        {
          return sub_10015B648(&v44);
        }
        else
        {
          sub_10015BB68((uint64_t)&v44);
          return 0;
        }
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Send events should be PUT, not %d", v15, v16, v17, v18, v19, v20, v21, *a1);
      uint64_t v22 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1720;
  }
  return v23;
}

uint64_t sub_10015F040(unsigned __int8 *a1, uint64_t a2)
{
  if (*a1 == 2)
  {
    uint64_t v4 = a1[408];
    if (a1[408])
    {
      LOWORD(v5) = 0;
      LOWORD(v6) = 0;
      uint64_t v7 = a1 + 40;
      do
      {
        int v8 = *(v7 - 16);
        if (v8 == 2)
        {
          if (*v7 == 2) {
            unsigned int v5 = bswap32(**((unsigned __int16 **)v7 - 1)) >> 16;
          }
          else {
            LOWORD(v5) = 0;
          }
        }
        else if (v8 == 1)
        {
          if (*v7 == 2) {
            unsigned int v6 = bswap32(**((unsigned __int16 **)v7 - 1)) >> 16;
          }
          else {
            LOWORD(v6) = 0;
          }
        }
        v7 += 24;
        --v4;
      }
      while (v4);
    }
    else
    {
      LOWORD(v6) = 0;
      LOWORD(v5) = 0;
    }
    uint64_t v18 = *(void (**)(uint64_t, void, void))(qword_100A04200 + 280);
    if (!v18)
    {
      sub_10025B8C0();
      uint64_t v18 = *(void (**)(uint64_t, void, void))(qword_100A04200 + 280);
    }
    v18(a2, (unsigned __int16)v6, (unsigned __int16)v5);
    return 0;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Send events should be GET, not %d", v9, v10, v11, v12, v13, v14, v15, *a1);
      uint64_t v16 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1720;
  }
}

uint64_t sub_10015F18C(unsigned __int8 *a1, uint64_t a2)
{
  memset(v37, 0, 32);
  memset(v36, 0, sizeof(v36));
  memset(v35, 0, 255);
  memset(v34, 0, 255);
  if (*a1 == 2)
  {
    uint64_t v4 = *((void *)a1 + 1);
    if (a1[408])
    {
      unint64_t v5 = 0;
      uint64_t v6 = 0;
      LOWORD(v7) = 0;
      int v8 = a1 + 40;
      LOWORD(v9) = 1024;
      do
      {
        switch(*(v8 - 16))
        {
          case 1:
            if (*v8 == 2) {
              unsigned int v9 = bswap32(**((unsigned __int16 **)v8 - 1)) >> 16;
            }
            else {
              LOWORD(v9) = 0;
            }
            break;
          case 2:
            if (*v8 == 2) {
              unsigned int v7 = bswap32(**((unsigned __int16 **)v8 - 1)) >> 16;
            }
            else {
              LOWORD(v7) = 0;
            }
            break;
          case 3:
          case 4:
          case 5:
          case 6:
          case 7:
          case 8:
          case 9:
          case 0x13:
            __memmove_chk();
            break;
          case 0x10:
            if (*v8 == 4) {
              uint64_t v6 = bswap32(**((_DWORD **)v8 - 1));
            }
            break;
          default:
            if (sub_100058654())
            {
              uint64_t v17 = v4;
              sub_100056E24((uint64_t)"Unknown application parameter %d", v10, v11, v12, v13, v14, v15, v16, *(v8 - 16));
              uint64_t v18 = sub_100050B4C(0x50u);
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                uint64_t v19 = sub_100050714();
                *(_DWORD *)int buf = 136446466;
                uint64_t v31 = v19;
                __int16 v32 = 1024;
                int v33 = 0xFFFF;
                _os_log_error_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
              }
              uint64_t v4 = v17;
            }
            break;
        }
        ++v5;
        v8 += 24;
      }
      while (v5 < a1[408]);
    }
    else
    {
      LOWORD(v7) = 0;
      uint64_t v6 = 0;
      LOWORD(v9) = 1024;
    }
    uint64_t v29 = *(void (**)(uint64_t, uint64_t, void, void, uint64_t, uint64_t, uint64_t, unsigned char *, unsigned char *, _BYTE, unsigned char *, _OWORD *, _BYTE))(qword_100A04200 + 272);
    if (!v29)
    {
      sub_10025B8C0();
      uint64_t v29 = *(void (**)(uint64_t, uint64_t, void, void, uint64_t, uint64_t, uint64_t, unsigned char *, unsigned char *, _BYTE, unsigned char *, _OWORD *, _BYTE))(qword_100A04200 + 272);
    }
    v29(a2, v4, (unsigned __int16)v9, (unsigned __int16)v7, 255, v6, 12, v37, v36, 0, v35, v34, 0);
    return 0;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Send events should be GET, not %d", v20, v21, v22, v23, v24, v25, v26, *a1);
      uint64_t v27 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1720;
  }
}

uint64_t sub_10015F5BC(unsigned __int8 *a1, uint64_t a2)
{
  int v4 = *a1;
  if (v4 == 1)
  {
    if (!a1[408])
    {
LABEL_48:
      int v81 = *(void (**)(uint64_t, void, void))(qword_100A04200 + 264);
      if (!v81)
      {
        sub_10025B8C0();
        int v81 = *(void (**)(uint64_t, void, void))(qword_100A04200 + 264);
      }
      v81(a2, *((void *)a1 + 52), *((unsigned __int16 *)a1 + 212));
      return 0;
    }
    unint64_t v38 = 0;
    uint64_t v39 = a1 + 40;
    while (1)
    {
      int v40 = *(v39 - 16);
      switch(v40)
      {
        case 20:
          __memmove_chk();
          if (!sub_100058654()) {
            goto LABEL_38;
          }
          sub_100056E24((uint64_t)"Charset is set to %s", v49, v50, v51, v52, v53, v54, v55, (uint64_t)"UTF8");
          uint64_t v48 = sub_100050B4C(0x50u);
          if (!os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
            goto LABEL_38;
          }
          break;
        case 12:
          __memmove_chk();
          if (!sub_100058654()) {
            goto LABEL_38;
          }
          sub_100056E24((uint64_t)"Retry is set to %s", v56, v57, v58, v59, v60, v61, v62, (uint64_t)"ON");
          uint64_t v48 = sub_100050B4C(0x50u);
          if (!os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
            goto LABEL_38;
          }
          break;
        case 11:
          __memmove_chk();
          if (!sub_100058654()) {
            goto LABEL_38;
          }
          sub_100056E24((uint64_t)"Transparent is set to %s", v41, v42, v43, v44, v45, v46, v47, (uint64_t)"OFF");
          uint64_t v48 = sub_100050B4C(0x50u);
          if (!os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
            goto LABEL_38;
          }
          break;
        default:
          if (!sub_100058654()) {
            goto LABEL_38;
          }
          sub_100056E24((uint64_t)"Unknown application parameter %d", v63, v64, v65, v66, v67, v68, v69, *(v39 - 16));
          uint64_t v48 = sub_100050B4C(0x50u);
          if (!os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
            goto LABEL_38;
          }
          break;
      }
      uint64_t v70 = sub_100050714();
      *(_DWORD *)int buf = 136446466;
      uint64_t v84 = v70;
      __int16 v85 = 1024;
      int v86 = 0xFFFF;
      _os_log_error_impl((void *)&_mh_execute_header, v48, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
LABEL_38:
      ++v38;
      v39 += 24;
      if (v38 >= a1[408]) {
        goto LABEL_48;
      }
    }
  }
  if (v4 == 2)
  {
    if (a1[408])
    {
      unint64_t v5 = 0;
      uint64_t v6 = a1 + 40;
      do
      {
        int v7 = *(v6 - 16);
        switch(v7)
        {
          case 21:
            __memmove_chk();
            if (!sub_100058654()) {
              goto LABEL_19;
            }
            sub_100056E24((uint64_t)"Fraction set to %s", v16, v17, v18, v19, v20, v21, v22, (uint64_t)"First");
            uint64_t v15 = sub_100050B4C(0x50u);
            if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
              goto LABEL_19;
            }
            break;
          case 20:
            __memmove_chk();
            if (!sub_100058654()) {
              goto LABEL_19;
            }
            sub_100056E24((uint64_t)"Charset is set to %s", v23, v24, v25, v26, v27, v28, v29, (uint64_t)"UTF8");
            uint64_t v15 = sub_100050B4C(0x50u);
            if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
              goto LABEL_19;
            }
            break;
          case 10:
            __memmove_chk();
            if (!sub_100058654()) {
              goto LABEL_19;
            }
            sub_100056E24((uint64_t)"Attachement is set to %s", v8, v9, v10, v11, v12, v13, v14, (uint64_t)"OFF");
            uint64_t v15 = sub_100050B4C(0x50u);
            if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
              goto LABEL_19;
            }
            break;
          default:
            if (!sub_100058654()) {
              goto LABEL_19;
            }
            sub_100056E24((uint64_t)"Unknown application parameter %d", v30, v31, v32, v33, v34, v35, v36, *(v6 - 16));
            uint64_t v15 = sub_100050B4C(0x50u);
            if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
              goto LABEL_19;
            }
            break;
        }
        uint64_t v37 = sub_100050714();
        *(_DWORD *)int buf = 136446466;
        uint64_t v84 = v37;
        __int16 v85 = 1024;
        int v86 = 0xFFFF;
        _os_log_error_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
LABEL_19:
        ++v5;
        v6 += 24;
      }
      while (v5 < a1[408]);
    }
    uint64_t v80 = *(void (**)(uint64_t, void, void, uint64_t, uint64_t))(qword_100A04200 + 256);
    if (!v80)
    {
      sub_10025B8C0();
      uint64_t v80 = *(void (**)(uint64_t, void, void, uint64_t, uint64_t))(qword_100A04200 + 256);
    }
    v80(a2, *((void *)a1 + 1), 0, 1, 1);
    return 0;
  }
  if (!sub_100058654()) {
    return 1720;
  }
  uint64_t v78 = 1720;
  sub_100056E24((uint64_t)"Error in GET or PUT message : %!", v71, v72, v73, v74, v75, v76, v77, 1720);
  uint64_t v79 = sub_100050B4C(0x50u);
  if (os_log_type_enabled(v79, OS_LOG_TYPE_ERROR))
  {
    sub_100744F6C();
    return 1720;
  }
  return v78;
}

uint64_t sub_10015FCBC(unsigned __int8 *a1, uint64_t a2)
{
  if (*a1 != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Send events should be PUT, not %d", v32, v33, v34, v35, v36, v37, v38, *a1);
      uint64_t v39 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1720;
  }
  if (!*((void *)a1 + 1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Message handle is NULL", v42, v43, v44, v45, v46, v47, v48, v50);
      uint64_t v49 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1739;
  }
  if (!a1[408])
  {
    int v5 = 0;
LABEL_35:
    uint64_t v41 = *(void (**)(uint64_t, BOOL, void))(qword_100A04200 + 304);
    if (!v41)
    {
      sub_10025B8C0();
      uint64_t v41 = *(void (**)(uint64_t, BOOL, void))(qword_100A04200 + 304);
    }
    goto LABEL_37;
  }
  unint64_t v4 = 0;
  int v5 = 0;
  int v6 = 0;
  int v7 = a1 + 40;
  do
  {
    int v8 = *(v7 - 16);
    if (v8 == 24)
    {
      if (*v7 == 1)
      {
        int v5 = **((unsigned __int8 **)v7 - 1);
        goto LABEL_19;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid msg of len %d for MapTagStatusValue", v24, v25, v26, v27, v28, v29, v30, *v7);
        uint64_t v16 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
LABEL_21:
          uint64_t v31 = sub_100050714();
          *(_DWORD *)int buf = 136446466;
          uint64_t v52 = v31;
          __int16 v53 = 1024;
          int v54 = 0xFFFF;
          _os_log_error_impl((void *)&_mh_execute_header, v16, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
        }
      }
    }
    else if (v8 == 23)
    {
      if (*v7 == 1)
      {
        int v6 = **((unsigned __int8 **)v7 - 1);
        goto LABEL_19;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid msg of len %d for MapTagStatusIndicator", v17, v18, v19, v20, v21, v22, v23, *v7);
        uint64_t v16 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          goto LABEL_21;
        }
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unknown application parameter %d", v9, v10, v11, v12, v13, v14, v15, *(v7 - 16));
      uint64_t v16 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        goto LABEL_21;
      }
    }
LABEL_19:
    ++v4;
    v7 += 24;
  }
  while (v4 < a1[408]);
  if (!v6) {
    goto LABEL_35;
  }
  if ((v6 & 1) == 0) {
    return 0;
  }
  uint64_t v41 = *(void (**)(uint64_t, BOOL, void))(qword_100A04200 + 312);
  if (!v41)
  {
    sub_10025B8C0();
    (*(void (**)(uint64_t, BOOL, void))(qword_100A04200 + 312))(a2, v5 != 0, *((void *)a1 + 1));
    return 0;
  }
LABEL_37:
  v41(a2, v5 != 0, *((void *)a1 + 1));
  return 0;
}

uint64_t sub_100160048(unsigned char *a1, unsigned int a2)
{
  if (*a1 == 1)
  {
    __n128 v3 = *(void (**)(void))(qword_100A04200 + 296);
    if (v3) {
      v3();
    }
    uint64_t v4 = sub_100113D3C(a2, 0, 0);
    if (v4)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Could not send PUT response : %!", v5, v6, v7, v8, v9, v10, v11, v4);
        uint64_t v12 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Send events should be PUT, not %d", v14, v15, v16, v17, v18, v19, v20, *a1);
      uint64_t v21 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1720;
  }
  return v4;
}

uint64_t sub_100160140(unsigned __int8 *a1, uint64_t a2)
{
  if (*a1 == 1)
  {
    if (a1[408])
    {
      unint64_t v4 = 0;
      uint64_t v5 = a1 + 40;
      do
      {
        if (*(v5 - 16) == 37)
        {
          __memmove_chk();
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"NotificationFilter is set to 0x%x", v6, v7, v8, v9, v10, v11, v12, 0);
            uint64_t v13 = sub_100050B4C(0x50u);
            if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
            {
              uint64_t v14 = sub_100050714();
              *(_DWORD *)int buf = 136446466;
              uint64_t v25 = v14;
              __int16 v26 = 1024;
              int v27 = 0xFFFF;
              _os_log_error_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }
        }
        v5 += 24;
        ++v4;
      }
      while (v4 < a1[408]);
    }
    (*(void (**)(uint64_t, void))(qword_100A04200 + 328))(a2, 0);
    return 0;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Send events should be PUT, not %d", v15, v16, v17, v18, v19, v20, v21, *a1);
      uint64_t v22 = sub_100050B4C(0x50u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1720;
  }
}

uint64_t sub_100160320(uint64_t a1, unsigned int a2)
{
  return 0;
}

void sub_100160344(uint64_t a1, uint64_t a2)
{
  int v30 = a1;
  __int16 v31 = WORD2(a1);
  if (qword_100A04200)
  {
    unsigned int v3 = sub_10015C290((uint64_t)&v30);
    if (v3 == 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid connection ID %:.", v4, v5, v6, v7, v8, v9, v10, (uint64_t)&v30);
        uint64_t v11 = sub_100050B4C(0x50u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      unsigned int v20 = v3;
      if (a2)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"BT Map Send failed with status %!", v21, v22, v23, v24, v25, v26, v27, a2);
          uint64_t v28 = sub_100050B4C(0x50u);
          if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
      sub_1002598B4(*(void *)(qword_100A04200 + 32 * v20 + 32), 1);
      if (sub_100059E10(*(void *)(qword_100A04200 + 32 * v20 + 32))) {
        sub_10015CC7C(*(unsigned __int16 *)(qword_100A04200 + 32 * v20 + 16));
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"MAP is not initialized", v12, v13, v14, v15, v16, v17, v18, v29);
    uint64_t v19 = sub_100050B4C(0x50u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

double sub_1001604C0(uint64_t a1)
{
  unsigned int v1 = *(_OWORD **)(a1 + 64);
  double result = 0.0;
  *(_OWORD *)((char *)v1 + 139) = 0u;
  v1[7] = 0u;
  v1[8] = 0u;
  v1[5] = 0u;
  v1[6] = 0u;
  v1[3] = 0u;
  v1[4] = 0u;
  v1[1] = 0u;
  v1[2] = 0u;
  *unsigned int v1 = 0u;
  return result;
}

uint64_t sub_1001604E4(uint64_t a1, const void *a2, unsigned int a3, char *__s)
{
  unsigned int v8 = strlen(__s);
  if (v8 > 0x10) {
    return 1740;
  }
  memmove(*(void **)(a1 + 64), __s, v8);
  uint64_t v10 = *(unsigned char **)(a1 + 64);
  v10[16] = v8;
  if (a3 > 0x14) {
    return 1757;
  }
  char v11 = 0;
  if (a2)
  {
    if (a3)
    {
      memmove(v10 + 17, a2, a3);
      uint64_t v10 = *(unsigned char **)(a1 + 64);
      char v11 = a3;
    }
  }
  uint64_t result = 0;
  v10[37] = v11;
  return result;
}

uint64_t sub_100160590(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = *(void *)(a1 + 64);
  if (!v4) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)a2 != 77) {
    sub_10025B8C0();
  }
  unsigned int v5 = *(unsigned __int16 *)(a2 + 8);
  if (*(_WORD *)(a2 + 8))
  {
    unsigned int v6 = 0;
    char v7 = 0;
    uint64_t result = 0;
    while (1)
    {
      uint64_t v9 = *(void *)(a2 + 16);
      uint64_t v10 = (unsigned char *)(v9 + v6);
      uint64_t v11 = v6 + 2;
      int v12 = v10[1];
      if (*v10)
      {
        if (*v10 == 1)
        {
          if (v12 != 1) {
            goto LABEL_13;
          }
          char v7 = *(unsigned char *)(v9 + v11);
        }
      }
      else
      {
        if (v12 != 16)
        {
LABEL_13:
          uint64_t result = 1744;
          goto LABEL_14;
        }
        *(_OWORD *)(v4 + 61) = *(_OWORD *)(v9 + v11);
        unsigned int v5 = *(unsigned __int16 *)(a2 + 8);
      }
LABEL_14:
      unsigned int v6 = v11 + v12;
      if (v6 >= v5) {
        goto LABEL_17;
      }
    }
  }
  uint64_t result = 0;
  char v7 = 0;
LABEL_17:
  *(unsigned char *)(v4 + 60) = v7 & 1;
  *(unsigned char *)(a1 + 57) = (v7 & 2) != 0;
  return result;
}

uint64_t sub_100160668(uint64_t a1, uint64_t a2)
{
  uint64_t v3 = *(void *)(a1 + 64);
  if (!v3) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)a2 != 78) {
    sub_10025B8C0();
  }
  *(void *)(v3 + 38) = 0;
  *(void *)(v3 + 46) = 0;
  *(_DWORD *)(v3 + 54) = 0;
  *(unsigned char *)(v3 + 58) = 0;
  if (*(_WORD *)(a2 + 8))
  {
    unsigned int v4 = 0;
    uint64_t v5 = 0;
    while (1)
    {
      uint64_t v6 = *(void *)(a2 + 16);
      char v7 = (unsigned char *)(v6 + v4);
      unsigned int v8 = v4 + 2;
      unsigned int v9 = v7[1];
      if (*v7 == 1)
      {
        if (v7[1])
        {
          if (v9 <= 0x14)
          {
            memmove((void *)(v3 + 38), (const void *)(v6 + v8), v7[1]);
            *(unsigned char *)(v3 + 58) = v9;
            goto LABEL_15;
          }
LABEL_13:
          uint64_t v5 = 1744;
        }
      }
      else if (!*v7)
      {
        if (v9 != 16) {
          goto LABEL_13;
        }
        *(_OWORD *)(v3 + 77) = *(_OWORD *)(v6 + v8);
      }
LABEL_15:
      unsigned int v4 = v8 + v9;
      if (v8 + v9 >= *(unsigned __int16 *)(a2 + 8)) {
        return v5;
      }
    }
  }
  return 0;
}

void sub_10016075C(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = *(void *)(a1 + 64);
  if (!v4) {
    sub_10025B8C0();
  }
  uint64_t v8 = 0;
  memset(v7, 0, sizeof(v7));
  sub_100259BA0((uint64_t)v7);
  sub_100259BB4((uint64_t)v7, (long long *)(*(void *)(a1 + 64) + 61), 0x10uLL);
  sub_100259BB4((uint64_t)v7, (long long *)":", 1uLL);
  sub_100259BB4((uint64_t)v7, *(long long **)(a1 + 64), *(unsigned __int8 *)(*(void *)(a1 + 64) + 16));
  *(_WORD *)(v4 + 93) = 4096;
  sub_10025A6B0((_OWORD *)(v4 + 95), (uint64_t)v7);
  size_t v5 = *(unsigned __int8 *)(v4 + 37);
  if (*(unsigned char *)(v4 + 37))
  {
    *(unsigned char *)(v4 + 111) = 1;
    *(unsigned char *)(v4 + 112) = v5;
    memmove((void *)(v4 + 113), (const void *)(v4 + 17), v5);
    __int16 v6 = *(unsigned __int8 *)(v4 + 37) + 20;
  }
  else
  {
    __int16 v6 = 18;
  }
  *(unsigned char *)a2 = 78;
  *(void *)(a2 + 16) = v4 + 93;
  *(_WORD *)(a2 + 8) = v6;
}

void sub_100160848(char *__s, uint64_t a2, uint64_t a3)
{
  uint64_t v6 = *(void *)(a2 + 64);
  if (v6)
  {
    if (__s) {
      goto LABEL_3;
    }
  }
  else
  {
    sub_10025B8C0();
    if (__s) {
      goto LABEL_3;
    }
  }
  sub_10025B8C0();
LABEL_3:
  uint64_t v11 = 0;
  memset(__src, 0, sizeof(__src));
  unsigned __int16 v7 = strlen(__s);
  sub_100259BA0((uint64_t)&__src[8]);
  sub_100026C30((uint64_t)__src);
  sub_100259BB4((uint64_t)&__src[8], (long long *)__src, 8uLL);
  sub_100259BB4((uint64_t)&__src[8], (long long *)__s, v7);
  *(_WORD *)(v6 + 134) = 4096;
  sub_10025A6B0((_OWORD *)(v6 + 136), (uint64_t)&__src[8]);
  char v8 = *(unsigned char *)(v6 + 59) | (2 * *(unsigned char *)(a2 + 57));
  if (v8)
  {
    *(_WORD *)(v6 + 152) = 257;
    *(unsigned char *)(v6 + 154) = v8;
    __int16 v9 = 21;
  }
  else
  {
    __int16 v9 = 18;
  }
  *(unsigned char *)a3 = 77;
  *(void *)(a3 + 16) = v6 + 134;
  *(_WORD *)(a3 + 8) = v9;
}

uint64_t sub_10016094C(uint64_t a1)
{
  uint64_t v1 = *(void *)(a1 + 64);
  if (!v1) {
    sub_10025B8C0();
  }
  uint64_t v4 = 0;
  memset(v3, 0, sizeof(v3));
  long long v5 = 0uLL;
  sub_100259BA0((uint64_t)v3);
  sub_100259BB4((uint64_t)v3, (long long *)(v1 + 136), 0x10uLL);
  sub_100259BB4((uint64_t)v3, (long long *)":", 1uLL);
  sub_100259BB4((uint64_t)v3, (long long *)v1, *(unsigned __int8 *)(v1 + 16));
  sub_10025A6B0(&v5, (uint64_t)v3);
  if (v5 == *(_OWORD *)(v1 + 77)) {
    return 0;
  }
  else {
    return 1742;
  }
}

uint64_t sub_100160A2C(uint64_t a1)
{
  for (uint64_t i = 0; i != 6; ++i)
  {
    if (!qword_100A04450[i])
    {
      uint64_t result = 0;
      qword_100A04450[i] = a1;
      *(_WORD *)(a1 + 280) = i;
      return result;
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"No more OBEX handles available!", v3, v4, v5, v6, v7, v8, v9, v12);
    uint64_t v10 = sub_100050B4C(0x17u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 104;
}

unsigned __int16 *sub_100160AC0(int a1)
{
  uint64_t v1 = 0;
  while (1)
  {
    int v2 = (unsigned __int16 *)qword_100A04450[v1];
    if (v2)
    {
      if (*v2 == a1) {
        break;
      }
    }
    if (++v1 == 6)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"GetObexCliConnectionByLinkHandle - context not found", v3, v4, v5, v6, v7, v8, v9, v12);
        uint64_t v10 = sub_100050B4C(0x17u);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 0;
    }
  }
  return v2;
}

void sub_100160B50(int a1)
{
  uint64_t v2 = 0;
  while (1)
  {
    uint64_t v3 = qword_100A04450[v2];
    if (v3)
    {
      if (*(unsigned __int16 *)(v3 + 280) == a1) {
        break;
      }
    }
    if (++v2 == 6)
    {
      sub_10025B8C0();
      return;
    }
  }
  if (*(void *)(v3 + 8))
  {
    sub_100023010(*(void **)(v3 + 8));
    uint64_t v3 = qword_100A04450[v2];
    *(void *)(v3 + 8) = 0;
  }
  if (*(void *)(v3 + 64))
  {
    sub_100023010(*(void **)(v3 + 64));
    uint64_t v3 = qword_100A04450[v2];
    *(void *)(v3 + 64) = 0;
  }
  sub_100023010((void *)v3);
  qword_100A04450[v2] = 0;
}

void sub_100160BF0(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = *(unsigned int *)(a1 + 132);
  int v5 = *(_DWORD *)(a1 + 276);
  *(_DWORD *)(a1 + 276) = 0;
  if (v4)
  {
    sub_100026DB4(v4);
    *(_DWORD *)(a1 + 132) = 0;
  }
  uint64_t v6 = *(void **)(a1 + 40);
  if (v6)
  {
    sub_10025C53C(v6);
    *(void *)(a1 + 40) = 0;
  }
  switch(v5)
  {
    case 1:
    case 2:
      (*(void (**)(void, void, uint64_t))(a1 + 152))(*(unsigned __int16 *)(a1 + 280), 0, a2);
      *(void *)(a1 + 136) = 0;
      break;
    case 5:
      int v7 = *(_DWORD *)(a1 + 264);
      if ((v7 - 3) < 2)
      {
        *(_DWORD *)(a1 + 264) = 0;
        uint64_t v8 = *(void (**)(void))(a1 + 152);
        if (v8) {
          v8(*(unsigned __int16 *)(a1 + 280));
        }
      }
      else if (v7 == 2 || v7 == 1)
      {
        *(_DWORD *)(a1 + 264) = 0;
        (*(void (**)(void, void, uint64_t))(a1 + 152))(*(unsigned __int16 *)(a1 + 280), 0, 1719);
      }
      break;
    case 6:
    case 7:
      if (v4) {
        (*(void (**)(void, void, uint64_t))(a1 + 152))(*(unsigned __int16 *)(a1 + 280), 0, a2);
      }
      break;
    case 8:
      (*(void (**)(void, uint64_t))(a1 + 152))(*(unsigned __int16 *)(a1 + 280), a2);
      break;
    default:
      break;
  }
  uint64_t v9 = *(void (**)(void))(a1 + 136);
  if (v9) {
    v9(*(unsigned __int16 *)(a1 + 280));
  }
  sub_100160B50(*(unsigned __int16 *)(a1 + 280));
  --dword_100A1980C;
}

void sub_100160D58(unsigned __int16 *a1, uint64_t a2)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OBEX client error %!", v4, v5, v6, v7, v8, v9, v10, a2);
    uint64_t v11 = sub_100050B4C(0x17u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  *((_DWORD *)a1 + 8) = 0;
  *((_DWORD *)a1 + 66) = 0;
  if (*((_DWORD *)a1 + 69) < 2u) {
    goto LABEL_15;
  }
  *((unsigned char *)a1 + 268) = 1;
  int v12 = *((_DWORD *)a1 + 1);
  if (v12 == 1)
  {
    uint64_t v13 = sub_1001E121C(*a1, 436);
  }
  else
  {
    if (v12)
    {
      uint64_t v14 = 101;
LABEL_12:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Transport disconnect failed %!", v15, v16, v17, v18, v19, v20, v21, v14);
        uint64_t v22 = sub_100050B4C(0x17u);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
LABEL_15:
      sub_100160BF0((uint64_t)a1, a2);
      return;
    }
    uint64_t v13 = sub_100246730(*a1, 926);
  }
  uint64_t v14 = v13;
  if (v13) {
    goto LABEL_12;
  }
}

uint64_t sub_100160E78(unsigned int a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (a4 == 1701) {
    char v4 = 2;
  }
  else {
    char v4 = -126;
  }
  if (!a3)
  {
    sub_10025B8C0();
    return 101;
  }
  if (a1 >= 6) {
    sub_10025B8C0();
  }
  uint64_t v9 = qword_100A04450[a1];
  if (!v9) {
    return 1709;
  }
  unsigned int v10 = *(_DWORD *)(v9 + 276);
  if (v10 < 4) {
    return 1709;
  }
  if (*(_DWORD *)(v9 + 132))
  {
    if (*(_DWORD *)(v9 + 264) == 4) {
      return 1719;
    }
    else {
      return 1711;
    }
  }
  if (v10 != 7 && v10 != 4) {
    return 1711;
  }
  *(void *)(v9 + 152) = a3;
  if (*(_DWORD *)(v9 + 264) == 2)
  {
LABEL_32:
    sub_1001610C4(v9);
    return 0;
  }
  uint64_t v33 = 0;
  uint64_t v34 = 0;
  uint64_t v35 = 0;
  v32[0] = 0;
  v32[1] = 0;
  if (a4 && a4 != 1701)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OBEX client terminating PUT operation with error %!", v15, v16, v17, v18, v19, v20, v21, a4);
      uint64_t v22 = sub_100050B4C(0x17u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    *(_DWORD *)(v9 + 264) = 2;
    goto LABEL_32;
  }
  if (!a2) {
    return 101;
  }
  sub_100162818(v9, v4, (uint64_t)v32);
  if (*(_DWORD *)(v9 + 276) == 4)
  {
    int v13 = *(_DWORD *)(v9 + 260);
    if (v13 == -1)
    {
      unsigned int v14 = 0;
    }
    else
    {
      LOBYTE(v33) = -53;
      LODWORD(v34) = v13;
      unsigned int v14 = 1;
    }
    *(_DWORD *)(v9 + 276) = 7;
  }
  else
  {
    unsigned int v14 = 0;
  }
  uint64_t v11 = sub_100162110(v9, (uint64_t)v32, (unsigned __int8 *)&v33, v14, a2);
  if (v11 || (uint64_t v11 = sub_10016114C((unsigned __int16 *)v9, *(unsigned __int16 *)(v9 + 128)), v11))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OBEXCLI_PutReq %!", v23, v24, v25, v26, v27, v28, v29, v11);
      int v30 = sub_100050B4C(0x17u);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    *(_DWORD *)(v9 + 276) = 4;
  }
  return v11;
}

void sub_1001610C4(uint64_t a1)
{
  if (sub_100161DD0(a1, 255, 50))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not send abort command", v2, v3, v4, v5, v6, v7, v8, v10);
      uint64_t v9 = sub_100050B4C(0x17u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_100160D58((unsigned __int16 *)a1, 1706);
  }
  else
  {
    *(_DWORD *)(a1 + 276) = 5;
  }
}

uint64_t sub_10016114C(unsigned __int16 *a1, int a2)
{
  int v4 = *((_DWORD *)a1 + 1);
  if (v4 == 1)
  {
    uint64_t v5 = ((uint64_t (*)(void (*)(int, void *, uint64_t, uint64_t), void, void, void, void))loc_1001DE1A4)(sub_10010A730, *a1, 0, *((void *)a1 + 5), 0);
  }
  else
  {
    if (v4)
    {
      uint64_t v6 = 101;
      goto LABEL_9;
    }
    uint64_t v5 = sub_100245E68((uint64_t)sub_10018B948, *a1, *((void *)a1 + 5));
  }
  uint64_t v6 = v5;
  if (v5)
  {
LABEL_9:
    sub_10025C53C(*((void **)a1 + 5));
    *((void *)a1 + 5) = 0;
    return v6;
  }
  uint64_t v11 = a1;
  unsigned int v8 = *((_DWORD *)a1 + 33);
  uint64_t v7 = (unsigned int *)(a1 + 66);
  if (sub_100026E24(v8))
  {
    sub_10025BC54(*v7, a2);
  }
  else
  {
    v10[0] = (const void *)8;
    v10[1] = &v11;
    sub_1000268E4((uint64_t)sub_100161E84, v10, a2, (int *)v7);
  }
  return 0;
}

uint64_t sub_100161244(uint64_t a1, int a2)
{
  if (*(_DWORD *)(a1 + 276) != 2) {
    sub_10025B8C0();
  }
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  memset(v17, 0, sizeof(v17));
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  sub_100162818(a1, 128, (uint64_t)&v13);
  if (HIBYTE(v14))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c");
    goto LABEL_21;
  }
  uint64_t v4 = WORD2(v14);
  if (WORD1(v14) <= WORD2(v14))
  {
LABEL_21:
    uint64_t v10 = "ByteStream_NumReadBytesAvail(pkt) >= 1";
    goto LABEL_23;
  }
  if (BYTE6(v14) != 2)
  {
    uint64_t v10 = "(pkt).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 1084, v10);
  }
  ++WORD2(v14);
  *(unsigned char *)(v13 + v4) = 16;
  if (HIBYTE(v14))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c");
    goto LABEL_25;
  }
  uint64_t v5 = WORD2(v14);
  if (WORD1(v14) <= WORD2(v14))
  {
LABEL_25:
    uint64_t v11 = "ByteStream_NumReadBytesAvail(pkt) >= 1";
    goto LABEL_27;
  }
  if (BYTE6(v14) != 2)
  {
    uint64_t v11 = "(pkt).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 1085, v11);
  }
  ++WORD2(v14);
  *(unsigned char *)(v13 + v5) = 0;
  if (HIBYTE(v14))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c");
    goto LABEL_29;
  }
  if (WORD1(v14) - WORD2(v14) <= 1)
  {
LABEL_29:
    int v12 = "ByteStream_NumReadBytesAvail(pkt) >= 2";
    goto LABEL_31;
  }
  if (BYTE6(v14) != 2)
  {
    int v12 = "(pkt).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 1086, v12);
  }
  *(unsigned char *)(v13 + WORD2(v14) + 1) = *(unsigned char *)(a1 + 74);
  *(unsigned char *)(v13 + WORD2(v14)) = *(unsigned char *)(a1 + 75);
  WORD2(v14) += 2;
  if (*(_DWORD *)(a1 + 272))
  {
    uint64_t v6 = sub_10025B218(0x17u);
    sub_100160848(*(char **)(v6 + 16), a1, (uint64_t)v17);
    unsigned int v7 = 1;
  }
  else
  {
    unsigned int v7 = 0;
  }
  if (*(unsigned char *)(a1 + 56))
  {
    unsigned int v8 = v7 + 1;
    sub_10016075C(a1, (uint64_t)v17 + 24 * v7);
    unsigned int v7 = v8;
  }
  uint64_t v15 = a1 + 160;
  LOBYTE(v16) = *(unsigned char *)(a1 + 256);
  uint64_t result = sub_100162110(a1, (uint64_t)&v13, (unsigned __int8 *)v17, v7, (uint64_t)&v15);
  if (!result) {
    return sub_10016114C((unsigned __int16 *)a1, a2);
  }
  return result;
}

void sub_1001614E8(uint64_t a1, void *a2, size_t a3)
{
  if (a1)
  {
    uint64_t v4 = sub_10016284C(a1, a2, a3);
    if (v4)
    {
      sub_100160D58((unsigned __int16 *)a1, v4);
    }
    else if (*(_DWORD *)(a1 + 32) == 2 && !*(void *)(a1 + 40))
    {
      sub_1001615CC((unsigned __int16 *)a1);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OBEX received data for unknown connection [%d]", v5, v6, v7, v8, v9, v10, v11, (uint64_t)&link);
    int v12 = sub_100050B4C(0x17u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_1001615CC(unsigned __int16 *a1)
{
  if (*((_DWORD *)a1 + 8) != 2) {
    sub_10025B8C0();
  }
  if (*((unsigned char *)a1 + 31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c");
    goto LABEL_105;
  }
  uint64_t v2 = a1[13];
  uint64_t v3 = a1[14];
  if (v2 <= v3)
  {
LABEL_105:
    uint64_t v57 = "ByteStream_NumReadBytesAvail(connection->common.rcvPacket) >= 1";
    goto LABEL_107;
  }
  if (*((unsigned char *)a1 + 30) != 1)
  {
    uint64_t v57 = "(connection->common.rcvPacket).__RWFlag == BYTESTREAM_READ";
LABEL_107:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 1268, v57);
  }
  uint64_t v4 = *((void *)a1 + 2);
  a1[14] = v3 + 1;
  if ((unint64_t)(v2 - (v3 + 1)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 1269, "ByteStream_NumReadBytesAvail(connection->common.rcvPacket) >= (sizeof(uint16_t))");
  }
  int v5 = *(unsigned __int8 *)(v4 + v3);
  a1[14] = v3 + 3;
  sub_100026DB4(*((unsigned int *)a1 + 33));
  *((_DWORD *)a1 + 33) = 0;
  if (!*((unsigned char *)a1 + 268))
  {
    switch(*((_DWORD *)a1 + 69))
    {
      case 2:
        ptr = 0;
        uint64_t v60 = 0;
        uint64_t v6 = sub_100161E94(v5, 1704);
        int v7 = v6;
        if (v6 != 1742 && v6 != 0)
        {
          uint64_t v28 = v6;
          goto LABEL_75;
        }
        if (*((unsigned char *)a1 + 30) != 1) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 891, "(connection->common.rcvPacket).__RWFlag == BYTESTREAM_READ");
        }
        if (*((unsigned char *)a1 + 31))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c");
LABEL_68:
          uint64_t v33 = 0;
          *((unsigned char *)a1 + 31) = 1;
LABEL_69:
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OBEX Client connect - version mismatch %d.%d", v35, v36, v37, v38, v39, v40, v41, v33);
            uint64_t v42 = sub_100050B4C(0x17u);
            if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
          uint64_t v28 = 1718;
          goto LABEL_73;
        }
        unsigned int v30 = a1[13];
        uint64_t v31 = a1[14];
        if (v30 <= v31) {
          goto LABEL_68;
        }
        uint64_t v32 = *((void *)a1 + 2);
        a1[14] = v31 + 1;
        uint64_t v33 = *(unsigned __int8 *)(v32 + v31) >> 4;
        if (v33 != 1) {
          goto LABEL_69;
        }
        if (v30 <= (unsigned __int16)(v31 + 1)) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcli_common.c", 907, "ByteStream_NumReadBytesAvail(connection->common.rcvPacket) >= (1)");
        }
        a1[14] = v31 + 2;
        if ((int)(v30 - (v31 + 2)) <= 1)
        {
          *((unsigned char *)a1 + 31) = 1;
          uint64_t v28 = 1707;
          goto LABEL_73;
        }
        unsigned int v34 = __rev16(*(unsigned __int16 *)(v32 + v31 + 2));
        a1[38] = v34;
        a1[14] = v31 + 4;
        if (v34 < 0xC8)
        {
          uint64_t v28 = 1736;
          goto LABEL_73;
        }
        uint64_t v28 = sub_100162BD0((uint64_t *)&ptr, (uint64_t *)a1 + 2);
        if (v28) {
          goto LABEL_73;
        }
        if (v7)
        {
          *((unsigned char *)a1 + 56) = 1;
          uint64_t v51 = sub_100162BA4((unsigned __int8 **)&ptr, 77);
          if (v51)
          {
            if (*((void *)a1 + 8))
            {
              sub_100160590((uint64_t)a1, (uint64_t)v51);
              uint64_t v52 = (void (*)(void, void))*((void *)a1 + 18);
              if (v52) {
                v52(a1[140], *(unsigned __int8 *)(*((void *)a1 + 8) + 60));
              }
              uint64_t v29 = ptr;
LABEL_61:
              sub_100023010(v29);
              break;
            }
            uint64_t v28 = 1743;
            goto LABEL_73;
          }
          goto LABEL_101;
        }
        __int16 v53 = sub_100162BA4((unsigned __int8 **)&ptr, 203);
        if (v53) {
          *((_DWORD *)a1 + 65) = *((_DWORD *)v53 + 2);
        }
        if (*((_DWORD *)a1 + 68))
        {
          int v54 = sub_100162BA4((unsigned __int8 **)&ptr, 78);
          if (!v54)
          {
LABEL_101:
            uint64_t v28 = 1714;
LABEL_73:
            if (ptr)
            {
              sub_100023010(ptr);
              ptr = 0;
            }
LABEL_75:
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"OBEX Client connection failed %!", v43, v44, v45, v46, v47, v48, v49, v28);
              uint64_t v50 = sub_100050B4C(0x17u);
              if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
                sub_100744F6C();
              }
            }
            uint64_t v15 = a1;
            uint64_t v14 = v28;
LABEL_79:
            sub_100160D58(v15, v14);
            break;
          }
          sub_100160668((uint64_t)a1, (uint64_t)v54);
          uint64_t v55 = *((void *)a1 + 8);
          if (*(unsigned char *)(v55 + 59)
            && ((size_t v56 = *(unsigned __int8 *)(v55 + 58), !*(unsigned char *)(v55 + 58))
             || *(unsigned __int8 *)(v55 + 37) != v56
             || strncmp((const char *)(v55 + 17), (const char *)(v55 + 38), v56))
            || sub_10016094C((uint64_t)a1))
          {
            sub_1001604C0((uint64_t)a1);
            uint64_t v28 = 1735;
            goto LABEL_73;
          }
        }
        *((_DWORD *)a1 + 69) = 4;
        (*((void (**)(void, void, void))a1 + 19))(a1[140], *((unsigned __int8 *)a1 + 57), 0);
        goto LABEL_60;
      case 3:
        uint64_t v13 = sub_100161E94(v5, 1705);
        if (v13)
        {
          uint64_t v14 = v13;
          uint64_t v15 = a1;
          goto LABEL_79;
        }
        *((unsigned char *)a1 + 268) = 1;
        int v26 = *((_DWORD *)a1 + 1);
        if (v26 == 1)
        {
          int v27 = sub_1001E121C(*a1, 436);
        }
        else
        {
          if (v26) {
            break;
          }
          int v27 = sub_100246730(*a1, 926);
        }
        if (!v27) {
          break;
        }
        uint64_t v15 = a1;
        uint64_t v14 = 1705;
        goto LABEL_79;
      case 5:
        *((_DWORD *)a1 + 69) = 4;
        int v9 = *((_DWORD *)a1 + 66);
        if ((v9 - 3) < 2)
        {
          *((_DWORD *)a1 + 66) = 0;
          uint64_t v25 = (void (*)(void))*((void *)a1 + 19);
          if (v25) {
            v25(a1[140]);
          }
        }
        else if (v9 == 2 || v9 == 1)
        {
          *((_DWORD *)a1 + 66) = 0;
          (*((void (**)(void, void, uint64_t))a1 + 19))(a1[140], 0, 1719);
        }
        break;
      case 6:
        ptr = 0;
        uint64_t v60 = 0;
        uint64_t v24 = sub_100162BD0((uint64_t *)&ptr, (uint64_t *)a1 + 2);
        if (!v24) {
          uint64_t v24 = sub_100161E94(v5, 1713);
        }
        if (v24 != 1701) {
          goto LABEL_46;
        }
        if (*((_DWORD *)a1 + 66) == 1)
        {
          if (ptr)
          {
            sub_100023010(ptr);
            ptr = 0;
          }
          goto LABEL_45;
        }
        if (*((_DWORD *)a1 + 69) == 6) {
          goto LABEL_55;
        }
        goto LABEL_58;
      case 7:
        ptr = 0;
        uint64_t v60 = 0;
        uint64_t v24 = sub_100162BD0((uint64_t *)&ptr, (uint64_t *)a1 + 2);
        if (!v24) {
          uint64_t v24 = sub_100161E94(v5, 1712);
        }
        if (v24 != 1701)
        {
LABEL_46:
          *((_DWORD *)a1 + 69) = 4;
          *((_DWORD *)a1 + 66) = 0;
          goto LABEL_59;
        }
        if (*((_DWORD *)a1 + 66) == 2)
        {
LABEL_45:
          sub_1001610C4((uint64_t)a1);
          break;
        }
        if (*((_DWORD *)a1 + 69) != 7) {
          goto LABEL_58;
        }
LABEL_55:
        if ((a1[40] & 0xFE) == 0x48)
        {
          uint64_t v24 = sub_100161FE8((uint64_t)a1);
          if (!v24) {
            goto LABEL_60;
          }
        }
        else
        {
LABEL_58:
          uint64_t v24 = 1701;
        }
LABEL_59:
        (*((void (**)(void, void **, uint64_t))a1 + 19))(a1[140], &ptr, v24);
LABEL_60:
        uint64_t v29 = ptr;
        if (ptr) {
          goto LABEL_61;
        }
        break;
      case 8:
        if (v5 == 161) {
          unsigned __int8 v10 = -96;
        }
        else {
          unsigned __int8 v10 = v5;
        }
        unsigned int v11 = sub_100161E94(v10, 1706);
        if (v11 == 1724) {
          uint64_t v12 = 1738;
        }
        else {
          uint64_t v12 = v11;
        }
        *((_DWORD *)a1 + 69) = 4;
        (*((void (**)(void, uint64_t))a1 + 19))(a1[140], v12);
        break;
      default:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Unexpected response packet", v16, v17, v18, v19, v20, v21, v22, v58);
          uint64_t v23 = sub_100050B4C(0x17u);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        uint64_t v15 = a1;
        uint64_t v14 = 1706;
        goto LABEL_79;
    }
  }
  *((_DWORD *)a1 + 8) = 0;
}

void sub_100161C50(uint64_t a1, void *a2, uint64_t a3)
{
  if (a1)
  {
    *(void *)(a1 + 40) = 0;
    sub_10025C53C(a2);
    if (a3)
    {
      sub_100160D58((unsigned __int16 *)a1, a3);
    }
    else if (*(_DWORD *)(a1 + 32) == 2)
    {
      sub_1001615CC((unsigned __int16 *)a1);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Write confirmation for unknown link [%d]", v5, v6, v7, v8, v9, v10, v11, (uint64_t)&link);
    uint64_t v12 = sub_100050B4C(0x17u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100161D38(unsigned int a1)
{
  if (a1 >= 6) {
    sub_10025B8C0();
  }
  uint64_t v2 = qword_100A04450[a1];
  if (!v2) {
    return 0;
  }
  unsigned int v3 = *(_DWORD *)(v2 + 276);
  if (v3 <= 3)
  {
    if (!v3) {
      return 0;
    }
    uint64_t v4 = (unsigned __int16 *)v2;
    uint64_t v5 = 1719;
LABEL_10:
    sub_100160D58(v4, v5);
    return 0;
  }
  if (v3 != 4) {
    return 1711;
  }
  uint64_t result = sub_100161DD0(v2, 129, 30);
  if (result)
  {
    uint64_t v5 = result;
    uint64_t v4 = (unsigned __int16 *)v2;
    goto LABEL_10;
  }
  *(_DWORD *)(v2 + 276) = 3;
  return result;
}

uint64_t sub_100161DD0(uint64_t a1, char a2, uint64_t a3)
{
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  v8[0] = 0;
  v8[1] = 0;
  sub_100162818(a1, a2, (uint64_t)v8);
  int v5 = *(_DWORD *)(a1 + 260);
  if (v5 == -1)
  {
    unsigned int v6 = 0;
  }
  else
  {
    LOBYTE(v9) = -53;
    LODWORD(v10) = v5;
    unsigned int v6 = 1;
  }
  uint64_t result = sub_100162110(a1, (uint64_t)v8, (unsigned __int8 *)&v9, v6, 0);
  if (!result) {
    return sub_10016114C(a1, a3);
  }
  return result;
}

void sub_100161E84(uint64_t a1)
{
}

uint64_t sub_100161E94(int a1, uint64_t a2)
{
  if (a1 <= 191)
  {
    if (a1 == 166) {
      unsigned int v2 = 1750;
    }
    else {
      unsigned int v2 = a2;
    }
    if (a1 == 160) {
      unsigned int v2 = 0;
    }
    if (a1 == 144) {
      return 1701;
    }
    else {
      return v2;
    }
  }
  else
  {
    switch(a1)
    {
      case 192:
        a2 = 1721;
        break;
      case 193:
        a2 = 1742;
        break;
      case 195:
        a2 = 1735;
        break;
      case 196:
        a2 = 1724;
        break;
      case 197:
        a2 = 1751;
        break;
      case 198:
        a2 = 1736;
        break;
      case 203:
        a2 = 1708;
        break;
      case 204:
        a2 = 1741;
        break;
      case 207:
        a2 = 1749;
        break;
      case 208:
        a2 = 1748;
        break;
      case 209:
        a2 = 1717;
        break;
      case 211:
        a2 = 1715;
        break;
      case 224:
        a2 = 1746;
        break;
      case 225:
        a2 = 1747;
        break;
      default:
        return a2;
    }
  }
  return a2;
}

uint64_t sub_100161FE8(uint64_t a1)
{
  uint64_t result = sub_100162784(a1);
  if (!result)
  {
    uint64_t v3 = *(unsigned __int16 *)(a1 + 128);
    return sub_10016114C(a1, v3);
  }
  return result;
}

uint64_t sub_100162034(unsigned __int8 *a1)
{
  unsigned __int16 v1 = 2;
  switch(*a1 >> 6)
  {
    case 1:
      __int16 v11 = *((_WORD *)a1 + 4);
      goto LABEL_9;
    case 2:
      return v1;
    case 3:
      unsigned __int16 v1 = 5;
      break;
    default:
      if (*((_WORD *)a1 + 4))
      {
        if (*(_WORD *)(*((void *)a1 + 2) + 2 * (*((unsigned __int16 *)a1 + 4) - 1)))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OBEX unicode must be NUL terminated", v3, v4, v5, v6, v7, v8, v9, v13);
            uint64_t v10 = sub_100050B4C(0x18u);
            if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
        __int16 v11 = 2 * *((_WORD *)a1 + 4);
LABEL_9:
        unsigned __int16 v1 = v11 + 3;
      }
      else
      {
        unsigned __int16 v1 = 3;
      }
      break;
  }
  return v1;
}

uint64_t sub_100162110(uint64_t a1, uint64_t a2, unsigned __int8 *a3, unsigned int a4, uint64_t a5)
{
  if (a5) {
    unsigned int v10 = *(unsigned __int8 *)(a5 + 8);
  }
  else {
    unsigned int v10 = 0;
  }
  if (*(void *)(a1 + 40)) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)(a1 + 80)) {
    sub_10025B8C0();
  }
  unsigned __int8 v11 = v10 + a4 + 1;
  if (a4)
  {
    uint64_t v12 = a4;
    uint64_t v13 = a3;
    do
    {
      unsigned __int8 v14 = *v13;
      v13 += 24;
      if ((v14 & 0xC0) == 0x40) {
        ++v11;
      }
      --v12;
    }
    while (v12);
  }
  if (v10)
  {
    uint64_t v15 = *(char **)a5;
    uint64_t v16 = v10;
    do
    {
      char v17 = *v15;
      v15 += 24;
      if ((v17 & 0xC0) == 0x40) {
        ++v11;
      }
      --v16;
    }
    while (v16);
  }
  __int16 v37 = *(_WORD *)(a2 + 12);
  uint64_t v18 = sub_10025C1E0(v11);
  if (v18)
  {
    uint64_t v19 = (unsigned __int8 *)v18;
    if (a4)
    {
      uint64_t v20 = a4;
      do
      {
        uint64_t v21 = sub_100162480(a1, v19, a3, &v37);
        if (v21) {
          goto LABEL_38;
        }
        a3 += 24;
      }
      while (--v20);
    }
    if (v10)
    {
      uint64_t v22 = 0;
      uint64_t v23 = 24 * v10;
      while (1)
      {
        uint64_t v21 = sub_100162480(a1, v19, (unsigned __int8 *)(*(void *)a5 + v22), &v37);
        if (v21) {
          break;
        }
        v22 += 24;
        if (v23 == v22) {
          goto LABEL_27;
        }
      }
LABEL_38:
      uint64_t v29 = v21;
LABEL_50:
      sub_10025C53C(v19);
      return v29;
    }
LABEL_27:
    size_t v24 = *(unsigned __int16 *)(a2 + 12);
    *(_WORD *)(a2 + 12) = 0;
    if ((*(unsigned char *)(a1 + 80) & 0xFE) == 0x48)
    {
      int v25 = *(unsigned __int8 *)(a1 + 78);
      char v26 = v25 & 0x7F;
      if (v25 == 160) {
        char v26 = -112;
      }
      if (v25 == 144) {
        char v27 = -112;
      }
      else {
        char v27 = v26;
      }
      if (*(unsigned char *)(a2 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
      }
      else if (*(_WORD *)(a2 + 10))
      {
        if (*(unsigned char *)(a2 + 14) != 2)
        {
          uint64_t v28 = "(*pktHdr).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_60;
        }
LABEL_43:
        unsigned int v30 = *(char **)a2;
        *(_WORD *)(a2 + 12) = 1;
        *unsigned int v30 = v27;
        if (*(unsigned char *)(a2 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
        }
        else
        {
          uint64_t v31 = *(unsigned __int16 *)(a2 + 12);
          if (*(unsigned __int16 *)(a2 + 10) - (int)v31 > 1)
          {
            if (*(unsigned char *)(a2 + 14) == 2)
            {
              char v32 = HIBYTE(v37);
              *(unsigned char *)(*(void *)a2 + v31 + 1) = v37;
              *(unsigned char *)(*(void *)a2 + *(unsigned __int16 *)(a2 + 12)) = v32;
              *(_WORD *)(a2 + 12) += 2;
              size_t v33 = *(unsigned __int16 *)(a2 + 10);
              if (v24 > v33) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 408, "(size_t)(pos) <= (size_t)((*pktHdr).__size)");
              }
              *(_WORD *)(a2 + 12) = v24;
              if (*(unsigned char *)(a2 + 14) == 2)
              {
                *(_WORD *)(a2 + 10) = v24;
                size_t v33 = v24;
              }
              *(unsigned char *)(a2 + 14) = 15;
              uint64_t v29 = sub_10025C7D4(v19, *(char **)a2, v33, 0);
              if (!v29)
              {
                sub_10025C9FC((uint64_t)v19, *(unsigned __int16 *)(a1 + 72));
                *(void *)(a1 + 40) = v19;
                return v29;
              }
              goto LABEL_50;
            }
            uint64_t v35 = "(*pktHdr).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 407, v35);
          }
        }
        uint64_t v35 = "ByteStream_NumReadBytesAvail(*pktHdr) >= 2";
        goto LABEL_56;
      }
      uint64_t v28 = "ByteStream_NumReadBytesAvail(*pktHdr) >= 1";
LABEL_60:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 403, v28);
    }
    if (*(unsigned char *)(a2 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
    }
    else if (*(_WORD *)(a2 + 10))
    {
      if (*(unsigned char *)(a2 + 14) == 2)
      {
        char v27 = *(unsigned char *)(a1 + 78);
        goto LABEL_43;
      }
      uint64_t v36 = "(*pktHdr).__RWFlag == BYTESTREAM_WRITE";
LABEL_64:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 405, v36);
    }
    uint64_t v36 = "ByteStream_NumReadBytesAvail(*pktHdr) >= 1";
    goto LABEL_64;
  }
  return 106;
}

uint64_t sub_100162480(uint64_t a1, unsigned __int8 *a2, unsigned __int8 *a3, _WORD *a4)
{
  unsigned int v8 = *a3;
  unsigned int v9 = sub_100162034(a3);
  if (!v9) {
    return 101;
  }
  unsigned int v10 = v9;
  uint64_t v24 = 0;
  int v11 = (unsigned __int16)*a4;
  unsigned int v12 = *(unsigned __int16 *)(a1 + 76);
  if (v11 + v9 <= v12)
  {
    *a4 = v11 + v9;
    switch(v8 >> 6)
    {
      case 1u:
        goto LABEL_17;
      case 2u:
        LOBYTE(v24) = v8;
        BYTE1(v24) = a3[8];
        uint64_t v19 = (char *)&v24;
        uint64_t v21 = a2;
        size_t v20 = 2;
        goto LABEL_21;
      case 3u:
        LOBYTE(v24) = v8;
        *(_DWORD *)((char *)&v24 + 1) = bswap32(*((_DWORD *)a3 + 2));
        uint64_t v19 = (char *)&v24;
        uint64_t v21 = a2;
        size_t v20 = 5;
LABEL_21:
        unsigned int v22 = 0;
        return sub_100022798(v21, v19, v20, v22);
      default:
        unsigned __int8 v14 = (char *)sub_100022FE8(v9);
        if (!v14) {
          return 106;
        }
        char *v14 = v8;
        if (v10 <= 2) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 269, "ByteStream_NumReadBytesAvail(bs) >= 2");
        }
        *(_WORD *)(v14 + 1) = __rev16(v10);
        if (*((_WORD *)a3 + 4))
        {
          unint64_t v15 = 0;
          unsigned __int16 v16 = 3;
          do
          {
            if ((unsigned __int16)(v10 - 1) <= v16) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 271, "ByteStream_NumReadBytesAvail(bs) >= 2");
            }
            char v17 = &v14[v16];
            v17[1] = *(unsigned char *)(*((void *)a3 + 2) + 2 * v15);
            *char v17 = *(unsigned char *)(*((void *)a3 + 2) + 2 * v15 + 1);
            v16 += 2;
            ++v15;
          }
          while (v15 < *((unsigned __int16 *)a3 + 4));
        }
        else
        {
          unsigned __int16 v16 = 3;
        }
        if (v10 > v16)
        {
          if ((int)(v10 - v16) <= 1) {
            uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          }
          else {
            uint64_t v23 = "sizeof(0) == 2";
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 279, v23);
        }
        return sub_100022798(a2, v14, v16, 1u);
    }
  }
  if ((*a3 & 0xFE) != 0x48) {
    return 1737;
  }
  LOWORD(v10) = v12 - v11;
  if ((unsigned __int16)(v12 - v11) < 4u) {
    return 0;
  }
  uint64_t v18 = *((void *)a3 + 2);
  *(_OWORD *)(a1 + 80) = *(_OWORD *)a3;
  *(void *)(a1 + 96) = v18 + (unsigned __int16)v10 - 3;
  *(_WORD *)(a1 + 88) -= v10 - 3;
  *a4 += v10;
  LOBYTE(v8) = 72;
LABEL_17:
  LOBYTE(v24) = v8;
  BYTE1(v24) = BYTE1(v10);
  BYTE2(v24) = v10;
  uint64_t result = sub_100022798(a2, (char *)&v24, 3uLL, 0);
  if (!result)
  {
    uint64_t v19 = (char *)*((void *)a3 + 2);
    size_t v20 = (unsigned __int16)(v10 - 3);
    uint64_t v21 = a2;
    unsigned int v22 = 2;
    return sub_100022798(v21, v19, v20, v22);
  }
  return result;
}

uint64_t sub_100162784(uint64_t a1)
{
  uint64_t v2 = a1 + 80;
  if ((*(unsigned char *)(a1 + 80) & 0xFE) != 0x48) {
    sub_10025B8C0();
  }
  long long v4 = *(_OWORD *)v2;
  uint64_t v5 = *(void *)(v2 + 16);
  *(void *)(a1 + 40) = 0;
  *(unsigned char *)(a1 + 80) = 0;
  uint64_t v6 = a1 + 48;
  __int16 v7 = 8;
  __int16 v9 = 2;
  int v8 = 196616;
  return sub_100162110(a1, (uint64_t)&v6, (unsigned __int8 *)&v4, 1u, 0);
}

uint64_t sub_100162818(uint64_t result, char a2, uint64_t a3)
{
  *(unsigned char *)(result + 78) = a2;
  *(void *)(result + 40) = 0;
  *(unsigned char *)(result + 80) = 0;
  *(void *)a3 = result + 48;
  *(_WORD *)(a3 + 8) = 8;
  *(_WORD *)(a3 + 14) = 2;
  *(_DWORD *)(a3 + 10) = 196616;
  return result;
}

uint64_t sub_10016284C(uint64_t a1, void *__src, size_t __len)
{
  unsigned int v3 = __len;
  int v6 = *(_DWORD *)(a1 + 32);
  if (v6)
  {
    if (v6 == 2)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OBEXCOMMON ReassemblePacket discarding data", v7, v8, v9, v10, v11, v12, v13, v54);
        unsigned __int8 v14 = sub_100050B4C(0x18u);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      goto LABEL_17;
    }
    unsigned int v17 = *(unsigned __int16 *)(a1 + 28);
    int v16 = *(unsigned __int16 *)(a1 + 26);
  }
  else
  {
    uint64_t v15 = *(void *)(a1 + 8);
    if (!v15)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OBEXCOMMON ReassemblePacket received dual DISCONNECT messages!", v44, v45, v46, v47, v48, v49, v50, v54);
        uint64_t v51 = sub_100050B4C(0x18u);
        if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      uint64_t v22 = 1709;
      goto LABEL_18;
    }
    int v16 = *(unsigned __int16 *)(a1 + 74);
    if (!*(_WORD *)(a1 + 74)) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 518, "(common->maxRecvPktLen) > 0");
    }
    unsigned int v17 = 0;
    *(void *)(a1 + 16) = v15;
    *(_WORD *)(a1 + 24) = v16;
    *(void *)(a1 + 28) = 0x100020000;
    *(_WORD *)(a1 + 26) = v16;
  }
  uint64_t v18 = v17;
  BOOL v20 = v17 < 3 && v17 + (unint64_t)__len > 2;
  int v21 = v16 - v17;
  if (v21 >= (int)__len)
  {
    uint64_t v32 = *(void *)(a1 + 16);
    if (*(unsigned char *)(a1 + 31))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
      int v21 = 0;
    }
    if (v21 < (int)v3)
    {
      uint64_t v52 = "ByteStream_NumReadBytesAvail(common->rcvPacket) >= (dataLen)";
    }
    else
    {
      if (*(unsigned char *)(a1 + 30) == 2)
      {
        memmove((void *)(v32 + v18), __src, v3);
        unsigned __int16 v33 = *(_WORD *)(a1 + 28) + v3;
        *(_WORD *)(a1 + 28) = v33;
        if (v20)
        {
          uint64_t v34 = __rev16(*(unsigned __int16 *)(*(void *)(a1 + 16) + 1));
          if (v34 > *(unsigned __int16 *)(a1 + 74))
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"OI_OBEXCOMMON_ReassemblePacket packet len %d exceeds buffer len %d\n", v35, v36, v37, v38, v39, v40, v41, v34);
              uint64_t v42 = sub_100050B4C(0x18u);
              if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
                sub_100744F6C();
              }
            }
            goto LABEL_46;
          }
          if (v34 < v3)
          {
LABEL_46:
            uint64_t v22 = 1720;
            goto LABEL_18;
          }
          if (v34 > *(unsigned __int16 *)(a1 + 24) || v34 < v33) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 555, "((pktLen) <= (common->rcvPacket).__trueSize) && ((pktLen) >= (common->rcvPacket).__pos)");
          }
          *(_WORD *)(a1 + 26) = v34;
        }
        else
        {
          LODWORD(v34) = *(unsigned __int16 *)(a1 + 26);
        }
        if (v34 != v33) {
          return 0;
        }
        if (*(unsigned char *)(a1 + 30) == 2) {
          *(_WORD *)(a1 + 26) = v33;
        }
        *(unsigned char *)(a1 + 30) = 15;
        uint64_t v43 = *(void *)(a1 + 8);
        if (v43)
        {
          if (v33)
          {
            uint64_t v22 = 0;
            *(void *)(a1 + 16) = v43;
            *(_WORD *)(a1 + 24) = v33;
            *(void *)(a1 + 28) = 0x200010000;
            *(_WORD *)(a1 + 26) = v33;
            return v22;
          }
          __int16 v53 = "(pktLen) > 0";
        }
        else
        {
          __int16 v53 = "common->rcvBuffer";
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 567, v53);
      }
      uint64_t v52 = "(common->rcvPacket).__RWFlag == BYTESTREAM_WRITE";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 536, v52);
  }
LABEL_17:
  uint64_t v22 = 1737;
LABEL_18:
  if (*(_DWORD *)(a1 + 32) == 1) {
    *(_DWORD *)(a1 + 32) = 0;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OBEXCOMMON Received Packet error %!", v23, v24, v25, v26, v27, v28, v29, v22);
    unsigned int v30 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return v22;
}

unsigned __int8 *sub_100162BA4(unsigned __int8 **a1, int a2)
{
  uint64_t v2 = *((unsigned __int8 *)a1 + 8);
  if (!*((unsigned char *)a1 + 8)) {
    return 0;
  }
  for (uint64_t result = *a1; *result != a2; result += 24)
  {
    if (!--v2) {
      return 0;
    }
  }
  return result;
}

uint64_t sub_100162BD0(uint64_t *a1, uint64_t *a2)
{
  *((unsigned char *)a1 + 8) = 0;
  *a1 = 0;
  unsigned int v4 = *((unsigned __int16 *)a2 + 6);
  if (*((unsigned char *)a2 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
    unsigned int v5 = *((unsigned __int16 *)a2 + 5);
LABEL_19:
    if (v4 > v5) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 748, "(size_t)(pos) <= (size_t)((*bs).__size)");
    }
    *((_WORD *)a2 + 6) = v4;
    if (!*((unsigned char *)a1 + 8)) {
      goto LABEL_58;
    }
    uint64_t v15 = sub_100022FE8(24 * *((unsigned __int8 *)a1 + 8));
    *a1 = (uint64_t)v15;
    if (!v15) {
      return 106;
    }
    if (!*((unsigned char *)a1 + 8))
    {
LABEL_58:
      if (*((unsigned char *)a2 + 14) == 2) {
        *((_WORD *)a2 + 5) = *((_WORD *)a2 + 6);
      }
      uint64_t result = 0;
      *((unsigned char *)a2 + 14) = 15;
      return result;
    }
    uint64_t v16 = 0;
    while (2)
    {
      if (*((unsigned char *)a2 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
      }
      else
      {
        unsigned int v17 = *((unsigned __int16 *)a2 + 5);
        uint64_t v18 = *((unsigned __int16 *)a2 + 6);
        if (v17 > v18)
        {
          if (*((unsigned char *)a2 + 14) == 1)
          {
            uint64_t v19 = *a1;
            BOOL v20 = (unsigned char *)(*a1 + 24 * v16);
            uint64_t v21 = *a2;
            *((_WORD *)a2 + 6) = v18 + 1;
            unsigned int v22 = *(unsigned __int8 *)(v21 + v18);
            *BOOL v20 = v22;
            int v23 = v18 + 1;
            switch(v22 >> 6)
            {
              case 1u:
                if ((int)(v17 - (unsigned __int16)v23) <= 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 678, "ByteStream_NumReadBytesAvail(*bs) >= 2");
                }
                uint64_t v32 = __rev16(*(unsigned __int16 *)(v21 + (unsigned __int16)(v18 + 1)));
                *((_WORD *)a2 + 6) = v18 + 3;
                if (v32 >= 4)
                {
                  unsigned __int16 v33 = v32 - 3;
                  uint64_t v34 = v19 + 24 * v16;
                  *(_WORD *)(v34 + 8) = v32 - 3;
                  *(void *)(v34 + 16) = *a2 + *((unsigned __int16 *)a2 + 6);
                  if (*((unsigned char *)a2 + 15))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c");
                    int v35 = 0;
                  }
                  else
                  {
                    int v35 = *((unsigned __int16 *)a2 + 5) - *((unsigned __int16 *)a2 + 6);
                  }
                  if (v35 < v33) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 683, "ByteStream_NumReadBytesAvail(*bs) >= (len)");
                  }
                  __int16 v36 = *((_WORD *)a2 + 6) + v33;
LABEL_56:
                  *((_WORD *)a2 + 6) = v36;
                  goto LABEL_57;
                }
                uint64_t v46 = v19 + 24 * v16;
                *(_WORD *)(v46 + 8) = 0;
                *(void *)(v46 + 16) = 0;
                if (!sub_100058654()) {
                  goto LABEL_57;
                }
                sub_100056E24((uint64_t)"Bad OBEX len: %d for header ID: %d", v47, v48, v49, v50, v51, v52, v53, v32);
                uint64_t v45 = sub_100050B4C(0x18u);
                if (!os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_57;
                }
                goto LABEL_52;
              case 2u:
                if (v17 <= (unsigned __int16)v23) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 691, "ByteStream_NumReadBytesAvail(*bs) >= 1");
                }
                *((_WORD *)a2 + 6) = v18 + 2;
                *(unsigned char *)(v19 + 24 * v16 + 8) = *(unsigned char *)(v21 + (unsigned __int16)(v18 + 1));
                goto LABEL_57;
              case 3u:
                if ((int)(v17 - (unsigned __int16)v23) <= 3) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 694, "ByteStream_NumReadBytesAvail(*bs) >= 4");
                }
                *(_DWORD *)(v19 + 24 * v16 + 8) = bswap32(*(_DWORD *)(v21 + (unsigned __int16)(v18 + 1)));
                __int16 v36 = *((_WORD *)a2 + 6) + 4;
                goto LABEL_56;
              default:
                if ((int)(v17 - v23) <= 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 648, "ByteStream_NumReadBytesAvail(*bs) >= 2");
                }
                uint64_t v24 = __rev16(*(unsigned __int16 *)(v21 + v18 + 1));
                *((_WORD *)a2 + 6) = v18 + 3;
                if (v24 < 4)
                {
                  uint64_t v37 = v19 + 24 * v16;
                  *(_WORD *)(v37 + 8) = 0;
                  *(void *)(v37 + 16) = 0;
                  if (sub_100058654())
                  {
                    sub_100056E24((uint64_t)"Bad OBEX len: %d for header ID: %d", v38, v39, v40, v41, v42, v43, v44, v24);
                    uint64_t v45 = sub_100050B4C(0x18u);
                    if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR))
                    {
LABEL_52:
                      uint64_t v54 = sub_100050714();
                      *(_DWORD *)int buf = 136446466;
                      uint64_t v84 = v54;
                      __int16 v85 = 1024;
                      int v86 = 0xFFFF;
                      _os_log_error_impl((void *)&_mh_execute_header, v45, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
                    }
                  }
                }
                else
                {
                  unsigned __int16 v25 = v24 - 3;
                  if (v25) {
                    sub_10025B8C0();
                  }
                  uint64_t v26 = v19 + 24 * v16;
                  *(_WORD *)(v26 + 8) = v25 >> 1;
                  uint64_t v27 = (unsigned __int16 *)(v26 + 8);
                  *(void *)(v26 + 16) = (*a2 + *((unsigned __int16 *)a2 + 6)) & 0xFFFFFFFFFFFFFFFELL;
                  uint64_t v28 = (void *)(v26 + 16);
                  if (v25 >= 2u)
                  {
                    if (*((unsigned char *)a2 + 14) == 1)
                    {
                      if (*((unsigned char *)a2 + 15))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles"
                                               "/obex/obexcommon.c");
                      }
                      else
                      {
                        unint64_t v29 = 0;
                        while (1)
                        {
                          uint64_t v30 = *((unsigned __int16 *)a2 + 6);
                          if (*((unsigned __int16 *)a2 + 5) - (int)v30 <= 1) {
                            break;
                          }
                          unsigned int v31 = bswap32(*(unsigned __int16 *)(*a2 + v30));
                          *((_WORD *)a2 + 6) = v30 + 2;
                          *(_WORD *)(*v28 + 2 * v29++) = HIWORD(v31);
                          if (v29 >= *v27) {
                            goto LABEL_57;
                          }
                        }
                      }
                      uint64_t v82 = "ByteStream_NumReadBytesAvail(*bs) >= 2";
                    }
                    else
                    {
                      uint64_t v82 = "(*bs).__RWFlag == BYTESTREAM_READ";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 668, v82);
                  }
                }
LABEL_57:
                if (++v16 >= (unint64_t)*((unsigned __int8 *)a1 + 8)) {
                  goto LABEL_58;
                }
                continue;
            }
          }
          int v81 = "(*bs).__RWFlag == BYTESTREAM_READ";
LABEL_76:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 644, v81);
        }
      }
      break;
    }
    int v81 = "ByteStream_NumReadBytesAvail(*bs) >= 1";
    goto LABEL_76;
  }
  unsigned int v5 = *((unsigned __int16 *)a2 + 5);
  if (v5 <= v4) {
    goto LABEL_19;
  }
  int v6 = 0;
  int v7 = *((unsigned __int8 *)a2 + 14);
  int v8 = *((unsigned __int16 *)a2 + 6);
  while (1)
  {
    if (v7 != 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/obex/obexcommon.c", 599, "(*bs).__RWFlag == BYTESTREAM_READ");
    }
    uint64_t v9 = *a2;
    uint64_t v10 = (unsigned __int16)v8 + 1;
    *((_WORD *)a2 + 6) = v8 + 1;
    uint64_t v11 = *(unsigned __int8 *)(v9 + (unsigned __int16)v8);
    if (v11 >> 6 >= 2)
    {
      if (v11 >> 6 == 2) {
        unsigned __int16 v13 = 1;
      }
      else {
        unsigned __int16 v13 = 4;
      }
      goto LABEL_17;
    }
    if ((int)(v5 - 1) <= (unsigned __int16)(v8 + 1))
    {
      uint64_t v12 = 0;
      *((unsigned char *)a2 + 15) = 1;
LABEL_66:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Bad OBEX Unicode len: %d, at least: %d \n", v64, v65, v66, v67, v68, v69, v70, v12);
        uint64_t v71 = sub_100050B4C(0x18u);
        if (os_log_type_enabled(v71, OS_LOG_TYPE_ERROR)) {
          goto LABEL_71;
        }
      }
      goto LABEL_72;
    }
    uint64_t v12 = __rev16(*(unsigned __int16 *)(v9 + v10));
    LODWORD(v10) = v8 + 3;
    *((_WORD *)a2 + 6) = v8 + 3;
    if (v12 <= 2) {
      goto LABEL_66;
    }
    unsigned __int16 v13 = v12 - 3;
    if v11 <= 0x3F && (v13) {
      break;
    }
LABEL_17:
    if ((int)(v5 - (unsigned __int16)v10) < v13)
    {
      *((unsigned char *)a2 + 15) = 1;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Bad OBEX Header:(%2x) len: (%d)\n", v56, v57, v58, v59, v60, v61, v62, v11);
        uint64_t v63 = sub_100050B4C(0x18u);
        if (os_log_type_enabled(v63, OS_LOG_TYPE_ERROR)) {
          goto LABEL_71;
        }
      }
      goto LABEL_72;
    }
    int v8 = v13 + v10;
    *((_WORD *)a2 + 6) = v13 + v10;
    *((unsigned char *)a1 + 8) = ++v6;
    if (v5 <= (unsigned __int16)(v13 + v10)) {
      goto LABEL_19;
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Bad OBEX Unicode len: %d (odd)\n", v73, v74, v75, v76, v77, v78, v79, v13);
    uint64_t v80 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v80, OS_LOG_TYPE_ERROR)) {
LABEL_71:
    }
      sub_100744F6C();
  }
LABEL_72:
  *((unsigned char *)a1 + 8) = 0;
  return 1720;
}

void sub_10016330C(int a1, void *a2, uint64_t a3)
{
  unsigned int v5 = sub_100112170(a1);

  sub_10011255C((uint64_t)v5, a2, a3);
}

uint64_t sub_10016334C(uint64_t a1, uint64_t a2, int a3, unsigned char *a4, uint64_t a5)
{
  if (!a5)
  {
    sub_10025B8C0();
    return 101;
  }
  if (!a2 || a1 && !*(void *)(a1 + 8)) {
    return 101;
  }
  uint64_t v10 = sub_10010CE48(0xD8uLL);
  if (!v10)
  {
    uint64_t v12 = 104;
    goto LABEL_18;
  }
  uint64_t v11 = sub_10025B218(0x18u);
  uint64_t v12 = sub_100245A8C((uint64_t)sub_100163650, (uint64_t)off_10099CEF8, *(unsigned __int16 *)(v11 + 8), 0, a4, a5);
  if (v12) {
    goto LABEL_18;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Registered channel number %d", v13, v14, v15, v16, v17, v18, v19, *a4);
    BOOL v20 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_INFO))
    {
      *(_DWORD *)int buf = 136446210;
      unsigned int v31 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
    }
  }
  if (a1)
  {
    v10[17] = *(void *)(a1 + 8);
    *((_WORD *)v10 + 64) = *(_WORD *)a1;
  }
  v10[18] = a2;
  *((_DWORD *)v10 + 38) = a3;
  *((unsigned char *)v10 + 200) = 0;
  *((unsigned char *)v10 + 192) = 1;
  *((_DWORD *)v10 + 51) = 0;
  *((unsigned char *)v10 + 194) = *a4;
  *((unsigned char *)v10 + 201) = 0;
  v10[8] = 0;
  v10[1] = 0;
  uint64_t v12 = sub_100112490((uint64_t)v10);
  if (v12)
  {
LABEL_18:
    if (sub_100058654()
      && (sub_100056E24((uint64_t)"OI_OBEXSRV_RegisterServer error %!", v22, v23, v24, v25, v26, v27, v28, v12),
          unint64_t v29 = sub_100050B4C(0x18u),
          os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)))
    {
      sub_100744F6C();
      if (!v10) {
        return v12;
      }
    }
    else if (!v10)
    {
      return v12;
    }
    sub_100023010(v10);
    return v12;
  }
  ++dword_100A19810;
  return v12;
}

void sub_100163564(unsigned int a1)
{
  uint64_t v2 = sub_100112170(a1);
  if (v2)
  {
    sub_1001137D0((uint64_t)v2);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OBEX server RFCOMM disconnect on bogus link handle %x %!", v3, v4, v5, v6, v7, v8, v9, a1);
    uint64_t v10 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100163610(int a1, void *a2, size_t a3)
{
  uint64_t v5 = sub_100112170(a1);

  sub_1001138B0((uint64_t)v5, a2, a3);
}

void sub_100163650(int *a1, int a2, uint64_t a3, unsigned int a4)
{
  uint64_t v6 = sub_100112200(a2);
  if (!v6)
  {
LABEL_14:
    sub_1002463C0(0, a4, 0);
    return;
  }
  uint64_t v7 = v6;
  int v8 = *(_DWORD *)(v6 + 204);
  if (v8)
  {
LABEL_12:
    if (v8 == 1)
    {
      *(_DWORD *)(v7 + 204) = 0;
      return;
    }
    goto LABEL_14;
  }
  uint64_t v9 = *(void **)(v6 + 8);
  if (v9) {
    sub_100023010(v9);
  }
  *(void *)(v7 + 112) = 0;
  *(_OWORD *)(v7 + 80) = 0u;
  *(_OWORD *)(v7 + 96) = 0u;
  *(_OWORD *)(v7 + 48) = 0u;
  *(_OWORD *)(v7 + 64) = 0u;
  *(_OWORD *)(v7 + 16) = 0u;
  *(_OWORD *)(v7 + 32) = 0u;
  *(_OWORD *)uint64_t v7 = 0u;
  int v10 = *a1;
  *(_WORD *)(v7 + 108) = *((_WORD *)a1 + 2);
  *(_DWORD *)(v7 + 104) = v10;
  *(_WORD *)uint64_t v7 = a4;
  *(_DWORD *)(v7 + 4) = 0;
  *(_WORD *)(v7 + 76) = 200;
  size_t v11 = *(unsigned __int16 *)(sub_10025B218(0x18u) + 8);
  *(_WORD *)(v7 + 74) = v11;
  *(void *)(v7 + 8) = sub_100022FE8(v11);
  *(_DWORD *)(v7 + 204) = 1;
  uint64_t v12 = sub_1002463C0((uint64_t)sub_100163988, a4, 1);
  if (v12)
  {
    uint64_t v13 = v12;
    uint64_t v14 = *(void **)(v7 + 8);
    if (v14)
    {
      sub_100023010(v14);
      *(void *)(v7 + 8) = 0;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OBEX server error %! accepting link request from %:", v15, v16, v17, v18, v19, v20, v21, v13);
      uint64_t v22 = sub_100050B4C(0x18u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    int v8 = *(_DWORD *)(v7 + 204);
    goto LABEL_12;
  }
  if (sub_10024681C(a4, v7))
  {
    sub_10025B8C0();
  }
}

uint64_t sub_1001637D0(unsigned int a1)
{
  uint64_t v2 = sub_100112200(a1);
  if (!v2)
  {
    if (sub_100058654())
    {
      uint64_t v11 = 1715;
      sub_100056E24((uint64_t)"OI_RFCOMM_DeregisterServer channel %d failed %!", v13, v14, v15, v16, v17, v18, v19, a1);
      uint64_t v20 = sub_100050B4C(0x18u);
      if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        return v11;
      }
      sub_100744F6C();
    }
    return 1715;
  }
  uint64_t v3 = v2;
  if (*(_DWORD *)(v2 + 204))
  {
    if (!sub_100058654()) {
      return 141;
    }
    uint64_t v11 = 141;
    sub_100056E24((uint64_t)"OI_RFCOMM_DeregisterServer channel %d failed %!", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v12 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      sub_100744F6C();
      return 141;
    }
  }
  else
  {
    uint64_t v11 = sub_100245D68(a1);
    if (v11)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_RFCOMM_DeregisterServer channel %d failed %!", v21, v22, v23, v24, v25, v26, v27, a1);
        uint64_t v28 = sub_100050B4C(0x18u);
        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      unint64_t v29 = *(void **)(v3 + 160);
      if (v29)
      {
        do
        {
          uint64_t v30 = (void *)v29[4];
          sub_100023010(v29);
          unint64_t v29 = v30;
        }
        while (v30);
      }
      --dword_100A19810;
    }
    sub_100112290(a1);
  }
  return v11;
}

uint64_t sub_100163948(unsigned int a1, unsigned char *a2)
{
  uint64_t v3 = sub_100112524(a1);
  if (!v3) {
    return 1709;
  }
  uint64_t v4 = v3;
  uint64_t result = 0;
  *a2 = *(unsigned char *)(v4 + 194);
  return result;
}

void sub_100163988(unsigned int a1, unsigned __int16 a2, uint64_t a3)
{
  __int16 v40 = a1;
  uint64_t v6 = sub_100112170(a1);
  v39[0] = 0;
  if (v6)
  {
    uint64_t v7 = v6;
    if (a3)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OBEX server RFCOMM connection failed: %!", v8, v9, v10, v11, v12, v13, v14, a3);
        uint64_t v15 = sub_100050B4C(0x18u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      *((_DWORD *)v7 + 51) = 0;
      uint64_t v16 = (void *)*((void *)v7 + 1);
      if (v16)
      {
        sub_100023010(v16);
        *((void *)v7 + 1) = 0;
      }
    }
    else
    {
      uint64_t v26 = (int *)(v6 + 88);
      uint64_t v25 = *((unsigned int *)v6 + 44);
      v7[36] = a2;
      *((_DWORD *)v7 + 51) = 2;
      if (v25)
      {
        sub_100026DB4(v25);
        *uint64_t v26 = 0;
      }
      BOOL v27 = *((_DWORD *)v7 + 38) != 0;
      int v28 = *(unsigned __int16 *)(sub_10025B218(0x18u) + 2 * v27);
      v39[1] = &v40;
      LOWORD(v39[0]) = 2;
      uint64_t v29 = sub_1000268E4((uint64_t)sub_100163B28, v39, v28, v26);
      if (v29)
      {
        uint64_t v30 = v29;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Register connect timeout handler failed %!\n", v31, v32, v33, v34, v35, v36, v37, v30);
          uint64_t v38 = sub_100050B4C(0x18u);
          if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"RFCOMM connect confirm called for bogus link handle %x", v17, v18, v19, v20, v21, v22, v23, a1);
    uint64_t v24 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100163B28(uint64_t a1)
{
  uint64_t v1 = **(unsigned __int16 **)(a1 + 8);
  uint64_t v2 = sub_100112170(v1);
  if (!v2) {
    sub_10025B8C0();
  }
  if (*((_DWORD *)v2 + 51) == 5) {
    sub_10025B8C0();
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Connection timeout: RFCOMM disconnect on link %x!", v3, v4, v5, v6, v7, v8, v9, v1);
    uint64_t v10 = sub_100050B4C(0x18u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  *((_DWORD *)v2 + 44) = 0;
  return sub_1001148A0(v2[104]);
}

uint64_t sub_100163BC8(int a1)
{
  if ((a1 - 4373) < 3) {
    return dword_1007B99A8[(__int16)(a1 - 4373)];
  }
  sub_10025B8C0();
  return 2;
}

uint64_t sub_100163C08(int a1)
{
  switch(a1)
  {
    case 2:
      return 4373;
    case 8:
      return 4374;
    case 4:
      return 4375;
  }
  sub_10025B8C0();
  return 4373;
}

BOOL sub_100163C58(int a1)
{
  return dword_100A1981C && (*(_DWORD *)(qword_100A04480 + 12) & a1) != 0;
}

uint64_t sub_100163C88(int a1)
{
  if (dword_100A1981C) {
    goto LABEL_2;
  }
  qword_100A04480 = (uint64_t)sub_10010CE48(0x10uLL);
  if (!qword_100A04480) {
    return 106;
  }
  uint64_t v4 = sub_100185350(0x20000);
  if (!v4)
  {
    dword_100A1981C = 1;
LABEL_2:
    uint64_t v2 = 0;
    *(_DWORD *)(qword_100A04480 + 12) |= a1;
    return v2;
  }
  uint64_t v2 = v4;
  sub_10018C1CC();
  if (qword_100A04480)
  {
    sub_100023010((void *)qword_100A04480);
    qword_100A04480 = 0;
  }
  return v2;
}

uint64_t sub_100163D28(int a1)
{
  if (!dword_100A1981C) {
    sub_10025B8C0();
  }
  int v2 = *(_DWORD *)(qword_100A04480 + 12);
  if ((v2 & a1) == 0) {
    return 121;
  }
  int v3 = v2 & ~a1;
  *(_DWORD *)(qword_100A04480 + 12) = v3;
  if (v3) {
    return 0;
  }
  dword_100A1981C = 0;
  uint64_t v5 = sub_100185404(0x20000);
  if (v5)
  {
    uint64_t v6 = v5;
    uint64_t result = sub_100058654();
    if (result)
    {
      sub_100056E24((uint64_t)"OI_DEVMGR_DeregisterServiceClass failed in internalTerminate - %!\n", v7, v8, v9, v10, v11, v12, v13, v6);
      uint64_t v14 = sub_100050B4C(0x1Bu);
      uint64_t result = os_log_type_enabled(v14, OS_LOG_TYPE_ERROR);
      if (result)
      {
        sub_1007457DC(v14);
        return 0;
      }
    }
  }
  else
  {
    uint64_t result = qword_100A04480;
    if (qword_100A04480)
    {
      sub_100023010((void *)qword_100A04480);
      uint64_t result = 0;
      qword_100A04480 = 0;
    }
  }
  return result;
}

uint64_t sub_100163E08(int a1, int a2)
{
  if (*(_DWORD *)(qword_100A04480 + 8) != a1) {
    return 408;
  }
  if (a1 == a2) {
    return 0;
  }
  if (a2)
  {
    if (!a1 && (a2 & ~*(_DWORD *)(qword_100A04480 + 12)) == 0)
    {
      qword_100A15238 = (uint64_t)sub_100022FE8(0x5EAuLL);
      if (!qword_100A15238) {
        return 106;
      }
      uint64_t result = 0;
      *(_DWORD *)(qword_100A04480 + 8) = a2;
      return result;
    }
    return 408;
  }
  *(_DWORD *)(qword_100A04480 + 8) = 0;
  uint64_t result = qword_100A15238;
  if (qword_100A15238)
  {
    sub_100023010((void *)qword_100A15238);
    uint64_t result = 0;
    qword_100A15238 = 0;
  }
  return result;
}

uint64_t sub_100163EB0(unsigned int a1, int a2, uint64_t a3, uint64_t (*a4)(uint64_t (*)(int *a1, unsigned int a2)), uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, unsigned __int8 a9)
{
  uint64_t v9 = 101;
  if (a7 && a6 && a4 && a5 && a3 && a8)
  {
    if (dword_100A1981C)
    {
      *(void *)qword_100A04480 = 0;
      switch(a2)
      {
        case 8:
          return sub_100164FC4(a1, a3, (uint64_t)a4, a5, a6, a7, a8, a9);
        case 4:
          return sub_100164E5C(a1, a3, (uint64_t)a4, a5, a6, a7, a8, a9);
        case 2:
          return sub_100166BC4(a1, a3, a4, a5, a6, a7, a8, a9);
      }
      return 101;
    }
    else
    {
      return 408;
    }
  }
  return v9;
}

uint64_t sub_100163F78(int a1, int a2, uint64_t a3, int a4, uint64_t a5, uint64_t (*a6)(uint64_t (*)(int *a1, unsigned int a2)), void (*a7)(void), uint64_t a8, uint64_t a9, uint64_t a10)
{
  if (a9) {
    BOOL v10 = a8 == 0;
  }
  else {
    BOOL v10 = 1;
  }
  if (v10 || a6 == 0 || a7 == 0 || a5 == 0 || a10 == 0) {
    return 101;
  }
  if (!dword_100A1981C) {
    return 408;
  }
  if ((a1 & ~*(_DWORD *)(qword_100A04480 + 12)) != 0) {
    return 2202;
  }
  *(void *)qword_100A04480 = 0;
  if (a1 != 8)
  {
    if (a1 != 4)
    {
      if (a1 == 2)
      {
        if (a2 != 2)
        {
          if (a2 == 8)
          {
            __int16 v21 = 4374;
            goto LABEL_41;
          }
          if (a2 == 4)
          {
            __int16 v21 = 4375;
LABEL_41:
            return sub_100166F48(v21, a3, a4, a5, a6, a7, a8, a9, a10);
          }
          sub_10025B8C0();
        }
        __int16 v21 = 4373;
        goto LABEL_41;
      }
      return 101;
    }
    if (a2 == 2)
    {
      return sub_100164FEC(a3, a4, a5, (uint64_t)a6, (uint64_t)a7, a8, a9, a10);
    }
    return 2203;
  }
  if (a2 != 2) {
    return 2203;
  }

  return sub_1001651B8(a3, a4, a5, (uint64_t)a6, (uint64_t)a7, a8, a9, a10);
}

uint64_t sub_10016415C(int a1)
{
  if (!dword_100A1981C) {
    return 408;
  }
  if (*(_DWORD *)(qword_100A04480 + 8) == a1) {
    return 141;
  }
  if ((*(_DWORD *)(qword_100A04480 + 12) & a1) == 0) {
    return 121;
  }
  if (a1 == 4)
  {
    sub_100164C24();
  }
  else if (a1 == 8)
  {
    sub_100164DF4();
  }
  else
  {
    sub_100166B6C();
  }
  return 0;
}

uint64_t sub_1001641E0(unsigned int a1, int a2)
{
  if (!dword_100A1981C) {
    return 408;
  }
  int v2 = *(_DWORD *)(qword_100A04480 + 8);
  if (v2 == 2) {
    return sub_1001671D4(a1, a2);
  }
  if (v2 == 8 || v2 == 4) {
    return sub_1001651E0(a1, a2);
  }
  else {
    return 101;
  }
}

uint64_t sub_100164228(unsigned int a1, int a2)
{
  if (!dword_100A1981C) {
    return 408;
  }
  int v2 = *(_DWORD *)(qword_100A04480 + 8);
  if (v2 == 2) {
    return sub_100167254(a1, a2);
  }
  if (v2 == 8 || v2 == 4) {
    return sub_1001652E8(a1, a2);
  }
  else {
    return 101;
  }
}

uint64_t sub_100164270(uint64_t a1, unsigned int a2, unsigned __int16 *a3, uint64_t *a4)
{
  if (*(unsigned char *)a1)
  {
    uint64_t v4 = *a4;
    if (*a4)
    {
      uint64_t v5 = *((unsigned __int16 *)a4 + 4);
      if (*((_WORD *)a4 + 4))
      {
        while (1)
        {
          unsigned int v6 = bswap32(*(_DWORD *)v4);
          unsigned int v7 = bswap32(*(_DWORD *)a1);
          if (v6 == v7)
          {
            unsigned int v6 = bswap32(*(unsigned __int16 *)(v4 + 4)) >> 16;
            unsigned int v8 = bswap32(*(unsigned __int16 *)(a1 + 4));
            if (v6 == HIWORD(v8))
            {
              int v9 = 0;
              goto LABEL_11;
            }
            unsigned int v7 = HIWORD(v8);
          }
          if (v6 < v7) {
            int v9 = -1;
          }
          else {
            int v9 = 1;
          }
LABEL_11:
          if (v9 <= 0)
          {
            unsigned int v10 = bswap32(*(_DWORD *)a1);
            unsigned int v11 = bswap32(*(_DWORD *)(v4 + 6));
            if (v10 == v11)
            {
              unsigned int v10 = bswap32(*(unsigned __int16 *)(a1 + 4)) >> 16;
              unsigned int v12 = bswap32(*(unsigned __int16 *)(v4 + 10));
              if (v10 == HIWORD(v12))
              {
                int v13 = 0;
                goto LABEL_19;
              }
              unsigned int v11 = HIWORD(v12);
            }
            if (v10 < v11) {
              int v13 = -1;
            }
            else {
              int v13 = 1;
            }
LABEL_19:
            if (v13 < 1) {
              goto LABEL_22;
            }
          }
          v4 += 12;
          if (!--v5) {
            return 0;
          }
        }
      }
      return 0;
    }
  }
LABEL_22:
  if (*(void *)a3)
  {
    uint64_t v14 = a3[4];
    if (!a3[4]) {
      return 0;
    }
    for (uint64_t i = (unsigned __int16 *)(*(void *)a3 + 2); *(i - 1) > a2 || *i < a2; i += 2)
    {
      if (!--v14) {
        return 0;
      }
    }
  }
  return 1;
}

uint64_t sub_100164384(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5 = *(void **)a2;
  if (!*(_WORD *)(a1 + 8))
  {
    if (!a3)
    {
      unsigned int v8 = 0;
      *(void *)a2 = 0;
LABEL_11:
      uint64_t result = 0;
      if (v5)
      {
        if (v5 != v8)
        {
          sub_100023010(v5);
          return 0;
        }
      }
      return result;
    }
    *(void *)a2 = *(void *)a3;
    *(_WORD *)(a2 + 8) = *(_WORD *)(a3 + 8);
LABEL_7:
    unsigned int v8 = *(void **)a3;
    goto LABEL_11;
  }
  unsigned int v7 = sub_100022FE8(4 * *(unsigned __int16 *)(a1 + 8));
  *(void *)a2 = v7;
  if (v7)
  {
    memmove(v7, *(const void **)a1, 4 * *(unsigned __int16 *)(a1 + 8));
    *(_WORD *)(a2 + 8) = *(_WORD *)(a1 + 8);
    if (!a3)
    {
      unsigned int v8 = 0;
      goto LABEL_11;
    }
    goto LABEL_7;
  }
  if (a3) {
    int v9 = *(void **)a3;
  }
  else {
    int v9 = 0;
  }
  unsigned int v11 = *(void **)a2;
  if (*(void *)a2 && v11 != v9) {
    sub_100023010(v11);
  }
  *(void *)a2 = v5;
  return 2023;
}

uint64_t sub_100164464(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5 = *(void **)a2;
  if (!*(_WORD *)(a1 + 8))
  {
    if (!a3)
    {
      unsigned int v8 = 0;
      *(void *)a2 = 0;
LABEL_11:
      uint64_t result = 0;
      if (v5)
      {
        if (v5 != v8)
        {
          sub_100023010(v5);
          return 0;
        }
      }
      return result;
    }
    *(void *)a2 = *(void *)a3;
    *(_WORD *)(a2 + 8) = *(_WORD *)(a3 + 8);
LABEL_7:
    unsigned int v8 = *(void **)a3;
    goto LABEL_11;
  }
  unsigned int v7 = sub_100022FE8(12 * *(unsigned __int16 *)(a1 + 8));
  *(void *)a2 = v7;
  if (v7)
  {
    memmove(v7, *(const void **)a1, 12 * *(unsigned __int16 *)(a1 + 8));
    *(_WORD *)(a2 + 8) = *(_WORD *)(a1 + 8);
    if (!a3)
    {
      unsigned int v8 = 0;
      goto LABEL_11;
    }
    goto LABEL_7;
  }
  if (a3) {
    int v9 = *(void **)a3;
  }
  else {
    int v9 = 0;
  }
  unsigned int v11 = *(void **)a2;
  if (*(void *)a2 && v11 != v9) {
    sub_100023010(v11);
  }
  *(void *)a2 = v5;
  return 2033;
}

void sub_10016454C(uint64_t a1, const void *a2, uint64_t a3)
{
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_18;
  }
  uint64_t v6 = 0;
  uint64_t v7 = qword_100A04488 + 200;
  while (*(unsigned __int16 *)(v7 - 100) != a1)
  {
    ++v6;
    v7 += 152;
    if (*(unsigned __int8 *)(qword_100A04488 + 1160) == v6) {
      goto LABEL_18;
    }
  }
  if ((v6 & 0x80000000) != 0)
  {
LABEL_18:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Filter net type request for non-existent connection handle\n", v10, v11, v12, v13, v14, v15, v16, v19);
      uint64_t v17 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (*(void *)v7)
  {
    sub_100023010(*(void **)v7);
    *(void *)uint64_t v7 = 0;
  }
  *(_WORD *)(v7 + 8) = a3;
  if (a3)
  {
    unsigned int v8 = sub_100022FE8(4 * a3);
    *(void *)uint64_t v7 = v8;
    if (!v8)
    {
      int v18 = 2023;
      goto LABEL_24;
    }
    memmove(v8, a2, 4 * a3);
  }
  if (*(_DWORD *)(qword_100A04488 + 1164) == 4
    && (int v9 = *(void (**)(uint64_t, const void *, uint64_t))(qword_100A04488 + 16)) != 0
    || (int v9 = *(void (**)(uint64_t, const void *, uint64_t))(qword_100A04488 + 24)) != 0)
  {
    v9(a1, a2, a3);
    return;
  }
  int v18 = 2021;
LABEL_24:
  sub_10014C000(a1, v18);
  if (*(void *)v7)
  {
    sub_100023010(*(void **)v7);
    *(void *)uint64_t v7 = 0;
  }
  *(_WORD *)(v7 + 8) = 0;
}

void sub_1001646B4(uint64_t a1, const void *a2, uint64_t a3)
{
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_18;
  }
  uint64_t v6 = 0;
  uint64_t v7 = qword_100A04488 + 216;
  while (*(unsigned __int16 *)(v7 - 116) != a1)
  {
    ++v6;
    v7 += 152;
    if (*(unsigned __int8 *)(qword_100A04488 + 1160) == v6) {
      goto LABEL_18;
    }
  }
  if ((v6 & 0x80000000) != 0)
  {
LABEL_18:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Filter net type request for non-existent connection handle\n", v10, v11, v12, v13, v14, v15, v16, v19);
      uint64_t v17 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (*(void *)v7)
  {
    sub_100023010(*(void **)v7);
    *(void *)uint64_t v7 = 0;
  }
  *(_WORD *)(v7 + 8) = a3;
  if (a3)
  {
    unsigned int v8 = sub_100022FE8(12 * a3);
    *(void *)uint64_t v7 = v8;
    if (!v8)
    {
      int v18 = 2033;
      goto LABEL_24;
    }
    memmove(v8, a2, 12 * a3);
  }
  if (*(_DWORD *)(qword_100A04488 + 1164) == 4
    && (int v9 = *(void (**)(uint64_t, const void *, uint64_t))(qword_100A04488 + 32)) != 0
    || (int v9 = *(void (**)(uint64_t, const void *, uint64_t))(qword_100A04488 + 40)) != 0)
  {
    v9(a1, a2, a3);
    return;
  }
  int v18 = 2031;
LABEL_24:
  sub_10014C068(a1, v18);
  if (*(void *)v7)
  {
    sub_100023010(*(void **)v7);
    *(void *)uint64_t v7 = 0;
  }
  *(_WORD *)(v7 + 8) = 0;
}

uint64_t sub_100164820(int a1)
{
  if (sub_100163C58(a1)) {
    return 0;
  }
  if (sub_100163C58(4))
  {
    uint64_t v2 = sub_100163C88(a1);
    if (!v2) {
      return v2;
    }
    goto LABEL_7;
  }
  BOOL v3 = sub_100163C58(8);
  uint64_t v2 = sub_100163C88(a1);
  if (v2)
  {
LABEL_7:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"PAN_RegisterRole inside GN/NAP internalInit failed - %!\n", v4, v5, v6, v7, v8, v9, v10, v2);
      uint64_t v11 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return v2;
  }
  if (v3) {
    return 0;
  }
  uint64_t v13 = sub_10010CE48(0x4F0uLL);
  qword_100A04488 = (uint64_t)v13;
  if (v13)
  {
    sub_10025C0F0(v13 + 10);
    uint64_t v2 = 0;
    uint64_t v14 = qword_100A04488;
    *(_OWORD *)(qword_100A04488 + 1168) = *(_OWORD *)&off_10099CFE0;
    *(_OWORD *)(v14 + 1184) = *(_OWORD *)&off_10099CFF0;
    *(_OWORD *)(v14 + 1200) = xmmword_10099D000;
    *(_OWORD *)(v14 + 1216) = *(_OWORD *)algn_10099D010;
    *(unsigned char *)(v14 + 1161) = 0;
    *(_DWORD *)(v14 + 1164) = 0;
    *(_OWORD *)(v14 + 1232) = unk_10099D020;
  }
  else
  {
    sub_100163D28(a1);
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"GN/NAP internalInit out of memory\n", v15, v16, v17, v18, v19, v20, v21, v23);
      uint64_t v22 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 106;
  }
  return v2;
}

void sub_100164998(uint64_t a1, uint64_t a2, int a3, int a4)
{
  unsigned int v8 = sub_100165FB0(a2);
  uint64_t v9 = qword_100A04488;
  if (v8 == -1)
  {
    unsigned int v10 = (*(unsigned char *)(qword_100A04488 + 1160))++;
    uint64_t v11 = v9 + 152 * v10;
    int v12 = *(_DWORD *)a2;
    *(_WORD *)(v11 + 106) = *(_WORD *)(a2 + 4);
    *(_DWORD *)(v11 + 102) = v12;
    *(void *)(v11 + 112) = 0;
    *(_WORD *)(v11 + 100) = a1;
  }
  else
  {
    unsigned int v10 = v8;
  }
  uint64_t v13 = v9 + 152 * (int)v10;
  int v16 = *(_DWORD *)(v13 + 96);
  uint64_t v14 = (_DWORD *)(v13 + 96);
  int v15 = v16;
  if (v16 == 1)
  {
LABEL_7:
    if (a3 == 4375)
    {
      uint64_t v39 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))v9;
      uint64_t v17 = sub_100163BC8(a4);
      uint64_t v18 = a1;
      uint64_t v19 = a2;
      uint64_t v20 = 4;
    }
    else
    {
      uint64_t v39 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(v9 + 8);
      uint64_t v17 = sub_100163BC8(a4);
      uint64_t v18 = a1;
      uint64_t v19 = a2;
      uint64_t v20 = 8;
    }
    v39(v18, v19, v20, v17);
    return;
  }
  if (!v15)
  {
    _DWORD *v14 = 1;
    goto LABEL_7;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Device for connection to %: in invalid state to accept incoming connect request\n", v21, v22, v23, v24, v25, v26, v27, a2);
    int v28 = sub_100050B4C(0x1Bu);
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  uint64_t v29 = sub_10014BAB0(a1, 0, 0, 0, (long long *)(qword_100A04488 + 1200));
  if (v29)
  {
    uint64_t v30 = v29;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Reject incoming connection failed - %!\n", v31, v32, v33, v34, v35, v36, v37, v30);
      uint64_t v38 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_100164B74(int a1)
{
  if (sub_100163C58(a1))
  {
    uint64_t v2 = sub_100163D28(a1);
    if (v2)
    {
      uint64_t v3 = v2;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"PAN_DeregisterRole failed inside GN/NAP internalTerminate - %!\n", v4, v5, v6, v7, v8, v9, v10, v3);
        uint64_t v11 = sub_100050B4C(0x1Bu);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else if (!sub_100163C58(4) && !sub_100163C58(8) && qword_100A04488)
    {
      sub_100023010((void *)qword_100A04488);
      qword_100A04488 = 0;
    }
  }
}

uint64_t sub_100164C24()
{
  if (!sub_100163C58(4)) {
    return 408;
  }
  uint64_t result = sub_10024E448(*(_DWORD *)(qword_100A04488 + 1252));
  if (!result)
  {
    uint64_t result = sub_10014B4AC(15, 4375);
    if (!result)
    {
      sub_100164B74(4);
      return 0;
    }
  }
  return result;
}

uint64_t sub_100164C7C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, int a7, int a8, int a9, int a10)
{
  if (!sub_100163C58(8))
  {
    long long v21 = 0u;
    long long v22 = 0u;
    uint64_t v18 = sub_100164820(8);
    if (!v18)
    {
      uint64_t v18 = sub_10014AF34(15, 4374, (uint64_t)sub_100164998);
      if (!v18)
      {
        uint64_t v19 = qword_100A04488;
        *(void *)(qword_100A04488 + 8) = a1;
        *(void *)(v19 + 24) = a2;
        *(void *)(v19 + 56) = a3;
        *(void *)(v19 + 40) = a4;
        *(void *)(v19 + 72) = a5;
        *(_DWORD *)(v19 + 1256) = a10;
        *(void *)&long long v21 = &unk_10099CF20;
        WORD4(v21) = 8;
        *(void *)&long long v22 = *(void *)a6;
        WORD4(v22) = *(_WORD *)(a6 + 8);
        byte_100A04490 = 1;
        word_100A04492 = 2;
        dword_100A04498 = a7;
        byte_100A044A0 = 1;
        word_100A044A2 = 2;
        dword_100A044A8 = a8;
        byte_100A044B0 = 1;
        word_100A044B2 = 4;
        dword_100A044B8 = a9;
        uint64_t v18 = sub_10024E258((uint64_t)&v21, (int *)(v19 + 1248));
        if (!v18) {
          return v18;
        }
        *(_DWORD *)(qword_100A04488 + 1248) = 0;
        sub_10014B4AC(15, 4374);
      }
    }
    sub_100164B74(8);
    return v18;
  }
  return 119;
}

uint64_t sub_100164DF4()
{
  if (!sub_100163C58(8)) {
    return 408;
  }
  uint64_t result = sub_10024E448(*(_DWORD *)(qword_100A04488 + 1248));
  if (!result)
  {
    *(_DWORD *)(qword_100A04488 + 1248) = 0;
    uint64_t result = sub_10014B4AC(15, 4374);
    if (!result)
    {
      sub_100164B74(8);
      return 0;
    }
  }
  return result;
}

uint64_t sub_100164E5C(unsigned int a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, int a8)
{
  return sub_100164E84(a1, a2, a3, a4, a5, a6, a7, a8, 4375);
}

uint64_t sub_100164E84(unsigned int a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, int a8, int a9)
{
  uint64_t v9 = *(unsigned __int8 *)(qword_100A04488 + 1160);
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    return 122;
  }
  uint64_t v12 = qword_100A04488 + 96;
  uint64_t v13 = 0xFFFFFFFFLL;
  while (*(unsigned __int16 *)(v12 + 4) != a1)
  {
    --v13;
    v12 += 152;
    if (!--v9) {
      return 122;
    }
  }
  if (!v13) {
    return 122;
  }
  if (a8)
  {
    *(void *)(v12 + 32) = a3;
    *(void *)(v12 + 40) = a4;
    *(void *)(v12 + 48) = a5;
    *(void *)(v12 + 56) = a6;
    *(void *)(v12 + 64) = a7;
    int v14 = sub_100163BC8((unsigned __int16)a9);
    unsigned int v15 = sub_100166000(v12, v14);
    BOOL v16 = v15 == 0;
  }
  else
  {
    BOOL v16 = 0;
    unsigned int v15 = 0;
  }
  if (*(_DWORD *)v12 != 1) {
    return 408;
  }
  uint64_t v19 = qword_100A04488;
  uint64_t v20 = (long long *)(qword_100A04488 + 1200);
  *(unsigned char *)(qword_100A04488 + 1200) = 3;
  *(_WORD *)(v19 + 1202) = 4;
  *(_DWORD *)(v19 + 1208) = a9;
  unsigned int v21 = sub_10014BAB0(a1, (uint64_t)sub_100166124, v19 + 1168, v16, v20);
  if (v16) {
    uint64_t v17 = v21;
  }
  else {
    uint64_t v17 = v15;
  }
  if (v21) {
    BOOL v22 = 0;
  }
  else {
    BOOL v22 = v16;
  }
  if (v22)
  {
    *(void *)(v12 + 24) = a2;
  }
  else
  {
    *(_DWORD *)uint64_t v12 = 0;
    sub_1001659E0((void *)v12);
  }
  return v17;
}

uint64_t sub_100164FC4(unsigned int a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, int a8)
{
  return sub_100164E84(a1, a2, a3, a4, a5, a6, a7, a8, 4374);
}

uint64_t sub_100164FEC(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_100165014(a1, a2, a3, a4, a5, a6, a7, a8, 4);
}

uint64_t sub_100165014(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, int a9)
{
  signed int v17 = sub_100165FB0(a1);
  uint64_t v18 = qword_100A04488;
  if (v17 == -1)
  {
    signed int v19 = *(unsigned __int8 *)(qword_100A04488 + 1160);
    if (v19 > 6) {
      return 104;
    }
    int v33 = a2;
    *(unsigned char *)(qword_100A04488 + 1160) = v19 + 1;
    uint64_t v20 = v18 + 152 * v19;
    int v21 = *(_DWORD *)a1;
    *(_WORD *)(v20 + 106) = *(_WORD *)(a1 + 4);
    *(_DWORD *)(v20 + 102) = v21;
    *(void *)(v20 + 112) = 0;
  }
  else
  {
    int v33 = a2;
    signed int v19 = v17;
  }
  uint64_t v22 = v18 + 152 * v19;
  int v24 = *(_DWORD *)(v22 + 96);
  uint64_t v23 = (void *)(v22 + 96);
  if (v24) {
    return 408;
  }
  uint64_t v26 = (void *)(v18 + 152 * v19);
  v26[16] = a4;
  v26[17] = a5;
  v26[18] = a6;
  v26[19] = a7;
  v26[20] = a8;
  uint64_t v25 = sub_100166000((uint64_t)v23, a9);
  if (!v25)
  {
    uint64_t v27 = qword_100A04488;
    *(unsigned char *)(qword_100A04488 + 1200) = 3;
    *(_WORD *)(v27 + 1202) = 4;
    int v28 = sub_100163C08(a9);
    uint64_t v29 = qword_100A04488;
    *(_DWORD *)(qword_100A04488 + 1208) = v28;
    uint64_t v30 = v29 + 1168;
    __int16 v31 = sub_100163C08(a9);
    uint64_t v25 = sub_10014B564(v33, (uint64_t)sub_100166124, v30, a1, v31, 4373, qword_100A04488 + 1200);
    if (v25)
    {
      sub_100165970((uint64_t)v23);
      sub_1001659E0(v23);
    }
    else
    {
      *(void *)(v18 + 152 * v19 + 120) = a3;
      *(_DWORD *)uint64_t v23 = 2;
    }
  }
  return v25;
}

uint64_t sub_1001651B8(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_100165014(a1, a2, a3, a4, a5, a6, a7, a8, 8);
}

uint64_t sub_1001651E0(unsigned int a1, int a2)
{
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_9;
  }
  uint64_t v3 = 0;
  uint64_t v4 = (void **)(qword_100A04488 + 200);
  while (*((unsigned __int16 *)v4 - 50) != a1)
  {
    ++v3;
    v4 += 19;
    if (*(unsigned __int8 *)(qword_100A04488 + 1160) == v3) {
      goto LABEL_9;
    }
  }
  if ((v3 & 0x80000000) != 0)
  {
LABEL_9:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Filter net type request for non-existent connection handle\n", v6, v7, v8, v9, v10, v11, v12, v16);
      uint64_t v13 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 122;
  }
  if (!a2)
  {
    uint64_t v15 = 56;
    if (*(_DWORD *)(qword_100A04488 + 1164) == 4) {
      uint64_t v15 = 48;
    }
    uint64_t v5 = sub_100164384((uint64_t)v4, (uint64_t)(v4 - 4), *(void *)(qword_100A04488 + v15));
    if (v5) {
      goto LABEL_17;
    }
    a2 = 0;
  }
  uint64_t v5 = sub_10014C000(a1, a2);
LABEL_17:
  if (*v4)
  {
    sub_100023010(*v4);
    *uint64_t v4 = 0;
  }
  return v5;
}

uint64_t sub_1001652E8(unsigned int a1, int a2)
{
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_9;
  }
  uint64_t v3 = 0;
  uint64_t v4 = (void **)(qword_100A04488 + 216);
  while (*((unsigned __int16 *)v4 - 58) != a1)
  {
    ++v3;
    v4 += 19;
    if (*(unsigned __int8 *)(qword_100A04488 + 1160) == v3) {
      goto LABEL_9;
    }
  }
  if ((v3 & 0x80000000) != 0)
  {
LABEL_9:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Filter multicast request for non-existent connection handle\n", v6, v7, v8, v9, v10, v11, v12, v16);
      uint64_t v13 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 122;
  }
  if (!a2)
  {
    uint64_t v15 = 72;
    if (*(_DWORD *)(qword_100A04488 + 1164) == 4) {
      uint64_t v15 = 64;
    }
    uint64_t v5 = sub_100164464((uint64_t)v4, (uint64_t)(v4 - 4), *(void *)(qword_100A04488 + v15));
    if (v5) {
      goto LABEL_17;
    }
    a2 = 0;
  }
  uint64_t v5 = sub_10014C068(a1, a2);
LABEL_17:
  if (*v4)
  {
    sub_100023010(*v4);
    *uint64_t v4 = 0;
  }
  return v5;
}

uint64_t sub_1001653F0(_DWORD *a1)
{
  if (!sub_100163C58(8)) {
    return 408;
  }
  uint64_t result = 0;
  *a1 = *(_DWORD *)(qword_100A04488 + 1248);
  return result;
}

void sub_100165438(uint64_t a1, uint64_t a2)
{
  uint64_t v2 = qword_100A04488;
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_7;
  }
  char v5 = 0;
  uint64_t v6 = 0;
  while (*(unsigned __int16 *)(qword_100A04488 + v6 + 100) != a1)
  {
    v6 += 152;
    ++v5;
    if (152 * *(unsigned __int8 *)(qword_100A04488 + 1160) == v6) {
      goto LABEL_7;
    }
  }
  if (v6 != -152)
  {
    uint64_t v15 = qword_100A04488 + v6;
    uint64_t v16 = (void *)(qword_100A04488 + v6 + 96);
    signed int v17 = *(void **)(qword_100A04488 + 80);
    if (v17 != (void *)(qword_100A04488 + 80))
    {
      int v18 = 1 << v5;
      do
      {
        signed int v19 = (void *)*v17;
        if ((v18 & *((unsigned char *)v17 - 6)) != 0)
        {
          *(void *)(v15 + 112) = v17 - 194;
          sub_10016583C(a1);
          uint64_t v2 = qword_100A04488;
        }
        signed int v17 = v19;
      }
      while (v19 != (void *)(v2 + 80));
    }
    *(_DWORD *)uint64_t v16 = 0;
    sub_100165970((uint64_t)v16);
    int v21 = *(void (**)(uint64_t, uint64_t))(v15 + 160);
    sub_1001659E0(v16);
    v21(a1, a2);
  }
  else
  {
LABEL_7:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DisconnectCB issued but no connection\n", v7, v8, v9, v10, v11, v12, v13, v20);
      int v14 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_1001655B0(int a1, uint64_t a2, uint64_t a3, __int16 a4, const void *a5, unsigned int a6, void *__src, size_t __len)
{
  uint64_t v8 = *(unsigned __int8 *)(qword_100A04488 + 1160);
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_28;
  }
  __int16 v9 = __len;
  uint64_t v16 = qword_100A04488 + 96;
  uint64_t v17 = 0xFFFFFFFFLL;
  while (*(unsigned __int16 *)(v16 + 4) != a1)
  {
    --v17;
    v16 += 152;
    if (!--v8) {
      goto LABEL_28;
    }
  }
  if (v17)
  {
    uint64_t v18 = qword_100A15238;
    if (!qword_100A15238) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_gn.c", 1018, "PAN_RecvBuf");
    }
    int v19 = *(_DWORD *)a2;
    *(_WORD *)(qword_100A15238 + 4) = *(_WORD *)(a2 + 4);
    *(_DWORD *)uint64_t v18 = v19;
    int v20 = *(_DWORD *)a3;
    *(_WORD *)(v18 + 10) = *(_WORD *)(a3 + 4);
    *(_DWORD *)(v18 + 6) = v20;
    *(_WORD *)(v18 + 12) = __rev16(a4);
    if (__len >= 0x5DD)
    {
      sub_10025B8C0();
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_gn.c", 1031, "ByteStream_NumReadBytesAvail(bs) >= (dataLen)");
    }
    memmove((void *)(v18 + 14), __src, __len);
    if (*(_DWORD *)(qword_100A04488 + 1256) == 1
      || (*(unsigned char *)a2 & 1) != 0
      || (*(_DWORD *)a2 == xmmword_100A195C0
        ? (BOOL v21 = *(unsigned __int16 *)(a2 + 4) == WORD2(xmmword_100A195C0))
        : (BOOL v21 = 0),
          v21))
    {
      if (*(_DWORD *)a3 != xmmword_100A195C0 || *(unsigned __int16 *)(a3 + 4) != WORD2(xmmword_100A195C0))
      {
        uint64_t v23 = (*(uint64_t (**)(uint64_t, void))(v16 + 48))(v18, (unsigned __int16)(v9 + 14));
        if (v23)
        {
          uint64_t v24 = v23;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Forwarding packet to host failed - %!\n", v25, v26, v27, v28, v29, v30, v31, v24);
            uint64_t v32 = sub_100050B4C(0x1Bu);
            if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
      }
    }
    LOWORD(__lena) = v9;
    uint64_t v33 = sub_100165B8C(v16, 0, (int *)a2, (int *)a3, a4, a5, a6, __src, __lena);
    if (v33)
    {
      uint64_t v34 = v33;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Forwarding packet to other BT devices failed - %!\n", v35, v36, v37, v38, v39, v40, v41, v34);
        uint64_t v42 = sub_100050B4C(0x1Bu);
        if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
          goto LABEL_30;
        }
      }
    }
  }
  else
  {
LABEL_28:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unknown handle\n", v43, v44, v45, v46, v47, v48, v49, __lena);
      uint64_t v50 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
LABEL_30:
      }
        sub_100744F6C();
    }
  }
}

void sub_10016583C(int a1)
{
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_14;
  }
  uint64_t v1 = 0;
  uint64_t v2 = (unsigned __int16 *)(qword_100A04488 + 100);
  while (*v2 != a1)
  {
    ++v1;
    v2 += 76;
    if (*(unsigned __int8 *)(qword_100A04488 + 1160) == v1) {
      goto LABEL_14;
    }
  }
  if ((v1 & 0x80000000) != 0)
  {
LABEL_14:
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"BNEP write completed for non-existent connection handle\n", v5, v6, v7, v8, v9, v10, v11, v21);
    uint64_t v12 = sub_100050B4C(0x1Bu);
    if (!os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_16;
  }
  uint64_t v3 = *(void *)(v2 + 6);
  if (!v3)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"FinishSend called on NULL packet\n", v13, v14, v15, v16, v17, v18, v19, v21);
    int v20 = sub_100050B4C(0x1Bu);
    if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_16:
    sub_100744F6C();
    return;
  }
  *(void *)(v2 + 6) = 0;
  int v4 = *(unsigned __int8 *)(v3 + 1546) & ~(1 << v1);
  *(unsigned char *)(v3 + 1546) = v4;
  if (!v4)
  {
    if (*(unsigned char *)(v3 + 1568)) {
      (*(void (**)(void))(v2 + 26))();
    }
    sub_10025C120((void *)(v3 + 1552));
    sub_100165B48((void *)v3);
  }
}

void sub_100165970(uint64_t a1)
{
  int v1 = (*(uint64_t (**)(void))(a1 + 40))();
  LODWORD(v2) = *(unsigned __int8 *)(qword_100A04488 + 1161);
  if (v2 == 1)
  {
    if (v1) {
      return;
    }
    if (sub_100163E08(*(_DWORD *)(qword_100A04488 + 1164), 0)) {
      sub_10025B8C0();
    }
    uint64_t v2 = qword_100A04488;
    *(_DWORD *)(qword_100A04488 + 1164) = 0;
    uint64_t v3 = (unsigned char *)(v2 + 1161);
    LOBYTE(v2) = *(unsigned char *)(v2 + 1161);
  }
  else
  {
    uint64_t v3 = (unsigned char *)(qword_100A04488 + 1161);
  }
  *uint64_t v3 = v2 - 1;
}

void sub_1001659E0(void *a1)
{
  uint64_t v2 = qword_100A04488;
  uint64_t v3 = *(void **)(qword_100A04488 + 48);
  if (v3) {
    LOBYTE(v3) = a1[9] == *v3;
  }
  int v4 = *(void ***)(qword_100A04488 + 56);
  uint64_t v5 = (void *)a1[9];
  if (v4) {
    LOBYTE(v4) = v5 == *v4;
  }
  if (!v5) {
    LOBYTE(v3) = 1;
  }
  if ((v3 & 1) == 0 && (v4 & 1) == 0)
  {
    sub_100023010(v5);
    uint64_t v2 = qword_100A04488;
  }
  uint64_t v6 = *(void **)(v2 + 64);
  if (v6) {
    LOBYTE(v6) = a1[11] == *v6;
  }
  uint64_t v7 = *(void ***)(v2 + 72);
  uint64_t v8 = (void *)a1[11];
  if (v7) {
    LOBYTE(v7) = v8 == *v7;
  }
  if (!v8) {
    LOBYTE(v6) = 1;
  }
  if ((v6 & 1) == 0 && (v7 & 1) == 0) {
    sub_100023010(v8);
  }
  uint64_t v9 = (void *)a1[13];
  if (v9)
  {
    sub_100023010(v9);
    a1[13] = 0;
  }
  uint64_t v10 = (void *)a1[15];
  if (v10)
  {
    sub_100023010(v10);
    a1[15] = 0;
  }
  uint64_t v11 = qword_100A04488;
  unint64_t v12 = 0x86BCA1AF286BCA1BLL * (((uint64_t)a1 - qword_100A04488 - 96) >> 3);
  unsigned int v13 = v12 + 1;
  if ((v12 + 1) <= 6)
  {
    uint64_t v14 = qword_100A04488 + 152 * (int)v12 + 96;
    uint64_t v15 = qword_100A04488 + 152 * v13 + 96;
    do
    {
      long long v16 = *(_OWORD *)(v15 + 16);
      *(_OWORD *)uint64_t v14 = *(_OWORD *)v15;
      *(_OWORD *)(v14 + 16) = v16;
      long long v17 = *(_OWORD *)(v15 + 32);
      long long v18 = *(_OWORD *)(v15 + 48);
      long long v19 = *(_OWORD *)(v15 + 80);
      *(_OWORD *)(v14 + 64) = *(_OWORD *)(v15 + 64);
      *(_OWORD *)(v14 + 80) = v19;
      *(_OWORD *)(v14 + 32) = v17;
      *(_OWORD *)(v14 + 48) = v18;
      long long v20 = *(_OWORD *)(v15 + 96);
      long long v21 = *(_OWORD *)(v15 + 112);
      long long v22 = *(_OWORD *)(v15 + 128);
      *(void *)(v14 + 144) = *(void *)(v15 + 144);
      *(_OWORD *)(v14 + 112) = v21;
      *(_OWORD *)(v14 + 128) = v22;
      *(_OWORD *)(v14 + 96) = v20;
      v14 += 152;
      v15 += 152;
      ++v13;
    }
    while (v13 < 7);
  }
  --*(unsigned char *)(v11 + 1160);
}

void sub_100165B48(void *ptr)
{
  uint64_t v2 = (void *)ptr[192];
  if (v2)
  {
    sub_100023010(v2);
    ptr[192] = 0;
  }

  sub_100023010(ptr);
}

uint64_t sub_100165B8C(uint64_t a1, int a2, int *a3, int *a4, __int16 a5, const void *a6, unsigned int a7, const void *a8, size_t __len)
{
  long long v17 = sub_100022FE8(0x628uLL);
  if (!v17) {
    return 106;
  }
  long long v18 = v17;
  if (a6)
  {
    long long v19 = sub_100022FE8(a7);
    *((void *)v18 + 192) = v19;
    if (v19)
    {
      memmove(v19, a6, a7);
      goto LABEL_6;
    }
    sub_100023010(v18);
    return 106;
  }
  *((void *)v17 + 192) = 0;
LABEL_6:
  *((_WORD *)v18 + 772) = a7;
  int v20 = *a3;
  *((_WORD *)v18 + 2) = *((_WORD *)a3 + 2);
  *long long v18 = v20;
  int v21 = *a4;
  *((_WORD *)v18 + 5) = *((_WORD *)a4 + 2);
  *(_DWORD *)((char *)v18 + 6) = v21;
  *((_WORD *)v18 + 6) = a5;
  uint64_t v22 = (uint64_t)memmove((char *)v18 + 14, a8, (unsigned __int16)__len);
  *((_WORD *)v18 + 764) = __len;
  *((unsigned char *)v18 + 1546) = 0;
  *((unsigned char *)v18 + 1568) = a2;
  uint64_t v23 = qword_100A04488;
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    goto LABEL_30;
  }
  uint64_t v40 = a1;
  uint64_t v24 = 0;
  unint64_t v25 = 0;
  do
  {
    if (*(_DWORD *)(v23 + v24 + 96) == 3)
    {
      if ((*(unsigned char *)a3 & 1) != 0
        || (*a3 == *(_DWORD *)(v23 + v24 + 102)
          ? (BOOL v26 = *((unsigned __int16 *)a3 + 2) == *(unsigned __int16 *)(v23 + v24 + 106))
          : (BOOL v26 = 0),
            v26))
      {
        uint64_t v27 = v23 + v24;
        uint64_t v28 = (_DWORD *)(v23 + v24 + 102);
        if ((*a4 != *v28 || *((unsigned __int16 *)a4 + 2) != *(unsigned __int16 *)(v23 + v24 + 106))
          && !*(void *)(v27 + 112))
        {
          uint64_t v22 = sub_100165E40((uint64_t)v18, v23 + v24 + 96);
          if (v22 != 2041)
          {
            if (v22)
            {
              uint64_t v22 = sub_100058654();
              if (v22)
              {
                sub_100056E24((uint64_t)"Forwarding packet to %: failed - %!\n", v30, v31, v32, v33, v34, v35, v36, (uint64_t)v28);
                uint64_t v37 = sub_100050B4C(0x1Bu);
                uint64_t v22 = os_log_type_enabled(v37, OS_LOG_TYPE_ERROR);
                if (v22)
                {
                  uint64_t v38 = sub_100050714();
                  *(_DWORD *)int buf = 136446466;
                  uint64_t v42 = v38;
                  __int16 v43 = 1024;
                  int v44 = 0xFFFF;
                  _os_log_error_impl((void *)&_mh_execute_header, v37, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
                }
              }
            }
            else
            {
              *((unsigned char *)v18 + 1546) |= 1 << v25;
              *(void *)(v27 + 112) = v18;
            }
          }
        }
      }
    }
    ++v25;
    uint64_t v23 = qword_100A04488;
    v24 += 152;
  }
  while (v25 < *(unsigned __int8 *)(qword_100A04488 + 1160));
  a1 = v40;
  if (*((unsigned char *)v18 + 1546))
  {
    sub_10025C10C((void *)v18 + 194, qword_100A04488 + 80);
  }
  else
  {
LABEL_30:
    if (a2) {
      (*(void (**)(uint64_t))(a1 + 56))(v22);
    }
    sub_100165B48(v18);
  }
  return 0;
}

uint64_t sub_100165E40(uint64_t a1, uint64_t a2)
{
  if (sub_100164270(a1, *(unsigned __int16 *)(a1 + 12), (unsigned __int16 *)(a2 + 72), (uint64_t *)(a2 + 88)))
  {
    unsigned int v4 = *(unsigned __int16 *)(a1 + 12);
    uint64_t v5 = (char *)(a1 + 14);
    unsigned __int16 v6 = *(_WORD *)(a1 + 1528);
    uint64_t v7 = *(char **)(a1 + 1536);
    return sub_10014BEA4((uint64_t)sub_100165ED8, *(unsigned __int16 *)(a2 + 4), a1, a1 + 6, v4, v7, *(unsigned __int16 *)(a1 + 1544), v5, v6);
  }
  uint64_t v7 = *(char **)(a1 + 1536);
  if (v7)
  {
    unsigned __int16 v6 = 0;
    uint64_t v5 = 0;
    unsigned int v4 = 0;
    return sub_10014BEA4((uint64_t)sub_100165ED8, *(unsigned __int16 *)(a2 + 4), a1, a1 + 6, v4, v7, *(unsigned __int16 *)(a1 + 1544), v5, v6);
  }
  return 2041;
}

void sub_100165ED8(int a1)
{
  sub_10016583C(a1);
  uint64_t v2 = qword_100A04488;
  if (*(unsigned char *)(qword_100A04488 + 1160))
  {
    int v3 = 0;
    uint64_t v4 = 0;
    while (*(unsigned __int16 *)(qword_100A04488 + v4 + 100) != a1)
    {
      v4 += 152;
      ++v3;
      if (152 * *(unsigned __int8 *)(qword_100A04488 + 1160) == v4) {
        return;
      }
    }
    if ((v3 & 0x80000000) == 0)
    {
      uint64_t v5 = *(void **)(qword_100A04488 + 80);
      if (v5 != (void *)(qword_100A04488 + 80))
      {
        int v6 = 1 << v3;
        do
        {
          uint64_t v7 = (void *)*v5;
          if ((v6 & *((unsigned char *)v5 - 6)) != 0)
          {
            *(void *)(v2 + v4 + 112) = v5 - 194;
            if (!sub_100165E40()) {
              return;
            }
            sub_10016583C(a1);
            uint64_t v2 = qword_100A04488;
          }
          uint64_t v5 = v7;
        }
        while (v7 != (void *)(v2 + 80));
      }
    }
  }
}

uint64_t sub_100165FB0(uint64_t a1)
{
  if (!*(unsigned char *)(qword_100A04488 + 1160)) {
    return 0xFFFFFFFFLL;
  }
  uint64_t result = 0;
  for (uint64_t i = qword_100A04488 + 102;
        *(_DWORD *)i != *(_DWORD *)a1 || *(unsigned __int16 *)(i + 4) != *(unsigned __int16 *)(a1 + 4);
        i += 152)
  {
    if (*(unsigned __int8 *)(qword_100A04488 + 1160) == ++result) {
      return 0xFFFFFFFFLL;
    }
  }
  return result;
}

uint64_t sub_100166000(uint64_t a1, int a2)
{
  if (*(unsigned char *)(qword_100A04488 + 1161))
  {
    if (*(_DWORD *)(qword_100A04488 + 1164) == a2)
    {
      uint64_t v4 = (*(uint64_t (**)(uint64_t (*)(uint64_t, unsigned int)))(a1 + 32))(sub_100166314);
      if (!v4) {
        goto LABEL_12;
      }
    }
    else
    {
      return 408;
    }
  }
  else
  {
    uint64_t v4 = sub_100163E08(0, a2);
    if (!v4)
    {
      uint64_t v5 = (*(uint64_t (**)(uint64_t (*)(uint64_t, unsigned int)))(a1 + 32))(sub_100166314);
      if (!v5)
      {
LABEL_12:
        uint64_t v4 = 0;
        uint64_t v16 = qword_100A04488;
        *(_DWORD *)(qword_100A04488 + 1164) = a2;
        ++*(unsigned char *)(v16 + 1161);
        return v4;
      }
      uint64_t v4 = v5;
      uint64_t v6 = sub_100163E08(a2, 0);
      if (v6)
      {
        uint64_t v7 = v6;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Could not revert role - %!\n", v8, v9, v10, v11, v12, v13, v14, v7);
          uint64_t v15 = sub_100050B4C(0x1Bu);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
  return v4;
}

void sub_100166124(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v6 = sub_100165FB0(a2);
  if (v6 != -1)
  {
    uint64_t v7 = qword_100A04488;
    int v8 = v6;
    uint64_t v9 = (void *)(qword_100A04488 + 152 * v6 + 96);
    if ((*(_DWORD *)v9 - 1) >= 2) {
      sub_10025B8C0();
    }
    uint64_t v10 = *(void (**)(void, void, void))(v7 + 152 * v8 + 120);
    if (a3)
    {
      *(_DWORD *)uint64_t v9 = 0;
      BOOL v26 = v10;
      sub_100165970((uint64_t)v9);
      sub_1001659E0(v9);
      uint64_t v10 = v26;
LABEL_22:
      v10(a1, a2, a3);
      return;
    }
    *(_WORD *)(v7 + 152 * v8 + 100) = a1;
    uint64_t v19 = qword_100A04488;
    if (*(_DWORD *)(qword_100A04488 + 1164) == 4)
    {
      int v20 = *(uint64_t **)(qword_100A04488 + 48);
      if (v20)
      {
        uint64_t v21 = *v20;
        *(_WORD *)(v7 + 152 * v8 + 176) = *((_WORD *)v20 + 4);
      }
      else
      {
        uint64_t v21 = 0;
      }
      *(void *)(v7 + 152 * v8 + 168) = v21;
      uint64_t v24 = *(void *)(v19 + 64);
      if (v24)
      {
LABEL_17:
        uint64_t v25 = v7 + 152 * v8;
        *(void *)(v25 + 184) = *(void *)v24;
        *(_WORD *)(v25 + 192) = *(_WORD *)(v24 + 8);
LABEL_21:
        *(_DWORD *)uint64_t v9 = 3;
        goto LABEL_22;
      }
    }
    else
    {
      uint64_t v22 = *(uint64_t **)(qword_100A04488 + 56);
      if (v22)
      {
        uint64_t v23 = *v22;
        *(_WORD *)(v7 + 152 * v8 + 176) = *((_WORD *)v22 + 4);
      }
      else
      {
        uint64_t v23 = 0;
      }
      *(void *)(v7 + 152 * v8 + 168) = v23;
      uint64_t v24 = *(void *)(v19 + 72);
      if (v24) {
        goto LABEL_17;
      }
    }
    *(void *)(v7 + 152 * v8 + 184) = 0;
    goto LABEL_21;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Connection %d not found for %:\n", v11, v12, v13, v14, v15, v16, v17, a1);
    long long v18 = sub_100050B4C(0x1Bu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100166314(uint64_t a1, unsigned int a2)
{
  if (!a1)
  {
    uint64_t v16 = "data";
    goto LABEL_18;
  }
  __int16 v2 = a2;
  if (!a2)
  {
    uint64_t v16 = "(dataLen) > 0";
LABEL_18:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_gn.c", 753, v16);
  }
  if (a2 <= 5) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_gn.c", 757, "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE");
  }
  int v20 = *(_DWORD *)a1;
  __int16 v21 = *(_WORD *)(a1 + 4);
  if (a2 <= 0xB) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_gn.c", 758, "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE");
  }
  int v18 = *(_DWORD *)(a1 + 6);
  __int16 v19 = *(_WORD *)(a1 + 10);
  if (a2 <= 0xD) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_gn.c", 759, "ByteStream_NumReadBytesAvail(bs) >= 2");
  }
  unsigned int v4 = *(unsigned __int16 *)(a1 + 12);
  unsigned int v5 = sub_100165FB0((uint64_t)&v20);
  uint64_t v6 = qword_100A04488;
  if ((v5 & 0x80000000) == 0) {
    goto LABEL_9;
  }
  if (*(unsigned char *)(qword_100A04488 + 1160))
  {
    unsigned int v5 = 0;
LABEL_9:
    LOWORD(__len) = v2 - 14;
    uint64_t result = sub_100165B8C(qword_100A04488 + 152 * v5 + 96, 1, &v20, &v18, bswap32(v4) >> 16, 0, 0, (const void *)(a1 + 14), __len);
    if (result)
    {
      (*(void (**)(void))(v6 + 152 * v5 + 152))();
      return 0;
    }
    return result;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"BNEP write completed for non-existent connection handle\n", v8, v9, v10, v11, v12, v13, v14, __len);
    uint64_t v15 = sub_100050B4C(0x1Bu);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 122;
}

void sub_1001664C8(uint64_t a1, const void *a2, uint64_t a3)
{
  uint64_t v6 = qword_100A044C0;
  uint64_t v7 = *(void **)(qword_100A044C0 + 664);
  if (v7)
  {
    sub_100023010(v7);
    uint64_t v6 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 664) = 0;
  }
  *(_WORD *)(v6 + 672) = a3;
  if (a3)
  {
    uint64_t v8 = sub_100022FE8(4 * a3);
    *(void *)(qword_100A044C0 + 664) = v8;
    if (!v8)
    {
      int v10 = 2023;
      goto LABEL_12;
    }
    memmove(v8, a2, 4 * a3);
    uint64_t v6 = qword_100A044C0;
  }
  uint64_t v9 = *(void (**)(uint64_t, const void *, uint64_t))(v6 + 576);
  if (v9)
  {
    v9(a1, a2, a3);
    return;
  }
  int v10 = 2021;
LABEL_12:
  sub_10014C000(a1, v10);
  uint64_t v11 = qword_100A044C0;
  uint64_t v12 = *(void **)(qword_100A044C0 + 664);
  if (v12)
  {
    sub_100023010(v12);
    uint64_t v11 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 664) = 0;
  }
  *(_WORD *)(v11 + 672) = 0;
}

void sub_1001665B4(uint64_t a1, const void *a2, uint64_t a3)
{
  uint64_t v6 = qword_100A044C0;
  uint64_t v7 = *(void **)(qword_100A044C0 + 680);
  if (v7)
  {
    sub_100023010(v7);
    uint64_t v6 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 680) = 0;
  }
  *(_WORD *)(v6 + 688) = a3;
  if (a3)
  {
    uint64_t v8 = sub_100022FE8(12 * a3);
    *(void *)(qword_100A044C0 + 680) = v8;
    if (!v8)
    {
      int v10 = 2033;
      goto LABEL_12;
    }
    memmove(v8, a2, 12 * a3);
    uint64_t v6 = qword_100A044C0;
  }
  uint64_t v9 = *(void (**)(uint64_t, const void *, uint64_t))(v6 + 584);
  if (v9)
  {
    v9(a1, a2, a3);
    return;
  }
  int v10 = 2031;
LABEL_12:
  sub_10014C068(a1, v10);
  uint64_t v11 = qword_100A044C0;
  uint64_t v12 = *(void **)(qword_100A044C0 + 680);
  if (v12)
  {
    sub_100023010(v12);
    uint64_t v11 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 680) = 0;
  }
  *(_WORD *)(v11 + 688) = 0;
}

uint64_t sub_1001666A4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, int a7)
{
  if (sub_100163C58(2)) {
    return 119;
  }
  long long v27 = 0u;
  long long v28 = 0u;
  if (sub_100163C58(2))
  {
    uint64_t v15 = qword_100A044C0;
  }
  else
  {
    uint64_t v17 = sub_100163C88(2);
    if (v17)
    {
      uint64_t v14 = v17;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"PAN_RegisterRole inside PANU internalInit failed - %!\n", v18, v19, v20, v21, v22, v23, v24, v14);
        uint64_t v25 = sub_100050B4C(0x1Bu);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      goto LABEL_21;
    }
    qword_100A044C0 = (uint64_t)sub_10010CE48(0x2D0uLL);
    if (!qword_100A044C0)
    {
      sub_100163D28(2);
      uint64_t v14 = 106;
      goto LABEL_21;
    }
    qword_100A044D8 = (uint64_t)sub_100022FE8(0x5EAuLL);
    uint64_t v15 = qword_100A044C0;
    *(_OWORD *)(qword_100A044C0 + 600) = *(_OWORD *)&off_10099D150;
    *(_OWORD *)(v15 + 616) = *(_OWORD *)off_10099D160;
  }
  *(void *)(v15 + 568) = a1;
  *(void *)(v15 + 576) = a2;
  *(void *)(v15 + 696) = a3;
  *(void *)(v15 + 584) = a4;
  *(void *)(v15 + 704) = a5;
  if (a3)
  {
    *(void *)(v15 + 632) = *(void *)a3;
    *(_WORD *)(v15 + 640) = *(_WORD *)(a3 + 8);
  }
  if (a5)
  {
    *(void *)(v15 + 648) = *(void *)a5;
    *(_WORD *)(v15 + 656) = *(_WORD *)(a5 + 8);
  }
  uint64_t v14 = sub_10014AF34(4111, 4373, (uint64_t)sub_1001668B0);
  uint64_t v16 = qword_100A044C0;
  *(_WORD *)(qword_100A044C0 + 562) = 0;
  if (v14) {
    goto LABEL_21;
  }
  if (!a6) {
    return 0;
  }
  *(void *)&long long v27 = &unk_10099D090;
  WORD4(v27) = 4;
  *(void *)&long long v28 = *(void *)a6;
  WORD4(v28) = *(_WORD *)(a6 + 8);
  byte_100A044C8 = 1;
  word_100A044CA = 2;
  dword_100A044D0 = a7;
  uint64_t v14 = sub_10024E258((uint64_t)&v27, (int *)(v16 + 592));
  if (v14)
  {
    sub_10014B4AC(4111, 4373);
LABEL_21:
    sub_100166A40();
  }
  return v14;
}

void sub_1001668B0(uint64_t a1, uint64_t a2, int a3, int a4)
{
  unsigned int v8 = sub_100167184(a2);
  uint64_t v9 = qword_100A044C0;
  if (v8 == -1)
  {
    unsigned int v10 = *(unsigned __int8 *)(qword_100A044C0 + 560);
    if (v10 > 6) {
      goto LABEL_12;
    }
    *(unsigned char *)(qword_100A044C0 + 560) = v10 + 1;
    uint64_t v11 = v9 + 80 * v10;
    int v12 = *(_DWORD *)a2;
    *(_WORD *)(v11 + 10) = *(_WORD *)(a2 + 4);
    *(_DWORD *)(v11 + 6) = v12;
    *(_DWORD *)(v11 + 12) = 0;
    *(_WORD *)(v11 + 16) = 0;
    *(_WORD *)(v11 + 4) = a1;
    *(unsigned char *)(v11 + 72) = a4 == a3;
  }
  else
  {
    if (!qword_100A044C0) {
      goto LABEL_12;
    }
    unsigned int v10 = v8;
  }
  uint64_t v13 = (_DWORD *)(v9 + 80 * (int)v10);
  if (*v13 == 1)
  {
LABEL_9:
    BOOL v26 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(v9 + 568);
    uint64_t v14 = sub_100163BC8(a3);
    uint64_t v15 = sub_100163BC8(a4);
    v26(a1, a2, v14, v15);
    return;
  }
  if (!*v13)
  {
    *uint64_t v13 = 1;
    goto LABEL_9;
  }
LABEL_12:
  uint64_t v16 = sub_10014BAB0(a1, 0, 0, 0, (long long *)&unk_10099D120);
  if (v16)
  {
    uint64_t v17 = v16;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Reject incoming connection failed - %!\n", v18, v19, v20, v21, v22, v23, v24, v17);
      uint64_t v25 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_100166A40()
{
  if (!sub_100163C58(2)) {
    return;
  }
  uint64_t v0 = sub_100163D28(2);
  if (v0)
  {
    uint64_t v1 = v0;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"PAN_DeregisterRole failed inside PANU internalTerminate - %!\n", v2, v3, v4, v5, v6, v7, v8, v1);
      uint64_t v9 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v10 = qword_100A044C0;
  uint64_t v11 = *(void **)(qword_100A044C0 + 696);
  uint64_t v12 = *(void *)(qword_100A044C0 + 632);
  if (v11)
  {
    if (v12 != *v11 && v12 != 0) {
      goto LABEL_11;
    }
  }
  else if (v12)
  {
LABEL_11:
    sub_100023010(*(void **)(qword_100A044C0 + 632));
    uint64_t v10 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 632) = 0;
  }
  uint64_t v14 = *(void **)(v10 + 704);
  uint64_t v15 = *(void *)(v10 + 648);
  if (v14)
  {
    if (v15 == *v14 || v15 == 0) {
      goto LABEL_18;
    }
  }
  else if (!v15)
  {
    goto LABEL_18;
  }
  sub_100023010(*(void **)(v10 + 648));
  uint64_t v10 = qword_100A044C0;
  *(void *)(qword_100A044C0 + 648) = 0;
LABEL_18:
  if (*(void *)(v10 + 664))
  {
    sub_100023010(*(void **)(v10 + 664));
    uint64_t v10 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 664) = 0;
  }
  if (*(void *)(v10 + 680))
  {
    sub_100023010(*(void **)(v10 + 680));
    uint64_t v10 = qword_100A044C0;
    *(void *)(qword_100A044C0 + 680) = 0;
  }
  sub_100023010((void *)v10);
  qword_100A044C0 = 0;
}

uint64_t sub_100166B6C()
{
  if (!sub_100163C58(2)) {
    return 408;
  }
  int v0 = *(_DWORD *)(qword_100A044C0 + 592);
  if (!v0 || (uint64_t result = sub_10024E448(v0), !result))
  {
    uint64_t result = sub_10014B4AC(4111, 4373);
    if (!result)
    {
      sub_100166A40();
      return 0;
    }
  }
  return result;
}

uint64_t sub_100166BC4(unsigned int a1, uint64_t a2, uint64_t (*a3)(uint64_t (*)(int *a1, unsigned int a2)), uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, int a8)
{
  uint64_t v8 = qword_100A044C0;
  if (!*(unsigned char *)(qword_100A044C0 + 560)) {
    return 122;
  }
  uint64_t v11 = 0;
  while (1)
  {
    uint64_t v12 = (_DWORD *)(qword_100A044C0 + v11);
    if (*(unsigned __int16 *)(qword_100A044C0 + v11 + 4) == a1) {
      break;
    }
    v11 += 80;
    if (80 * *(unsigned __int8 *)(qword_100A044C0 + 560) == v11) {
      return 122;
    }
  }
  if (v11 == 0x4FFFFFFFB0) {
    return 122;
  }
  if (a8)
  {
    uint64_t v15 = (void *)(qword_100A044C0 + v11);
    v15[4] = a3;
    v15[5] = a4;
    v15[6] = a5;
    v15[7] = a6;
    v15[8] = a7;
    BOOL v16 = a3(sub_100167534) == 0;
  }
  else
  {
    BOOL v16 = 0;
  }
  if (*v12 != 1) {
    return 408;
  }
  if (*(unsigned char *)(v8 + v11 + 72)) {
    uint64_t v17 = (long long *)&unk_10099D0F0;
  }
  else {
    uint64_t v17 = (long long *)&unk_10099D120;
  }
  uint64_t v18 = sub_10014BAB0(a1, (uint64_t)sub_100166D28, qword_100A044C0 + 600, v16, v17);
  if (v18) {
    BOOL v19 = 0;
  }
  else {
    BOOL v19 = v16;
  }
  if (v19)
  {
    uint64_t v13 = 0;
    *(void *)(v8 + v11 + 24) = a2;
  }
  else
  {
    uint64_t v13 = v18;
    if (v16 && v18) {
      (*(void (**)(void))(v8 + v11 + 40))();
    }
    _DWORD *v12 = 0;
    sub_100166ED8(v8 + v11);
  }
  return v13;
}

void sub_100166D28(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v6 = sub_100167184(a2);
  if (v6 == -1 || (uint64_t v7 = qword_100A044C0) == 0)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Connection %d not found for %:\n", v10, v11, v12, v13, v14, v15, v16, a1);
      uint64_t v17 = sub_100050B4C(0x1Bu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    int v8 = v6;
    uint64_t v9 = qword_100A044C0 + 80 * v6;
    (*(void (**)(uint64_t, uint64_t, uint64_t))(v9 + 24))(a1, a2, a3);
    if ((*(_DWORD *)v9 - 1) >= 2) {
      sub_10025B8C0();
    }
    if (a3)
    {
      *(_DWORD *)uint64_t v9 = 0;
      (*(void (**)(void))(v7 + 80 * v8 + 40))();
      sub_100166ED8(v9);
    }
    else
    {
      uint64_t v18 = v7 + 80 * v8;
      *(_WORD *)(v18 + 4) = a1;
      *(_DWORD *)uint64_t v9 = 3;
      *(unsigned char *)(v18 + 73) = 1;
      if (!*(_DWORD *)(qword_100A044C0 + 712) && *(unsigned char *)(v7 + 80 * v8 + 72))
      {
        BOOL v19 = (int *)(qword_100A044C0 + 712);
        sub_1000268E4((uint64_t)sub_1001677CC, 0, 1200, v19);
      }
    }
  }
}

uint64_t sub_100166ED8(uint64_t result)
{
  uint64_t v1 = qword_100A044C0;
  unint64_t v2 = 0xCCCCCCCCCCCCCCCDLL * ((result - qword_100A044C0) >> 4);
  unsigned int v3 = v2 + 1;
  if ((v2 + 1) <= 6)
  {
    uint64_t v4 = (_OWORD *)(qword_100A044C0 + 80 * (int)v2);
    uint64_t v5 = (_OWORD *)(qword_100A044C0 + 80 * v3);
    do
    {
      *uint64_t v4 = *v5;
      long long v6 = v5[1];
      long long v7 = v5[2];
      long long v8 = v5[4];
      v4[3] = v5[3];
      v4[4] = v8;
      v4[1] = v6;
      v4[2] = v7;
      v4 += 5;
      v5 += 5;
      ++v3;
    }
    while (v3 < 7);
  }
  --*(unsigned char *)(v1 + 560);
  return result;
}

uint64_t sub_100166F48(__int16 a1, uint64_t a2, int a3, uint64_t a4, uint64_t (*a5)(uint64_t (*)(int *a1, unsigned int a2)), void (*a6)(void), uint64_t a7, uint64_t a8, uint64_t a9)
{
  signed int v17 = sub_100167184(a2);
  uint64_t v18 = qword_100A044C0;
  if (v17 != -1)
  {
    if (qword_100A044C0)
    {
      __int16 v35 = a1;
      BOOL v19 = a6;
      signed int v20 = v17;
      goto LABEL_6;
    }
    return 104;
  }
  __int16 v35 = a1;
  signed int v20 = *(unsigned __int8 *)(qword_100A044C0 + 560);
  if (v20 > 6) {
    return 104;
  }
  BOOL v19 = a6;
  *(unsigned char *)(qword_100A044C0 + 560) = v20 + 1;
  uint64_t v21 = v18 + 80 * v20;
  int v22 = *(_DWORD *)a2;
  *(_WORD *)(v21 + 10) = *(_WORD *)(a2 + 4);
  *(_DWORD *)(v21 + 6) = v22;
  *(_DWORD *)(v21 + 12) = 0;
  *(_WORD *)(v21 + 16) = 0;
LABEL_6:
  uint64_t v23 = (_DWORD *)(v18 + 80 * v20);
  if (*v23)
  {
    sub_100166ED8((uint64_t)v23);
    return 408;
  }
  else
  {
    uint64_t v34 = v18 + 80 * v20;
    *(void *)(v34 + 32) = a5;
    uint64_t v33 = v19;
    *(void *)(v34 + 40) = v19;
    *(void *)(v34 + 48) = a7;
    *(void *)(v34 + 56) = a8;
    *(void *)(v34 + 64) = a9;
    uint64_t v25 = a5(sub_100167534);
    uint64_t v26 = a8;
    uint64_t v24 = v25;
    if (!v25)
    {
      uint64_t v32 = (void (**)(void))(v34 + 40);
      uint64_t v31 = v26;
      if (a3 == 15)
      {
        long long v27 = &unk_10099D120;
        int v28 = 15;
      }
      else
      {
        long long v27 = &unk_10099D0F0;
        int v28 = a3;
      }
      uint64_t v24 = sub_10014B564(v28, (uint64_t)sub_100166D28, qword_100A044C0 + 600, a2, 4373, v35, (uint64_t)v27);
      if (v24)
      {
        (*v32)();
        sub_100166ED8(v34);
      }
      else
      {
        uint64_t v29 = v18 + 80 * v20;
        *(void *)(v29 + 24) = a4;
        *(void *)(v34 + 32) = a5;
        *uint64_t v32 = v33;
        *(void *)(v34 + 48) = a7;
        *(void *)(v34 + 56) = v31;
        *(void *)(v34 + 64) = a9;
        *(unsigned char *)(v29 + 72) = a3 != 15;
        *(_DWORD *)uint64_t v34 = 2;
      }
    }
  }
  return v24;
}

uint64_t sub_100167184(uint64_t a1)
{
  if (!*(unsigned char *)(qword_100A044C0 + 560)) {
    return 0xFFFFFFFFLL;
  }
  uint64_t result = 0;
  for (uint64_t i = qword_100A044C0 + 6;
        *(_DWORD *)i != *(_DWORD *)a1 || *(unsigned __int16 *)(i + 4) != *(unsigned __int16 *)(a1 + 4);
        i += 80)
  {
    if (*(unsigned __int8 *)(qword_100A044C0 + 560) == ++result) {
      return 0xFFFFFFFFLL;
    }
  }
  return result;
}

uint64_t sub_1001671D4(unsigned int a1, int a2)
{
  if (a2) {
    goto LABEL_2;
  }
  uint64_t v3 = sub_100164384(qword_100A044C0 + 664, qword_100A044C0 + 632, *(void *)(qword_100A044C0 + 696));
  if (!v3)
  {
    a2 = 0;
LABEL_2:
    uint64_t v3 = sub_10014C000(a1, a2);
  }
  uint64_t v4 = *(void **)(qword_100A044C0 + 664);
  if (v4)
  {
    sub_100023010(v4);
    *(void *)(qword_100A044C0 + 664) = 0;
  }
  return v3;
}

uint64_t sub_100167254(unsigned int a1, int a2)
{
  if (a2) {
    goto LABEL_2;
  }
  uint64_t v3 = sub_100164464(qword_100A044C0 + 680, qword_100A044C0 + 648, *(void *)(qword_100A044C0 + 704));
  if (!v3)
  {
    a2 = 0;
LABEL_2:
    uint64_t v3 = sub_10014C068(a1, a2);
  }
  uint64_t v4 = *(void **)(qword_100A044C0 + 680);
  if (v4)
  {
    sub_100023010(v4);
    *(void *)(qword_100A044C0 + 680) = 0;
  }
  return v3;
}

uint64_t sub_1001672D4(uint64_t result, uint64_t a2)
{
  uint64_t v2 = qword_100A044C0;
  uint64_t v3 = *(unsigned __int8 *)(qword_100A044C0 + 560);
  if (*(unsigned char *)(qword_100A044C0 + 560))
  {
    uint64_t v5 = result;
    uint64_t v6 = 0xFFFFFFFFLL;
    while (*(unsigned __int16 *)(v2 + 4) != result)
    {
      v2 += 80;
      --v6;
      if (!--v3) {
        return result;
      }
    }
    if (v6)
    {
      *(_DWORD *)uint64_t v2 = 0;
      (*(void (**)(void))(v2 + 40))();
      long long v7 = *(void (**)(uint64_t, uint64_t))(v2 + 64);
      sub_100166ED8(v2);
      v7(v5, a2);
      uint64_t result = *(unsigned int *)(qword_100A044C0 + 712);
      if (result)
      {
        if (!*(unsigned char *)(qword_100A044C0 + 560))
        {
          uint64_t result = sub_100026DB4(result);
          *(_DWORD *)(qword_100A044C0 + 712) = 0;
        }
      }
    }
  }
  return result;
}

void sub_100167384(int a1, int *a2, int *a3, unsigned int a4, int a5, int a6, void *__src, size_t __len)
{
  uint64_t v8 = qword_100A044D8;
  if (!qword_100A044D8) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_user.c", 484, "PANU_RecvBuf");
  }
  __int16 v9 = __len;
  int v12 = *a2;
  *(_WORD *)(qword_100A044D8 + 4) = *((_WORD *)a2 + 2);
  *(_DWORD *)uint64_t v8 = v12;
  int v13 = *a3;
  *(_WORD *)(v8 + 10) = *((_WORD *)a3 + 2);
  *(_DWORD *)(v8 + 6) = v13;
  *(_WORD *)(v8 + 12) = __rev16(a4);
  if (__len >= 0x5DD)
  {
    sub_10025B8C0();
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_user.c", 497, "ByteStream_NumReadBytesAvail(bs) >= (dataLen)");
  }
  memmove((void *)(v8 + 14), __src, __len);
  uint64_t v15 = *(unsigned __int8 *)(qword_100A044C0 + 560);
  if (*(unsigned char *)(qword_100A044C0 + 560))
  {
    uint64_t v16 = qword_100A044C0 + 48;
    uint64_t v17 = 0xFFFFFFFFLL;
    while (*(unsigned __int16 *)(v16 - 44) != a1)
    {
      --v17;
      v16 += 80;
      if (!--v15) {
        return;
      }
    }
    if (v17)
    {
      if (*(_DWORD *)(v16 - 36)) {
        BOOL v18 = 0;
      }
      else {
        BOOL v18 = *(unsigned __int16 *)(v16 - 32) == 0;
      }
      if (v18 || (char v19 = *(unsigned char *)a2, (*(unsigned char *)a2 & 1) == 0))
      {
        int v20 = *a3;
        *(_WORD *)(v16 - 32) = *((_WORD *)a3 + 2);
        *(_DWORD *)(v16 - 36) = v20;
        char v19 = *(unsigned char *)a2;
      }
      if ((v19 & 1) == 0) {
        *(unsigned char *)(v16 + 25) = 1;
      }
      uint64_t v21 = (*(uint64_t (**)(uint64_t, void))v16)(v8, (unsigned __int16)(v9 + 14));
      if (v21)
      {
        uint64_t v22 = v21;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Forwarding packet to host failed - %!\n", v23, v24, v25, v26, v27, v28, v29, v22);
          uint64_t v30 = sub_100050B4C(0x1Bu);
          if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
}

uint64_t sub_100167534(int *a1, unsigned int a2)
{
  if (!a1)
  {
    char v19 = "data";
    goto LABEL_36;
  }
  __int16 v2 = a2;
  if (!a2)
  {
    char v19 = "(dataLen) > 0";
LABEL_36:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_user.c", 424, v19);
  }
  if (a2 <= 5) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_user.c", 428, "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE");
  }
  int v22 = *a1;
  unsigned __int16 v23 = *((_WORD *)a1 + 2);
  if (a2 <= 0xB) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_user.c", 429, "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE");
  }
  int v20 = *(int *)((char *)a1 + 6);
  __int16 v21 = *((_WORD *)a1 + 5);
  if (a2 <= 0xD) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pan/pan_user.c", 430, "ByteStream_NumReadBytesAvail(bs) >= 2");
  }
  unsigned int v4 = bswap32(*((unsigned __int16 *)a1 + 6)) >> 16;
  if (!sub_100164270((uint64_t)&v22, v4, (unsigned __int16 *)(qword_100A044C0 + 632), (uint64_t *)(qword_100A044C0 + 648)))return 2041; {
  uint64_t v5 = qword_100A044C0;
  }
  if (!*(unsigned char *)(qword_100A044C0 + 560)) {
    return 122;
  }
  uint64_t v6 = 0;
  unint64_t v7 = 0;
  int v8 = 0;
  __int16 v9 = (char *)a1 + 14;
  unsigned __int16 v10 = v2 - 14;
  do
  {
    if (*(_DWORD *)(v5 + v6) == 3)
    {
      if ((v22 & 1) != 0
        || (v22 == *(_DWORD *)(v5 + v6 + 12) ? (BOOL v11 = v23 == *(unsigned __int16 *)(v5 + v6 + 16)) : (BOOL v11 = 0), v11))
      {
        uint64_t v12 = v5 + v6;
        if (v20 != *(_DWORD *)(v5 + v6 + 12) || v21 != *(_WORD *)(v5 + v6 + 16))
        {
          int v14 = *(_DWORD *)(v12 + 12);
          int v15 = *(unsigned __int16 *)(v12 + 16);
          if (v22 == v14 && v23 == v15) {
            *(unsigned char *)(v5 + v6 + 73) = 1;
          }
          int v17 = sub_10014BEA4((uint64_t)sub_100167770, *(unsigned __int16 *)(v5 + v6 + 4), (uint64_t)&v22, (uint64_t)&v20, v4, 0, 0, v9, v10);
          uint64_t v5 = qword_100A044C0;
          if (!v17)
          {
            ++*(_WORD *)(qword_100A044C0 + 562);
            int v8 = 1;
          }
        }
      }
    }
    ++v7;
    v6 += 80;
  }
  while (v7 < *(unsigned __int8 *)(v5 + 560));
  if (v8) {
    return 0;
  }
  else {
    return 122;
  }
}

uint64_t sub_100167770(uint64_t result)
{
  uint64_t v1 = qword_100A044C0;
  __int16 v2 = *(_WORD *)(qword_100A044C0 + 562) - 1;
  *(_WORD *)(qword_100A044C0 + 562) = v2;
  uint64_t v3 = *(unsigned __int8 *)(v1 + 560);
  if (*(unsigned char *)(v1 + 560))
  {
    unsigned int v4 = (uint64_t (**)(void))(v1 + 56);
    uint64_t v5 = 0xFFFFFFFFLL;
    while (*((unsigned __int16 *)v4 - 26) != result)
    {
      --v5;
      v4 += 10;
      if (!--v3) {
        return result;
      }
    }
    if (v5)
    {
      if (!v2) {
        return (*v4)();
      }
    }
  }
  return result;
}

void sub_1001677CC()
{
  uint64_t v0 = qword_100A044C0;
  if (!*(unsigned char *)(qword_100A044C0 + 560)) {
    goto LABEL_14;
  }
  uint64_t v1 = 0;
  unint64_t v2 = 0;
  char v3 = 0;
  do
  {
    if (*(unsigned char *)(v0 + v1 + 72))
    {
      if (*(unsigned char *)(v0 + v1 + 73))
      {
        char v3 = 1;
      }
      else
      {
        int v4 = sub_10014BE1C(*(unsigned __int16 *)(v0 + v1 + 4));
        uint64_t v0 = qword_100A044C0;
        if (!v4) {
          *(_DWORD *)(qword_100A044C0 + v1) = 4;
        }
      }
      *(unsigned char *)(v0 + v1 + 73) = 0;
    }
    ++v2;
    v1 += 80;
  }
  while (v2 < *(unsigned __int8 *)(v0 + 560));
  if (v3)
  {
    sub_1000268E4((uint64_t)sub_1001677CC, 0, 1200, (int *)(v0 + 712));
  }
  else
  {
LABEL_14:
    *(_DWORD *)(v0 + 712) = 0;
  }
}

void sub_1001678B0(uint64_t a1)
{
  *(unsigned char *)(qword_100A044E0 + 128) = 4;
  unsigned int v1 = *(unsigned __int8 *)(a1 + 8);
  if (*(unsigned char *)(a1 + 8))
  {
    uint64_t v3 = 0;
    unint64_t v4 = 0;
    do
    {
      int v5 = *(unsigned __int8 *)(*(void *)a1 + v3);
      if (v5 == 152)
      {
        *(unsigned char *)(qword_100A044E0 + 128) = 2;
      }
      else if (v5 == 151)
      {
        sub_10025B8C0();
        unsigned int v1 = *(unsigned __int8 *)(a1 + 8);
      }
      ++v4;
      v3 += 24;
    }
    while (v4 < v1);
  }
}

uint64_t sub_100167940(unsigned int a1, uint64_t a2, int a3)
{
  if (a3 != 1752 && a3 != 1701)
  {
    uint64_t v7 = 0;
    goto LABEL_109;
  }
  uint64_t v6 = qword_100A044E0;
  if (!*(unsigned char *)(qword_100A044E0 + 201))
  {
    if (*(_DWORD *)qword_100A044E0 >= 2u)
    {
      if (*(unsigned char *)(qword_100A044E0 + 128))
      {
        sub_1001678B0(a2);
        uint64_t v6 = qword_100A044E0;
      }
      if ((*(unsigned int (**)(void, void, void, void))(*(void *)(v6 + 16) + 32))(*(void *)(v6 + 8), *(unsigned __int16 *)(v6 + 24), sub_10016806C, *(unsigned __int16 *)(v6 + 26)))
      {
        uint64_t v7 = sub_100113A54(a1, 0, 1701);
        if (v7)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Failed to inform client of read failure", v8, v9, v10, v11, v12, v13, v14, v78);
            int v15 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
              goto LABEL_89;
            }
          }
        }
        goto LABEL_109;
      }
      return 0;
    }
    *(_DWORD *)(qword_100A044E0 + 124) = 1;
    *(unsigned char *)(v6 + 120) = 0;
    *(unsigned char *)(v6 + 128) = 0;
    *(unsigned char *)(v6 + 140) = 0;
    *(unsigned char *)(v6 + 148) = 0;
    *(unsigned char *)(v6 + 161) = 0;
    *(unsigned char *)(v6 + 164) = 0;
    *(unsigned char *)(v6 + 168) = 0;
    *(unsigned char *)(v6 + 180) = 0;
    *(unsigned char *)(v6 + 188) = 0;
    *(unsigned char *)(v6 + 196) = 0;
    *(_DWORD *)(v6 + 136) = 0;
    uint64_t v16 = *(void **)(v6 + 152);
    if (v16)
    {
      sub_100023010(v16);
      uint64_t v6 = qword_100A044E0;
      *(void *)(qword_100A044E0 + 152) = 0;
    }
    *(unsigned char *)(v6 + 160) = 0;
    *(_DWORD *)(v6 + 144) = 0;
    *(_WORD *)(v6 + 162) = -1;
    *(_WORD *)(v6 + 166) = 0;
    *(_DWORD *)(v6 + 172) = 0;
    *(_DWORD *)(v6 + 176) = 0;
    *(_DWORD *)(v6 + 184) = 0;
  }
  if (*(unsigned char *)(a2 + 8))
  {
    uint64_t v17 = 0;
    unint64_t v18 = 0;
    while (1)
    {
      uint64_t v19 = *(void *)a2;
      unsigned int v20 = *(unsigned __int8 *)(*(void *)a2 + v17);
      if (v20 <= 0x4B)
      {
        if (v20 == 1)
        {
          uint64_t v28 = (unsigned __int16 *)(qword_100A044E0 + 112);
          if (!*(_WORD *)(qword_100A044E0 + 112))
          {
            uint64_t v29 = v19 + v17;
            if (*(void *)(v29 + 16))
            {
              uint64_t v27 = sub_100169744((unsigned __int16 *)(v29 + 8), (void *)(qword_100A044E0 + 80), v28);
              if (v27) {
                goto LABEL_86;
              }
            }
            else
            {
              *uint64_t v28 = 0;
            }
          }
        }
        else if (v20 == 66)
        {
          uint64_t v23 = v19 + v17;
          if (!*(_WORD *)(v19 + v17 + 8) || (uint64_t v24 = *(unsigned __int8 **)(v23 + 16)) == 0)
          {
LABEL_61:
            uint64_t v7 = 1735;
            goto LABEL_87;
          }
          if (sub_100262E60(v24, "x-bt/vcard-listing", 18))
          {
            if (sub_100262E60(*(unsigned __int8 **)(v23 + 16), "x-bt/vcard", 10))
            {
              if (sub_100262E60(*(unsigned __int8 **)(v23 + 16), "x-bt/phonebook", 14)) {
                goto LABEL_61;
              }
              uint64_t v25 = qword_100A044E0;
              int v26 = 2;
            }
            else
            {
              uint64_t v25 = qword_100A044E0;
              int v26 = 1;
            }
            *(_DWORD *)(v25 + 124) = v26;
          }
          else
          {
            *(_DWORD *)(qword_100A044E0 + 124) = 0;
          }
        }
      }
      else if (v20 == 76)
      {
        if (*(_WORD *)(v19 + v17 + 8))
        {
          uint64_t v27 = sub_100169830((unsigned __int16 *)(v19 + v17 + 8));
          if (v27)
          {
LABEL_86:
            uint64_t v7 = v27;
LABEL_87:
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Failed to parse OBEX header", v58, v59, v60, v61, v62, v63, v64, v78);
              uint64_t v65 = sub_100050B4C(0x1Du);
              if (os_log_type_enabled(v65, OS_LOG_TYPE_ERROR)) {
LABEL_89:
              }
                sub_100748324();
            }
LABEL_109:
            uint64_t v71 = qword_100A044E0;
            if (!*(unsigned char *)(qword_100A044E0 + 201) && *(_DWORD *)qword_100A044E0 >= 2u)
            {
              uint64_t v72 = *(void *)(qword_100A044E0 + 8);
              if (v72)
              {
                *(void *)(qword_100A044E0 + 8) = 0;
                sub_10016829C(v72, *(_WORD *)(v71 + 26), a3);
                uint64_t v71 = qword_100A044E0;
              }
            }
            uint64_t v73 = *(void **)(v71 + 80);
            if (v73)
            {
              sub_100023010(v73);
              uint64_t v71 = qword_100A044E0;
              *(void *)(qword_100A044E0 + 80) = 0;
            }
            *(_WORD *)(v71 + 112) = 0;
            uint64_t v74 = *(void **)(v71 + 152);
            if (v74)
            {
              sub_100023010(v74);
              uint64_t v71 = qword_100A044E0;
              *(void *)(qword_100A044E0 + 152) = 0;
            }
            *(unsigned char *)(v71 + 201) = 0;
            *(_DWORD *)uint64_t v71 = 1;
            *(unsigned char *)(v71 + 128) = 0;
            return v7;
          }
        }
      }
      else
      {
        if (v20 != 151)
        {
          if (v20 != 152 || *(unsigned char *)(v19 + v17 + 8) != 1) {
            goto LABEL_45;
          }
          uint64_t v21 = qword_100A044E0;
          char v22 = *(unsigned char *)(qword_100A044E0 + 128) | 2;
          goto LABEL_37;
        }
        if (*(unsigned char *)(v19 + v17 + 8) == 1)
        {
          uint64_t v21 = qword_100A044E0;
          char v22 = *(unsigned char *)(qword_100A044E0 + 128) | 1;
LABEL_37:
          *(unsigned char *)(v21 + 128) = v22;
        }
      }
LABEL_45:
      ++v18;
      v17 += 24;
      if (v18 >= *(unsigned __int8 *)(a2 + 8))
      {
        uint64_t v6 = qword_100A044E0;
        break;
      }
    }
  }
  *(unsigned char *)(v6 + 201) = a3 == 1752;
  if (a3 != 1752)
  {
    if (*(unsigned char *)(v6 + 164) && !*(_WORD *)(v6 + 162))
    {
      unsigned int v79 = 0;
      *(_DWORD *)uint64_t v6 = 3;
      uint64_t v56 = (unsigned int *)(v6 + 68);
      if (*(_DWORD *)(v6 + 124)) {
        uint64_t v57 = sub_10016A26C((int *)&v79, v56);
      }
      else {
        uint64_t v57 = sub_10016A194((int *)&v79, v56);
      }
      uint64_t v7 = v57;
      if (!v57)
      {
        uint64_t v66 = qword_100A044E0;
        if (*(_DWORD *)(qword_100A044E0 + 68) == 3) {
          *(unsigned char *)(qword_100A044E0 + 120) = 1;
        }
        (*(void (**)(void, void))(v66 + 48))(*(unsigned __int16 *)(v66 + 26), v79);
        uint64_t v7 = 0;
      }
      goto LABEL_108;
    }
    unsigned int v80 = 0;
    int v38 = *(_DWORD *)(v6 + 124);
    if (v38 != 1)
    {
      uint64_t v39 = (unsigned int *)(v6 + 68);
      if (!v38)
      {
        uint64_t v7 = sub_10016A194((int *)&v80, v39);
        if (!v7)
        {
          uint64_t v40 = qword_100A044E0;
          if (*(_DWORD *)(qword_100A044E0 + 68) == 3) {
            *(unsigned char *)(qword_100A044E0 + 120) = 1;
          }
          *(_DWORD *)uint64_t v40 = 4;
          uint64_t v41 = (**(uint64_t (***)(void))(v40 + 16))(v80);
          goto LABEL_81;
        }
LABEL_107:
        *(_DWORD *)qword_100A044E0 = 1;
LABEL_108:
        if (v7) {
          goto LABEL_109;
        }
        uint64_t v76 = qword_100A044E0;
        uint64_t v77 = *(void **)(qword_100A044E0 + 80);
        if (v77)
        {
          sub_100023010(v77);
          uint64_t v76 = qword_100A044E0;
          *(void *)(qword_100A044E0 + 80) = 0;
        }
        uint64_t v7 = 0;
        *(_WORD *)(v76 + 112) = 0;
        return v7;
      }
      uint64_t v7 = sub_10016A26C((int *)&v80, v39);
      if (v7) {
        goto LABEL_107;
      }
      uint64_t v55 = qword_100A044E0;
      if (*(_DWORD *)(qword_100A044E0 + 68) == 3) {
        *(unsigned char *)(qword_100A044E0 + 120) = 1;
      }
      *(_DWORD *)uint64_t v55 = 2;
      uint64_t v41 = (*(uint64_t (**)(void))(*(void *)(v55 + 16) + 8))(v80);
LABEL_81:
      uint64_t v7 = v41;
      if (!v41) {
        goto LABEL_108;
      }
      goto LABEL_107;
    }
    int v42 = sub_100262BF8((unsigned __int16 *)".");
    uint64_t v43 = sub_10016A340((unsigned __int16 **)(qword_100A044E0 + 80), *(unsigned __int16 *)(qword_100A044E0 + 112), (int *)&v80);
    uint64_t v44 = qword_100A044E0;
    unsigned int v45 = *(unsigned __int16 *)(qword_100A044E0 + 112);
    uint64_t v46 = v80;
    if (v45 != 4 || v80 != 0)
    {
      uint64_t v7 = v43;
      if (v43) {
        goto LABEL_107;
      }
      uint64_t v48 = (_DWORD *)(v6 + 68);
      if (*(unsigned char *)(qword_100A044E0 + 73))
      {
        if (v45 != 1) {
          goto LABEL_106;
        }
        *uint64_t v48 = *(_DWORD *)(qword_100A044E0 + 68);
      }
      else
      {
        if (v45 < 2) {
          goto LABEL_106;
        }
        uint64_t v7 = sub_10016A3E4(*(unsigned __int16 **)(qword_100A044E0 + 8 * (v45 - 2) + 80), v48);
        if (v7) {
          goto LABEL_107;
        }
        uint64_t v44 = qword_100A044E0;
      }
      uint64_t v49 = *(unsigned __int16 **)(v44 + 8 * *(unsigned __int16 *)(v44 + 112) + 72);
      unsigned int v50 = sub_100262BF8(v49);
      uint64_t v51 = v50 - v42;
      int v52 = sub_100262C30(&v49[v51], (unsigned __int16 *)".");
      if (v50 <= 0xF && v52 == 0)
      {
        if (v50 == v42)
        {
          uint64_t v54 = 0;
        }
        else
        {
          LODWORD(v54) = 0;
          do
          {
            int v68 = *v49++;
            int v67 = v68;
            int v69 = v68 - 48;
            if ((v68 - 48) >= 0xA)
            {
              if ((v67 - 71) > 0xFFFFFFF9)
              {
                int v69 = v67 - 55;
              }
              else
              {
                if ((v67 - 103) < 0xFFFFFFFA) {
                  goto LABEL_106;
                }
                int v69 = v67 - 87;
              }
            }
            uint64_t v54 = (v69 + 16 * v54);
            --v51;
          }
          while (v51);
        }
        uint64_t v70 = qword_100A044E0;
        *(_DWORD *)qword_100A044E0 = 5;
        uint64_t v41 = (*(uint64_t (**)(uint64_t, void, uint64_t, uint64_t, void, void (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t), void))(*(void *)(v70 + 16) + 16))(v46, *(unsigned int *)(v70 + 68), v54, v70 + 172, *(unsigned int *)(v70 + 184), sub_10016A460, *(unsigned __int16 *)(v70 + 26));
        goto LABEL_81;
      }
    }
LABEL_106:
    uint64_t v7 = 1724;
    goto LABEL_107;
  }
  uint64_t v7 = sub_100113A54(a1, 0, 1701);
  if (v7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to send OBEX GET repsonse", v30, v31, v32, v33, v34, v35, v36, v78);
      uint64_t v37 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        goto LABEL_89;
      }
    }
    goto LABEL_109;
  }
  return v7;
}

void sub_10016806C(uint64_t a1, uint64_t a2, __int16 a3, uint64_t a4)
{
  uint64_t v43 = 0;
  uint64_t v44 = 0;
  uint64_t v42 = 0;
  uint64_t v4 = qword_100A044E0;
  BOOL v5 = *(_DWORD *)qword_100A044E0 > 5u || ((1 << *(_DWORD *)qword_100A044E0) & 0x34) == 0;
  if (v5 || *(void *)(qword_100A044E0 + 8) != a1) {
    return;
  }
  if (!a4)
  {
    LOBYTE(v43) = 72;
    int v8 = 1701;
    goto LABEL_11;
  }
  if (a4 == 135)
  {
    int v8 = 0;
    LOBYTE(v43) = 73;
    *(unsigned char *)(qword_100A044E0 + 128) = 0;
LABEL_11:
    uint64_t v45 = a2;
    LOWORD(v44) = a3;
    uint64_t v41 = &v43;
    LOBYTE(v42) = 1;
    uint64_t v9 = sub_100113A54(*(unsigned __int16 *)(v4 + 26), (uint64_t)&v41, v8);
    if (v9)
    {
      uint64_t v10 = v9;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_OBEXSRV_GetResponse failed with error %!", v11, v12, v13, v14, v15, v16, v17, v10);
        unint64_t v18 = sub_100050B4C(0x1Du);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      uint64_t v19 = qword_100A044E0;
      uint64_t v20 = *(void *)(qword_100A044E0 + 8);
      *(void *)(qword_100A044E0 + 8) = 0;
      sub_10016829C(v20, *(_WORD *)(v19 + 26), v10);
      uint64_t v21 = qword_100A044E0;
      *(_DWORD *)qword_100A044E0 = 1;
    }
    else
    {
      uint64_t v21 = qword_100A044E0;
    }
    if (*(unsigned char *)(v21 + 128) == 4)
    {
      v40[0] = 0;
      v40[1] = 0;
      sub_100167940(*(unsigned __int16 *)(v21 + 26), v40, 1701);
    }
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"File read error", v22, v23, v24, v25, v26, v27, v28, v39);
    uint64_t v29 = sub_100050B4C(0x1Du);
    if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  uint64_t v30 = qword_100A044E0;
  *(void *)(qword_100A044E0 + 8) = 0;
  sub_10016829C(a1, *(_WORD *)(v30 + 26), a4);
  if (sub_100113A54(*(unsigned __int16 *)(qword_100A044E0 + 26), 0, a4))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to inform client of Read Failure (%!)", v31, v32, v33, v34, v35, v36, v37, a4);
      int v38 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  *(_DWORD *)qword_100A044E0 = 1;
}

void sub_10016829C(uint64_t a1, unsigned __int16 a2, int a3)
{
  uint64_t v12 = a1;
  int v13 = a3;
  int v14 = a2;
  v11[1] = &v12;
  v11[0] = (const void *)16;
  if (sub_100026DA8((uint64_t)sub_10016A7D4, v11, 0) && sub_100058654())
  {
    sub_100056E24((uint64_t)"Failed to register deferred close", v3, v4, v5, v6, v7, v8, v9, (uint64_t)v11[0]);
    uint64_t v10 = sub_100050B4C(0x1Du);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

uint64_t sub_100168344(int a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, _DWORD *a7, int a8, int a9)
{
  long long v53 = unk_10099D1D0;
  if (!a6 || !a3 || !a2 || !a5)
  {
    sub_10025B8C0();
    return 101;
  }
  long long v51 = 0u;
  long long v52 = 0u;
  long long v49 = 0u;
  long long v50 = 0u;
  if (dword_100A19824)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_PBAPServer_Register is already registered.", v12, v13, v14, v15, v16, v17, v18, v48);
      uint64_t v19 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 119;
  }
  uint64_t v27 = sub_10010CE48(0xD0uLL);
  qword_100A044E0 = (uint64_t)v27;
  v27[4] = a2;
  v27[5] = a3;
  v27[6] = a4;
  v27[1] = 0;
  v27[2] = a5;
  uint64_t v28 = (unsigned char *)sub_10025B218(0x1Du);
  uint64_t v29 = qword_100A044E0;
  *(unsigned char *)(qword_100A044E0 + 60) = *v28;
  uint64_t v20 = sub_10016334C((uint64_t)&v53, (uint64_t)off_1009F9270, a1, (unsigned char *)(v29 + 60), (uint64_t)&unk_1007B9B68);
  if (v20) {
    goto LABEL_14;
  }
  uint64_t v20 = sub_100263D70((uint64_t)&v53, (uint64_t)off_1009F9270, a1, (_WORD *)(qword_100A044E0 + 62), (uint64_t)&unk_1007B9B68, 1);
  if (v20) {
    goto LABEL_14;
  }
  byte_100A044E8 = 1;
  word_100A044EA = 1;
  dword_100A044F0 = *(unsigned __int8 *)(qword_100A044E0 + 60);
  byte_100A044F8 = 1;
  word_100A044FA = 1;
  dword_100A04500 = a8;
  byte_100A04508 = 1;
  word_100A0450A = 4;
  dword_100A04510 = a9;
  byte_100A04518 = 1;
  word_100A0451A = 2;
  dword_100A04520 = *(unsigned __int16 *)(qword_100A044E0 + 62);
  byte_100A04528 = 1;
  word_100A0452A = 1;
  dword_100A04530 = 1;
  *(void *)&long long v51 = &unk_10099D1E0;
  WORD4(v51) = 6;
  *(void *)&long long v52 = *(void *)a6;
  WORD4(v52) = *(_WORD *)(a6 + 8);
  *(void *)&long long v49 = &unk_10099D270;
  WORD4(v49) = 4;
  *(void *)&long long v50 = v52;
  WORD4(v50) = WORD4(v52);
  uint64_t v39 = sub_10024E258((uint64_t)&v51, (int *)(qword_100A044E0 + 56));
  if (v39)
  {
    uint64_t v20 = v39;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_SDPDB_AddServiceRecord failed: %!", v40, v41, v42, v43, v44, v45, v46, v20);
      uint64_t v47 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
LABEL_14:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_PBAPServer_Register failed", v30, v31, v32, v33, v34, v35, v36, v48);
      uint64_t v37 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    if (qword_100A044E0)
    {
      sub_100185404(0x100000);
      int v38 = (int *)qword_100A044E0;
      if (*(unsigned char *)(qword_100A044E0 + 60))
      {
        sub_1001637D0(*(unsigned __int8 *)(qword_100A044E0 + 60));
        int v38 = (int *)qword_100A044E0;
      }
      if (v38[14])
      {
        sub_10024E448(v38[14]);
        int v38 = (int *)qword_100A044E0;
      }
      sub_100023010(v38);
    }
    return v20;
  }
  sub_10024E564(*(unsigned int *)(qword_100A044E0 + 56), (uint64_t)&v49);
  sub_100185350(0x100000);
  ++dword_100A19824;
  uint64_t v20 = 0;
  if (a7) {
    *a7 = *(_DWORD *)(qword_100A044E0 + 56);
  }
  return v20;
}

void sub_100168694(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (a5)
  {
    sub_100169830((unsigned __int16 *)(a5 + 8));
    uint64_t v9 = qword_100A044E0;
  }
  else
  {
    uint64_t v9 = qword_100A044E0;
    *(_DWORD *)(qword_100A044E0 + 192) = 0;
  }
  __int16 v44 = 0;
  int v43 = 0;
  if (*(_DWORD *)v9)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"PBAP server already in use", v10, v11, v12, v13, v14, v15, v16, v42);
      uint64_t v17 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (sub_100114014(a1, 0, 104) && sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to inform client of connection failure", v18, v19, v20, v21, v22, v23, v24, v42);
      uint64_t v25 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  else
  {
    *(unsigned char *)(v9 + 200) = a2;
    *(_WORD *)(v9 + 26) = a1;
    if (sub_1001147F0(a1, (uint64_t)&v43))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to get client address", v26, v27, v28, v29, v30, v31, v32, v42);
        uint64_t v33 = sub_100050B4C(0x1Du);
        if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      if (sub_100114014(a1, 0, 3005))
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Failed to inform client of connection failure", v34, v35, v36, v37, v38, v39, v40, v42);
          uint64_t v41 = sub_100050B4C(0x1Du);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
      }
    }
    else
    {
      (*(void (**)(int *, uint64_t, uint64_t, uint64_t, uint64_t))(qword_100A044E0 + 32))(&v43, a2, a3, a4, a1);
    }
  }
}

void sub_100168888(uint64_t a1)
{
  uint64_t v2 = qword_100A044E0;
  if (*(unsigned __int16 *)(qword_100A044E0 + 26) == a1)
  {
    *(_DWORD *)qword_100A044E0 = 0;
    uint64_t v3 = *(void (**)(void))(v2 + 40);
    v3();
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Received disconnect indication from invalid connectionId %d", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = sub_100050B4C(0x1Du);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100168938(uint64_t a1, uint64_t a2, unsigned int a3)
{
  if (a3 == 1701) {
    unsigned int v3 = 1721;
  }
  else {
    unsigned int v3 = a3;
  }
  if (a3) {
    return v3;
  }
  else {
    return 1721;
  }
}

uint64_t sub_100168950(uint64_t a1, uint64_t a2, int a3, char a4)
{
  if (a4)
  {
    uint64_t v4 = 1735;
    goto LABEL_18;
  }
  if (!a2 || (uint64_t v5 = *(_WORD **)(a2 + 8)) == 0 || !*v5)
  {
    uint64_t v8 = qword_100A044E0;
    if (!a3)
    {
      uint64_t v4 = 0;
      *(_WORD *)(qword_100A044E0 + 72) = 0;
      *(_DWORD *)(v8 + 64) = 0;
      *(unsigned char *)(v8 + 74) = 0;
      goto LABEL_18;
    }
    if (*(unsigned char *)(qword_100A044E0 + 74))
    {
      char v9 = *(unsigned char *)(qword_100A044E0 + 74) - 1;
      *(unsigned char *)(qword_100A044E0 + 74) = v9;
      if (*(unsigned char *)(v8 + 73))
      {
        uint64_t v4 = 0;
        *(unsigned char *)(v8 + 73) = 0;
      }
      else if (v9)
      {
        uint64_t v4 = 0;
        if (v9 == 1 && *(_DWORD *)(v8 + 64) == 1) {
          *(unsigned char *)(v8 + 72) = 0;
        }
      }
      else
      {
        uint64_t v4 = 0;
        *(unsigned char *)(v8 + 72) = 0;
        *(_DWORD *)(v8 + 64) = 0;
      }
      goto LABEL_18;
    }
LABEL_17:
    uint64_t v4 = 1724;
    goto LABEL_18;
  }
  ptr[1] = 0;
  ptr[2] = 0;
  unsigned __int16 v29 = 3;
  if (!*(_WORD *)a2 || *(unsigned char *)(qword_100A044E0 + 73)) {
    goto LABEL_17;
  }
  ptr[0] = 0;
  uint64_t v6 = sub_100169744((unsigned __int16 *)a2, ptr, &v29);
  if (v6)
  {
LABEL_9:
    uint64_t v4 = v6;
    goto LABEL_10;
  }
  unint64_t v20 = v29;
  if (v29 + *(unsigned __int8 *)(qword_100A044E0 + 74) > 3)
  {
    uint64_t v7 = ptr[0];
    uint64_t v4 = 1724;
    if (ptr[0]) {
      goto LABEL_11;
    }
    goto LABEL_18;
  }
  if (!v29)
  {
LABEL_52:
    uint64_t v4 = 0;
    goto LABEL_10;
  }
  uint64_t v21 = 0;
  while (1)
  {
    uint64_t v22 = qword_100A044E0;
    int v23 = *(unsigned __int8 *)(qword_100A044E0 + 74);
    if (v23 == 2) {
      break;
    }
    if (v23 == 1)
    {
      uint64_t v27 = (unsigned __int16 *)ptr[v21];
      if (*(_DWORD *)(qword_100A044E0 + 64) != 1
        || (v28 = sub_100262C30((unsigned __int16 *)ptr[v21], (unsigned __int16 *)"t"), uint64_t v22 = qword_100A044E0, v28))
      {
        uint64_t v26 = (_DWORD *)(v22 + 68);
        uint64_t v25 = v27;
        goto LABEL_47;
      }
    }
    else
    {
      if (*(unsigned char *)(qword_100A044E0 + 74)) {
        goto LABEL_53;
      }
      uint64_t v24 = (unsigned __int16 *)ptr[v21];
      if (!sub_100262C30(v24, L"SIM1"))
      {
        uint64_t v22 = qword_100A044E0;
        *(_DWORD *)(qword_100A044E0 + 64) = 1;
        goto LABEL_51;
      }
      if (sub_100262C30(v24, (unsigned __int16 *)"t")) {
        goto LABEL_53;
      }
      uint64_t v22 = qword_100A044E0;
      *(_DWORD *)(qword_100A044E0 + 64) = 0;
    }
    *(unsigned char *)(v22 + 72) = 1;
LABEL_51:
    ++*(unsigned char *)(v22 + 74);
    if (++v21 >= v20) {
      goto LABEL_52;
    }
  }
  if (*(_DWORD *)(qword_100A044E0 + 64))
  {
    uint64_t v25 = (unsigned __int16 *)ptr[v21];
    uint64_t v26 = (_DWORD *)(qword_100A044E0 + 68);
LABEL_47:
    uint64_t v6 = sub_10016A3E4(v25, v26);
    if (v6) {
      goto LABEL_9;
    }
    uint64_t v22 = qword_100A044E0;
    *(unsigned char *)(qword_100A044E0 + 73) = 1;
    goto LABEL_51;
  }
LABEL_53:
  uint64_t v4 = 1724;
LABEL_10:
  uint64_t v7 = ptr[0];
  if (ptr[0]) {
LABEL_11:
  }
    sub_100023010(v7);
LABEL_18:
  if (sub_1001146F8(*(unsigned __int16 *)(qword_100A044E0 + 26), v4))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to confirm (%!) the set path operation with the client", v10, v11, v12, v13, v14, v15, v16, v4);
      uint64_t v17 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v4;
}

uint64_t sub_100168C28()
{
  if (!dword_100A19824) {
    return 121;
  }
  uint64_t v0 = sub_1001637D0(*(unsigned __int8 *)(qword_100A044E0 + 60));
  if (v0)
  {
    uint64_t v1 = v0;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Error deregistering RFCOMM server", v2, v3, v4, v5, v6, v7, v8, v38);
      char v9 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
LABEL_19:
      }
        sub_100748324();
    }
  }
  else
  {
    uint64_t v11 = sub_100264110(*(unsigned __int16 *)(qword_100A044E0 + 62));
    if (v11)
    {
      uint64_t v1 = v11;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Error deregistering L2CAP server", v12, v13, v14, v15, v16, v17, v18, v38);
        uint64_t v19 = sub_100050B4C(0x1Du);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          goto LABEL_19;
        }
      }
    }
    else
    {
      uint64_t v20 = sub_100185404(0x100000);
      if (v20)
      {
        uint64_t v1 = v20;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Error deregistering service class", v21, v22, v23, v24, v25, v26, v27, v38);
          int v28 = sub_100050B4C(0x1Du);
          if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
            goto LABEL_19;
          }
        }
      }
      else
      {
        uint64_t v29 = sub_10024E448(*(_DWORD *)(qword_100A044E0 + 56));
        if (v29)
        {
          uint64_t v1 = v29;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Error removing service record", v30, v31, v32, v33, v34, v35, v36, v38);
            uint64_t v37 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
              goto LABEL_19;
            }
          }
        }
        else
        {
          if (qword_100A044E0) {
            sub_100023010((void *)qword_100A044E0);
          }
          uint64_t v1 = 0;
          qword_100A044E0 = 0;
          --dword_100A19824;
        }
      }
    }
  }
  return v1;
}

uint64_t sub_100168DE8(unsigned int a1, char a2, char a3, int a4)
{
  if (!dword_100A19824) {
    return 103;
  }
  uint64_t v4 = qword_100A044E0;
  if (*(_DWORD *)qword_100A044E0 || *(unsigned __int16 *)(qword_100A044E0 + 26) != a1) {
    return 1745;
  }
  if (*(unsigned char *)(qword_100A044E0 + 200) || (a3 & 1) == 0)
  {
    uint64_t v7 = sub_100114014(a1, 0, a4);
    if (v7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to inform client of connection rejection", v17, v18, v19, v20, v21, v22, v23, v27);
        uint64_t v24 = sub_100050B4C(0x1Du);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
          goto LABEL_9;
        }
      }
    }
  }
  else
  {
    *(unsigned char *)(qword_100A044E0 + 74) = 0;
    *(_WORD *)(v4 + 72) = 0;
    *(_DWORD *)(v4 + 64) = 0;
    *(unsigned char *)(v4 + 121) = a2;
    uint64_t v6 = sub_100114014(a1, 1, 0);
    if (v6)
    {
      uint64_t v7 = v6;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"PBAP: Failed to accept connection", v8, v9, v10, v11, v12, v13, v14, v27);
        uint64_t v15 = sub_100050B4C(0x1Du);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
LABEL_9:
        }
          sub_100748324();
      }
    }
    else
    {
      uint64_t v25 = qword_100A044E0;
      *(_DWORD *)qword_100A044E0 = 1;
      *(_WORD *)(qword_100A044E0 + 24) = sub_100114794(*(unsigned __int16 *)(v25 + 26));
      int v28 = 0;
      sub_10011484C(a1, &v28);
      if (*(unsigned __int16 *)(qword_100A044E0 + 24) > 0x1000u && v28 == 0) {
        *(_WORD *)(qword_100A044E0 + 24) = 4096;
      }
      return 0;
    }
  }
  return v7;
}

uint64_t sub_100168F7C(unsigned int a1, const void *a2, unsigned int a3, char *a4)
{
  if (!dword_100A19824) {
    return 103;
  }
  if (*(_DWORD *)qword_100A044E0 || !*(unsigned char *)(qword_100A044E0 + 200)) {
    return 1745;
  }
  uint64_t result = sub_10011448C(*(unsigned __int16 *)(qword_100A044E0 + 26), a2, a3, a4, 1);
  if (!result)
  {
    *(_WORD *)(qword_100A044E0 + 24) = sub_100114794(*(unsigned __int16 *)(qword_100A044E0 + 26));
    int v7 = 0;
    sub_10011484C(a1, &v7);
    if (*(unsigned __int16 *)(qword_100A044E0 + 24) > 0x1000u && v7 == 0) {
      *(_WORD *)(qword_100A044E0 + 24) = 4096;
    }
    return 0;
  }
  return result;
}

uint64_t sub_100169034(uint64_t a1, __int16 a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, int a9)
{
  v37[0] = a3;
  v37[1] = a4;
  v36[0] = a5;
  v36[1] = a6;
  v35[0] = a7;
  v35[1] = a8;
  memset(v38, 0, sizeof(v38));
  uint64_t v33 = v38;
  uint64_t v34 = 0;
  uint64_t v9 = qword_100A044E0;
  if (*(_DWORD *)qword_100A044E0 == 3)
  {
    int v10 = a9;
    if (a9)
    {
      *(_DWORD *)qword_100A044E0 = 1;
      unsigned int v11 = *(unsigned __int16 *)(v9 + 26);
      uint64_t v12 = 0;
    }
    else
    {
      char v22 = *(unsigned char *)(qword_100A044E0 + 128);
      if (v22)
      {
        LOBYTE(v38[0]) = -105;
        unsigned int v23 = 1;
        BYTE8(v38[0]) = 1;
        LOBYTE(v34) = 1;
        *(unsigned char *)(qword_100A044E0 + 128) = v22 & 0xFA | 4;
      }
      else
      {
        unsigned int v23 = 0;
      }
      qword_100A04538 = (uint64_t)&word_100A04548;
      word_100A04540 = 61;
      word_100A04546 = 2;
      *(_DWORD *)&word_100A04542 = 262205;
      word_100A04548 = 520;
      byte_100A0454A = HIBYTE(a2);
      byte_100A0454B = a2;
      if (*(unsigned char *)(v9 + 120))
      {
        word_100A0454C = 265;
        char v26 = *(unsigned char *)(v9 + 121);
        __int16 v27 = 7;
        word_100A04544 = 7;
        byte_100A0454E = v26;
      }
      else
      {
        __int16 v27 = 4;
      }
      if ((*(unsigned char *)(v9 + 192) & 8) != 0)
      {
        sub_1001692F0(&qword_100A04538, 10, (uint64_t)v37);
        uint64_t v9 = qword_100A044E0;
        int v28 = *(_DWORD *)(qword_100A044E0 + 68);
        if (v28 != 5 && v28)
        {
          v27 += 18;
        }
        else
        {
          sub_1001692F0(&qword_100A04538, 11, (uint64_t)v36);
          v27 += 36;
          uint64_t v9 = qword_100A044E0;
        }
      }
      if ((*(unsigned char *)(v9 + 192) & 4) != 0)
      {
        int v29 = *(_DWORD *)(v9 + 68);
        uint64_t v30 = v35;
        if (v29 && v29 != 5) {
          uint64_t v30 = &unk_100A15240;
        }
        sub_1001692F0(&qword_100A04538, 13, (uint64_t)v30);
        v27 += 18;
      }
      uint64_t v31 = (char *)v38 + 24 * v23;
      char *v31 = 76;
      *((_WORD *)v31 + 4) = v27;
      *((void *)v31 + 2) = qword_100A04538;
      LOBYTE(v34) = v23 + 1;
      if (word_100A04546 == 2) {
        word_100A04542 = word_100A04544;
      }
      LOBYTE(word_100A04546) = 15;
      uint64_t v32 = qword_100A044E0;
      *(_DWORD *)qword_100A044E0 = 1;
      unsigned int v11 = *(unsigned __int16 *)(v32 + 26);
      uint64_t v12 = &v33;
      int v10 = 0;
    }
    return sub_100113A54(v11, (uint64_t)v12, v10);
  }
  else
  {
    if (sub_100058654())
    {
      uint64_t v20 = *(int *)qword_100A044E0;
      uint64_t v21 = v20 > 5 ? "<unknown state>" : off_10099D340[v20];
      sub_100056E24((uint64_t)"Server state is %s, ignoring getsize response", v13, v14, v15, v16, v17, v18, v19, (uint64_t)v21);
      uint64_t v24 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 3004;
  }
}

uint64_t *sub_1001692F0(uint64_t *result, char a2, uint64_t a3)
{
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
    goto LABEL_21;
  }
  uint64_t v3 = *((unsigned __int16 *)result + 6);
  if (*((unsigned __int16 *)result + 5) <= v3)
  {
LABEL_21:
    unsigned int v11 = "ByteStream_NumReadBytesAvail(*byteStream) >= 1";
    goto LABEL_23;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    unsigned int v11 = "(*byteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 294, v11);
  }
  uint64_t v4 = *result;
  *((_WORD *)result + 6) = v3 + 1;
  *(unsigned char *)(v4 + v3) = a2;
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
    goto LABEL_25;
  }
  uint64_t v5 = *((unsigned __int16 *)result + 6);
  if (*((unsigned __int16 *)result + 5) <= v5)
  {
LABEL_25:
    uint64_t v12 = "ByteStream_NumReadBytesAvail(*byteStream) >= 1";
    goto LABEL_27;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    uint64_t v12 = "(*byteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 295, v12);
  }
  uint64_t v6 = *result;
  *((_WORD *)result + 6) = v5 + 1;
  *(unsigned char *)(v6 + v5) = 16;
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
    goto LABEL_29;
  }
  uint64_t v7 = *((unsigned __int16 *)result + 6);
  if (*((unsigned __int16 *)result + 5) - (int)v7 <= 3)
  {
LABEL_29:
    uint64_t v13 = "ByteStream_NumReadBytesAvail(*byteStream) >= 4";
    goto LABEL_31;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    uint64_t v13 = "(*byteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 296, v13);
  }
  *(unsigned char *)(*result + v7 + 3) = *(_DWORD *)a3;
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 2) = BYTE1(*(_DWORD *)a3);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 1) = *(_WORD *)(a3 + 2);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6)) = *(unsigned char *)(a3 + 3);
  unsigned __int16 v8 = *((_WORD *)result + 6) + 4;
  *((_WORD *)result + 6) = v8;
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
    goto LABEL_33;
  }
  if (*((unsigned __int16 *)result + 5) - v8 <= 3)
  {
LABEL_33:
    uint64_t v14 = "ByteStream_NumReadBytesAvail(*byteStream) >= 4";
    goto LABEL_35;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    uint64_t v14 = "(*byteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 297, v14);
  }
  *(unsigned char *)(*result + v8 + 3) = *(_DWORD *)(a3 + 4);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 2) = BYTE1(*(_DWORD *)(a3 + 4));
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 1) = *(_WORD *)(a3 + 6);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6)) = *(unsigned char *)(a3 + 7);
  unsigned __int16 v9 = *((_WORD *)result + 6) + 4;
  *((_WORD *)result + 6) = v9;
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
    goto LABEL_37;
  }
  if (*((unsigned __int16 *)result + 5) - v9 <= 3)
  {
LABEL_37:
    uint64_t v15 = "ByteStream_NumReadBytesAvail(*byteStream) >= 4";
    goto LABEL_39;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    uint64_t v15 = "(*byteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 298, v15);
  }
  *(unsigned char *)(*result + v9 + 3) = *(_DWORD *)(a3 + 8);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 2) = BYTE1(*(_DWORD *)(a3 + 8));
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 1) = *(_WORD *)(a3 + 10);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6)) = *(unsigned char *)(a3 + 11);
  unsigned __int16 v10 = *((_WORD *)result + 6) + 4;
  *((_WORD *)result + 6) = v10;
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
    goto LABEL_41;
  }
  if (*((unsigned __int16 *)result + 5) - v10 <= 3)
  {
LABEL_41:
    uint64_t v16 = "ByteStream_NumReadBytesAvail(*byteStream) >= 4";
    goto LABEL_43;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    uint64_t v16 = "(*byteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 299, v16);
  }
  *(unsigned char *)(*result + v10 + 3) = *(_DWORD *)(a3 + 12);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 2) = BYTE1(*(_DWORD *)(a3 + 12));
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6) + 1) = *(_WORD *)(a3 + 14);
  *(unsigned char *)(*result + *((unsigned __int16 *)result + 6)) = *(unsigned char *)(a3 + 15);
  *((_WORD *)result + 6) += 4;
  return result;
}

uint64_t sub_1001696FC(unsigned int a1)
{
  if (!dword_100A19824) {
    return 103;
  }
  if (*(unsigned __int16 *)(qword_100A044E0 + 26) != a1) {
    return 101;
  }
  if (*(_DWORD *)qword_100A044E0) {
    return sub_1001148A0(a1);
  }
  return 1709;
}

uint64_t sub_100169744(unsigned __int16 *a1, void *a2, unsigned __int16 *a3)
{
  uint64_t v4 = *a1;
  if (*a1 && ((int v7 = *a3, v4 != 1) || **((_WORD **)a1 + 1)))
  {
    unsigned __int16 v8 = sub_100022FE8(2 * v4 + 2);
    if (v8)
    {
      unsigned __int16 v9 = v8;
      memmove(v8, *((const void **)a1 + 1), 2 * *a1);
      v9[*a1] = 0;
      if (*v9 == 47)
      {
        return 1724;
      }
      else
      {
        *a2 = v9;
        unsigned __int16 v11 = 1;
LABEL_10:
        *a3 = v11;
        while (1)
        {
          if (!*v9++) {
            return 0;
          }
          if (*(v9 - 1) == 47)
          {
            if (v7 == v11) {
              return 1724;
            }
            *(v9 - 1) = 0;
            uint64_t v12 = *a3;
            a2[v12] = v9;
            unsigned __int16 v11 = v12 + 1;
            goto LABEL_10;
          }
        }
      }
    }
    else
    {
      return 106;
    }
  }
  else
  {
    uint64_t result = 0;
    *a3 = 0;
  }
  return result;
}

uint64_t sub_100169830(unsigned __int16 *a1)
{
  uint64_t v1 = *((void *)a1 + 1);
  if (!v1)
  {
    uint64_t v114 = "appParams->data";
    goto LABEL_152;
  }
  unsigned int v2 = *a1;
  if (!*a1)
  {
    uint64_t v114 = "(appParams->len) > 0";
LABEL_152:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c", 676, v114);
  }
  signed int v3 = 0;
  int v4 = 0;
  int v5 = v2 - 3;
  int v6 = v2 - 1;
  while (2)
  {
    if (v2 <= (unsigned __int16)v4) {
      return 0;
    }
    uint64_t v7 = (unsigned __int16)v4;
    uint64_t v8 = (unsigned __int16)v4 + 1;
    if (v2 <= (unsigned __int16)(v4 + 1))
    {
      int v9 = 1;
      int v4 = (unsigned __int16)v4 + 1;
    }
    else
    {
      int v9 = 0;
      v4 += 2;
      signed int v3 = *(unsigned __int8 *)(v1 + v8);
    }
    switch(*(unsigned char *)(v1 + v7))
    {
      case 1:
        if (v3 != 1)
        {
          if (!sub_100058654()) {
            return 1741;
          }
          sub_100056E24((uint64_t)"PBAP: Order value has wrong length", v34, v35, v36, v37, v38, v39, v40, v115);
          uint64_t v41 = sub_100050B4C(0x1Du);
          if (!os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
            return 1741;
          }
          goto LABEL_136;
        }
        uint64_t v10 = qword_100A044E0;
        if (*(unsigned char *)(qword_100A044E0 + 140))
        {
          if (v2 > (unsigned __int16)v8) {
            goto LABEL_38;
          }
          goto LABEL_133;
        }
        if (v2 <= (unsigned __int16)v8)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
          uint64_t v10 = qword_100A044E0;
        }
        else if (v2 > (unsigned __int16)v4)
        {
          unsigned int v23 = *(unsigned __int8 *)(v1 + (unsigned __int16)v4);
          *(_DWORD *)(qword_100A044E0 + 136) = v23;
          if (v23 >= 3)
          {
            if (!sub_100058654()) {
              return 1741;
            }
            sub_100056E24((uint64_t)"PBAP: client sent invalid order value: %d\n", v106, v107, v108, v109, v110, v111, v112, *(unsigned int *)(qword_100A044E0 + 136));
            uint64_t v113 = sub_100050B4C(0x1Du);
            if (!os_log_type_enabled(v113, OS_LOG_TYPE_ERROR)) {
              return 1741;
            }
            goto LABEL_136;
          }
          int v24 = 0;
          ++v4;
LABEL_84:
          *(unsigned char *)(v10 + 140) = 1;
          if (!v24) {
            continue;
          }
          goto LABEL_134;
        }
        int v24 = 1;
        *(_DWORD *)(v10 + 136) = 1;
        goto LABEL_84;
      case 2:
        if (!*(unsigned char *)(qword_100A044E0 + 161))
        {
          int v116 = v5;
          *(unsigned char *)(qword_100A044E0 + 160) = v3;
          uint64_t v18 = sub_100022FE8(v3);
          *(void *)(qword_100A044E0 + 152) = v18;
          if (!v18)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Failed to allocate memory for SearchValue", v90, v91, v92, v93, v94, v95, v96, v115);
              uint64_t v97 = sub_100050B4C(0x1Du);
              if (os_log_type_enabled(v97, OS_LOG_TYPE_ERROR)) {
                sub_1007493A8();
              }
            }
            return 106;
          }
          uint64_t v19 = v18;
          if (v2 <= (unsigned __int16)v8)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
            signed int v20 = 0;
          }
          else
          {
            signed int v20 = v2 - (unsigned __int16)v4;
          }
          if (v20 >= v3)
          {
            if (v3)
            {
              uint64_t v30 = (char *)(v1 + (unsigned __int16)v4);
              uint64_t v31 = &v19[v3];
              do
              {
                char v32 = *v30++;
                *v19++ = v32;
              }
              while (v19 < v31);
            }
            v4 += v3;
          }
          else
          {
            int v9 = 1;
          }
          *(unsigned char *)(qword_100A044E0 + 161) = 1;
          int v5 = v116;
LABEL_107:
          if (v9) {
            goto LABEL_134;
          }
          continue;
        }
        if (v2 > (unsigned __int16)v8) {
          goto LABEL_18;
        }
LABEL_74:
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
        signed int v12 = 0;
        goto LABEL_75;
      case 3:
        uint64_t v11 = qword_100A044E0;
        if (!*(unsigned char *)(qword_100A044E0 + 148))
        {
          if (v2 <= (unsigned __int16)v8)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
            int v22 = 0;
            uint64_t v11 = qword_100A044E0;
          }
          else
          {
            if (v2 > (unsigned __int16)v4)
            {
              int v21 = 0;
              int v22 = *(unsigned __int8 *)(v1 + (unsigned __int16)v4++);
              goto LABEL_111;
            }
            int v22 = 0;
          }
          int v21 = 1;
LABEL_111:
          *(_DWORD *)(v11 + 144) = v22;
          *(unsigned char *)(v11 + 148) = 1;
          if (v21) {
            goto LABEL_134;
          }
          continue;
        }
        if (v2 <= (unsigned __int16)v8) {
          goto LABEL_74;
        }
LABEL_18:
        signed int v12 = v2 - (unsigned __int16)v4;
LABEL_75:
        if (v12 < v3) {
          goto LABEL_134;
        }
        v4 += v3;
        if (v9) {
          goto LABEL_134;
        }
        continue;
      case 4:
        if (v3 != 2)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"PBAP: MaxListCount value has wrong length", v42, v43, v44, v45, v46, v47, v48, v115);
            long long v49 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
              goto LABEL_136;
            }
          }
          return 1741;
        }
        uint64_t v13 = qword_100A044E0;
        if (*(unsigned char *)(qword_100A044E0 + 164))
        {
          if (v2 <= (unsigned __int16)v8) {
            goto LABEL_133;
          }
          goto LABEL_26;
        }
        if (v2 <= (unsigned __int16)v8)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
          uint64_t v13 = qword_100A044E0;
        }
        else if (v6 > (unsigned __int16)v4)
        {
          int v25 = 0;
          *(_WORD *)(qword_100A044E0 + 162) = bswap32(*(unsigned __int16 *)(v1 + (unsigned __int16)v4)) >> 16;
          v4 += 2;
          goto LABEL_88;
        }
        int v25 = 1;
LABEL_88:
        *(unsigned char *)(v13 + 164) = 1;
        if (v25) {
          goto LABEL_134;
        }
        continue;
      case 5:
        if (v3 != 2)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"PBAP: ListStartOffset value has wrong length", v50, v51, v52, v53, v54, v55, v56, v115);
            uint64_t v57 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR)) {
              goto LABEL_136;
            }
          }
          return 1741;
        }
        uint64_t v14 = qword_100A044E0;
        if (!*(unsigned char *)(qword_100A044E0 + 168))
        {
          if (v2 <= (unsigned __int16)v8)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
            uint64_t v14 = qword_100A044E0;
          }
          else if (v6 > (unsigned __int16)v4)
          {
            int v26 = 0;
            *(_WORD *)(qword_100A044E0 + 166) = bswap32(*(unsigned __int16 *)(v1 + (unsigned __int16)v4)) >> 16;
            v4 += 2;
            goto LABEL_92;
          }
          int v26 = 1;
LABEL_92:
          *(unsigned char *)(v14 + 168) = 1;
          if (v26) {
            goto LABEL_134;
          }
          continue;
        }
        if (v2 <= (unsigned __int16)v8) {
          goto LABEL_133;
        }
LABEL_26:
        if ((int)(v2 - 2) < (unsigned __int16)v4) {
          goto LABEL_134;
        }
        v4 += 2;
        if (v9) {
          goto LABEL_134;
        }
        continue;
      case 6:
        if (v3 != 8)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"PBAP: Filter value has wrong length", v58, v59, v60, v61, v62, v63, v64, v115);
            uint64_t v65 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v65, OS_LOG_TYPE_ERROR)) {
              goto LABEL_136;
            }
          }
          return 1741;
        }
        uint64_t v15 = qword_100A044E0;
        if (!*(unsigned char *)(qword_100A044E0 + 180))
        {
          if (v2 <= (unsigned __int16)v8)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
          }
          else if (v5 > (unsigned __int16)v4)
          {
            *(_DWORD *)(qword_100A044E0 + 172) = bswap32(*(_DWORD *)(v1 + (unsigned __int16)v4));
            if (v5 <= (unsigned __int16)(v4 + 4))
            {
              int v27 = 1;
              v4 += 4;
            }
            else
            {
              int v27 = 0;
              *(_DWORD *)(v15 + 176) = bswap32(*(_DWORD *)(v1 + (unsigned __int16)(v4 + 4)));
              v4 += 8;
            }
LABEL_96:
            *(unsigned char *)(v15 + 180) = 1;
            if (v27) {
              goto LABEL_134;
            }
            continue;
          }
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
          uint64_t v15 = qword_100A044E0;
          int v27 = 1;
          goto LABEL_96;
        }
        if (v2 <= (unsigned __int16)v8) {
          goto LABEL_133;
        }
        if ((int)(v2 - 8) < (unsigned __int16)v4) {
          goto LABEL_134;
        }
        v4 += 8;
        if (v9) {
          goto LABEL_134;
        }
        continue;
      case 7:
        if (v3 != 1)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"PBAP: Format has wrong length", v66, v67, v68, v69, v70, v71, v72, v115);
            uint64_t v73 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v73, OS_LOG_TYPE_ERROR)) {
              goto LABEL_136;
            }
          }
          return 1741;
        }
        uint64_t v16 = qword_100A044E0;
        if (*(unsigned char *)(qword_100A044E0 + 188))
        {
          if (v2 <= (unsigned __int16)v8) {
            goto LABEL_133;
          }
LABEL_38:
          if (v2 <= (unsigned __int16)v4) {
            goto LABEL_134;
          }
          ++v4;
          if (v9) {
            goto LABEL_134;
          }
          continue;
        }
        if (v2 > (unsigned __int16)v8)
        {
          if (v2 <= (unsigned __int16)v4) {
            goto LABEL_143;
          }
          unsigned int v28 = *(unsigned __int8 *)(v1 + (unsigned __int16)v4);
          *(_DWORD *)(qword_100A044E0 + 184) = v28;
          if (v28 >= 2) {
            goto LABEL_144;
          }
          ++v4;
          *(unsigned char *)(v16 + 188) = 1;
          continue;
        }
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
        uint64_t v16 = qword_100A044E0;
LABEL_143:
        *(_DWORD *)(v16 + 184) = 7;
LABEL_144:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"PBAP: client sent invalid Format: %d\n", v98, v99, v100, v101, v102, v103, v104, *(unsigned int *)(qword_100A044E0 + 184));
          uint64_t v105 = sub_100050B4C(0x1Du);
          if (os_log_type_enabled(v105, OS_LOG_TYPE_ERROR)) {
LABEL_136:
          }
            sub_1007494A8();
        }
        return 1741;
      case 0x10:
        if (v3 != 4)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"PBAP: Supported Features has wrong length", v74, v75, v76, v77, v78, v79, v80, v115);
            int v81 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v81, OS_LOG_TYPE_ERROR)) {
              goto LABEL_136;
            }
          }
          return 1741;
        }
        uint64_t v17 = qword_100A044E0;
        if (!*(unsigned char *)(qword_100A044E0 + 196))
        {
          if (v2 <= (unsigned __int16)v8)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
            uint64_t v17 = qword_100A044E0;
          }
          else if (v5 > (unsigned __int16)v4)
          {
            int v29 = 0;
            *(_DWORD *)(qword_100A044E0 + 192) = bswap32(*(_DWORD *)(v1 + (unsigned __int16)v4));
            v4 += 4;
            goto LABEL_100;
          }
          int v29 = 1;
LABEL_100:
          *(unsigned char *)(v17 + 196) = 1;
          if (v29) {
            goto LABEL_134;
          }
          continue;
        }
        if (v2 <= (unsigned __int16)v8)
        {
LABEL_133:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
LABEL_134:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/profiles/pbap/pbap_server.c");
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"PBAP: Application parameters are corrupted", v82, v83, v84, v85, v86, v87, v88, v115);
            uint64_t v89 = sub_100050B4C(0x1Du);
            if (os_log_type_enabled(v89, OS_LOG_TYPE_ERROR)) {
              goto LABEL_136;
            }
          }
          return 1741;
        }
        if ((int)(v2 - 4) < (unsigned __int16)v4) {
          goto LABEL_134;
        }
        v4 += 4;
        if (v9) {
          goto LABEL_134;
        }
        continue;
      default:
        goto LABEL_107;
    }
  }
}

uint64_t sub_10016A194(int *a1, unsigned int *a2)
{
  uint64_t v4 = qword_100A044E0;
  if (*(unsigned char *)(qword_100A044E0 + 73))
  {
    if (*(_WORD *)(qword_100A044E0 + 112)) {
      return 1724;
    }
    uint64_t result = 0;
    *a1 = *(_DWORD *)(qword_100A044E0 + 64);
    *a2 = *(_DWORD *)(v4 + 68);
  }
  else
  {
    uint64_t result = sub_10016A340((unsigned __int16 **)(qword_100A044E0 + 80), *(unsigned __int16 *)(qword_100A044E0 + 112), a1);
    uint64_t v6 = *(unsigned __int16 *)(qword_100A044E0 + 112);
    if (v6 == 3 && !*a1) {
      return 1724;
    }
    if (!result)
    {
      uint64_t result = sub_10016A3E4(*(unsigned __int16 **)(qword_100A044E0 + 8 * v6 + 72), a2);
      if (!result)
      {
        if (sub_100262BF8(*(unsigned __int16 **)(qword_100A044E0
                                                              + 8 * *(unsigned __int16 *)(qword_100A044E0 + 112)
                                                              + 72)) == (unsigned __int16)word_1007B9B56[*a2] - 1)
          return 0;
        else {
          return 1724;
        }
      }
    }
  }
  return result;
}

uint64_t sub_10016A26C(int *a1, _DWORD *a2)
{
  unsigned int v3 = *(unsigned __int16 *)(qword_100A044E0 + 112);
  if (*(unsigned char *)(qword_100A044E0 + 73)) {
    BOOL v4 = v3 >= 2;
  }
  else {
    BOOL v4 = 1;
  }
  if (!v4) {
    return 1724;
  }
  uint64_t result = sub_10016A340((unsigned __int16 **)(qword_100A044E0 + 80), v3, a1);
  uint64_t v7 = *(unsigned __int16 *)(qword_100A044E0 + 112);
  if (v7 == 3 && !*a1) {
    return 1724;
  }
  if (!result)
  {
    uint64_t result = sub_10016A3E4(*(unsigned __int16 **)(qword_100A044E0 + 8 * v7 + 72), a2);
    if (!result)
    {
      int v8 = sub_100262BF8(*(unsigned __int16 **)(qword_100A044E0 + 8 * *(unsigned __int16 *)(qword_100A044E0 + 112) + 72));
      int v9 = (unsigned __int16)word_1007B9B56[*a2];
      if (v8 == v9 + sub_100262BF8((unsigned __int16 *)".") - 1) {
        return 0;
      }
      else {
        return 1724;
      }
    }
  }
  return result;
}

uint64_t sub_10016A340(unsigned __int16 **a1, unsigned int a2, int *a3)
{
  uint64_t v4 = qword_100A044E0;
  if (*(unsigned char *)(qword_100A044E0 + 72)) {
    goto LABEL_2;
  }
  if (a2 >= 2)
  {
    if (!sub_100262C30(*a1, L"SIM1") && !sub_100262C30(a1[1], (unsigned __int16 *)"t"))
    {
      int v5 = 1;
      goto LABEL_3;
    }
    if (!sub_100262C30(*a1, (unsigned __int16 *)"t"))
    {
      uint64_t v4 = qword_100A044E0;
LABEL_2:
      int v5 = *(_DWORD *)(v4 + 64);
LABEL_3:
      uint64_t result = 0;
      *a3 = v5;
      return result;
    }
  }
  return 1724;
}

uint64_t sub_10016A3E4(unsigned __int16 *a1, _DWORD *a2)
{
  uint64_t v4 = 0;
  while (1)
  {
    uint64_t result = sub_100262CB4(a1, (unsigned __int16 *)(&off_1009F9240)[v4], (unsigned __int16)(word_1007B9B56[v4] - 1));
    if (!result) {
      break;
    }
    if (++v4 == 6) {
      return 1724;
    }
  }
  *a2 = v4;
  return result;
}

void sub_10016A460(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v49[0] = a2;
  v49[1] = a3;
  v48[0] = a4;
  v48[1] = a5;
  v47[0] = a6;
  v47[1] = a7;
  memset(v50, 0, sizeof(v50));
  uint64_t v45 = v50;
  uint64_t v46 = 0;
  uint64_t v8 = qword_100A044E0;
  int v9 = *(_DWORD *)qword_100A044E0;
  if (*(_DWORD *)qword_100A044E0 > 5u || ((1 << *(_DWORD *)qword_100A044E0) & 0x34) == 0) {
    return;
  }
  int v12 = a8;
  if (a8) {
    goto LABEL_6;
  }
  if (!a1)
  {
    sub_10025B8C0();
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid handle", v26, v27, v28, v29, v30, v31, v32, v43);
      uint64_t v33 = sub_100050B4C(0x1Du);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
        sub_100749520();
      }
    }
    int v12 = 101;
LABEL_6:
    uint64_t v13 = qword_100A044E0;
    *(_DWORD *)qword_100A044E0 = 1;
    if (sub_100113A54(*(unsigned __int16 *)(v13 + 26), 0, v12))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to inform the client of the open failure (%!)", v14, v15, v16, v17, v18, v19, v20, a8);
        int v21 = sub_100050B4C(0x1Du);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    uint64_t v22 = qword_100A044E0;
    if (*(unsigned char *)(qword_100A044E0 + 161))
    {
      *(unsigned char *)(qword_100A044E0 + 161) = 0;
      unsigned int v23 = *(void **)(v22 + 152);
      if (v23)
      {
        sub_100023010(v23);
        *(void *)(qword_100A044E0 + 152) = 0;
      }
    }
    return;
  }
  *(void *)(qword_100A044E0 + 8) = a1;
  char v24 = *(unsigned char *)(v8 + 128);
  if (v24)
  {
    LOBYTE(v50[0]) = -105;
    unsigned int v25 = 1;
    BYTE8(v50[0]) = 1;
    LOBYTE(v46) = 1;
    *(unsigned char *)(v8 + 128) = v24 & 0xFA | 4;
    int v9 = *(_DWORD *)v8;
  }
  else
  {
    unsigned int v25 = 0;
  }
  qword_100A04588 = (uint64_t)&word_100A04598;
  unk_100A04590 = 0x2000000390039;
  if (v9 == 4 || v9 == 2)
  {
    if (*(unsigned char *)(v8 + 120))
    {
      word_100A04598 = 265;
      char v35 = *(unsigned char *)(v8 + 121);
      int v36 = 3;
      word_100A04594 = 3;
      byte_100A0459A = v35;
    }
    else
    {
      int v36 = 0;
    }
    if ((*(unsigned char *)(v8 + 192) & 8) != 0)
    {
      sub_1001692F0(&qword_100A04588, 10, (uint64_t)v49);
      uint64_t v8 = qword_100A044E0;
      int v37 = *(_DWORD *)(qword_100A044E0 + 68);
      if (v37 != 5 && v37)
      {
        v36 += 18;
      }
      else
      {
        sub_1001692F0(&qword_100A04588, 11, (uint64_t)v48);
        v36 |= 0x24u;
        uint64_t v8 = qword_100A044E0;
      }
    }
    if ((*(unsigned char *)(v8 + 192) & 4) == 0)
    {
      if (!v36) {
        goto LABEL_44;
      }
      goto LABEL_43;
    }
LABEL_39:
    int v38 = *(_DWORD *)(v8 + 68);
    uint64_t v39 = v47;
    if (v38 && v38 != 5) {
      uint64_t v39 = &unk_100A15240;
    }
    sub_1001692F0(&qword_100A04588, 13, (uint64_t)v39);
    LOWORD(v36) = v36 + 18;
LABEL_43:
    uint64_t v40 = (char *)v50 + 24 * v25;
    *uint64_t v40 = 76;
    *((_WORD *)v40 + 4) = v36;
    *((void *)v40 + 2) = qword_100A04588;
    LOBYTE(v46) = v25 + 1;
    goto LABEL_44;
  }
  if ((*(unsigned char *)(v8 + 192) & 4) != 0)
  {
    LOWORD(v36) = 0;
    goto LABEL_39;
  }
LABEL_44:
  if (byte_100A04596 == 2) {
    word_100A04592 = word_100A04594;
  }
  byte_100A04596 = 15;
  int v41 = sub_100113A54(*(unsigned __int16 *)(qword_100A044E0 + 26), (uint64_t)&v45, 1701);
  uint64_t v42 = qword_100A044E0;
  if (v41)
  {
    sub_10016829C(*(void *)(qword_100A044E0 + 8), *(_WORD *)(qword_100A044E0 + 26), v41);
    uint64_t v42 = qword_100A044E0;
    *(void *)(qword_100A044E0 + 8) = 0;
    *(_DWORD *)uint64_t v42 = 1;
  }
  if (*(unsigned char *)(v42 + 128) == 4)
  {
    v44[0] = 0;
    v44[1] = 0;
    sub_100167940(*(unsigned __int16 *)(v42 + 26), v44, 1701);
  }
}

void sub_10016A7D4(uint64_t a1)
{
  if (qword_100A044E0)
  {
    (*(void (**)(void, void, void))(*(void *)(qword_100A044E0 + 16) + 24))(**(void **)(a1 + 8), *(unsigned __int16 *)(*(void *)(a1 + 8) + 12), *(unsigned int *)(*(void *)(a1 + 8) + 8));
    if (*(unsigned char *)(qword_100A044E0 + 161))
    {
      uint64_t v1 = *(void **)(qword_100A044E0 + 152);
      if (v1)
      {
        sub_100023010(v1);
        *(void *)(qword_100A044E0 + 152) = 0;
      }
    }
  }
}

uint64_t sub_10016A854()
{
  return 102;
}

uint64_t sub_10016A85C()
{
  return 102;
}

uint64_t sub_10016A864()
{
  return 102;
}

uint64_t sub_10016A86C()
{
  return 102;
}

uint64_t sub_10016A874()
{
  return 102;
}

uint64_t sub_10016A87C()
{
  return 102;
}

uint64_t sub_10016A884()
{
  return 0;
}

uint64_t sub_10016A88C()
{
  return 102;
}

uint64_t sub_10016A898()
{
  return 102;
}

uint64_t sub_10016A8A0()
{
  return 102;
}

uint64_t sub_10016A8A8()
{
  return 102;
}

uint64_t sub_10016A8B0()
{
  return 102;
}

uint64_t sub_10016A8B8()
{
  uint64_t v0 = (*((uint64_t (**)(void))off_1009F93C8 + 3))(*((void *)off_1009F93C8 + 2));
  if (v0) {
    sub_10025B778("Failed to initialize driver %s\n", *((const char **)off_1009F93C8 + 1));
  }
  return v0;
}

uint64_t sub_10016A910()
{
  uint64_t v0 = (*((uint64_t (__cdecl **)())off_1009F93C8 + 4))();
  if (v0) {
    sub_10025B778("Failed to initialize driver %s\n", *((const char **)off_1009F93C8 + 1));
  }
  return v0;
}

uint64_t sub_10016A96C()
{
  return (*((uint64_t (__cdecl **)())off_1009F93C8 + 6))();
}

uint64_t sub_10016A97C()
{
  return (*((uint64_t (__cdecl **)())off_1009F93C8 + 7))();
}

uint64_t sub_10016A98C()
{
  return (*((uint64_t (**)(void))off_1009F93D0 + 7))();
}

uint64_t sub_10016A99C()
{
  return (*((uint64_t (__cdecl **)())off_1009F93D0 + 8))();
}

uint64_t sub_10016A9AC()
{
  uint64_t v0 = (*((uint64_t (**)(void))off_1009F93C8 + 5))(*((void *)off_1009F93C8 + 2));
  if (v0) {
    sub_10025B778("Failed to initialize driver %s\n", *((const char **)off_1009F93C8 + 1));
  }
  return v0;
}

uint64_t sub_10016AA08()
{
  uint64_t result = sub_1001E694C((uint64_t *)&off_1009F93C8, &off_1009F93D0);
  if (result)
  {
    sub_10025B778("FATAL ERROR - no hci driver was found\n");
    return 102;
  }
  return result;
}

uint64_t sub_10016AA48()
{
  if (sub_1001E694C((uint64_t *)&off_1009F93C8, &off_1009F93D0))
  {
    sub_10025B778("FATAL ERROR - no hci driver was found\n");
    return 102;
  }
  else
  {
    unsigned int v2 = off_1009F93D0;
    if (!*off_1009F93D0)
    {
      sub_10016A8B8();
      unsigned int v2 = off_1009F93D0;
    }
    uint64_t v3 = (*((uint64_t (__cdecl **)())v2 + 2))();
    uint64_t v0 = v3;
    if (v3 && v3 != 109) {
      sub_10025B778("Failed to initialize transport %s\n", *((const char **)off_1009F93D0 + 1));
    }
  }
  return v0;
}

uint64_t sub_10016AAE8()
{
  return (*((uint64_t (__cdecl **)())off_1009F93D0 + 3))();
}

uint64_t sub_10016AAF8()
{
  return (*((uint64_t (__cdecl **)())off_1009F93D0 + 4))();
}

uint64_t sub_10016AB08()
{
  if (*off_1009F93D0) {
    return (*((uint64_t (**)(void))off_1009F93D0 + 12))();
  }
  return result;
}

uint64_t sub_10016AB24()
{
  if (sub_1001E694C((uint64_t *)&off_1009F93C8, &off_1009F93D0))
  {
    sub_10025B778("FATAL ERROR - no hci driver was found\n");
    return 102;
  }
  uint64_t v1 = (void (*)(void))*((void *)off_1009F93D0 + 13);
  if (!v1)
  {
    sub_10025B778("FATAL ERROR - can't find sniffLogONly function\n");
    return 102;
  }
  v1();
  unsigned int v2 = (uint64_t (__cdecl *)())*((void *)off_1009F93D0 + 2);

  return v2();
}

uint64_t (*sub_10016ABB0())(void)
{
  uint64_t result = (uint64_t (*)(void))*((void *)off_1009F93D0 + 14);
  if (result) {
    return (uint64_t (*)(void))result();
  }
  return result;
}

uint64_t sub_10016ABC8()
{
  uint64_t v0 = (uint64_t (*)(void))*((void *)off_1009F93D0 + 18);
  if (v0) {
    return v0();
  }
  else {
    return 0;
  }
}

uint64_t sub_10016ABE4()
{
  return (*((uint64_t (__cdecl **)())off_1009F93D0 + 5))();
}

uint64_t sub_10016ABF4()
{
  return (*((uint64_t (__cdecl **)())off_1009F93D0 + 9))();
}

uint64_t (__cdecl *sub_10016AC04())()
{
  uint64_t result = (uint64_t (__cdecl *)())*((void *)off_1009F93D0 + 10);
  if (result) {
    return (uint64_t (__cdecl *)())result();
  }
  return result;
}

uint64_t (*sub_10016AC1C())(void)
{
  uint64_t result = (uint64_t (*)(void))*((void *)off_1009F93D0 + 15);
  if (result) {
    return (uint64_t (*)(void))result();
  }
  return result;
}

uint64_t sub_10016AC34()
{
  uint64_t v0 = (uint64_t (*)(void))*((void *)off_1009F93D0 + 16);
  if (v0) {
    return v0();
  }
  else {
    return 0;
  }
}

uint64_t (*sub_10016AC50())(void)
{
  uint64_t result = (uint64_t (*)(void))*((void *)off_1009F93D0 + 17);
  if (result) {
    return (uint64_t (*)(void))result();
  }
  return result;
}

void **sub_10016AC68(void **result, uint64_t a2)
{
  off_100A045D8 = *result;
  qword_100A045E0 = a2;
  return result;
}

uint64_t sub_10016AC80(void *a1)
{
  if (!a1)
  {
    sub_10025B8C0();
    return 101;
  }
  unsigned int v2 = (uint64_t (*)(void))off_100A045D8;
  if (!off_100A045D8)
  {
    __int16 v7 = 0;
    int v6 = 0;
    uint64_t v5 = sub_100183EF4((uint64_t)&v6);
    if (v5)
    {
      uint64_t v4 = v5;
      sub_10025B778("OI_DEVMGR_GetCachedLocalBdAddr failed %!\n", v5);
    }
    else
    {
      sub_10025B778("Local device address is: %:\n", &v6);
      off_100A045E8 = a1;
      return sub_10025AF38(off_10099D370);
    }
    return v4;
  }

  return v2();
}

uint64_t sub_10016AD58(uint64_t a1)
{
  unsigned int v2 = (uint64_t (*)(uint64_t))off_100A045E8;
  if (!off_100A045E8)
  {
    sub_10025B8C0();
    unsigned int v2 = (uint64_t (*)(uint64_t))off_100A045E8;
  }

  return v2(a1);
}

void sub_10016ADA0()
{
  if (byte_1009F93FB >= 2u && sub_100183F14() <= 3) {
    byte_1009F93FB = 1;
  }
  uint64_t v0 = sub_100183F24((void (*)(int))sub_10016B080, (uint64_t)&unk_1009F93E8);
  if (v0)
  {
    uint64_t v1 = v0;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_DEVMGR_WriteStaticSettings", v2, v3, v4, v5, v6, v7, v8, v10);
      int v9 = sub_100050B4C(0x4Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10025B144((void (**)(uint64_t))off_10099D370, v1);
  }
}

void sub_10016AE58(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = sub_10018EFE8((uint64_t)sub_10016B148, a2, a3, a4, a5, a6, a7, a8, v18);
  if (v8)
  {
    uint64_t v9 = v8;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCI_ReadLocalName", v10, v11, v12, v13, v14, v15, v16, v19);
      uint64_t v17 = sub_100050B4C(0x4Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10025B144((void (**)(uint64_t))off_10099D370, v9);
  }
}

void sub_10016AEE4()
{
  if (sub_100183F14() < 4)
  {
    sub_10025B0BC((uint64_t)off_10099D370);
  }
  else
  {
    uint64_t v5 = sub_10018F230((uint64_t)sub_10016B3B8, 1u, (uint64_t)&unk_1007B9C08, v0, v1, v2, v3, v4);
    if (v5)
    {
      uint64_t v6 = v5;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCI_WriteEIR", v7, v8, v9, v10, v11, v12, v13, v15);
        uint64_t v14 = sub_100050B4C(0x4Eu);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))off_10099D370, v6);
    }
  }
}

void sub_10016AFAC()
{
  uint64_t v0 = sub_1000262C4();
  if (v0)
  {
    uint64_t v1 = v0;
    sub_10025B778("OI_LinkKeyStorage_Init failed %!\n", v0);
LABEL_7:
    sub_10025B144((void (**)(uint64_t))off_10099D370, v1);
    return;
  }
  uint64_t v2 = sub_10025396C(&off_10099D3A0);
  if (v2)
  {
    uint64_t v1 = v2;
    sub_10025B778("OI_SECMGR_RegisterESE failed %!\n", v2);
    goto LABEL_7;
  }
  uint64_t v3 = sub_100253BCC(&off_10099D418);
  if (v3)
  {
    uint64_t v1 = v3;
    sub_10025B778("OI_SECMGR_RegisterSecurityDB failed %!\n", v3);
    goto LABEL_7;
  }
  sub_10025346C(1);

  sub_10025B0BC((uint64_t)off_10099D370);
}

void sub_10016B080(uint64_t a1)
{
  if ((a1 - 701) <= 0x44)
  {
    sub_10025B778("writeStaticSettingsCb: ignoring HCI error %!\n", a1);
LABEL_8:
    sub_10025B0BC((uint64_t)off_10099D370);
    return;
  }
  if (!a1) {
    goto LABEL_8;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeStaticSettingsCb", v2, v3, v4, v5, v6, v7, v8, v10);
    uint64_t v9 = sub_100050B4C(0x4Eu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  sub_10025B144((void (**)(uint64_t))off_10099D370, a1);
}

void sub_10016B148(uint64_t a1, uint64_t a2)
{
  if (a1)
  {
    uint64_t v2 = a1;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"readNameCb", v3, v4, v5, v6, v7, v8, v9, v36);
      uint64_t v10 = sub_100050B4C(0x4Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
LABEL_5:
    sub_10025B144((void (**)(uint64_t))off_10099D370, v2);
    return;
  }
  if (*(unsigned char *)a2)
  {
    sub_10025B778("Local device name is: %s\n", (const char *)a2);
    uint64_t v12 = *(void *)a2;
    byte_100A045F8 = *(unsigned char *)(a2 + 8);
    qword_100A045F0 = v12;
    byte_100A045F9 = 0;
    sub_10025B0BC((uint64_t)off_10099D370);
  }
  else
  {
    sub_10025B778("Device has no name\n");
    __int16 v39 = 0;
    int v38 = 0;
    if (sub_100183EF4((uint64_t)&v38))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_DEVMGR_GetCachedLocalBdAddr", v18, v19, v13, v14, v15, v16, v17, v36);
        uint64_t v20 = sub_100050B4C(0x4Eu);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    sub_10025B74C((uint64_t)&qword_100A045F0, 10, (uint64_t)"APPLE %2x", v13, v14, v15, v16, v17, HIBYTE(v39));
    sub_10025B778("Writing device name as %s\n", (const char *)&qword_100A045F0);
    uint64_t v27 = sub_10018EFB8((uint64_t)sub_10016B328, (uint64_t)&qword_100A045F0, v21, v22, v23, v24, v25, v26);
    if (v27)
    {
      uint64_t v2 = v27;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCI_ChangeLocalName", v28, v29, v30, v31, v32, v33, v34, v37);
        char v35 = sub_100050B4C(0x4Eu);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      goto LABEL_5;
    }
  }
}

void sub_10016B328(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeNameCb", v3, v4, v5, v6, v7, v8, v9, v11);
      uint64_t v10 = sub_100050B4C(0x4Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10025B144((void (**)(uint64_t))off_10099D370, a1);
  }
  else
  {
    sub_10025B0BC((uint64_t)off_10099D370);
  }
}

void sub_10016B3B8(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeEirCb", v3, v4, v5, v6, v7, v8, v9, v11);
      uint64_t v10 = sub_100050B4C(0x4Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10025B144((void (**)(uint64_t))off_10099D370, a1);
  }
  else
  {
    sub_10025B0BC((uint64_t)off_10099D370);
  }
}

void sub_10016B454(uint64_t a1)
{
}

void sub_10016B468(uint64_t a1)
{
  sub_10025B778("pinCodeHandler, providing pin code %s for %:\n", off_1009F93E0, a1);
  uint64_t v2 = strlen(off_1009F93E0);
  uint64_t v7 = off_1009F93E0;

  sub_1002564F4(1, a1, (uint64_t)v7, v2, v3, v4, v5, v6);
}

void sub_10016B4D4(uint64_t a1)
{
  sub_10025B778("NEW SECURITY MODEL : securityManagerUserConfirmRequest\n");

  sub_100254CB8(1, a1, v2, v3, v4, v5, v6, v7);
}

void sub_10016B518(uint64_t a1)
{
  sub_10025B778("NEW SECURITY MODEL : securityManagerPassKeyRequest\n");

  sub_100255028(1, a1, 0, v2, v3, v4, v5, v6);
}

void sub_10016B560()
{
}

void sub_10016B56C()
{
}

void sub_10016B578(uint64_t a1)
{
  sub_10025B778("NEW SECURITY MODEL : securityManagerOOBRequest\n");

  sub_10025571C(0, a1, 0, 0, 0, 0, v2, v3);
}

void sub_10016B5CC()
{
}

void sub_10016B5D8()
{
}

void sub_10016B5E4()
{
}

uint64_t sub_10016B5F0()
{
  return 2;
}

uint64_t sub_10016B5F8(uint64_t a1, uint64_t a2)
{
  v3[0] = a1;
  v3[1] = a2;
  return 2 * (sub_100178188((uint64_t)v3) - 4096 > 2);
}

unint64_t sub_10016B630()
{
  *(_DWORD *)buffer = 0;
  uint64_t v0 = getenv("BT_BAUDRATE");
  if (v0) {
    return strtoul(v0, 0, 0);
  }
  CFDictionaryRef v2 = IOServiceNameMatching("bluetooth");
  if (!v2) {
    return 0;
  }
  io_service_t MatchingService = IOServiceGetMatchingService(kIOMainPortDefault, v2);
  if (!MatchingService) {
    return 0;
  }
  io_object_t v4 = MatchingService;
  CFDataRef v5 = (const __CFData *)IORegistryEntrySearchCFProperty(MatchingService, "IODeviceTree", @"transport-speed", kCFAllocatorDefault, 1u);
  if (v5)
  {
    CFDataRef v6 = v5;
    v8.location = 0;
    v8.length = 4;
    CFDataGetBytes(v5, v8, buffer);
    CFRelease(v6);
    sub_10025B778("DeviceTree speed = %d\n", *(_DWORD *)buffer);
  }
  IOObjectRelease(v4);
  unint64_t result = *(unsigned int *)buffer;
  if (*(_DWORD *)buffer >> 9 <= 0xE0u) {
    return 0;
  }
  return result;
}

uint64_t sub_10016B718()
{
  if (qword_100A04600 != -1) {
    dispatch_once(&qword_100A04600, &stru_10099D448);
  }
  return dword_1009F9400;
}

void sub_10016B75C(id a1)
{
  if (sub_10016B8BC("marconi-bt")) {
    sub_10016B8BC("bluetooth");
  }
  bzero(__str, 0x400uLL);
  size_t v6 = 1024;
  if (!sysctlbyname("kern.bootargs", __str, &v6, 0, 0))
  {
    uint64_t v1 = strtok(__str, " ");
    if (v1)
    {
      CFDictionaryRef v2 = v1;
      do
      {
        if (strstr(v2, "bt-transport-override"))
        {
          uint64_t v3 = strchr(v2, 61);
          unint64_t v4 = strtol(v3 + 1, 0, 10);
          int v5 = v4;
          if (v4 < 0xC)
          {
            sub_10025B778("transport override from boot-arg: %llu", v4);
            dword_1009F9400 = v5;
          }
          else
          {
            sub_10025B778("transport override from boot-arg is invalid: %llu", v4);
          }
        }
        CFDictionaryRef v2 = strtok(0, " ");
      }
      while (v2);
    }
  }
}

uint64_t sub_10016B8BC(const char *a1)
{
  CFDictionaryRef v1 = IOServiceNameMatching(a1);
  if (v1)
  {
    io_service_t MatchingService = IOServiceGetMatchingService(kIOMainPortDefault, v1);
    if (MatchingService)
    {
      io_object_t v3 = MatchingService;
      CFDataRef v4 = (const __CFData *)IORegistryEntrySearchCFProperty(MatchingService, "IODeviceTree", @"transport-encoding", kCFAllocatorDefault, 1u);
      if (v4)
      {
        CFDataRef v5 = v4;
        v7.location = 0;
        v7.length = 4;
        CFDataGetBytes(v4, v7, (UInt8 *)&dword_1009F9400);
        CFRelease(v5);
        IOObjectRelease(v3);
        sub_10025B778("DeviceTree transport = 0x%08x\n", dword_1009F9400);
        return 0;
      }
      IOObjectRelease(v3);
    }
  }
  return 1;
}

void sub_10016B988(int a1, uint64_t a2)
{
  unint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    unint64_t v5 = 0;
    size_t v6 = qword_100A15298;
    do
    {
      if (*v6 && *(unsigned __int16 *)*v6 == a1)
      {
        if (a2)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Transport switch error %d with lm %x, contiguous %d, leRSSI %d, connTO %d:%d", v7, v8, v9, v10, v11, v12, v13, a2);
            uint64_t v14 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
              sub_1007495A0();
            }
          }
          unsigned int v15 = (unsigned __int16)++*((_WORD *)v6 + 224);
          if (v15 > 8)
          {
            if (off_100A15288) {
              off_100A15288(*v6, 81, 297, 165);
            }
            sub_10010B844(5015, "TS Switch HW Error");
          }
        }
        else
        {
          if (*((_WORD *)v6 + 224))
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Successful TS, clearing contiguous TS failures", v16, v17, v18, v19, v20, v21, v22, v25);
              uint64_t v23 = sub_100050B4C(0x56u);
              if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
              {
                uint64_t v24 = sub_100050714();
                *(_DWORD *)int buf = 136446210;
                uint64_t v27 = v24;
                _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
              }
            }
          }
          *((_WORD *)v6 + 224) = 0;
        }
        unint64_t v2 = dword_100A1525C;
      }
      ++v5;
      v6 += 134;
    }
    while (v5 < v2);
  }
}

uint64_t sub_10016BB94(char a1, uint64_t a2)
{
  v57[0] = *(_OWORD *)off_10099D498;
  v57[1] = *(_OWORD *)off_10099D4A8;
  uint64_t v58 = 0;
  sub_1001F7F8C((uint64_t)sub_10016B988);
  uint64_t v4 = sub_1000E9608("com.apple.BT.TS", 0xFuLL, 2, 10, 1, 0, 1, 1, v57);
  if (v4)
  {
    uint64_t v5 = v4;
    if (!sub_100058654()) {
      goto LABEL_9;
    }
    sub_100056E24((uint64_t)"Failed to register TS service.", v6, v7, v8, v9, v10, v11, v12, v54);
    uint64_t v13 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      goto LABEL_9;
    }
    goto LABEL_8;
  }
  sub_10023413C((__n128 *)off_10099D4C0);
  if (v14)
  {
    uint64_t v5 = v14;
    if (!sub_100058654()) {
      goto LABEL_9;
    }
    sub_100056E24((uint64_t)"Failed to register TS security.", v15, v16, v17, v18, v19, v20, v21, v54);
    uint64_t v22 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      goto LABEL_9;
    }
LABEL_8:
    sub_100744F6C();
LABEL_9:
    bzero(qword_100A15298, 0x4300uLL);
    dword_100A1525C = 0;
    long long v24 = *(_OWORD *)(a2 + 16);
    long long v23 = *(_OWORD *)(a2 + 32);
    long long v25 = *(_OWORD *)a2;
    off_100A15290 = *(uint64_t (**)(void, void, void))(a2 + 48);
    *(_OWORD *)&xmmword_100A15270 = v24;
    *(_OWORD *)&off_100A15280 = v23;
    xmmword_100A15260 = v25;
    return v5;
  }
  bzero(qword_100A15298, 0x4300uLL);
  dword_100A1525C = 0;
  long long v28 = *(_OWORD *)(a2 + 16);
  long long v27 = *(_OWORD *)(a2 + 32);
  long long v29 = *(_OWORD *)a2;
  off_100A15290 = *(uint64_t (**)(void, void, void))(a2 + 48);
  *(_OWORD *)&xmmword_100A15270 = v28;
  *(_OWORD *)&off_100A15280 = v27;
  xmmword_100A15260 = v29;
  uint64_t v56 = 0;
  if (a1) {
    unsigned int v30 = 2;
  }
  else {
    unsigned int v30 = 1;
  }
  unsigned __int16 v55 = 0;
  if ((a1 & 2) != 0 && !sub_100263A48(&v56, &v55) && v56 && v55)
  {
    uint64_t v31 = sub_100022FE8(((unint64_t)v55 << 6) + 128);
    qword_100A15250 = (uint64_t)v31;
    byte_100A15258 = v30 + v55;
    if (v55)
    {
      unint64_t v46 = 0;
      unint64_t v47 = (unint64_t)v30 << 6;
      uint64_t v48 = 40;
      do
      {
        uint64_t v49 = v56;
        if (!*(void *)(v56 + v48 + 8))
        {
          sub_10025B8C0();
          uint64_t v49 = v56;
        }
        if (!*(void *)(v49 + v48 + 24))
        {
          sub_10025B8C0();
          uint64_t v49 = v56;
        }
        if (!*(void *)(v49 + v48 + 32))
        {
          sub_10025B8C0();
          uint64_t v49 = v56;
        }
        unint64_t v50 = qword_100A15250 + v47;
        *(unsigned char *)unint64_t v50 = v30 + v55;
        uint64_t v51 = (void *)(v49 + v48);
        *(_WORD *)(v50 + 1) = *((_WORD *)v51 - 18);
        *(_DWORD *)(v50 + 4) = *((_DWORD *)v51 - 8);
        uint64_t v52 = *(void *)((char *)v51 - 28);
        *(_WORD *)(v50 + 10) = WORD2(v52);
        *(_WORD *)(v50 + 8) = v52;
        *(_DWORD *)(v50 + 16) = *((_DWORD *)v51 - 5);
        *(unsigned char *)(v50 + 12) = *((unsigned char *)v51 - 16);
        *(_DWORD *)(v50 + 20) = *((_DWORD *)v51 - 3);
        *(void *)(v50 + 24) = *v51;
        *(void *)(qword_100A15250 + v47 + 32) = *(void *)(v56 + v48 + 8);
        *(void *)(qword_100A15250 + v47 + 40) = *(void *)(v56 + v48 + 24);
        *(void *)(qword_100A15250 + v47 + 48) = *(void *)(v56 + v48 + 32);
        *(void *)(qword_100A15250 + v47 + 56) = *(void *)(v56 + v48 + 16);
        uint64_t v53 = v56;
        if (*(unsigned char *)(v56 + v48 - 16) && !*(void *)(v56 + v48 + 16))
        {
          sub_10025B8C0();
          *(unsigned char *)(qword_100A15250 + v47 + 12) = 0;
          uint64_t v53 = v56;
        }
        sub_10019C404(*(unsigned char *)(qword_100A15250 + v47), *(_WORD *)(v53 + v48 - 8), *(_WORD *)(v53 + v48 - 6), *(void *)(v53 + v48 + 40));
        (*(void (**)(void))(v56 + v48))(*(unsigned __int8 *)(v56 + v48 - 36));
        ++v46;
        v47 += 64;
        v48 += 88;
      }
      while (v46 < v55);
      uint64_t v31 = (unsigned char *)qword_100A15250;
    }
  }
  else
  {
    uint64_t v31 = sub_100022FE8(v30 << 6);
    qword_100A15250 = (uint64_t)v31;
    byte_100A15258 = v30;
  }
  if (!v31) {
    return 106;
  }
  *(_WORD *)uint64_t v31 = 257;
  v31[2] = 1;
  v31[12] = 0;
  int v32 = sub_10021C948();
  int v33 = sub_10021C948();
  int v34 = sub_100219F44(v32, v33, 0x1D4Cu, 0x1Eu, 1, 1);
  *(_DWORD *)(qword_100A15250 + 4) = v34;
  if (!v34)
  {
    if (sub_100058654())
    {
      unsigned int v35 = sub_10021C948();
      sub_100056E24((uint64_t)"Calculated tput is zero for data length %d and ce %d us", v36, v37, v38, v39, v40, v41, v42, v35);
      uint64_t v43 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  uint64_t v44 = qword_100A15250;
  *(_DWORD *)(qword_100A15250 + 8) = 1179678;
  *(void *)(v44 + 16) = 0xFFFFFC1800000000;
  *(_OWORD *)(v44 + 24) = 0u;
  *(_OWORD *)(v44 + 40) = 0u;
  *(void *)(v44 + 56) = 0;
  if (a1)
  {
    *(_WORD *)(v44 + 64) = 514;
    *(unsigned char *)(v44 + 66) = 1;
    *(unsigned char *)(v44 + 76) = 0;
    *(void *)(v44 + 68) = 0x64000400000708;
    int v45 = dword_1009F9408;
    *(_DWORD *)(v44 + 80) = 300;
    *(_DWORD *)(v44 + 84) = v45;
    *(_OWORD *)(v44 + 88) = 0uLL;
    *(_OWORD *)(v44 + 104) = 0uLL;
    *(void *)(v44 + 120) = 0;
  }
  return 0;
}

uint64_t sub_10016C078()
{
  return 1;
}

void sub_10016C080(unsigned __int16 *a1, unsigned int a2, void *a3, int a4)
{
  if (a4 == 15 && *a3 == 0x6C7070612E6D6F63 && *(void *)((char *)a3 + 7) == 0x53542E54422E656CLL)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Pipe 0x%4x is available for %p (lm 0x%4x) with priority %d", v7, v8, v9, v10, v11, v12, v13, a2);
      uint64_t v14 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v51 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v14, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    unsigned int v15 = dword_100A1525C;
    if (!dword_100A1525C) {
      goto LABEL_28;
    }
    uint64_t v16 = &word_100A152A0;
    uint64_t v17 = dword_100A1525C;
    while (*((unsigned __int16 **)v16 - 1) != a1)
    {
      v16 += 536;
      if (!--v17) {
        goto LABEL_17;
      }
    }
    if (*v16 != -1)
    {
      sub_10025B8C0();
      unsigned int v15 = dword_100A1525C;
    }
    if (!v15) {
      goto LABEL_28;
    }
LABEL_17:
    uint64_t v18 = v15;
    uint64_t v19 = &word_100A152A0;
    while (*((unsigned __int16 **)v19 - 1) != a1)
    {
      v19 += 536;
      if (!--v18) {
        goto LABEL_28;
      }
    }
    if (*v19 != -1)
    {
      if (off_100A15288) {
        off_100A15288(a1, 81, 3207, 133);
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Already have a TS pipe fot his handle !!!", v20, v21, v22, v23, v24, v25, v26, v49);
        long long v27 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
    }
    else
    {
LABEL_28:
      long long v28 = &qword_100A15298[134 * v15];
      bzero(v28, 0x430uLL);
      *long long v28 = (uint64_t)a1;
      *((_WORD *)v28 + 4) = a2;
      *((_DWORD *)v28 + 12) = 1;
      sub_1001713B0(v15, 1u);
      long long v29 = &qword_100A15298[134 * dword_100A1525C];
      *((unsigned char *)v29 + 77) = 0;
      v29[10] = 0x100000001;
      *((_DWORD *)v29 + 29) = 0;
      *((_DWORD *)v29 + 47) = -30;
      sub_10010BC48((uint64_t)(v29 + 24));
      unsigned int v30 = &qword_100A15298[134 * dword_100A1525C];
      *((_DWORD *)v30 + 40) = *((_DWORD *)v30 + 48);
      *((_WORD *)v30 + 82) = *((_WORD *)v30 + 98);
      sub_10010BC48((uint64_t)(v30 + 26));
      sub_1000E4750(dword_100A1525C);
      BYTE5(qword_100A15298[134 * dword_100A1525C + 55]) = sub_1000E7334((uint64_t)a1);
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Storing pipe start %d:%d with tsTimeoutRequired %d", v31, v32, v33, v34, v35, v36, v37, LODWORD(qword_100A15298[134 * dword_100A1525C + 24]));
        uint64_t v38 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v39 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v51 = v39;
          _os_log_impl((void *)&_mh_execute_header, v38, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      ++dword_100A1525C;
      if (sub_1000E7480((uint64_t)a1))
      {
        sub_100170D50(a2, 2u);
        if (sub_1001F7D74()
          && sub_1001F7D74() <= 0x7CF
          && sub_1001F7D74() > 0xE
          || sub_1001F7D74() >= 0x7D0 && sub_1001F7D74() <= 0xF9F)
        {
          sub_1002010A4((uint64_t)a1, 1, 1);
        }
        if (sub_1000E7430((uint64_t)a1)) {
          sub_1001722A8(a1);
        }
      }
      if (sub_1000EA094() && sub_1000E37C0((uint64_t)a1, 1) && sub_100058654())
      {
        sub_100056E24((uint64_t)"Force upgrade TS not ready E", v40, v41, v42, v43, v44, v45, v46, v49);
        unint64_t v47 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v48 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v51 = v48;
          _os_log_impl((void *)&_mh_execute_header, v47, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }
  }
}

void sub_10016C4C8(unsigned int a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"pipe 0x%4x is gone, remaining peers %d", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (dword_100A1525C)
  {
    uint64_t v10 = 0;
    while (LOWORD(qword_100A15298[134 * v10 + 1]) != a1)
    {
      if (++v10 == dword_100A1525C) {
        return;
      }
    }
    uint64_t v11 = &qword_100A15298[134 * v10];
    uint64_t v46 = 0;
    sub_10010BC48((uint64_t)&v46);
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Done with connection, %d total bytes sent in %d seconds (%d kbps)", v12, v13, v14, v15, v16, v17, v18, HIDWORD(qword_100A15298[134 * v10 + 11]));
      uint64_t v19 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v20 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = v20;
        _os_log_impl((void *)&_mh_execute_header, v19, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    if (*((void *)&xmmword_100A15270 + 1)) {
      (*((void (**)(void, void, uint64_t, uint64_t))&xmmword_100A15270 + 1))(LOBYTE(qword_100A15298[134 * v10 + 7]), 0, v11[24], v46);
    }
    uint64_t v21 = (unsigned char *)*v11;
    uint64_t v22 = &qword_100A15298[134 * v10];
    int v24 = *((unsigned __int8 *)v22 + 10);
    uint64_t v23 = (unsigned __int8 *)v22 + 10;
    if (v24)
    {
      uint64_t v45 = (unsigned char *)*v11;
      unint64_t v25 = 0;
      char v26 = 0;
      do
      {
        long long v27 = &qword_100A15298[134 * v10 + 2 * v25];
        long long v28 = (unsigned __int16 *)v27[2];
        if (v28)
        {
          if (sub_100197698(v27[2]))
          {
            sub_10017BD74((uint64_t)v28, 0x13u);
          }
          else if (*((unsigned char *)v28 + 2) == 8)
          {
            uint64_t v29 = byte_100A15258;
            if (byte_100A15258)
            {
              unsigned int v30 = (void (**)(void))(qword_100A15250 + 48);
              while (*((unsigned __int8 *)v30 - 47) != LOBYTE(qword_100A15298[134 * v10 + 3 + 2 * v25]))
              {
                v30 += 8;
                if (!--v29) {
                  goto LABEL_26;
                }
              }
              (*v30)(*v28);
            }
          }
LABEL_26:
          char v26 = 1;
        }
        ++v25;
      }
      while (v25 < *v23);
      uint64_t v21 = v45;
      if (v26) {
        goto LABEL_37;
      }
    }
    if (LODWORD(qword_100A15298[134 * v10 + 6]) != 8 || !sub_1000E7430((uint64_t)v21)) {
      goto LABEL_37;
    }
    if (v21[48])
    {
      if (!v21[55] || v21[56]) {
        goto LABEL_37;
      }
      uint64_t v37 = (uint64_t)(v21 + 57);
    }
    else
    {
      uint64_t v37 = (uint64_t)(v21 + 49);
    }
    sub_10018F058(0, v37, v31, v32, v33, v34, v35, v36);
LABEL_37:
    uint64_t v38 = HIDWORD(qword_100A15298[134 * v10 + 6]);
    if (v38) {
      sub_100026DB4(v38);
    }
    uint64_t v39 = &qword_100A15298[134 * v10];
    if (sub_100026E24(*((_DWORD *)v39 + 110))) {
      sub_100026DB4(*((unsigned int *)v39 + 110));
    }
    uint64_t v40 = &qword_100A15298[134 * v10];
    uint64_t v43 = (void *)v40[8];
    uint64_t v42 = v40 + 8;
    uint64_t v41 = v43;
    if (v43)
    {
      sub_100023010(v41);
      *uint64_t v42 = 0;
      LODWORD(qword_100A15298[134 * v10 + 9]) = 0;
    }
    v48[0] = xmmword_1007B9D70;
    v48[1] = unk_1007B9D80;
    memcpy(buf, "state", sizeof(buf));
    sub_10010CA6C("Magnet Operation", (const char *)buf, v48, 2);
    uint64_t v44 = &qword_100A15298[134 * --dword_100A1525C];
    memcpy(&qword_100A15298[134 * v10], v44, 0x430uLL);
    bzero(v44, 0x430uLL);
  }
}

void sub_10016C900(uint64_t a1, unsigned __int8 *a2, uint64_t a3, uint64_t a4, int a5)
{
  int v5 = a3;
  uint64_t v7 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v8 = &word_100A152A0;
    while ((unsigned __int16)*v8 != a1)
    {
      v8 += 536;
      if (!--v7) {
        goto LABEL_5;
      }
    }
    uint64_t v9 = (unsigned __int16 *)*((void *)v8 - 1);
    if (!a2) {
      return;
    }
  }
  else
  {
LABEL_5:
    uint64_t v9 = 0;
    if (!a2) {
      return;
    }
  }
  if (a3 < 2 || !v9) {
    return;
  }
  if (a3 - 2 != a2[1])
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"Wrong packet : %@", v11, v12, v13, v14, v15, v16, v17, (uint64_t)a2);
    uint64_t v18 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_21:
    sub_100744F6C();
    return;
  }
  if (a5 && off_100A15290) {
    off_100A15290(v9, a1, a3);
  }
  unsigned int v10 = *a2;
  if (v10 <= 0x1F)
  {
    switch(*a2)
    {
      case 1u:
        sub_100173B28(v9, a2 + 2, (v5 - 2));
        break;
      case 2u:
        sub_100174484(v9, a2 + 2, v5 - 2);
        break;
      case 5u:
        sub_100174A64((uint64_t)v9, a2 + 2);
        break;
      case 0x10u:
        sub_1001751A8(v9, a2 + 2, v5 - 2);
        break;
      case 0x11u:
        sub_100174C8C(v9, a2 + 2, v5 - 2);
        break;
      case 0x12u:
        sub_1001758DC(v9, a2 + 2, v5 - 2);
        break;
      case 0x13u:
        sub_100175BCC(v9, a2 + 2, v5 - 2);
        break;
      case 0x14u:
        sub_100175E2C(v9, a2 + 2, v5 - 2);
        break;
      default:
        goto LABEL_61;
    }
    return;
  }
  if (*a2 <= 0x21u)
  {
    if (v10 == 32)
    {
      sub_10017627C(v9);
    }
    else
    {
      if (v10 != 33) {
        goto LABEL_61;
      }
      sub_100176610(v9);
    }
  }
  else
  {
    if (v10 != 34)
    {
      if (v10 == 255)
      {
        if (!sub_100058654()) {
          return;
        }
        uint64_t v19 = sub_100176E24(a2[2]);
        sub_100056E24((uint64_t)"Got TS error with message %s %s", v28, v29, v30, v31, v32, v33, v34, (uint64_t)v19);
        uint64_t v35 = sub_100050B4C(0x56u);
        if (!os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
          return;
        }
        goto LABEL_21;
      }
      if (v10 == 254) {
        sub_100176D54(a2[2]);
      }
LABEL_61:
      if (!sub_100058654()) {
        return;
      }
      sub_100056E24((uint64_t)"Unknown PDU opcode %d, dataSize %d", v20, v21, v22, v23, v24, v25, v26, *a2);
      long long v27 = sub_100050B4C(0x56u);
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        return;
      }
      goto LABEL_21;
    }
    sub_100176A98(v9);
  }
}

void sub_10016CD64(int a1, int a2)
{
  uint64_t v2 = byte_100A15258;
  if (byte_100A15258)
  {
    for (uint64_t i = (unsigned char *)(qword_100A15250 + 2); *(i - 1) != a1; i += 64)
    {
      if (!--v2) {
        return;
      }
    }
    int v4 = *i;
    *uint64_t i = a2;
    if (v4 != a2 && dword_100A1525C != 0)
    {
      unint64_t v6 = 0;
      int v7 = *(i - 2);
      uint64_t v8 = qword_100A15298;
      do
      {
        sub_100172698(*v8, v7);
        ++v6;
        v8 += 134;
      }
      while (v6 < dword_100A1525C);
    }
  }
}

void sub_10016CE08(int a1, int a2, int a3)
{
  uint64_t v3 = byte_100A15258;
  if (byte_100A15258)
  {
    for (uint64_t i = (_WORD *)(qword_100A15250 + 8); *((unsigned __int8 *)i - 7) != a1; i += 32)
    {
      if (!--v3) {
        return;
      }
    }
    if (*((_DWORD *)i - 1) == a2)
    {
      int v5 = (unsigned __int16)*i;
      *((_DWORD *)i - 1) = a2;
      *uint64_t i = a3;
      if (v5 == a3) {
        return;
      }
    }
    else
    {
      *((_DWORD *)i - 1) = a2;
      *uint64_t i = a3;
    }
    if (dword_100A1525C)
    {
      unint64_t v6 = 0;
      int v7 = *((unsigned __int8 *)i - 8);
      uint64_t v8 = qword_100A15298;
      do
      {
        sub_100172698(*v8, v7);
        ++v6;
        v8 += 134;
      }
      while (v6 < dword_100A1525C);
    }
  }
}

uint64_t sub_10016CEC8()
{
  sub_1002341F8(off_10099D4C0);
  sub_1000EA0F4("com.apple.BT.TS", 0xFu, 2, 10);
  bzero(qword_100A15298, 0x4300uLL);
  dword_100A1525C = 0;
  unsigned int v0 = byte_100A15258;
  if (byte_100A15258)
  {
    uint64_t v1 = 0;
    unint64_t v2 = 0;
    uint64_t v3 = qword_100A15250;
    do
    {
      int v4 = *(void (**)(void))(v3 + v1 + 32);
      if (v4)
      {
        v4(*(unsigned __int8 *)(v3 + v1));
        uint64_t v3 = qword_100A15250;
        unsigned int v0 = byte_100A15258;
      }
      ++v2;
      v1 += 64;
    }
    while (v2 < v0);
    if (v0) {
      sub_100023010((void *)qword_100A15250);
    }
  }
  qword_100A15250 = 0;
  byte_100A15258 = 0;

  return sub_10025B3D0();
}

uint64_t sub_10016CF94(unsigned __int16 *a1, int a2, int a3)
{
  if (sub_1000E7480((uint64_t)a1))
  {
    if (sub_1000E7430((uint64_t)a1))
    {
      return sub_10016D074(a1, a2, a3);
    }
    else
    {
      return sub_10016D5D4(a1, a2, a3);
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Link is not encrypted, can't send upgrade", v7, v8, v9, v10, v11, v12, v13, v15);
      uint64_t v14 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4802;
  }
}

uint64_t sub_10016D074(unsigned __int16 *a1, int a2, int a3)
{
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    return 414;
  }
  for (uint64_t i = &word_100A152A0; *((unsigned __int16 **)i - 1) != a1; i += 536)
  {
    if (!--v3) {
      return 414;
    }
  }
  uint64_t v8 = (unsigned __int16)*i;
  unsigned __int16 __len = 0;
  if (v8 == 0xFFFF) {
    return 414;
  }
  if ((sub_1000E7480((uint64_t)a1) & 1) == 0)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Link is not encrypted, can't send caps changed", v13, v14, v15, v16, v17, v18, v19, v58);
      uint64_t v20 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4802;
  }
  uint64_t v9 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_30;
  }
  uint64_t v10 = &dword_100A152C8;
  while (*((unsigned __int16 *)v10 - 20) != v8)
  {
    v10 += 268;
    if (!--v9) {
      goto LABEL_30;
    }
  }
  if (*v10 != 6)
  {
LABEL_30:
    if (sub_100058654())
    {
      uint64_t v30 = dword_100A1525C;
      if (dword_100A1525C)
      {
        uint64_t v31 = (unsigned int *)&dword_100A152C8;
        while (*((unsigned __int16 *)v31 - 20) != v8)
        {
          v31 += 268;
          if (!--v30) {
            goto LABEL_35;
          }
        }
        unsigned int v32 = *v31;
      }
      else
      {
LABEL_35:
        unsigned int v32 = 0;
      }
      uint64_t v33 = sub_10016E6F8(v32);
      sub_100056E24((uint64_t)"Message should only be send when in ##state state. Current state is %s", v34, v35, v36, v37, v38, v39, v40, (uint64_t)v33);
      uint64_t v41 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 408;
  }
  if (!byte_100A15258)
  {
LABEL_24:
    if (!sub_100058654()) {
      return 120;
    }
    if (a2 <= 2)
    {
      if (a2 == 1)
      {
        uint64_t v29 = "LE";
        goto LABEL_70;
      }
      if (a2 == 2)
      {
        uint64_t v29 = "BT";
        goto LABEL_70;
      }
    }
    else
    {
      switch(a2)
      {
        case 3:
          uint64_t v29 = "WL";
          goto LABEL_70;
        case 16:
          uint64_t v29 = "USB";
          goto LABEL_70;
        case 17:
          uint64_t v29 = "AWDL";
          goto LABEL_70;
      }
    }
    uint64_t v29 = "??";
LABEL_70:
    sub_100056E24((uint64_t)"Could not find transport tech %s.", v22, v23, v24, v25, v26, v27, v28, (uint64_t)v29);
    uint64_t v54 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
    return 120;
  }
  uint64_t v21 = 0;
  while (*(unsigned __int8 *)(qword_100A15250 + v21 + 1) != a2)
  {
    v21 += 64;
    if ((unint64_t)byte_100A15258 << 6 == v21) {
      goto LABEL_24;
    }
  }
  if (*(unsigned char *)(qword_100A15250 + v21 + 12)) {
    uint64_t v42 = (void *)(*(uint64_t (**)(unsigned __int16 *))(qword_100A15250 + v21 + 56))(&__len);
  }
  else {
    uint64_t v42 = 0;
  }
  sub_100170974(a1);
  uint64_t v43 = sub_100022FE8(__len + 3);
  if (!v43)
  {
    if (v42) {
      sub_100023010(v42);
    }
    return 106;
  }
  uint64_t v44 = v43;
  *uint64_t v43 = 17;
  v43[1] = __len + 1;
  v43[2] = *(unsigned char *)(qword_100A15250 + v21);
  if (v42 && __len)
  {
    memmove(v43 + 3, v42, __len);
LABEL_54:
    sub_100023010(v42);
    goto LABEL_55;
  }
  if (v42) {
    goto LABEL_54;
  }
LABEL_55:
  sub_100170D50(v8, 7u);
  if (dword_100A1525C)
  {
    unsigned __int16 v45 = 0;
    while ((unsigned __int16 *)qword_100A15298[134 * v45] != a1)
    {
      if (dword_100A1525C <= ++v45) {
        goto LABEL_61;
      }
    }
    BYTE5(qword_100A15298[134 * v45 + 9]) = a2;
  }
LABEL_61:
  if (a1) {
    uint64_t v46 = *a1;
  }
  else {
    uint64_t v46 = 0;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Sending UPGRADE for lmhandle 0x%4x pipe:0x%4X to %s", v47, v48, v49, v50, v51, v52, v53, v46);
    unsigned __int16 v55 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v56 = sub_100050714();
      *(_DWORD *)__len_2 = 136446210;
      *(void *)&__len_2[4] = v56;
      _os_log_impl((void *)&_mh_execute_header, v55, OS_LOG_TYPE_DEFAULT, " %{public}s", __len_2, 0xCu);
    }
  }
  unsigned int v57 = sub_1000E8FC8(0, a1, v8, v44, (unsigned __int16)(__len + 3), 0);
  if (v57 == 412) {
    uint64_t v11 = 0;
  }
  else {
    uint64_t v11 = v57;
  }
  if (!v11)
  {
    long long v61 = 0u;
    long long v62 = 0u;
    LOBYTE(v61) = 1;
    WORD1(v61) = 4;
    DWORD2(v61) = 8;
    LOBYTE(v62) = 1;
    WORD1(v62) = 4;
    DWORD2(v62) = a2 | (a3 << 8);
    memcpy(__len_2, "state", sizeof(__len_2));
    sub_10010CA6C("Magnet Operation", (const char *)__len_2, &v61, 2);
    sub_100170F7C(v8, 0x3A98u);
  }
  sub_100023010(v44);
  return v11;
}

uint64_t sub_10016D5D4(unsigned __int16 *a1, int a2, int a3)
{
  char v39 = 0;
  __int16 v38 = 272;
  LODWORD(v3) = dword_100A1525C;
  if (!dword_100A1525C) {
    return 120;
  }
  unsigned __int16 v6 = 0;
  while (1)
  {
    unsigned __int16 v7 = v6;
    if ((unsigned __int16 *)qword_100A15298[134 * v6] == a1) {
      break;
    }
LABEL_4:
    unsigned __int16 v6 = v7 + 1;
    if (v3 <= (unsigned __int16)(v7 + 1)) {
      return 120;
    }
  }
  uint64_t v8 = &qword_100A15298[134 * v6];
  int v11 = *((unsigned __int16 *)v8 + 4);
  uint64_t v10 = (unsigned __int16 *)(v8 + 1);
  int v9 = v11;
  uint64_t v12 = &dword_100A152C8;
  uint64_t v3 = v3;
  while (*((unsigned __int16 *)v12 - 20) != v9)
  {
    v12 += 268;
    if (!--v3) {
      goto LABEL_19;
    }
  }
  if (*v12 != 6)
  {
LABEL_19:
    if (sub_100058654())
    {
      uint64_t v24 = dword_100A1525C;
      if (dword_100A1525C)
      {
        uint64_t v25 = (unsigned int *)&dword_100A152C8;
        while (*((unsigned __int16 *)v25 - 20) != *v10)
        {
          v25 += 268;
          if (!--v24) {
            goto LABEL_24;
          }
        }
        unsigned int v26 = *v25;
      }
      else
      {
LABEL_24:
        unsigned int v26 = 0;
      }
      uint64_t v28 = sub_10016E6F8(v26);
      sub_100056E24((uint64_t)"Message should only be send when in ##state state. Current state is %s", v29, v30, v31, v32, v33, v34, v35, (uint64_t)v28);
      uint64_t v36 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 408;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Sending UPGRADE_REQ for lmhandle 0x%4x tech %s", v13, v14, v15, v16, v17, v18, v19, *a1);
    uint64_t v20 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v21 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = v21;
      _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  long long v41 = 0u;
  long long v42 = 0u;
  LOBYTE(v41) = 1;
  WORD1(v41) = 4;
  DWORD2(v41) = 7;
  LOBYTE(v42) = 1;
  WORD1(v42) = 4;
  DWORD2(v42) = a3;
  memcpy(buf, "state", sizeof(buf));
  sub_10010CA6C("Magnet Operation", (const char *)buf, &v41, 2);
  uint64_t v22 = byte_100A15258;
  if (!byte_100A15258)
  {
LABEL_18:
    LODWORD(v3) = dword_100A1525C;
    goto LABEL_4;
  }
  uint64_t v23 = (unsigned __int8 *)(qword_100A15250 + 1);
  while (*v23 != a2)
  {
    v23 += 64;
    if (!--v22) {
      goto LABEL_18;
    }
  }
  char v39 = *(v23 - 1);
  LODWORD(result) = sub_1000E8FC8(0, a1, *v10, &v38, 3, 0);
  if (result == 412) {
    return 0;
  }
  else {
    return result;
  }
}

uint64_t sub_10016D914(unsigned __int16 *a1, int a2)
{
  if (sub_1000E7480((uint64_t)a1))
  {
    if (sub_1000E7430((uint64_t)a1))
    {
      return sub_10016DC1C(a1, a2);
    }
    uint64_t v13 = dword_100A1525C;
    if (dword_100A1525C)
    {
      uint64_t v14 = &word_100A152A0;
      uint64_t v15 = dword_100A1525C;
      while (*((unsigned __int16 **)v14 - 1) != a1)
      {
        v14 += 536;
        if (!--v15)
        {
          uint64_t v16 = 0xFFFFLL;
          goto LABEL_17;
        }
      }
      uint64_t v16 = (unsigned __int16)*v14;
LABEL_17:
      __int16 v39 = 34;
      uint64_t v17 = &dword_100A152C8;
      while (*((unsigned __int16 *)v17 - 20) != v16)
      {
        v17 += 268;
        if (!--v13) {
          goto LABEL_28;
        }
      }
      if (*v17 == 6)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Sending DOWNGRADE_REQ to lmhandle 0x%4x", v18, v19, v20, v21, v22, v23, v24, *a1);
          uint64_t v25 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            *(void *)&uint8_t buf[4] = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        uint64_t result = sub_1000E8FC8(0, a1, v16, &v39, 2, 0);
        if (result == 412 || !result)
        {
          long long v41 = 0u;
          long long v42 = 0u;
          LOBYTE(v41) = 1;
          WORD1(v41) = 4;
          DWORD2(v41) = 11;
          LOBYTE(v42) = 1;
          WORD1(v42) = 4;
          DWORD2(v42) = a2;
          memcpy(buf, "state", sizeof(buf));
          sub_10010CA6C("Magnet Operation", (const char *)buf, &v41, 2);
          return 0;
        }
        return result;
      }
    }
    else
    {
      LODWORD(v16) = 0xFFFF;
    }
LABEL_28:
    if (sub_100058654())
    {
      uint64_t v26 = dword_100A1525C;
      if (dword_100A1525C)
      {
        uint64_t v27 = (unsigned int *)&dword_100A152C8;
        while (*((unsigned __int16 *)v27 - 20) != v16)
        {
          v27 += 268;
          if (!--v26) {
            goto LABEL_33;
          }
        }
        unsigned int v28 = *v27;
      }
      else
      {
LABEL_33:
        unsigned int v28 = 0;
      }
      uint64_t v29 = sub_10016E6F8(v28);
      sub_100056E24((uint64_t)"Message should only be send when in ##state state. Current state is %s", v30, v31, v32, v33, v34, v35, v36, (uint64_t)v29);
      uint64_t v37 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 408;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Link is not encrypted, can't send upgrade", v5, v6, v7, v8, v9, v10, v11, v38);
      uint64_t v12 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4802;
  }
}

uint64_t sub_10016DC1C(unsigned __int16 *a1, int a2)
{
  __int16 v60 = 32;
  uint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v5 = &word_100A152A0;
    uint64_t v6 = dword_100A1525C;
    while (*((unsigned __int16 **)v5 - 1) != a1)
    {
      v5 += 536;
      if (!--v6) {
        goto LABEL_5;
      }
    }
    if (!*((unsigned char *)v5 + 2))
    {
      if (!sub_100058654()) {
        return 408;
      }
      sub_100056E24((uint64_t)"No alternate handle to downgrade from.", v21, v22, v23, v24, v25, v26, v27, v59);
      unsigned int v28 = sub_100050B4C(0x56u);
      if (!os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        return 408;
      }
      goto LABEL_50;
    }
    uint64_t v17 = (unsigned __int16)*v5;
    if (v17 != 0xFFFF)
    {
      uint64_t v18 = (unsigned __int16 *)*((void *)v5 + 1);
      uint64_t v19 = &dword_100A152C8;
      uint64_t v20 = dword_100A1525C;
      while (*((unsigned __int16 *)v19 - 20) != v17)
      {
        v19 += 268;
        if (!--v20) {
          goto LABEL_20;
        }
      }
      if (*v19 == 6)
      {
LABEL_25:
        sub_100170974(v18);
        if ((sub_100197698((uint64_t)v18)
           || sub_100197740((uint64_t)v18)
           || sub_100197770((uint64_t)v18)
           || sub_1001977A0((uint64_t)v18))
          && sub_10019E5A8((uint64_t)v18))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Waiting for data on lmhandle 0x%4x to be flushed before sending downgrade.", v30, v31, v32, v33, v34, v35, v36, *v18);
            uint64_t v37 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
            {
              *(_DWORD *)int buf = 136446210;
              *(void *)&uint8_t buf[4] = sub_100050714();
              _os_log_impl((void *)&_mh_execute_header, v37, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
          sub_100170D50(v17, 0xBu);
          sub_10019E2C4(1, (uint64_t)v18, sub_100170EA0);
          return 0;
        }
        else
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Sending DOWNGRADE to lmhandle 0x%4x", v41, v42, v43, v44, v45, v46, v47, *a1);
            uint64_t v48 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
            {
              *(_DWORD *)int buf = 136446210;
              *(void *)&uint8_t buf[4] = sub_100050714();
              _os_log_impl((void *)&_mh_execute_header, v48, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
          unsigned int v49 = sub_1000E8FC8(0, a1, v17, &v60, 2, 0);
          if (v49 == 412) {
            uint64_t v15 = 0;
          }
          else {
            uint64_t v15 = v49;
          }
          if (v15)
          {
            sub_100171078(v18);
          }
          else
          {
            sub_100170D50(v17, 0xCu);
            sub_100170F7C(v17, 0x3A98u);
          }
          long long v62 = 0u;
          long long v63 = 0u;
          LOBYTE(v62) = 1;
          WORD1(v62) = 4;
          DWORD2(v62) = 10;
          LOBYTE(v63) = 1;
          WORD1(v63) = 4;
          DWORD2(v63) = a2;
          memcpy(buf, "state", sizeof(buf));
          sub_10010CA6C("Magnet Operation", (const char *)buf, &v62, 2);
        }
        return v15;
      }
LABEL_20:
      uint64_t v29 = &dword_100A152C8;
      while (*((unsigned __int16 *)v29 - 20) != v17)
      {
        v29 += 268;
        if (!--v2) {
          goto LABEL_34;
        }
      }
      if (*v29 == 11) {
        goto LABEL_25;
      }
LABEL_34:
      if (!sub_100058654()) {
        return 408;
      }
      uint64_t v38 = dword_100A1525C;
      if (dword_100A1525C)
      {
        __int16 v39 = (unsigned int *)&dword_100A152C8;
        while (*((unsigned __int16 *)v39 - 20) != v17)
        {
          v39 += 268;
          if (!--v38) {
            goto LABEL_39;
          }
        }
        unsigned int v40 = *v39;
      }
      else
      {
LABEL_39:
        unsigned int v40 = 0;
      }
      uint64_t v50 = sub_10016E6F8(v40);
      sub_100056E24((uint64_t)"Message should only be send when in IDLE/DOWNGRADE_STALL state. Current state is %s", v51, v52, v53, v54, v55, v56, v57, (uint64_t)v50);
      uint64_t v58 = sub_100050B4C(0x56u);
      if (!os_log_type_enabled(v58, OS_LOG_TYPE_ERROR)) {
        return 408;
      }
LABEL_50:
      sub_100744F6C();
      return 408;
    }
  }
LABEL_5:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Invalid handle for downgrade", v7, v8, v9, v10, v11, v12, v13, v59);
    uint64_t v14 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 414;
}

uint64_t sub_10016E058(unsigned __int16 *a1, char a2, int a3)
{
  uint64_t result = sub_10016D914(a1, a3);
  if (!result)
  {
    uint64_t v6 = dword_100A1525C;
    if (dword_100A1525C)
    {
      for (uint64_t i = qword_100A15298; (unsigned __int16 *)*i != a1; i += 134)
      {
        if (!--v6) {
          return result;
        }
      }
      *((unsigned char *)i + 77) = a2;
    }
  }
  return result;
}

void sub_10016E0C0(uint64_t a1)
{
  if (a1 && sub_100058654())
  {
    sub_100056E24((uint64_t)"PhyStatsEnabled with error %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
}

uint64_t sub_10016E134(uint64_t a1, _DWORD *a2)
{
  if (!dword_100A1525C) {
    return 0;
  }
  uint64_t v4 = 0;
  for (uint64_t i = qword_100A15298;
        !*i || !sub_100197770(*i) || *(unsigned __int16 *)(a1 + 204) != *(unsigned __int16 *)*i;
        i += 134)
  {
    if (++v4 >= (unint64_t)dword_100A1525C) {
      return 0;
    }
  }
  int v7 = sub_1000E8334(*i, a1);
  *((_DWORD *)i + 47) = *(__int16 *)(a1 + 18);
  long long v8 = *(_OWORD *)(a1 + 144);
  long long v9 = *(_OWORD *)(a1 + 160);
  long long v10 = *(_OWORD *)(a1 + 176);
  *(_OWORD *)((char *)i + 422) = *(_OWORD *)(a1 + 190);
  *(_OWORD *)(i + 49) = v9;
  *(_OWORD *)(i + 51) = v10;
  *(_OWORD *)(i + 47) = v8;
  long long v11 = *(_OWORD *)(a1 + 80);
  long long v12 = *(_OWORD *)(a1 + 96);
  long long v13 = *(_OWORD *)(a1 + 128);
  *(_OWORD *)(i + 43) = *(_OWORD *)(a1 + 112);
  *(_OWORD *)(i + 45) = v13;
  *(_OWORD *)(i + 39) = v11;
  *(_OWORD *)(i + 41) = v12;
  long long v14 = *(_OWORD *)(a1 + 16);
  long long v15 = *(_OWORD *)(a1 + 32);
  long long v16 = *(_OWORD *)(a1 + 64);
  *(_OWORD *)(i + 35) = *(_OWORD *)(a1 + 48);
  *(_OWORD *)(i + 37) = v16;
  *(_OWORD *)(i + 33) = v15;
  *(_OWORD *)(i + 31) = v14;
  *(_OWORD *)(i + 29) = *(_OWORD *)a1;
  if (a2) {
    *a2 = v7;
  }
  return 1;
}

uint64_t sub_10016E224(uint64_t result, int a2)
{
  uint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    for (uint64_t i = qword_100A15298; *i != result; i += 134)
    {
      if (!--v2) {
        return result;
      }
    }
    *((_DWORD *)i + 47) = a2;
  }
  return result;
}

uint64_t sub_10016E25C(unsigned int a1)
{
  if (dword_100A1525C <= a1) {
    return 0;
  }
  else {
    return HIDWORD(qword_100A15298[134 * a1 + 23]);
  }
}

uint64_t sub_10016E28C(uint64_t result, _DWORD *a2, _DWORD *a3)
{
  unint64_t v3 = dword_100A1525C;
  if (dword_100A1525C)
  {
    unint64_t v4 = 0;
    uint64_t v5 = &dword_100A15350;
    do
    {
      if (*((void *)v5 - 23) == result)
      {
        *a2 = *(v5 - 2);
        *a3 = *(v5 - 1);
        *uint64_t v5 = 0;
        *((void *)v5 - 2) = 0;
        unint64_t v3 = dword_100A1525C;
      }
      ++v4;
      v5 += 268;
    }
    while (v4 < v3);
  }
  return result;
}

void sub_10016E2E0(uint64_t a1, int a2, int a3, int a4, int a5, uint64_t a6, uint64_t a7, int a8, unsigned __int8 a9, char a10, unsigned __int8 a11, unsigned __int8 a12, char a13, char a14, char a15)
{
  if (!dword_100A1525C) {
    return;
  }
  uint64_t v20 = 0;
  for (uint64_t i = qword_100A15298; ; i += 134)
  {
    if (*i != a1) {
      goto LABEL_9;
    }
    int v22 = *((unsigned __int8 *)i + 76);
    if (v22 == 2) {
      break;
    }
    if (v22 == 1)
    {
      *((_DWORD *)i + 113) = a2;
      *((_DWORD *)i + 114) += a4;
      *((_DWORD *)i + 115) += a5;
      uint64_t v34 = a6;
      *((_WORD *)i + 234) += a6;
      char v35 = a10;
      uint64_t v36 = (-a10 / 0xAu - 2);
      if (a10 < 0xFFFFFF92) {
        uint64_t v36 = 9;
      }
      if (a10 > -30) {
        uint64_t v36 = 0;
      }
      ++*((unsigned char *)i + 10 * ((205 * a8) >> 11) + v36 + 470);
      uint64_t v33 = (char *)i + 10 * (a9 / 0xAu) + v36 + 570;
      goto LABEL_21;
    }
    if (sub_100058654())
    {
      uint64_t v23 = sub_10016E6F8(*((unsigned __int8 *)i + 76));
      sub_100056E24((uint64_t)"Unexpected transport : %s. Don't collect stats", v24, v25, v26, v27, v28, v29, v30, (uint64_t)v23);
      uint64_t v31 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_1007495A0();
      }
    }
LABEL_9:
    if (++v20 >= (unint64_t)dword_100A1525C) {
      return;
    }
  }
  *((_DWORD *)i + 168) = a3;
  *((_DWORD *)i + 169) += a4;
  *((_DWORD *)i + 170) += a5;
  *((_WORD *)i + 344) += a7;
  uint64_t v32 = (-a13 / 0xAu - 2);
  if (a13 < 0xFFFFFF92) {
    uint64_t v32 = 9;
  }
  if (a13 > -30) {
    uint64_t v32 = 0;
  }
  ++*((unsigned char *)i + 10 * (a11 / 0xAu) + v32 + 690);
  uint64_t v33 = (char *)i + 10 * (a12 / 0xAu) + v32 + 790;
  uint64_t v34 = a6;
  char v35 = a10;
LABEL_21:
  ++*v33;
  if (a15 == 2)
  {
    uint64_t v47 = *((unsigned __int8 *)i + 1062);
    uint64_t v48 = (char *)i + 4 * v47;
    *((_WORD *)v48 + 446) = v34;
    v48[894] = v35;
    *((unsigned char *)i + 1062) = v47 + 1;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Disconnect BT_TS_SetTransportMetrics. leCoexDenials = %u; leRSSI = %u",
        v49,
        v50,
        v51,
        v52,
        v53,
        v54,
        v55,
        v34);
      uint64_t v46 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
      {
LABEL_28:
        *(_DWORD *)int buf = 136446210;
        __int16 v60 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v46, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }
  else if (a15 == 1)
  {
    uint64_t v37 = *((unsigned __int8 *)i + 1063);
    uint64_t v38 = (char *)i + 4 * v37;
    *((_WORD *)v38 + 486) = a7;
    v38[974] = a13;
    *((unsigned char *)i + 1063) = v37 + 1;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Disconnect BT_TS_SetTransportMetrics. coexDenials = %u; classicRSSI = %u",
        v39,
        v40,
        v41,
        v42,
        v43,
        v44,
        v45,
        a7);
      uint64_t v46 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT)) {
        goto LABEL_28;
      }
    }
  }
  *((unsigned char *)i + 1062) %= 0x14u;
  *((unsigned char *)i + 1063) %= 0x14u;
}

const char *sub_10016E6F8(unsigned int a1)
{
  if (a1 > 0xC) {
    return "??";
  }
  else {
    return off_10099D4D8[a1];
  }
}

void sub_10016E71C(uint64_t a1, int a2, int a3)
{
  if (!dword_100A1525C) {
    return;
  }
  uint64_t v6 = 0;
  for (uint64_t i = qword_100A15298; ; i += 134)
  {
    if (*i != a1) {
      goto LABEL_9;
    }
    int v8 = *((unsigned __int8 *)i + 76);
    if (v8 == 2) {
      break;
    }
    if (v8 == 1)
    {
      if (*(_DWORD *)(a1 + 144) == 2) {
        int v19 = 2;
      }
      else {
        int v19 = 1;
      }
      *((_DWORD *)i + 113) = v19;
      *((_DWORD *)i + 114) += a2;
      *((_DWORD *)i + 115) += a3;
      return;
    }
    if (sub_100058654())
    {
      long long v9 = sub_10016E6F8(*((unsigned __int8 *)i + 76));
      sub_100056E24((uint64_t)"Unexpected transport : %s. Don't collect stats", v10, v11, v12, v13, v14, v15, v16, (uint64_t)v9);
      uint64_t v17 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_1007495A0();
      }
    }
LABEL_9:
    if (++v6 >= (unint64_t)dword_100A1525C) {
      return;
    }
  }
  if (sub_1000EB00C(a1)) {
    int v18 = 4;
  }
  else {
    int v18 = 3;
  }
  *((_DWORD *)i + 168) = v18;
  *((_DWORD *)i + 169) += a2;
  *((_DWORD *)i + 170) += a3;
}

_DWORD *sub_10016E8A8(_DWORD *result, _DWORD *a2, _DWORD *a3, _DWORD *a4, _DWORD *a5, void *__dst, uint64_t a7, uint64_t a8, _DWORD *a9, _DWORD *a10, _DWORD *a11, _DWORD *a12, _DWORD *a13, void *a14, uint64_t a15, uint64_t a16, _DWORD *a17)
{
  if (dword_100A1525C)
  {
    unint64_t v21 = 0;
    int v22 = &xmmword_100A154D2;
    uint64_t v45 = a2;
    uint64_t v46 = a3;
    uint64_t v43 = __dst;
    uint64_t v44 = result;
    do
    {
      *uint64_t result = *(_DWORD *)((char *)v22 - 118);
      *a2 = *(_DWORD *)((char *)v22 - 114);
      *a3 = *(_DWORD *)((char *)v22 - 110);
      *a4 = *((unsigned __int16 *)v22 - 51);
      *a5 = *(_DWORD *)((char *)v22 - 106);
      long long v23 = *(long long *)((char *)v22 - 100);
      long long v24 = *(long long *)((char *)v22 - 68);
      *(_OWORD *)(a7 + 16) = *(long long *)((char *)v22 - 84);
      *(_OWORD *)(a7 + 32) = v24;
      *(_OWORD *)a7 = v23;
      long long v25 = *(long long *)((char *)v22 - 52);
      long long v26 = *(long long *)((char *)v22 - 36);
      long long v27 = *(long long *)((char *)v22 - 20);
      *(_DWORD *)(a7 + 96) = *((_DWORD *)v22 - 1);
      *(_OWORD *)(a7 + 64) = v26;
      *(_OWORD *)(a7 + 80) = v27;
      *(_OWORD *)(a7 + 48) = v25;
      long long v29 = v22[4];
      long long v28 = v22[5];
      long long v30 = v22[3];
      *(_DWORD *)(a8 + 96) = *((_DWORD *)v22 + 24);
      *(_OWORD *)(a8 + 64) = v29;
      *(_OWORD *)(a8 + 80) = v28;
      *(_OWORD *)(a8 + 48) = v30;
      long long v31 = *v22;
      long long v32 = v22[2];
      *(_OWORD *)(a8 + 16) = v22[1];
      *(_OWORD *)(a8 + 32) = v32;
      *(_OWORD *)a8 = v31;
      memcpy(__dst, (char *)v22 + 322, 4 * *((unsigned __int8 *)v22 + 492));
      *a9 = *(_DWORD *)((char *)v22 + 102);
      *a10 = *(_DWORD *)((char *)v22 + 106);
      *a11 = *(_DWORD *)((char *)v22 + 110);
      *a12 = *((unsigned __int16 *)v22 + 59);
      *a13 = *(_DWORD *)((char *)v22 + 114);
      long long v33 = *(long long *)((char *)v22 + 152);
      long long v34 = *(long long *)((char *)v22 + 136);
      *(_OWORD *)a15 = *(long long *)((char *)v22 + 120);
      *(_OWORD *)(a15 + 16) = v34;
      *(_OWORD *)(a15 + 32) = v33;
      long long v35 = *(long long *)((char *)v22 + 184);
      long long v36 = *(long long *)((char *)v22 + 200);
      long long v37 = *(long long *)((char *)v22 + 168);
      *(_DWORD *)(a15 + 96) = *((_DWORD *)v22 + 54);
      *(_OWORD *)(a15 + 64) = v35;
      *(_OWORD *)(a15 + 80) = v36;
      *(_OWORD *)(a15 + 48) = v37;
      long long v38 = *(long long *)((char *)v22 + 252);
      long long v39 = *(long long *)((char *)v22 + 220);
      *(_OWORD *)(a16 + 16) = *(long long *)((char *)v22 + 236);
      *(_OWORD *)(a16 + 32) = v38;
      *(_OWORD *)a16 = v39;
      long long v41 = *(long long *)((char *)v22 + 284);
      long long v40 = *(long long *)((char *)v22 + 300);
      long long v42 = *(long long *)((char *)v22 + 268);
      *(_DWORD *)(a16 + 96) = *((_DWORD *)v22 + 79);
      *(_OWORD *)(a16 + 64) = v41;
      *(_OWORD *)(a16 + 80) = v40;
      *(_OWORD *)(a16 + 48) = v42;
      memcpy(a14, (char *)v22 + 402, 4 * *((unsigned __int8 *)v22 + 493));
      *a17 = *((unsigned __int16 *)v22 + 241);
      bzero((char *)v22 - 118, 0x264uLL);
      uint64_t result = v44;
      a2 = v45;
      a3 = v46;
      __dst = v43;
      ++v21;
      v22 += 67;
    }
    while (v21 < dword_100A1525C);
  }
  return result;
}

void sub_10016EAD8(uint64_t a1)
{
  if (a1 && sub_100058654())
  {
    sub_100056E24((uint64_t)"SetBidirectionalMaxPowerMode completed with error %!", v2, v3, v4, v5, v6, v7, v8, a1);
    long long v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
}

uint64_t sub_10016EB4C(int a1)
{
  uint64_t result = sub_1001F7D74();
  if (result >= 0x7D0)
  {
    uint64_t result = sub_1001F7D74();
    if (result <= 0xF9F)
    {
      if (sub_100058654())
      {
        uint64_t v10 = "Disabling";
        if (a1) {
          uint64_t v10 = "Enabling";
        }
        sub_100056E24((uint64_t)"%s bidirectional max power mode for handle 0x%x", v3, v4, v5, v6, v7, v8, v9, (uint64_t)v10);
        uint64_t v11 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v13 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      return sub_100201644();
    }
  }
  return result;
}

const char *sub_10016EC6C(int a1)
{
  if (a1 <= 2)
  {
    if (a1 == 1) {
      return "LE";
    }
    if (a1 == 2) {
      return "BT";
    }
  }
  else
  {
    switch(a1)
    {
      case 3:
        return "WL";
      case 16:
        return "USB";
      case 17:
        return "AWDL";
    }
  }
  return "??";
}

void sub_10016ECE4()
{
  sub_10025B778("Transport Switch: lNbTsPeers %d\n", dword_100A1525C);
  if (!dword_100A1525C)
  {
LABEL_66:
    long long v28 = sub_100050B4C(0x5Cu);
    if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      long long v30 = "No Transport Switching.\n";
      _os_log_impl((void *)&_mh_execute_header, v28, OS_LOG_TYPE_DEFAULT, "%{public}s", buf, 0xCu);
    }
    return;
  }
  unint64_t v0 = 0;
  do
  {
    uint64_t v1 = &qword_100A15298[134 * v0];
    uint64_t v2 = (unsigned __int16 *)*v1;
    if (*v1) {
      int v3 = *v2;
    }
    else {
      int v3 = 0;
    }
    int v4 = *((_DWORD *)v1 + 14);
    uint64_t v5 = &qword_100A15298[134 * v0];
    int v6 = *((unsigned __int16 *)v5 + 4);
    int v7 = *((unsigned __int8 *)v5 + 10);
    uint64_t v8 = sub_10016E6F8(*((_DWORD *)v5 + 12));
    int v11 = *((_DWORD *)v5 + 18);
    uint64_t v10 = (unsigned int *)(v5 + 9);
    int v9 = v11;
    unsigned int v12 = *((unsigned __int8 *)v10 + 4);
    if (v12 <= 2)
    {
      uint64_t v13 = "LE";
      if (v12 == 1) {
        goto LABEL_17;
      }
      if (v12 == 2)
      {
        uint64_t v13 = "BT";
        goto LABEL_17;
      }
    }
    else
    {
      switch(v12)
      {
        case 3u:
          uint64_t v13 = "WL";
          goto LABEL_17;
        case 0x10u:
          uint64_t v13 = "USB";
          goto LABEL_17;
        case 0x11u:
          uint64_t v13 = "AWDL";
          goto LABEL_17;
      }
    }
    uint64_t v13 = "??";
LABEL_17:
    unsigned int v14 = BYTE5(qword_100A15298[134 * v0 + 9]);
    if (v14 <= 2)
    {
      uint64_t v15 = "LE";
      if (v14 == 1) {
        goto LABEL_28;
      }
      if (v14 == 2)
      {
        uint64_t v15 = "BT";
        goto LABEL_28;
      }
    }
    else
    {
      switch(v14)
      {
        case 3u:
          uint64_t v15 = "WL";
          goto LABEL_28;
        case 0x10u:
          uint64_t v15 = "USB";
          goto LABEL_28;
        case 0x11u:
          uint64_t v15 = "AWDL";
          goto LABEL_28;
      }
    }
    uint64_t v15 = "??";
LABEL_28:
    int v16 = qword_100A15298[134 * v0 + 10];
    if (v16 <= 2)
    {
      uint64_t v17 = "LE";
      if (v16 == 1) {
        goto LABEL_39;
      }
      if (v16 == 2)
      {
        uint64_t v17 = "BT";
        goto LABEL_39;
      }
    }
    else
    {
      switch(v16)
      {
        case 3:
          uint64_t v17 = "WL";
          goto LABEL_39;
        case 16:
          uint64_t v17 = "USB";
          goto LABEL_39;
        case 17:
          uint64_t v17 = "AWDL";
          goto LABEL_39;
      }
    }
    uint64_t v17 = "??";
LABEL_39:
    int v18 = HIDWORD(qword_100A15298[134 * v0 + 10]);
    if (v18 <= 2)
    {
      int v19 = "LE";
      if (v18 == 1) {
        goto LABEL_50;
      }
      if (v18 == 2)
      {
        int v19 = "BT";
        goto LABEL_50;
      }
    }
    else
    {
      switch(v18)
      {
        case 3:
          int v19 = "WL";
          goto LABEL_50;
        case 16:
          int v19 = "USB";
          goto LABEL_50;
        case 17:
          int v19 = "AWDL";
          goto LABEL_50;
      }
    }
    int v19 = "??";
LABEL_50:
    uint64_t v20 = &qword_100A15298[134 * v0];
    sub_10025B778(">> Peer %d: version %d, connectionHandle=%p, lm=0x%4x, pipeID=0x%4x, nbTransportHandles=%d, state=%s, nbCaps=%d, currenTech=%s, updateTech=%s, localReq=%s, remoteReq=%s, leRSSI=%d\n", v0, v4, v2, v3, v6, v7, v8, v9, v13, v15, v17, v19, *((_DWORD *)v20 + 47));
    sub_10025B778("messageTimer=0x%x, samplingConfirmCount=%d, totalBytesQueued=%d, bytesSentOnTransport=%d, chipFull=%d, weightedLength=%d\n", *((_DWORD *)v20 + 13), *((unsigned __int8 *)v20 + 78), *((_DWORD *)v20 + 22), *((_DWORD *)v20 + 23), *((_DWORD *)v20 + 24), *((_DWORD *)v20 + 25));
    sub_10025B778("weightedInterPacketGap=%d, numOfEwmaSamples=%d, transportSelectReason=0x%x, calculatedTransportIndex=%d, actionToBeConfirm=%d, prevTSAction=%d, upgradeCount=%d\n", *((_DWORD *)v20 + 26), *((_DWORD *)v20 + 27), *((_DWORD *)v20 + 28), *((_DWORD *)v20 + 29), *((_DWORD *)v20 + 30), *((_DWORD *)v20 + 31), *((_DWORD *)v20 + 50));
    sub_10025B778("timeSpentUpgraded=%d, overrideIncomingRate=%d, overrideOutgoingRate=%d, overridePacketRate=%d, forceClassic=%d, bidirectionalMaxPowerModeAction=%d, bidirectionalMaxPowerModeActionPending=%d\n", *((_DWORD *)v20 + 56), *((unsigned __int8 *)v20 + 444), *((_DWORD *)v20 + 51), *((_DWORD *)v20 + 54), *((_DWORD *)v20 + 55), *((unsigned __int8 *)v20 + 447), *((unsigned __int8 *)v20 + 446));
    if (*v10)
    {
      uint64_t v21 = 0;
      unint64_t v22 = 0;
      long long v23 = &qword_100A15298[134 * v0 + 8];
      do
      {
        long long v24 = (unsigned __int8 *)(*v23 + v21);
        unsigned int v25 = v24[1];
        if (v25 <= 2)
        {
          long long v26 = "LE";
          if (v25 != 1)
          {
            if (v25 != 2)
            {
LABEL_62:
              long long v26 = "??";
              goto LABEL_63;
            }
            long long v26 = "BT";
          }
        }
        else
        {
          switch(v25)
          {
            case 3u:
              long long v26 = "WL";
              break;
            case 0x10u:
              long long v26 = "USB";
              break;
            case 0x11u:
              long long v26 = "AWDL";
              break;
            default:
              goto LABEL_62;
          }
        }
LABEL_63:
        uint64_t v27 = *v23 + v21;
        sub_10025B778("Cap %d is {id=%d, tech=%s, usable=%d, tput=%d, latency=%d, power=%d, extra=%d, common=%d}", v22++, *v24, v26, *(unsigned __int8 *)(v27 + 2), *(_DWORD *)(v27 + 4), *(unsigned __int16 *)(v27 + 8), *(unsigned __int16 *)(v27 + 10), *(unsigned __int8 *)(v27 + 12), *(unsigned __int8 *)(v27 + 13));
        v21 += 64;
      }
      while (v22 < *v10);
    }
    ++v0;
  }
  while (v0 < dword_100A1525C);
  if (!dword_100A1525C) {
    goto LABEL_66;
  }
}

uint64_t sub_10016F1D8(_DWORD *a1, _DWORD *a2, _DWORD *a3, _DWORD *a4, _DWORD *a5, _DWORD *a6, unsigned char *a7, void *a8, void *a9)
{
  uint64_t v18 = 0;
  uint64_t result = sub_10010BC48((uint64_t)&v18);
  if (a1) {
    *a1 = dword_100A1525C != 0;
  }
  if (dword_100A1525C)
  {
    if (a2) {
      *a2 = dword_100A15358;
    }
    if (a3) {
      *a3 = v18;
    }
    if (a4) {
      *a4 = dword_100A15360;
    }
    if (a5) {
      *a5 = dword_100A15364;
    }
    if (a9) {
      *a9 = qword_100A15298[0];
    }
    if (a6) {
      *a6 = dword_100A152C8;
    }
    if (a7) {
      *a7 = byte_100A152E4;
    }
    if (a8) {
      *a8 = 1000 * ((int)v18 - dword_100A15368) - word_100A1536C + SWORD2(v18);
    }
  }
  return result;
}

uint64_t sub_10016F308(int a1)
{
  if (!dword_100A1525C) {
    return 0;
  }
  uint64_t v1 = 0;
  for (uint64_t i = &qword_100A152A8; ; i += 134)
  {
    if (LOWORD(qword_100A15298[134 * v1 + 1]) == a1)
    {
      int v3 = &qword_100A15298[134 * v1];
      uint64_t v4 = *((unsigned __int8 *)v3 + 10);
      uint64_t v5 = i;
      if (*((unsigned char *)v3 + 10)) {
        break;
      }
    }
LABEL_7:
    if (++v1 == dword_100A1525C) {
      return 0;
    }
  }
  while (1)
  {
    uint64_t v6 = *v5;
    if (*v5) {
      return v6;
    }
    v5 += 2;
    if (!--v4) {
      goto LABEL_7;
    }
  }
}

uint64_t sub_10016F37C(uint64_t a1)
{
  uint64_t v1 = dword_100A1525C;
  if (!dword_100A1525C) {
    return 0xFFFFLL;
  }
  for (uint64_t i = &word_100A152A0; *((void *)i - 1) != a1; i += 536)
  {
    if (!--v1) {
      return 0xFFFFLL;
    }
  }
  return (unsigned __int16)*i;
}

uint64_t sub_10016F3B8(uint64_t a1)
{
  uint64_t v1 = 0;
  unsigned int v2 = *(_DWORD *)(a1 + 48);
  if (v2 <= 0xC)
  {
    int v3 = 1 << v2;
    if ((v3 & 0x780) != 0)
    {
      uint64_t v4 = 0;
      for (char i = 1; ; char i = 0)
      {
        char v6 = i;
        if (*(unsigned __int8 *)(a1 + 77) == *(unsigned __int8 *)(a1 + 16 * v4 + 24)) {
          break;
        }
        uint64_t v4 = 1;
        if ((v6 & 1) == 0) {
          return 0;
        }
      }
      return *(void *)(a1 + 16 * v4 + 16);
    }
    if ((v3 & 0x1840) != 0)
    {
      if (*(unsigned char *)(a1 + 10))
      {
        uint64_t v4 = 0;
        for (char j = 1; ; char j = 0)
        {
          char v8 = j;
          if (*(unsigned __int8 *)(a1 + 16 * v4 + 24) == *(unsigned __int8 *)(a1 + 76)) {
            break;
          }
          uint64_t v4 = 1;
          if ((v8 & 1) == 0) {
            return 0;
          }
        }
        return *(void *)(a1 + 16 * v4 + 16);
      }
      return 0;
    }
  }
  return v1;
}

uint64_t sub_10016F460(uint64_t result)
{
  dword_1009F9408 = result;
  return result;
}

uint64_t sub_10016F46C(uint64_t a1, uint64_t a2)
{
  uint64_t v3 = a1;
  unint64_t v4 = 99;
  unint64_t v46 = 99;
  uint64_t v50 = 0;
  memset(v49, 0, sizeof(v49));
  if (a1 && a2)
  {
    if (*(unsigned char *)(a2 + 2)) {
      a1 = a2;
    }
    sub_1000E669C(a1, (uint64_t)v49, &v46);
    unint64_t v4 = v46;
  }
  uint64_t v5 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v6 = 0;
    int v7 = &qword_100A152A8;
    while (1)
    {
      uint64_t v8 = qword_100A15298[134 * v6];
      if (v8 == v3 || v8 == a2) {
        break;
      }
      uint64_t v10 = BYTE2(qword_100A15298[134 * v6 + 1]);
      int v11 = v7;
      if (BYTE2(qword_100A15298[134 * v6 + 1]))
      {
        while (*v11 != v3 && *v11 != a2)
        {
          v11 += 2;
          if (!--v10) {
            goto LABEL_18;
          }
        }
        int v13 = LOWORD(qword_100A15298[134 * v6 + 1]);
        *((_WORD *)v49 + v4) = v13;
      }
      else
      {
LABEL_18:
        int v13 = *((unsigned __int16 *)v49 + v4);
      }
      ++v6;
      v7 += 134;
      if (v13) {
        BOOL v14 = 1;
      }
      else {
        BOOL v14 = v6 == v5;
      }
      if (v14) {
        goto LABEL_27;
      }
    }
    *((_WORD *)v49 + v4) = qword_100A15298[134 * v6 + 1];
  }
LABEL_27:
  unint64_t v46 = v4 + 1;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Moving channels from %p (0x%2x) to %p (0x%2x) with an exception:", v15, v16, v17, v18, v19, v20, v21, v3);
    unint64_t v22 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      long long v23 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      uint64_t v48 = v23;
      _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (v46)
  {
    for (unint64_t i = 0; i < v46; ++i)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"\tCID:0x%4x", v25, v26, v27, v28, v29, v30, v31, *((unsigned __int16 *)v49 + i));
        long long v32 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v32, OS_LOG_TYPE_DEFAULT))
        {
          long long v33 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v48 = v33;
          _os_log_impl((void *)&_mh_execute_header, v32, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      unint64_t v34 = v46;
    }
  }
  else
  {
    unint64_t v34 = 0;
  }
  sub_1001F479C(v3, a2, (unsigned __int16 *)v49, v34);
  sub_1001F667C(v3);
  sub_1001F667C(a2);
  if (!*(unsigned char *)(a2 + 2))
  {
    if (!*(unsigned char *)(a2 + 144))
    {
      uint64_t v36 = sub_1001DF2E4(a2);
      if (v36)
      {
        uint64_t v37 = v36;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"TS setting LSTO error %!", v38, v39, v40, v41, v42, v43, v44, v37);
          uint64_t v45 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
      }
    }
    if (!*(unsigned char *)(a2 + 2))
    {
      *(_WORD *)(a2 + 25) = *(_WORD *)(v3 + 25);
      *(_WORD *)(a2 + 28) = *(_WORD *)(v3 + 28);
    }
  }
  return 0;
}

uint64_t sub_10016F7CC(unsigned __int16 *a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Force disconnecting this channel %p", v2, v3, v4, v5, v6, v7, v8, (uint64_t)a1);
    int v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  if (dword_100A1525C)
  {
    uint64_t v10 = 0;
    int v11 = &qword_100A152A8;
    while (1)
    {
      unsigned int v12 = &qword_100A15298[134 * v10];
      if ((unsigned __int16 *)*v12 == a1) {
        break;
      }
      uint64_t v13 = BYTE2(qword_100A15298[134 * v10 + 1]);
      BOOL v14 = v11;
      if (BYTE2(qword_100A15298[134 * v10 + 1]))
      {
        while ((unsigned __int16 *)*v14 != a1)
        {
          v14 += 2;
          if (!--v13) {
            goto LABEL_10;
          }
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Disconnecting peer %d", v24, v25, v26, v27, v28, v29, v30, LOWORD(qword_100A15298[134 * v10 + 1]));
          uint64_t v31 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
            goto LABEL_17;
          }
        }
        return sub_100223D18(*v12);
      }
LABEL_10:
      ++v10;
      v11 += 134;
      if (v10 == dword_100A1525C) {
        goto LABEL_11;
      }
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Disconnecting peer %d", v32, v33, v34, v35, v36, v37, v38, LOWORD(qword_100A15298[134 * v10 + 1]));
      uint64_t v39 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
LABEL_17:
      }
        sub_100744F6C();
    }
    return sub_100223D18(*v12);
  }
  else
  {
LABEL_11:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Unknown lmhandle 0x%4x", v15, v16, v17, v18, v19, v20, v21, *a1);
      unint64_t v22 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 122;
  }
}

void sub_10016F9A4(uint64_t a1, int *a2, uint64_t a3)
{
  char v40 = 0;
  int v41 = *a2;
  __int16 v42 = *((_WORD *)a2 + 2);
  uint64_t v5 = sub_100197B34(&v40);
  if (!a1
    || !sub_100058654()
    || (sub_100056E24((uint64_t)"TS connection completed with status %! with lmhandle 0x%4x (0x%x)", v6, v7, v8, v9, v10, v11, v12, a1), uint64_t v13 = sub_100050B4C(0x56u), !os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)))
  {
    if (v5) {
      goto LABEL_5;
    }
LABEL_26:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"ACL connection complete, not a TS handle", v30, v31, v32, v33, v34, v35, v36, v39);
      uint64_t v37 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v38 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v44 = v38;
        _os_log_impl((void *)&_mh_execute_header, v37, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    return;
  }
  sub_100745764();
  if (!v5) {
    goto LABEL_26;
  }
LABEL_5:
  if (!a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"TS connection complete, classicHandle is invalid", v18, v19, v20, v21, v22, v23, v24, v39);
      uint64_t v25 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    char v14 = 0;
    goto LABEL_17;
  }
  char v14 = sub_100253590(a3);
  if (a1 || !*(unsigned char *)(v5 + 70))
  {
LABEL_17:
    sub_10016FBE8((unsigned __int16 *)v5, a3, a1, v14);
    return;
  }
  uint64_t v15 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v16 = &qword_100A152A8;
    while (*(v16 - 2) != v5)
    {
      v16 += 134;
      if (!--v15) {
        goto LABEL_12;
      }
    }
    char v26 = 0;
    uint64_t v27 = 0;
    do
    {
      uint64_t v28 = v16[2 * v27];
      if (v26) {
        break;
      }
      char v26 = 1;
      uint64_t v27 = 1;
    }
    while (v28 != a3);
    BOOL v17 = v28 != a3;
  }
  else
  {
LABEL_12:
    BOOL v17 = 1;
  }
  int v29 = sub_10016FBE8((unsigned __int16 *)v5, a3, a1, v14);
  if (v17 && !v29) {
    sub_10017BCA0(a3);
  }
}

uint64_t sub_10016FBE8(unsigned __int16 *a1, uint64_t a2, uint64_t a3, char a4)
{
  if (!a1 && !a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"No LE connection for this new connection.", v8, v9, v10, v11, v12, v13, v14, v130);
      uint64_t v15 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 5009;
  }
  if (!a1 && a3)
  {
    int v24 = sub_100058654();
    uint64_t result = 0;
    if (!v24) {
      return result;
    }
    sub_100056E24((uint64_t)"BT connection failed and LE is gone anyways - dropping the message.", v17, v18, v19, v20, v21, v22, v23, v130);
    uint64_t v25 = sub_100050B4C(0x56u);
    BOOL v26 = os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT);
    uint64_t result = 0;
    if (!v26) {
      return result;
    }
LABEL_35:
    *(_DWORD *)int buf = 136446210;
    v132 = sub_100050714();
    _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    return 0;
  }
  if (dword_100A1525C)
  {
    uint64_t v27 = 0;
    uint64_t v28 = qword_100A15298;
    while ((unsigned __int16 *)*v28 != a1)
    {
      ++v27;
      v28 += 134;
      if (dword_100A1525C == v27) {
        goto LABEL_16;
      }
    }
  }
  else
  {
LABEL_16:
    LODWORD(v27) = 16;
  }
  if (v27 >= dword_100A1525C)
  {
    int v57 = sub_100058654();
    uint64_t result = 0;
    if (!v57) {
      return result;
    }
    sub_100056E24((uint64_t)"Ignoring connection complete - connected a device from an LE but we weren't tracking it.", v50, v51, v52, v53, v54, v55, v56, v130);
    uint64_t v25 = sub_100050B4C(0x56u);
    BOOL v58 = os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT);
    uint64_t result = 0;
    if (!v58) {
      return result;
    }
    goto LABEL_35;
  }
  if (a1 && a3)
  {
    if (off_100A15288) {
      off_100A15288(a1, 81, 1644, a3);
    }
    if (sub_1000E7430((uint64_t)a1))
    {
      sub_100171078(a1);
      if (a3 == 708)
      {
        if (BYTE5(qword_100A15298[134 * v27 + 55]))
        {
          sub_10010BC48((uint64_t)&qword_100A15298[134 * v27 + 20]);
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"TS Connection timeout timestamped at %d:%d. Connection start %d:%d", v79, v80, v81, v82, v83, v84, v85, LODWORD(qword_100A15298[134 * v27 + 20]));
            uint64_t v86 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v86, OS_LOG_TYPE_ERROR)) {
              sub_100745764();
            }
          }
        }
      }
      else if (a3 == 717)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Controller returning transport switch with error %!, retry. Current count %d, version 0x%x", v29, v30, v31, v32, v33, v34, v35, 717);
          uint64_t v36 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
        uint64_t v37 = &qword_100A15298[134 * v27];
        unsigned int v39 = *((unsigned __int8 *)v37 + 79);
        uint64_t v38 = (char *)v37 + 79;
        if (v39 > 7)
        {
          if (!sub_100058654()) {
            goto LABEL_95;
          }
          sub_100056E24((uint64_t)"Error count exceeds threshold %d and RSSI was %d", v122, v123, v124, v125, v126, v127, v128, 8);
          v129 = sub_100050B4C(0x56u);
          if (!os_log_type_enabled(v129, OS_LOG_TYPE_ERROR)) {
            goto LABEL_95;
          }
        }
        else
        {
          uint64_t v40 = sub_10017285C((uint64_t)a1);
          if (!v40) {
            goto LABEL_95;
          }
          uint64_t v41 = v40;
          if (!sub_100058654()) {
            goto LABEL_95;
          }
          sub_100056E24((uint64_t)"Upgrade retry failed with status %!", v42, v43, v44, v45, v46, v47, v48, v41);
          uint64_t v49 = sub_100050B4C(0x56u);
          if (!os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
            goto LABEL_95;
          }
        }
        sub_100745764();
LABEL_95:
        uint64_t result = 0;
        ++*v38;
        return result;
      }
      uint64_t v87 = a1;
      char v88 = 4;
LABEL_61:
      sub_100172AD0(v87, v88);
      return 0;
    }
    uint64_t v65 = &qword_100A15298[134 * v27];
    unsigned int v66 = *((unsigned __int8 *)v65 + 79);
    uint64_t v38 = (char *)v65 + 79;
    if (v66 <= 7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Peripheral connection complete with status %!, retry %d is under limit. Version 0x%x", v67, v68, v69, v70, v71, v72, v73, a3);
        uint64_t v74 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          v132 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v74, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      goto LABEL_95;
    }
    uint64_t v77 = a1;
    int v78 = 4;
    goto LABEL_55;
  }
  if (!a1 || a3) {
    sub_10025B8C0();
  }
  uint64_t v59 = &qword_100A15298[134 * v27];
  *((unsigned char *)v59 + 79) = 0;
  BOOL v60 = sub_1000E7430((uint64_t)a1);
  long long v62 = (unsigned __int16 *)(v59 + 1);
  int v61 = *((unsigned __int16 *)v59 + 4);
  uint64_t v63 = dword_100A1525C;
  if (v60)
  {
    if (!dword_100A1525C) {
      goto LABEL_65;
    }
    uint64_t v64 = &dword_100A152C8;
    while (*((unsigned __int16 *)v64 - 20) != v61)
    {
      v64 += 268;
      if (!--v63) {
        goto LABEL_65;
      }
    }
    if (*v64 != 8)
    {
LABEL_65:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Got an upgrade we were not tracking !", v89, v90, v91, v92, v93, v94, v95, v130);
        uint64_t v96 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v96, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 5010;
    }
  }
  else
  {
    if (!dword_100A1525C) {
      goto LABEL_88;
    }
    uint64_t v75 = &dword_100A152C8;
    uint64_t v76 = dword_100A1525C;
    while (*((unsigned __int16 *)v75 - 20) != v61)
    {
      v75 += 268;
      if (!--v76) {
        goto LABEL_70;
      }
    }
    if (*v75 == 8) {
      goto LABEL_75;
    }
LABEL_70:
    uint64_t v97 = &dword_100A152C8;
    while (*((unsigned __int16 *)v97 - 20) != v61)
    {
      v97 += 268;
      if (!--v63) {
        goto LABEL_88;
      }
    }
    if (*v97 != 10)
    {
LABEL_88:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Got an upgrade we were not tracking !", v114, v115, v116, v117, v118, v119, v120, v130);
        uint64_t v121 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v121, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 5011;
    }
  }
LABEL_75:
  unsigned int v98 = v27;
  uint64_t v99 = &qword_100A15298[134 * v27];
  unsigned int v102 = *((unsigned __int8 *)v99 + 10);
  uint64_t v101 = (char *)v99 + 10;
  uint64_t v100 = v102;
  if (v102)
  {
    uint64_t v103 = &qword_100A15298[134 * v98 + 2];
    uint64_t v104 = v100;
    while (*v103 != a2)
    {
      v103 += 2;
      if (!--v104)
      {
        unsigned int v105 = 0;
        uint64_t v106 = &qword_100A15298[134 * v98];
        uint64_t v107 = v106 + 4;
        uint64_t v108 = v106 + 5;
        do
        {
          uint64_t v109 = &qword_100A15298[134 * v98 + 2 * v105];
          uint64_t v111 = v109[2];
          uint64_t v110 = v109 + 2;
          if (v111 == a2)
          {
            *uint64_t v110 = 0;
            if (!v105)
            {
              *uint64_t v110 = *v107;
              LOBYTE(qword_100A15298[134 * v98 + 3]) = *v108;
              *uint64_t v107 = 0;
            }
            unsigned int v105 = 0;
            LOBYTE(v100) = v100 - 1;
            unsigned char *v101 = v100;
          }
          ++v105;
        }
        while (v105 < v100);
        goto LABEL_85;
      }
    }
    goto LABEL_100;
  }
LABEL_85:
  qword_100A15298[134 * v98 + 2 + 2 * v100] = a2;
  if (*(unsigned char *)(a2 + 2) == 8)
  {
    uint64_t v112 = &qword_100A15298[134 * v98 + 2 * v100];
    char v113 = 17;
  }
  else
  {
    if (*(unsigned char *)(a2 + 2))
    {
      sub_10025B8C0();
      LOBYTE(v100) = *v101;
      goto LABEL_99;
    }
    uint64_t v112 = &qword_100A15298[134 * v98 + 2 * v100];
    char v113 = 2;
  }
  *((unsigned char *)v112 + 24) = v113;
LABEL_99:
  unsigned char *v101 = v100 + 1;
LABEL_100:
  sub_10017307C((uint64_t)v59, 0, 1);
  sub_100170974((unsigned __int16 *)a2);
  if (!*(unsigned char *)(a2 + 2) && !sub_1000E7430((uint64_t)a1)) {
    *(unsigned char *)(a2 + 196) = 1;
  }
  if (!sub_1000E7480((uint64_t)a1) || (a4 & 1) != 0)
  {
    if (sub_1000E7430((uint64_t)a1))
    {
      sub_10016F46C((uint64_t)a1, a2);
      uint64_t v87 = a1;
      char v88 = 0;
      goto LABEL_61;
    }
    uint64_t v77 = a1;
    int v78 = 0;
LABEL_55:
    sub_100172C50(v77, v78);
    return 0;
  }
  if (!sub_100197698(a2)) {
    sub_10025B8C0();
  }
  sub_100170D50(*v62, 9u);
  uint64_t result = sub_1000E7430((uint64_t)a1);
  if (result)
  {
    uint64_t result = sub_1002576E0(sub_1001735E4, a2 + 48, 1048579, (uint64_t)&unk_1007B9D60, *v62, 0);
    if (result)
    {
      sub_100172AD0(a1, 4);
      return 5012;
    }
  }
  return result;
}

uint64_t sub_100170424(uint64_t result, int a2)
{
  if (result)
  {
    unsigned __int8 v2 = a2;
    uint64_t v3 = result;
    uint64_t result = sub_100170478(result, a2);
    if (result)
    {
      return sub_10017BD74(v3, v2);
    }
  }
  return result;
}

BOOL sub_100170478(uint64_t a1, int a2)
{
  if (!dword_100A1525C) {
    return 0;
  }
  unint64_t v3 = 0;
  BOOL v4 = 1;
  for (unint64_t i = &qword_100A152A8; ; i += 134)
  {
    uint64_t v6 = &qword_100A15298[134 * v3];
    unsigned int v9 = *((unsigned __int8 *)v6 + 10);
    uint64_t v8 = (char *)v6 + 10;
    char v7 = v9;
    uint64_t v10 = v9;
    uint64_t v11 = i;
    if (v9) {
      break;
    }
LABEL_6:
    BOOL v4 = ++v3 < dword_100A1525C;
    if (v3 == dword_100A1525C) {
      return 0;
    }
  }
  while (*v11 != a1)
  {
    v11 += 2;
    if (!--v10) {
      goto LABEL_6;
    }
  }
  uint64_t v12 = &qword_100A15298[134 * v3];
  uint64_t v14 = *v12;
  uint64_t v13 = v12 + 2;
  *uint64_t v8 = v7 - 1;
  *uint64_t v11 = 0;
  sub_10016F46C(a1, v14);
  if (*v8 && !*v13)
  {
    uint64_t v15 = &qword_100A15298[134 * v3];
    *uint64_t v13 = v15[4];
    *((unsigned char *)v13 + 8) = *((unsigned char *)v15 + 40);
    v15[4] = 0;
  }
  if (sub_100058654())
  {
    unsigned int v16 = BYTE4(qword_100A15298[134 * v3 + 9]);
    if (v16 <= 2)
    {
      if (v16 == 1)
      {
        uint64_t v17 = "LE";
        goto LABEL_24;
      }
      if (v16 == 2)
      {
        uint64_t v17 = "BT";
        goto LABEL_24;
      }
    }
    else
    {
      switch(v16)
      {
        case 3u:
          uint64_t v17 = "WL";
          goto LABEL_24;
        case 0x10u:
          uint64_t v17 = "USB";
          goto LABEL_24;
        case 0x11u:
          uint64_t v17 = "AWDL";
          goto LABEL_24;
      }
    }
    uint64_t v17 = "??";
LABEL_24:
    sub_10016E6F8(qword_100A15298[134 * v3 + 6]);
    sub_100056E24((uint64_t)"Common transport disconnection: tech (current %s updating %s), state %s, pipeID %d, reason %!", v18, v19, v20, v21, v22, v23, v24, (uint64_t)v17);
    uint64_t v25 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v36 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  BOOL v26 = &qword_100A15298[134 * v3];
  unsigned int v28 = *((unsigned __int16 *)v26 + 4);
  uint64_t v27 = (unsigned __int16 *)(v26 + 1);
  sub_100173AD0(v28);
  if (*((unsigned char *)v27 + 68) == 2)
  {
    sub_100173AD0(*v27);
    sub_1001713B0(v3, 1u);
    char v30 = a2 == 705 || a2 == 723;
    sub_1001715C4((unsigned __int16)v3, 2, v30);
    int v31 = *v27;
    uint64_t v32 = dword_100A1525C;
    if (!dword_100A1525C) {
      goto LABEL_39;
    }
    uint64_t v33 = &dword_100A152C8;
    while (*((unsigned __int16 *)v33 - 20) != v31)
    {
      v33 += 268;
      if (!--v32) {
        goto LABEL_39;
      }
    }
    if (*v33 != 6)
    {
LABEL_39:
      sub_100170D50(v31, 6u);
      sub_100171078((unsigned __int16 *)qword_100A15298[134 * v3]);
    }
    HIWORD(qword_100A15298[134 * v3 + 55]) = 0;
  }
  return v4;
}

uint64_t sub_1001707DC(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!byte_1009F9404 || !dword_100A1525C) {
    return 101;
  }
  int v8 = 0;
  while (1)
  {
    if (a1 && qword_100A15298[134 * v8] == a1)
    {
      uint64_t v9 = v8;
      if (BYTE4(qword_100A15298[134 * v8 + 9]) != 2) {
        return 5008;
      }
      if (v8 < BYTE2(qword_100A15298[134 * v8 + 1])) {
        break;
      }
    }
LABEL_13:
    if (++v8 >= dword_100A1525C) {
      return 101;
    }
  }
  uint64_t v10 = &qword_100A15298[134 * v8];
  while (*((unsigned char *)v10 + 24) != 2 || !v10[2])
  {
    uint64_t v11 = *((unsigned __int8 *)v10 + 1082);
    v10 += 134;
    if (++v9 >= v11)
    {
      int v8 = v9;
      goto LABEL_13;
    }
  }
  unint64_t v14 = (858993460 * (unint64_t)(8 * a2)) >> 32;
  uint64_t v12 = sub_10001BDE0(85, 0, a3, a4, a5, a6, a7, a8, v10[2]);
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"TS setting flush timeout to %d ms with status %!", v15, v16, v17, v18, v19, v20, v21, v14);
    uint64_t v22 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v24 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  return v12;
}

uint64_t sub_100170974(unsigned __int16 *a1)
{
  unint64_t v53 = 99;
  uint64_t v57 = 0;
  memset(v56, 0, sizeof(v56));
  if (a1) {
    sub_1000E669C((uint64_t)a1, (uint64_t)v56, &v53);
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"stallL2CAPForHandle Number of LeOnlyPipe CID %d", v2, v3, v4, v5, v6, v7, v8, v53);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v10 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      uint64_t v55 = v10;
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (v53)
  {
    uint64_t v11 = 0;
    unsigned int v12 = 1;
    do
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"stallL2CAPForHandle LeOnlyPipe CID 0x%4x", v13, v14, v15, v16, v17, v18, v19, *((unsigned __int16 *)v56 + v11));
        uint64_t v20 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v21 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v55 = v21;
          _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      uint64_t v11 = v12;
      BOOL v22 = v53 > v12++;
    }
    while (v22);
  }
  if (dword_100A1525C)
  {
    uint64_t v23 = 0;
    uint64_t v24 = &qword_100A152A8;
    while ((unsigned __int16 *)qword_100A15298[134 * v23] != a1)
    {
      uint64_t v25 = BYTE2(qword_100A15298[134 * v23 + 1]);
      BOOL v26 = v24;
      if (BYTE2(qword_100A15298[134 * v23 + 1]))
      {
        while ((unsigned __int16 *)*v26 != a1)
        {
          v26 += 2;
          if (!--v25) {
            goto LABEL_20;
          }
        }
        uint64_t v27 = &qword_100A15298[134 * v23];
        uint64_t v28 = *((unsigned __int16 *)v27 + 4);
        if (*((_WORD *)v27 + 4)) {
          goto LABEL_23;
        }
      }
LABEL_20:
      ++v23;
      v24 += 134;
      if (v23 == dword_100A1525C) {
        goto LABEL_21;
      }
    }
    uint64_t v28 = LOWORD(qword_100A15298[134 * v23 + 1]);
  }
  else
  {
LABEL_21:
    uint64_t v28 = 0;
  }
LABEL_23:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"stallL2CAPForHandle lTsPeers cid 0x%4x", v29, v30, v31, v32, v33, v34, v35, v28);
    uint64_t v36 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v37 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      uint64_t v55 = v37;
      _os_log_impl((void *)&_mh_execute_header, v36, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  unint64_t v38 = v53;
  if (v28)
  {
    if (v53)
    {
      uint64_t v39 = 0;
      unsigned int v40 = 1;
      while (*((unsigned __int16 *)v56 + v39) != v28)
      {
        uint64_t v39 = v40;
        BOOL v22 = v53 > v40++;
        if (!v22) {
          goto LABEL_31;
        }
      }
      goto LABEL_33;
    }
LABEL_31:
    *((_WORD *)v56 + v53) = v28;
    unint64_t v53 = ++v38;
  }
  if (!v38)
  {
    uint64_t v51 = 0;
    return sub_1001F46C0((uint64_t)a1, (unsigned __int16 *)v56, v51, 1);
  }
LABEL_33:
  unsigned int v41 = 1;
  do
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Stalling lmhandle 0x%4x with an exception for cid 0x%4x", v42, v43, v44, v45, v46, v47, v48, *a1);
      uint64_t v49 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v50 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v55 = v50;
        _os_log_impl((void *)&_mh_execute_header, v49, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v51 = v53;
    BOOL v22 = v53 > v41++;
  }
  while (v22);
  return sub_1001F46C0((uint64_t)a1, (unsigned __int16 *)v56, v51, 1);
}

void sub_100170D50(int a1, unsigned int a2)
{
  unint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    unint64_t v5 = 0;
    uint64_t v6 = (unsigned int *)&dword_100A152C8;
    do
    {
      if (*((unsigned __int16 *)v6 - 20) == a1)
      {
        if (sub_100058654())
        {
          sub_10016E6F8(*v6);
          sub_10016E6F8(a2);
          sub_100056E24((uint64_t)"Peer %d state updated %s -> %s", v7, v8, v9, v10, v11, v12, v13, v5);
          uint64_t v14 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v15 = sub_100050714();
            *(_DWORD *)int buf = 136446210;
            uint64_t v17 = v15;
            _os_log_impl((void *)&_mh_execute_header, v14, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        *uint64_t v6 = a2;
        unint64_t v2 = dword_100A1525C;
      }
      v6 += 268;
      ++v5;
    }
    while (v5 < v2);
  }
}

uint64_t sub_100170EA0(unsigned __int16 *a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Lmhandle 0x%4x drained", v2, v3, v4, v5, v6, v7, v8, *a1);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v12 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  sub_10019E2C4(0, 0, 0);
  return sub_1000E48B0();
}

uint64_t sub_100170F7C(uint64_t result, unsigned int a2)
{
  __int16 v14 = result;
  uint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    for (unint64_t i = &dword_100A152CC; *((unsigned __int16 *)i - 22) != result; i += 268)
    {
      if (!--v2) {
        return result;
      }
    }
    v13[1] = &v14;
    v13[0] = (const void *)2;
    if (*i)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"An older timer is still active, canceling a previously started timer (%x).", v5, v6, v7, v8, v9, v10, v11, *i);
        uint64_t v12 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      sub_100026DB4(*i);
      *unint64_t i = 0;
    }
    return sub_1000268E4((uint64_t)sub_100177778, v13, (unsigned __int16)(a2 / 0x64), i);
  }
  return result;
}

uint64_t sub_100171078(unsigned __int16 *a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Unstalling lmhandle 0x%4x", v2, v3, v4, v5, v6, v7, v8, *a1);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v12 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  return sub_1001F46C0((uint64_t)a1, 0, 0, 0);
}

uint64_t sub_100171154(unsigned __int16 *a1, int a2, uint64_t a3)
{
  uint64_t v6 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v7 = &word_100A152A0;
    while (*((unsigned __int16 **)v7 - 1) != a1)
    {
      v7 += 536;
      if (!--v6) {
        goto LABEL_5;
      }
    }
    uint64_t v8 = (unsigned __int16)*v7;
  }
  else
  {
LABEL_5:
    uint64_t v8 = 0xFFFFLL;
  }
  __int16 v33 = 289;
  char v34 = a2;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Sending DOWNGRADE_CFM to 0x%x", v9, v10, v11, v12, v13, v14, v15, *a1);
    uint64_t v16 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v36 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v16, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  unsigned int v17 = sub_1000E8FC8(0, a1, v8, &v33, 3, 0);
  if (v17 == 412) {
    uint64_t v18 = 0;
  }
  else {
    uint64_t v18 = v17;
  }
  if (!a2 && !v18 && dword_100A1525C)
  {
    uint64_t v19 = 0;
    for (unint64_t i = &byte_100A152E4; *(unsigned __int16 **)(i - 76) != a1; i += 1072)
    {
      if (dword_100A1525C == ++v19) {
        return v18;
      }
    }
    sub_100170D50(*((unsigned __int16 *)i - 34), 6u);
    int v21 = *i;
    sub_1001713B0(v19, 1u);
    sub_10016F46C(a3, (uint64_t)a1);
    sub_1000EAB1C((uint64_t)a1, 0);
    sub_100171078(a1);
    sub_1001715C4((unsigned __int16)v19, v21, 0);
    if (i[1] != 1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Requesting transport upgrade since this downgrade was triggered by a upgrade to different alternate transport", v22, v23, v24, v25, v26, v27, v28, v32);
        uint64_t v29 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v30 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v36 = v30;
          _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      sub_10016D5D4(a1, i[1], *((_DWORD *)i + 9));
    }
  }
  return v18;
}

void sub_1001713B0(unsigned int a1, unsigned int a2)
{
  char v2 = a2;
  uint64_t v3 = &qword_100A15298[134 * a1];
  unsigned int v6 = *((unsigned __int8 *)v3 + 76);
  uint64_t v5 = (char *)v3 + 76;
  unsigned int v4 = v6;
  if (v6 >= a2)
  {
    uint64_t v7 = (_DWORD *)&qword_100A15298[134 * a1 + 15] + 1;
    if (v4 <= a2) {
      *uint64_t v7 = 0;
    }
    else {
      *uint64_t v7 = 2;
    }
  }
  else
  {
    HIDWORD(qword_100A15298[134 * a1 + 15]) = 1;
  }
  if (!sub_100058654()) {
    goto LABEL_21;
  }
  unsigned int v15 = *v5;
  if (v15 <= 2)
  {
    if (v15 == 1)
    {
      uint64_t v16 = "LE";
      goto LABEL_19;
    }
    if (v15 == 2)
    {
      uint64_t v16 = "BT";
      goto LABEL_19;
    }
  }
  else
  {
    switch(v15)
    {
      case 3u:
        uint64_t v16 = "WL";
        goto LABEL_19;
      case 0x10u:
        uint64_t v16 = "USB";
        goto LABEL_19;
      case 0x11u:
        uint64_t v16 = "AWDL";
        goto LABEL_19;
    }
  }
  uint64_t v16 = "??";
LABEL_19:
  sub_100056E24((uint64_t)"Updating tech %s -> %s", v8, v9, v10, v11, v12, v13, v14, (uint64_t)v16);
  unsigned int v17 = sub_100050B4C(0x56u);
  if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)int buf = 136446210;
    uint64_t v19 = sub_100050714();
    _os_log_impl((void *)&_mh_execute_header, v17, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
  }
LABEL_21:
  *uint64_t v5 = v2;
}

void sub_1001715C4(unsigned int a1, int a2, char a3)
{
  uint64_t v54 = 0;
  uint64_t v5 = &qword_100A15298[134 * a1];
  sub_10010BC48((uint64_t)&v54);
  int v6 = SWORD2(v54) + 1000 * v54;
  int v7 = *((__int16 *)v5 + 106) + 1000 * *((_DWORD *)v5 + 52);
  if (v6 == v7) {
    uint64_t v8 = 0xFFFFFFFFLL;
  }
  else {
    uint64_t v8 = 8 * HIDWORD(qword_100A15298[134 * a1 + 11]) / (v6 - v7);
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Done with upgraded connection, %d total bytes sent in %d seconds (%d kbps)", v9, v10, v11, v12, v13, v14, v15, HIDWORD(qword_100A15298[134 * a1 + 11]));
    uint64_t v16 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      unsigned int v17 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = v17;
      _os_log_impl((void *)&_mh_execute_header, v16, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v18 = &qword_100A15298[134 * a1];
  sub_10017307C((uint64_t)v5, (*((_DWORD *)v18 + 20) != 1) | (2 * (*((_DWORD *)v18 + 21) != 1)), a2);
  int v20 = *((unsigned __int8 *)v18 + 10);
  uint64_t v19 = (unsigned __int8 *)v18 + 10;
  if (v20)
  {
    unint64_t v21 = 0;
    uint64_t v22 = &qword_100A15298[134 * a1 + 3];
    while (*(unsigned char *)v22 == 1 || !*(v22 - 1) || !sub_100058654())
    {
LABEL_25:
      ++v21;
      v22 += 2;
      if (v21 >= *v19) {
        goto LABEL_26;
      }
    }
    unsigned int v30 = *(unsigned __int8 *)v22;
    if (v30 <= 2)
    {
      uint64_t v31 = "LE";
      if (v30 == 1) {
        goto LABEL_23;
      }
      if (v30 == 2)
      {
        uint64_t v31 = "BT";
        goto LABEL_23;
      }
    }
    else
    {
      switch(v30)
      {
        case 3u:
          uint64_t v31 = "WL";
          goto LABEL_23;
        case 0x10u:
          uint64_t v31 = "USB";
          goto LABEL_23;
        case 0x11u:
          uint64_t v31 = "AWDL";
          goto LABEL_23;
      }
    }
    uint64_t v31 = "??";
LABEL_23:
    sub_100056E24((uint64_t)"Af ter downgrade, tech %s still available\n", v23, v24, v25, v26, v27, v28, v29, (uint64_t)v31);
    uint64_t v32 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v32, OS_LOG_TYPE_DEFAULT))
    {
      __int16 v33 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = v33;
      _os_log_impl((void *)&_mh_execute_header, v32, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
    goto LABEL_25;
  }
LABEL_26:
  if (a2 == 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Detected error in upgrade, past tech is LE", v34, v35, v36, v37, v38, v39, v40, v52);
      unsigned int v41 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v42 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = v42;
        _os_log_impl((void *)&_mh_execute_header, v41, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }
  else if (*((void *)&xmmword_100A15260 + 1) && (a3 & 1) == 0)
  {
    (*((void (**)(uint64_t, uint64_t, uint64_t))&xmmword_100A15260 + 1))(*v5, 1, v8);
    goto LABEL_36;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Skipping scalable pipe downCb due to upgrade error %x", v43, v44, v45, v46, v47, v48, v49, *((uint64_t *)&xmmword_100A15260 + 1));
    uint64_t v50 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v50, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v51 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = v51;
      _os_log_impl((void *)&_mh_execute_header, v50, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
LABEL_36:
  long long v56 = 0u;
  long long v57 = 0u;
  LOBYTE(v56) = 1;
  WORD1(v56) = 4;
  DWORD2(v56) = 1;
  LOBYTE(v57) = 1;
  WORD1(v57) = 4;
  DWORD2(v57) = v8;
  memcpy(buf, "state", sizeof(buf));
  sub_10010CA6C("Magnet Operation", (const char *)buf, &v56, 2);
}

void sub_100171A04(unsigned __int16 *a1)
{
  if (dword_100A1525C)
  {
    uint64_t v2 = 0;
    for (unint64_t i = &dword_100A152C8; *((unsigned __int16 **)i - 6) != a1; i += 268)
    {
      if (dword_100A1525C == ++v2) {
        return;
      }
    }
    if (*((unsigned char *)i - 38))
    {
      unint64_t v4 = 0;
      uint64_t v5 = 0;
      int v6 = i - 6;
      while (1)
      {
        if (sub_100058654())
        {
          uint64_t v14 = *i == 6 ? " " : "not ";
          sub_100056E24((uint64_t)"New channel created while TS is %sIdle, state:%d index [%d, %d], transport [tech:%d, currentInUseTech:%d]", v7, v8, v9, v10, v11, v12, v13, (uint64_t)v14);
          uint64_t v15 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v16 = sub_100050714();
            *(_DWORD *)int buf = 136446210;
            uint64_t v40 = v16;
            _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        unsigned int v17 = *(unsigned __int8 *)v6;
        unsigned int v18 = *((unsigned __int8 *)i + 28);
        if (v17 != v18)
        {
          if (v17 <= v18 || (*i - 7) > 3) {
            goto LABEL_22;
          }
          if (sub_100058654())
          {
            uint64_t v26 = *((void *)v6 - 1);
            if (v26) {
              uint64_t v26 = *(unsigned __int16 *)v26;
            }
            sub_100056E24((uint64_t)"Updating lmhandle 0x%x -> 0x%x during encryption pending state", v19, v20, v21, v22, v23, v24, v25, v26);
            uint64_t v27 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
            {
              uint64_t v28 = sub_100050714();
              *(_DWORD *)int buf = 136446210;
              uint64_t v40 = v28;
              _os_log_impl((void *)&_mh_execute_header, v27, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
        }
        uint64_t v5 = *((void *)v6 - 1);
LABEL_22:
        ++v4;
        v6 += 4;
        if (v4 >= *((unsigned __int8 *)i - 38)) {
          goto LABEL_27;
        }
      }
    }
    uint64_t v5 = 0;
LABEL_27:
    if (*i >= 7) {
      sub_100170974(a1);
    }
    if (v5 && (unsigned __int16 *)v5 != a1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Faster tech available at the time of channel creation.  Moving channels\n", v29, v30, v31, v32, v33, v34, v35, v38);
        uint64_t v36 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v37 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v40 = v37;
          _os_log_impl((void *)&_mh_execute_header, v36, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      sub_10016F46C((uint64_t)a1, v5);
    }
  }
}

uint64_t sub_100171CD8(uint64_t a1, int *a2)
{
  uint64_t v4 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v5 = qword_100A15298;
    while (*v5 != a1)
    {
      v5 += 134;
      if (!--v4) {
        goto LABEL_5;
      }
    }
    uint64_t result = sub_10016F3B8((uint64_t)v5);
    if (result)
    {
      uint64_t v11 = result;
      int v12 = *(unsigned __int8 *)(result + 2);
      if (v12 == 8)
      {
        uint64_t result = 0;
        int v10 = 1460;
      }
      else
      {
        uint64_t result = 0;
        if (v12)
        {
          int v10 = 1015;
        }
        else if (*(unsigned char *)(v11 + 278))
        {
          int v10 = 2570;
        }
        else
        {
          int v10 = 2031;
        }
      }
    }
    else
    {
      unsigned int v13 = *(unsigned __int16 *)(a1 + 104);
      unsigned int v14 = *(_DWORD *)(a1 + 216) / v13;
      if (v14 <= 1) {
        unsigned int v14 = 1;
      }
      if (v14 >= 0xF) {
        unsigned int v14 = 15;
      }
      int v10 = v14 * v13 - 6;
    }
    goto LABEL_25;
  }
LABEL_5:
  BOOL v6 = sub_100197770(a1);
  uint64_t result = 601;
  if (a2 && v6)
  {
    unsigned int v8 = *(unsigned __int16 *)(a1 + 104);
    unsigned int v9 = *(_DWORD *)(a1 + 216) / v8;
    if (v9 <= 1) {
      unsigned int v9 = 1;
    }
    if (v9 >= 0xF) {
      unsigned int v9 = 15;
    }
    int v10 = v9 * v8 - 6;
    uint64_t result = 5007;
LABEL_25:
    *a2 = v10;
  }
  return result;
}

uint64_t sub_100171DE8(uint64_t a1, void *a2, int *a3)
{
  uint64_t result = sub_100171CD8(a1, a3);
  if (!result)
  {
    BOOL v6 = sub_100022FE8(*a3);
    *a2 = v6;
    if (v6) {
      return 0;
    }
    else {
      return 106;
    }
  }
  return result;
}

uint64_t sub_100171E34(uint64_t result)
{
  byte_1009F9404 = result ^ 1;
  return result;
}

void sub_100171E44(uint64_t a1, uint64_t a2, int a3)
{
  if (a2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"TS_LE_EncryptionCompleteCb completed with error %! with connectionHandle= %p ", v5, v6, v7, v8, v9, v10, v11, a2);
      int v12 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  else if (a1)
  {
    if (a3)
    {
      uint64_t v13 = dword_100A1525C;
      if (dword_100A1525C)
      {
        for (unint64_t i = &word_100A152A0; *((void *)i - 1) != a1; i += 536)
        {
          if (!--v13) {
            return;
          }
        }
        int v15 = (unsigned __int16)*i;
        if (v15 != 0xFFFF)
        {
          int v16 = sub_100237AD0((_DWORD *)(a1 + 48));
          int v17 = sub_100058654();
          if (v16)
          {
            if (v17)
            {
              sub_100056E24((uint64_t)"Got encrypted but pairing is still in progress, waiting for pairing completion", v18, v19, v20, v21, v22, v23, v24, v40);
              uint64_t v25 = sub_100050B4C(0x56u);
              if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
              {
                *(_DWORD *)int buf = 136446210;
                uint64_t v42 = sub_100050714();
                _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
              }
            }
          }
          else
          {
            if (v17)
            {
              uint64_t v26 = dword_100A1525C;
              if (dword_100A1525C)
              {
                uint64_t v27 = (unsigned int *)&dword_100A152C8;
                while (*((unsigned __int16 *)v27 - 20) != v15)
                {
                  v27 += 268;
                  if (!--v26) {
                    goto LABEL_22;
                  }
                }
                unsigned int v28 = *v27;
              }
              else
              {
LABEL_22:
                unsigned int v28 = 0;
              }
              uint64_t v29 = sub_10016E6F8(v28);
              sub_100056E24((uint64_t)"Encryption complete, pipe state is %s", v30, v31, v32, v33, v34, v35, v36, (uint64_t)v29);
              uint64_t v37 = sub_100050B4C(0x56u);
              if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
              {
                *(_DWORD *)int buf = 136446210;
                uint64_t v42 = sub_100050714();
                _os_log_impl((void *)&_mh_execute_header, v37, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
              }
            }
            uint64_t v38 = dword_100A1525C;
            if (dword_100A1525C)
            {
              for (char j = &dword_100A152C8; *((unsigned __int16 *)j - 20) != v15; j += 268)
              {
                if (!--v38) {
                  return;
                }
              }
              if (*j == 1)
              {
                sub_100170D50(v15, 2u);
                if (sub_1000E7430(a1)) {
                  sub_1001722A8((unsigned __int16 *)a1);
                }
              }
            }
          }
        }
      }
    }
  }
}

void sub_1001720A8(_DWORD *a1, uint64_t a2, uint64_t a3)
{
  if (a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"TS_LE_PairingCompleteCb completed with error %! with address=%: publicAddress=%: ", v5, v6, v7, v8, v9, v10, v11, a3);
      int v12 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  uint64_t v13 = sub_100197B34(a1);
  if (v13)
  {
    uint64_t v14 = dword_100A1525C;
    if (dword_100A1525C)
    {
      int v15 = (unsigned __int16 *)v13;
      for (unint64_t i = &word_100A152A0; *((void *)i - 1) != v13; i += 536)
      {
        if (!--v14) {
          return;
        }
      }
      int v17 = (unsigned __int16)*i;
      if (v17 != 0xFFFF)
      {
        if (sub_100058654())
        {
          uint64_t v18 = dword_100A1525C;
          if (dword_100A1525C)
          {
            uint64_t v19 = (unsigned int *)&dword_100A152C8;
            while (*((unsigned __int16 *)v19 - 20) != v17)
            {
              v19 += 268;
              if (!--v18) {
                goto LABEL_17;
              }
            }
            unsigned int v20 = *v19;
          }
          else
          {
LABEL_17:
            unsigned int v20 = 0;
          }
          uint64_t v21 = sub_10016E6F8(v20);
          sub_100056E24((uint64_t)"Got paired, pipe state is %s", v22, v23, v24, v25, v26, v27, v28, (uint64_t)v21);
          uint64_t v29 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v33 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        uint64_t v30 = dword_100A1525C;
        if (dword_100A1525C)
        {
          for (char j = &dword_100A152C8; *((unsigned __int16 *)j - 20) != v17; j += 268)
          {
            if (!--v30) {
              return;
            }
          }
          if (*j == 1)
          {
            sub_100170D50(v17, 2u);
            if (sub_1000E7430((uint64_t)v15)) {
              sub_1001722A8(v15);
            }
          }
        }
      }
    }
  }
}

void sub_1001722A8(unsigned __int16 *a1)
{
  uint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v3 = &word_100A152A0;
    while (*((unsigned __int16 **)v3 - 1) != a1)
    {
      v3 += 536;
      if (!--v2) {
        goto LABEL_5;
      }
    }
    uint64_t v4 = (unsigned __int16)*v3;
  }
  else
  {
LABEL_5:
    uint64_t v4 = 0xFFFFLL;
  }
  if (sub_1000E7480((uint64_t)a1))
  {
    uint64_t v5 = dword_100A1525C;
    if (dword_100A1525C)
    {
      uint64_t v6 = &dword_100A152C8;
      while (*((unsigned __int16 *)v6 - 20) != v4)
      {
        v6 += 268;
        if (!--v5) {
          goto LABEL_22;
        }
      }
      if (*v6 == 2)
      {
        uint64_t v15 = 13 * byte_100A15258;
        int v16 = (char *)sub_100022FE8(v15 + 7);
        if (v16)
        {
          int v17 = v16;
          *int v16 = 1;
          v16[1] = v15 + 5;
          *(_DWORD *)(v16 + 2) = 2;
          sub_100172580(v16 + 6);
          sub_100170D50(v4, 3u);
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Sending VERSION_IND to lmhandle 0x%4x for pipe 0x%4x", v18, v19, v20, v21, v22, v23, v24, *a1);
            uint64_t v25 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
            {
              *(_DWORD *)int buf = 136446210;
              uint64_t v48 = sub_100050714();
              _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
          sub_1000E8FC8(0, (uint64_t)a1, v4, v17, v15 + 7, 0);
          sub_100023010(v17);
          return;
        }
        if (!sub_100058654()) {
          return;
        }
        sub_100056E24((uint64_t)"Failed to allocate %d bytes (%d transports)", v38, v39, v40, v41, v42, v43, v44, (v15 + 7));
        uint64_t v45 = sub_100050B4C(0x56u);
        if (!os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          return;
        }
LABEL_30:
        sub_100744F6C();
        return;
      }
    }
LABEL_22:
    if (sub_100058654())
    {
      uint64_t v26 = dword_100A1525C;
      if (dword_100A1525C)
      {
        uint64_t v27 = (unsigned int *)&dword_100A152C8;
        while (*((unsigned __int16 *)v27 - 20) != v4)
        {
          v27 += 268;
          if (!--v26) {
            goto LABEL_27;
          }
        }
        unsigned int v28 = *v27;
      }
      else
      {
LABEL_27:
        unsigned int v28 = 0;
      }
      uint64_t v29 = sub_10016E6F8(v28);
      sub_100056E24((uint64_t)"VERSION should only be send when in ENCRYPTED state. Current state is %s", v30, v31, v32, v33, v34, v35, v36, (uint64_t)v29);
      uint64_t v37 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        goto LABEL_30;
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Link is not encrypted, can't send version", v7, v8, v9, v10, v11, v12, v13, v46);
    uint64_t v14 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100172580(unsigned char *a1)
{
  *a1 = byte_100A15258;
  if (!byte_100A15258) {
    return 1;
  }
  uint64_t v1 = 0;
  unint64_t v2 = 0;
  uint64_t v3 = 13;
  do
  {
    uint64_t v4 = &a1[v3];
    *(v4 - 12) = 12;
    *(v4 - 11) = *(unsigned char *)(qword_100A15250 + v1);
    *(v4 - 10) = *(unsigned char *)(qword_100A15250 + v1 + 1);
    *(v4 - 9) = *(unsigned char *)(qword_100A15250 + v1 + 2);
    *(v4 - 8) = *(unsigned char *)(qword_100A15250 + v1 + 12);
    *(_WORD *)(v4 - 7) = *(_DWORD *)(qword_100A15250 + v1 + 4);
    *(v4 - 5) = *(_WORD *)(qword_100A15250 + v1 + 6);
    *(v4 - 4) = *(unsigned char *)(qword_100A15250 + v1 + 7);
    *(v4 - 3) = *(unsigned char *)(qword_100A15250 + v1 + 8);
    *(v4 - 2) = *(unsigned char *)(qword_100A15250 + v1 + 9);
    *(v4 - 1) = *(unsigned char *)(qword_100A15250 + v1 + 10);
    *uint64_t v4 = *(unsigned char *)(qword_100A15250 + v1 + 11);
    ++v2;
    v1 += 64;
    v3 += 13;
  }
  while (v2 < byte_100A15258);
  return (v3 - 12);
}

void sub_100172698(uint64_t a1, int a2)
{
  uint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    for (unint64_t i = &word_100A152A0; *((void *)i - 1) != a1; i += 536)
    {
      if (!--v2) {
        return;
      }
    }
    uint64_t v6 = (unsigned __int16)*i;
    if (v6 != 0xFFFF)
    {
      if (sub_1000E7480(a1))
      {
        if (byte_100A15258)
        {
          uint64_t v7 = 0;
          while (*(unsigned __int8 *)(qword_100A15250 + v7) != a2)
          {
            v7 += 64;
            if ((unint64_t)byte_100A15258 << 6 == v7) {
              return;
            }
          }
          int v16 = sub_100022FE8(0xAuLL);
          if (v16)
          {
            int v17 = v16;
            *int v16 = 2053;
            *((unsigned char *)v16 + 2) = a2;
            *((unsigned char *)v16 + 3) = *(unsigned char *)(qword_100A15250 + v7 + 2);
            v16[2] = *(_DWORD *)(qword_100A15250 + v7 + 4);
            *((unsigned char *)v16 + 6) = *(_WORD *)(qword_100A15250 + v7 + 6);
            *((unsigned char *)v16 + 7) = *(unsigned char *)(qword_100A15250 + v7 + 7);
            uint64_t v18 = qword_100A15250 + v7;
            *((unsigned char *)v16 + 8) = *(unsigned char *)(qword_100A15250 + v7 + 8);
            *((unsigned char *)v16 + 9) = *(unsigned char *)(v18 + 9);
            sub_1000E8FC8(0, a1, v6, (char *)v16, 0xAuLL, 0);
            sub_100023010(v17);
          }
        }
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Link is not encrypted, can't send cpas changed", v8, v9, v10, v11, v12, v13, v14, v19);
        uint64_t v15 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
}

uint64_t sub_10017285C(uint64_t a1)
{
  if (sub_100197698(a1))
  {
    if (!sub_100058654()) {
      return 1;
    }
    sub_100056E24((uint64_t)"Already connected to classic", v2, v3, v4, v5, v6, v7, v8, v46);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      return 1;
    }
    goto LABEL_12;
  }
  if (!sub_100197770(a1))
  {
    if (!sub_100058654()) {
      return 1;
    }
    sub_100056E24((uint64_t)"Invalid LE handle", v11, v12, v13, v14, v15, v16, v17, v46);
    uint64_t v18 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      return 1;
    }
LABEL_12:
    sub_100744F6C();
    return 1;
  }
  if (*(unsigned char *)(a1 + 48))
  {
    if (!*(unsigned char *)(a1 + 55) || *(unsigned char *)(a1 + 56)) {
      return 1;
    }
    uint64_t v10 = a1 + 57;
  }
  else
  {
    uint64_t v10 = a1 + 49;
  }
  int v48 = *(_DWORD *)v10;
  __int16 v49 = *(_WORD *)(v10 + 4);
  if (sub_1001F7D74() > 0xE)
  {
    uint64_t v26 = 0;
  }
  else
  {
    uint64_t v26 = sub_10018F028((uint64_t)sub_1001739C8, a1, v20, v21, v22, v23, v24, v25);
    if (v26)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Read RSSI failed with status %!", v27, v28, v29, v30, v31, v32, v33, v26);
        uint64_t v34 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
    }
  }
  sub_100170974((unsigned __int16 *)a1);
  uint64_t v35 = sub_100197A30((uint64_t)&v48);
  BOOL v36 = sub_1000E7430(a1);
  if (!v35)
  {
    if (!v36)
    {
LABEL_29:
      if (!v26) {
        return 0;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to start upgrade %!.", v38, v39, v40, v41, v42, v43, v44, v26);
        uint64_t v45 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_100171078((unsigned __int16 *)a1);
      return 4;
    }
LABEL_28:
    uint64_t v26 = sub_10017B9C4((uint64_t)sub_10016F9A4, (uint64_t)&v48);
    goto LABEL_29;
  }
  if (v36) {
    goto LABEL_28;
  }
  uint64_t result = 0;
  unsigned int v37 = *(unsigned __int8 *)(v35 + 54);
  if (v37 <= 5 && ((1 << v37) & 0x39) != 0)
  {
    v47[1] = &v48;
    v47[0] = (const void *)6;
    sub_10017BCA0(v35);
    sub_100026DA8((uint64_t)sub_100173A6C, v47, 0);
    return 0;
  }
  return result;
}

uint64_t sub_100172AD0(unsigned __int16 *a1, char a2)
{
  uint64_t v3 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v4 = &word_100A152A0;
    while (*((unsigned __int16 **)v4 - 1) != a1)
    {
      v4 += 536;
      if (!--v3) {
        goto LABEL_5;
      }
    }
    uint64_t v5 = (unsigned __int16)*v4;
  }
  else
  {
LABEL_5:
    uint64_t v5 = 0xFFFFLL;
  }
  __int16 v16 = 275;
  char v17 = a2;
  if (a1) {
    uint64_t v6 = *a1;
  }
  else {
    uint64_t v6 = 0;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Sending UPGRADE_COMPLETE to lmhandle 0x%4x p:%0x%4X with %s", v7, v8, v9, v10, v11, v12, v13, v6);
    uint64_t v14 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v19 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v14, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t result = sub_1000E8FC8(0, (uint64_t)a1, v5, (char *)&v16, 3uLL, 0);
  if (result == 412 || !result) {
    return sub_100170F7C(v5, 0x3A98u);
  }
  return result;
}

void sub_100172C50(unsigned __int16 *a1, int a2)
{
  unsigned int v2 = dword_100A1525C;
  if (!dword_100A1525C)
  {
    LODWORD(v7) = 0xFFFF;
LABEL_19:
    if (sub_100058654())
    {
      uint64_t v14 = dword_100A1525C;
      if (dword_100A1525C)
      {
        uint64_t v15 = (unsigned int *)&dword_100A152C8;
        while (*((unsigned __int16 *)v15 - 20) != v7)
        {
          v15 += 268;
          if (!--v14) {
            goto LABEL_24;
          }
        }
        unsigned int v16 = *v15;
      }
      else
      {
LABEL_24:
        unsigned int v16 = 0;
      }
      char v17 = sub_10016E6F8(v16);
      sub_100056E24((uint64_t)"Not sending UPGRADE_COMPLETE_CFM, since the state is %s", v18, v19, v20, v21, v22, v23, v24, (uint64_t)v17);
      uint64_t v25 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    return;
  }
  uint64_t v5 = &word_100A152A0;
  uint64_t v6 = dword_100A1525C;
  while (*((unsigned __int16 **)v5 - 1) != a1)
  {
    v5 += 536;
    if (!--v6)
    {
      uint64_t v7 = 0xFFFFLL;
      goto LABEL_8;
    }
  }
  uint64_t v7 = (unsigned __int16)*v5;
LABEL_8:
  __int16 v37 = 276;
  char v38 = a2;
  uint64_t v8 = &dword_100A152C8;
  uint64_t v9 = dword_100A1525C;
  while (*((unsigned __int16 *)v8 - 20) != v7)
  {
    v8 += 268;
    if (!--v9) {
      goto LABEL_19;
    }
  }
  if (*v8 != 10) {
    goto LABEL_19;
  }
  unint64_t v10 = 0;
  unsigned int v11 = 0;
  if (dword_100A1525C <= 1) {
    unsigned int v2 = 1;
  }
  uint64_t v12 = 1072 * v2;
  while ((unsigned __int16 *)qword_100A15298[v10 / 8] != a1)
  {
    ++v11;
    v10 += 1072;
    if (v12 == v10)
    {
      uint64_t v13 = 0;
      goto LABEL_34;
    }
  }
  uint64_t v26 = &qword_100A15298[v10 / 8];
  uint64_t v7 = LOWORD(qword_100A15298[v10 / 8 + 1]);
  sub_100170D50(LOWORD(qword_100A15298[v10 / 8 + 1]), 6u);
  sub_1001713B0(v11, *((unsigned __int8 *)v26 + 77));
  *((unsigned char *)v26 + 77) = 1;
  sub_1000EAB1C((uint64_t)a1, 1);
  sub_100171078(a1);
  ++*((_DWORD *)v26 + 50);
  ++*((_WORD *)v26 + 526);
  sub_100026C30((uint64_t)(v26 + 16));
  uint64_t v13 = sub_10016F3B8((uint64_t)v26);
  if (!sub_100197698(v13) && !sub_100197740(v13) && !sub_100197770(v13) && !sub_1001977A0(v13))
  {
LABEL_34:
    uint64_t v27 = 1;
    if (a1)
    {
LABEL_35:
      uint64_t v28 = *a1;
      goto LABEL_41;
    }
    goto LABEL_40;
  }
  if (a2)
  {
    sub_10017BD74(v13, 0x13u);
    goto LABEL_34;
  }
  sub_10016F46C((uint64_t)a1, v13);
  sub_100171078((unsigned __int16 *)v13);
  if (*(unsigned char *)(v13 + 2)) {
    uint64_t v27 = 17;
  }
  else {
    uint64_t v27 = 2;
  }
  if (a1) {
    goto LABEL_35;
  }
LABEL_40:
  uint64_t v28 = 0;
LABEL_41:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Sending UPGRADE_COMPLETE_CFM to lmhandle 0x%4x p:%0x%4X with %s", v29, v30, v31, v32, v33, v34, v35, v28);
    BOOL v36 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v36, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  sub_1000E8FC8(0, (uint64_t)a1, v7, (char *)&v37, 3uLL, 0);
  if (!a2 && (void)xmmword_100A15260)
  {
    if (sub_100197698(v13))
    {
      if (!v13) {
        sub_10025B8C0();
      }
      ((void (*)(unsigned __int16 *, uint64_t, uint64_t, void))xmmword_100A15260)(a1, v27, v13 + 48, *(unsigned __int8 *)(v13 + 278));
    }
    else
    {
      ((void (*)(unsigned __int16 *, uint64_t, void, void))xmmword_100A15260)(a1, v27, 0, 0);
    }
  }
  long long v40 = 0u;
  long long v41 = 0u;
  LOBYTE(v40) = 1;
  WORD1(v40) = 4;
  DWORD2(v40) = 9;
  LOBYTE(v41) = 1;
  WORD1(v41) = 4;
  DWORD2(v41) = a2;
  memcpy(buf, "state", sizeof(buf));
  sub_10010CA6C("Magnet Operation", (const char *)buf, &v40, 2);
}

void sub_10017307C(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v48 = 0;
  sub_10010BC48((uint64_t)&v48);
  int v6 = *(__int16 *)(a1 + 156) + 1000 * *(_DWORD *)(a1 + 152);
  if (v6)
  {
    int v7 = 1000 * v48;
    int v8 = SWORD2(v48);
    unsigned int v9 = 1000 * v48 - v6 + SWORD2(v48);
    *(_DWORD *)(a1 + 152) = 0;
    *(_WORD *)(a1 + 156) = 0;
    unsigned int v10 = v9 / 0x3E8;
    unsigned int v11 = v9 % 0x3E8;
  }
  else
  {
    unsigned int v10 = 0;
    LOWORD(v11) = 0;
    int v8 = SWORD2(v48);
    int v7 = 1000 * v48;
  }
  int v12 = v7 + v8;
  int v13 = *(__int16 *)(a1 + 212) + 1000 * *(_DWORD *)(a1 + 208);
  unsigned int v14 = v12 - v13;
  if (v12 == v13) {
    signed int v15 = -1;
  }
  else {
    signed int v15 = 8 * *(_DWORD *)(a1 + 92) / v14;
  }
  unsigned int v16 = *(unsigned __int8 *)(a1 + 77);
  int v17 = sub_100058654();
  if (v16 <= a3)
  {
    if (!v17) {
      goto LABEL_47;
    }
    if (a3 <= 2)
    {
      if (a3 == 1)
      {
        uint64_t v26 = "LE";
        goto LABEL_45;
      }
      if (a3 == 2)
      {
        uint64_t v26 = "BT";
        goto LABEL_45;
      }
    }
    else
    {
      switch(a3)
      {
        case 3:
          uint64_t v26 = "WL";
          goto LABEL_45;
        case 16:
          uint64_t v26 = "USB";
          goto LABEL_45;
        case 17:
          uint64_t v26 = "AWDL";
          goto LABEL_45;
      }
    }
    uint64_t v26 = "??";
LABEL_45:
    sub_100056E24((uint64_t)"Transport downgrade (%s -> %s): duration %d ms, Tx[ %d kbps, %d B]", v18, v19, v20, v21, v22, v23, v24, (uint64_t)v26);
    __int16 v37 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_47;
    }
    goto LABEL_46;
  }
  if (!v17) {
    goto LABEL_36;
  }
  if (a3 <= 2)
  {
    if (a3 == 1)
    {
      uint64_t v25 = "LE";
      goto LABEL_34;
    }
    if (a3 == 2)
    {
      uint64_t v25 = "BT";
      goto LABEL_34;
    }
  }
  else
  {
    switch(a3)
    {
      case 3:
        uint64_t v25 = "WL";
        goto LABEL_34;
      case 16:
        uint64_t v25 = "USB";
        goto LABEL_34;
      case 17:
        uint64_t v25 = "AWDL";
        goto LABEL_34;
    }
  }
  uint64_t v25 = "??";
LABEL_34:
  sub_100056E24((uint64_t)"Transport upgrade (%s -> %s): duration %d ms, Tx[ %d kbps, %d B] upgrade time %d ms, retries %d", v18, v19, v20, v21, v22, v23, v24, (uint64_t)v25);
  uint64_t v27 = sub_100050B4C(0x56u);
  if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
  {
    uint64_t v28 = sub_100050714();
    *(_DWORD *)int buf = 136446210;
    uint64_t v50 = v28;
    _os_log_impl((void *)&_mh_execute_header, v27, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
  }
LABEL_36:
  if (!*(unsigned char *)(a1 + 446))
  {
    if (!sub_100058654()) {
      goto LABEL_47;
    }
    sub_100056E24((uint64_t)"No action pending on upgrade", v30, v31, v32, v33, v34, v35, v36, v47);
    __int16 v37 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_47;
    }
LABEL_46:
    uint64_t v46 = sub_100050714();
    *(_DWORD *)int buf = 136446210;
    uint64_t v50 = v46;
    _os_log_impl((void *)&_mh_execute_header, v37, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    goto LABEL_47;
  }
  uint64_t v29 = sub_10016F3B8(a1);
  if (sub_100197698(v29))
  {
    sub_10016EB4C(*(unsigned char *)(a1 + 447) != 0);
    *(unsigned char *)(a1 + 446) = 0;
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Invalid connection handle.", v38, v39, v40, v41, v42, v43, v44, v47);
    uint64_t v45 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
LABEL_47:
  if (1000 * v10 + (unsigned __int16)v11 >= 0x1F5) {
    sub_10025B8C0();
  }
  if (off_100A15280) {
    off_100A15280(a2, a3, *(void *)(a1 + 208), v48, v14 / 0x3E8uLL, (v15 / 8), *(unsigned int *)(a1 + 92) / 0x3E8uLL, v10 | ((unint64_t)(unsigned __int16)v11 << 32));
  }
  if (a3 != 1) {
    *(_DWORD *)(a1 + 204) += v14 / 0x3E8;
  }
  *(_WORD *)(a1 + 212) = WORD2(v48);
  *(_DWORD *)(a1 + 208) = v48;
  *(_DWORD *)(a1 + 92) = 0;
}

void sub_1001735E4(uint64_t a1, __int16 a2)
{
  if (!dword_100A1525C) {
    goto LABEL_30;
  }
  uint64_t v3 = 0;
  uint64_t v4 = &word_100A152A0;
  while (*v4 != a2)
  {
    ++v3;
    v4 += 536;
    if (dword_100A1525C == v3) {
      goto LABEL_30;
    }
  }
  uint64_t v5 = (unsigned __int16 *)*((void *)v4 - 1);
  if (!v5)
  {
LABEL_30:
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"No more connection handle for this pipeID", v27, v28, v29, v30, v31, v32, v33, v59);
    uint64_t v34 = sub_100050B4C(0x56u);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_32;
  }
  int v6 = &qword_100A15298[134 * (unsigned __int16)v3];
  int v8 = *((_DWORD *)v6 + 12);
  int v7 = v6 + 6;
  if (v8 != 9)
  {
    sub_10025B8C0();
    if (*v7 != 9)
    {
      if (!sub_100058654()) {
        return;
      }
      sub_100056E24((uint64_t)"Got an encryption complete although we were not pending an encryption", v35, v36, v37, v38, v39, v40, v41, v59);
      uint64_t v42 = sub_100050B4C(0x56u);
      if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
        return;
      }
LABEL_32:
      sub_100744F6C();
      return;
    }
  }
  if ((sub_1000E7480((uint64_t)v5) & 1) == 0) {
    sub_10025B8C0();
  }
  unsigned int v9 = &qword_100A15298[134 * (unsigned __int16)v3];
  int v11 = *((unsigned __int8 *)v9 + 10);
  unsigned int v10 = (char *)v9 + 10;
  if (v11 || (sub_10025B8C0(), *v10))
  {
    unint64_t v12 = 0;
    char v13 = 0;
    uint64_t v14 = 0;
    signed int v15 = &qword_100A15298[134 * (unsigned __int16)v3 + 2];
    do
    {
      uint64_t v16 = *v15;
      int v17 = *(unsigned __int8 *)(*v15 + 2);
      if ((*(unsigned char *)(*v15 + 2) != 0) == (*((unsigned char *)v15 + 8) == 2))
      {
        sub_10025B8C0();
        uint64_t v16 = *v15;
        int v17 = *(unsigned __int8 *)(*v15 + 2);
      }
      BOOL v18 = v17 == 0;
      if (sub_100197698(v16)) {
        uint64_t v14 = *v15;
      }
      v13 |= v18;
      ++v12;
      v15 += 2;
    }
    while (v12 < *v10);
    if (v14)
    {
      if (v13)
      {
        if (a1)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Error from security callback %!", v19, v20, v21, v22, v23, v24, v25, a1);
            uint64_t v26 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
            {
              *(_DWORD *)int buf = 136446210;
              int v61 = sub_100050714();
              _os_log_impl((void *)&_mh_execute_header, v26, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
          if (off_100A15288) {
            off_100A15288(v5, 81, 2020, a1);
          }
        }
        if (sub_100253590(v14))
        {
          if (sub_1000E7430((uint64_t)v5))
          {
            sub_10016F46C((uint64_t)v5, v14);
            sub_100172AD0(v5, 0);
          }
          else
          {
            sub_100172C50(v5, 0);
          }
        }
        else
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Failed to encrypt : %!", v51, v52, v53, v54, v55, v56, v57, a1);
            BOOL v58 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
          sub_100170D50((unsigned __int16)v3, 8u);
          if (sub_1000E7430((uint64_t)v5))
          {
            sub_10017BD74(v14, 5u);
            sub_100172AD0(v5, 6);
            sub_1000E5354((uint64_t)v5);
          }
        }
        return;
      }
    }
    else
    {
      sub_10025B8C0();
      if (v13) {
        goto LABEL_41;
      }
    }
  }
  else
  {
    sub_10025B8C0();
  }
  sub_10025B8C0();
LABEL_41:
  if (off_100A15288) {
    off_100A15288(v5, 81, 2012, a1);
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"No classic connection for this handle...", v43, v44, v45, v46, v47, v48, v49, v59);
    uint64_t v50 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_1001739C8(uint64_t a1, uint64_t a2, int a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read RSSI CB failed with status %!", v4, v5, v6, v7, v8, v9, v10, a1);
      int v11 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  else
  {
    uint64_t v12 = dword_100A1525C;
    if (dword_100A1525C)
    {
      for (unint64_t i = qword_100A15298; *i != a2; i += 134)
      {
        if (!--v12) {
          return;
        }
      }
      *((_DWORD *)i + 47) = a3;
    }
  }
}

uint64_t sub_100173A6C(uint64_t a1)
{
  uint64_t v1 = *(int **)(a1 + 8);
  __int16 v2 = *((_WORD *)v1 + 2);
  int v5 = *v1;
  __int16 v6 = v2;
  uint64_t v3 = sub_100197A30((uint64_t)&v5);
  if (v3) {
    sub_10016F9A4(0, &v5, v3);
  }
  return sub_10017BD74(v3, 0x13u);
}

uint64_t sub_100173AD0(uint64_t result)
{
  uint64_t v1 = dword_100A1525C;
  if (dword_100A1525C)
  {
    for (unint64_t i = &dword_100A152CC; *((unsigned __int16 *)i - 22) != result; i += 268)
    {
      if (!--v1) {
        return result;
      }
    }
    uint64_t result = sub_100026DB4(*i);
    *unint64_t i = 0;
  }
  return result;
}

void sub_100173B28(unsigned __int16 *a1, unsigned __int8 *a2, uint64_t a3)
{
  int v156 = 0;
  uint64_t v3 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v7 = &word_100A152A0;
    while (*((unsigned __int16 **)v7 - 1) != a1)
    {
      v7 += 536;
      if (!--v3) {
        goto LABEL_12;
      }
    }
    if (*v7 != -1)
    {
      if (sub_1000E7430((uint64_t)a1))
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"VERSION_IND not supposed to get a version from the peripheral.", v8, v9, v10, v11, v12, v13, v14, v154);
          signed int v15 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            *(void *)&uint8_t buf[4] = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        uint64_t v16 = (uint64_t)a1;
        char v17 = 2;
LABEL_53:
        sub_100176F7C(v16, 1, v17);
        return;
      }
      uint64_t v26 = dword_100A1525C;
      if (!dword_100A1525C) {
        goto LABEL_26;
      }
      uint64_t v27 = &word_100A152A0;
      uint64_t v28 = dword_100A1525C;
      while (*((unsigned __int16 **)v27 - 1) != a1)
      {
        v27 += 536;
        if (!--v28)
        {
          int v29 = 0xFFFF;
          goto LABEL_21;
        }
      }
      int v29 = (unsigned __int16)*v27;
LABEL_21:
      uint64_t v30 = &dword_100A152C8;
      while (*((unsigned __int16 *)v30 - 20) != v29)
      {
        v30 += 268;
        if (!--v26) {
          goto LABEL_26;
        }
      }
      if (*v30 != 2)
      {
LABEL_26:
        if (sub_100058654())
        {
          uint64_t v31 = dword_100A1525C;
          if (dword_100A1525C)
          {
            uint64_t v32 = &word_100A152A0;
            uint64_t v33 = dword_100A1525C;
            while (*((unsigned __int16 **)v32 - 1) != a1)
            {
              v32 += 536;
              if (!--v33)
              {
                int v34 = 0xFFFF;
                goto LABEL_33;
              }
            }
            int v34 = (unsigned __int16)*v32;
LABEL_33:
            uint64_t v35 = (unsigned int *)&dword_100A152C8;
            while (*((unsigned __int16 *)v35 - 20) != v34)
            {
              v35 += 268;
              if (!--v31) {
                goto LABEL_36;
              }
            }
            unsigned int v36 = *v35;
          }
          else
          {
LABEL_36:
            unsigned int v36 = 0;
          }
          uint64_t v37 = sub_10016E6F8(v36);
          sub_100056E24((uint64_t)"VERSION_IND as peripheral but the current state is %s", v38, v39, v40, v41, v42, v43, v44, (uint64_t)v37);
          uint64_t v45 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
      uint64_t v46 = (a3 - 4);
      if (a3 < 4)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"VERSION_IND bad length for version PDU : %d", v67, v68, v69, v70, v71, v72, v73, a3);
          uint64_t v74 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v74, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        uint64_t v16 = (uint64_t)a1;
        char v17 = 1;
        goto LABEL_53;
      }
      uint64_t v47 = *a2;
      int v48 = v47 | (a2[1] << 8) | (a2[2] << 16) | (a2[3] << 24);
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Received VERSION_IND for lmhandle 0x%4x version %d", v49, v50, v51, v52, v53, v54, v55, *a1);
        uint64_t v56 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v56, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          *(void *)&uint8_t buf[4] = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v56, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      uint64_t v157 = 0;
      uint64_t v57 = sub_100176FFC(a2 + 4, v46, &v157, &v156);
      if (v57)
      {
        uint64_t v58 = v57;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Parsing error with status %!", v59, v60, v61, v62, v63, v64, v65, v58);
          unsigned int v66 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        uint64_t v16 = (uint64_t)a1;
        char v17 = v58;
        goto LABEL_53;
      }
      uint64_t v75 = dword_100A1525C;
      if (dword_100A1525C)
      {
        uint64_t v76 = &dword_100A152E0;
        while (*((unsigned __int16 **)v76 - 9) != a1)
        {
          v76 += 268;
          if (!--v75) {
            goto LABEL_63;
          }
        }
        uint64_t v77 = (void *)*((void *)v76 - 1);
        if (v77) {
          sub_100023010(v77);
        }
        *((void *)v76 - 1) = v157;
        *uint64_t v76 = v156;
        *(v76 - 4) = v48;
      }
LABEL_63:
      int v155 = v48;
      sub_1000E5010((uint64_t)a1);
      if (xmmword_100A15270) {
        xmmword_100A15270(a1, v47, *((unsigned __int8 *)a1 + 26), *((_DWORD *)a1 + 37) == 2);
      }
      uint64_t v78 = dword_100A1525C;
      if (!dword_100A1525C) {
        goto LABEL_77;
      }
      uint64_t v79 = &word_100A152A0;
      while (*((unsigned __int16 **)v79 - 1) != a1)
      {
        v79 += 536;
        if (!--v78) {
          goto LABEL_77;
        }
      }
      uint64_t v80 = (unsigned __int16)*v79;
      if (v80 == 0xFFFF)
      {
LABEL_77:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Not tracking this device.", v83, v84, v85, v86, v87, v88, v89, v154);
          uint64_t v90 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v90, OS_LOG_TYPE_ERROR)) {
            goto LABEL_79;
          }
        }
      }
      else if (sub_1000E7480((uint64_t)a1))
      {
        uint64_t v81 = dword_100A1525C;
        if (!dword_100A1525C) {
          goto LABEL_114;
        }
        uint64_t v82 = &dword_100A152C8;
        while (*((unsigned __int16 *)v82 - 20) != v80)
        {
          v82 += 268;
          if (!--v81) {
            goto LABEL_114;
          }
        }
        if (*v82 != 2)
        {
LABEL_114:
          if (!sub_100058654()) {
            goto LABEL_80;
          }
          uint64_t v134 = dword_100A1525C;
          if (dword_100A1525C)
          {
            v135 = (unsigned int *)&dword_100A152C8;
            while (*((unsigned __int16 *)v135 - 20) != v80)
            {
              v135 += 268;
              if (!--v134) {
                goto LABEL_119;
              }
            }
            unsigned int v136 = *v135;
          }
          else
          {
LABEL_119:
            unsigned int v136 = 0;
          }
          v137 = sub_10016E6F8(v136);
          sub_100056E24((uint64_t)"Caps response should only be send when in ENCRYPTED state. Current state is %s", v138, v139, v140, v141, v142, v143, v144, (uint64_t)v137);
          v145 = sub_100050B4C(0x56u);
          if (!os_log_type_enabled(v145, OS_LOG_TYPE_ERROR)) {
            goto LABEL_80;
          }
          goto LABEL_79;
        }
        sub_100170D50(v80, 6u);
        uint64_t v121 = 13 * byte_100A15258;
        uint64_t v122 = (char *)sub_100022FE8(v121 + 7);
        if (v122)
        {
          uint64_t v123 = v122;
          *uint64_t v122 = 2;
          v122[1] = v121 + 5;
          *(_DWORD *)(v122 + 2) = 2;
          if (v121 + 1 != (unsigned __int16)sub_100172580(v122 + 6)) {
            sub_10025B8C0();
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Sending CAPS_IND on lmhandle 0x%4x to version %d", v124, v125, v126, v127, v128, v129, v130, *a1);
            v131 = sub_100050B4C(0x56u);
            if (os_log_type_enabled(v131, OS_LOG_TYPE_DEFAULT))
            {
              v132 = sub_100050714();
              *(_DWORD *)int buf = 136446210;
              *(void *)&uint8_t buf[4] = v132;
              _os_log_impl((void *)&_mh_execute_header, v131, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
          int v133 = sub_1000E8FC8(0, (uint64_t)a1, v80, v123, v121 + 7, 0);
          sub_100023010(v123);
          if (!v133 || v133 == 412) {
            goto LABEL_100;
          }
          goto LABEL_80;
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Failed to allocate %d bytes (%d transports)", v146, v147, v148, v149, v150, v151, v152, (v121 + 7));
          v153 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v153, OS_LOG_TYPE_ERROR)) {
LABEL_79:
          }
            sub_100744F6C();
        }
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Link is not encrypted, can't send caps", v113, v114, v115, v116, v117, v118, v119, v154);
        uint64_t v120 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v120, OS_LOG_TYPE_ERROR)) {
          goto LABEL_79;
        }
      }
LABEL_80:
      sub_100176F7C((uint64_t)a1, 1, 1);
      unsigned int v91 = dword_100A1525C;
      if (dword_100A1525C)
      {
        unsigned int v92 = 0;
        do
        {
          unsigned int v93 = v92;
          uint64_t v94 = &qword_100A15298[134 * v92];
          if ((unsigned __int16 *)*v94 == a1)
          {
            *(void *)&long long v159 = 0;
            sub_10010BC48((uint64_t)&v159);
            int v95 = SWORD2(v159) + 1000 * v159;
            int v96 = SWORD2(qword_100A15298[134 * v93 + 24]) + 1000 * LODWORD(qword_100A15298[134 * v93 + 24]);
            if (v95 == v96) {
              uint64_t v97 = 0xFFFFFFFFLL;
            }
            else {
              uint64_t v97 = 8 * HIDWORD(qword_100A15298[134 * v93 + 11]) / (v95 - v96);
            }
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Done with connection, %d total bytes sent in %d seconds (%d kbps)", v98, v99, v100, v101, v102, v103, v104, HIDWORD(qword_100A15298[134 * v93 + 11]));
              unsigned int v105 = sub_100050B4C(0x56u);
              if (os_log_type_enabled(v105, OS_LOG_TYPE_DEFAULT))
              {
                uint64_t v106 = sub_100050714();
                *(_DWORD *)int buf = 136446210;
                *(void *)&uint8_t buf[4] = v106;
                _os_log_impl((void *)&_mh_execute_header, v105, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
              }
            }
            if (*((void *)&xmmword_100A15260 + 1)) {
              (*((void (**)(unsigned __int16 *, uint64_t, uint64_t))&xmmword_100A15260 + 1))(a1, 1, v97);
            }
            uint64_t v107 = HIDWORD(qword_100A15298[134 * v93 + 6]);
            if (v107) {
              sub_100026DB4(v107);
            }
            uint64_t v108 = &qword_100A15298[134 * v93];
            uint64_t v111 = (void *)v108[8];
            uint64_t v110 = v108 + 8;
            uint64_t v109 = v111;
            if (v111)
            {
              sub_100023010(v109);
              *uint64_t v110 = 0;
              LODWORD(qword_100A15298[134 * v93 + 9]) = 0;
            }
            int v112 = dword_100A1525C;
            unsigned int v91 = --dword_100A1525C;
            if (v112 != 1) {
              memcpy(&qword_100A15298[134 * (v112 - 2)], v94, 0x430uLL);
            }
            bzero(&qword_100A15298[134 * v91], 0x430uLL);
            unsigned int v92 = 0;
          }
          else
          {
            ++v92;
          }
        }
        while (v92 < v91);
      }
LABEL_100:
      long long v159 = 0u;
      long long v160 = 0u;
      LOBYTE(v159) = 1;
      WORD1(v159) = 4;
      DWORD2(v159) = 2;
      LOBYTE(v160) = 1;
      WORD1(v160) = 4;
      DWORD2(v160) = v155;
      memcpy(buf, "state", sizeof(buf));
      sub_10010CA6C("Magnet Operation", (const char *)buf, &v159, 2);
      return;
    }
  }
LABEL_12:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"VERSION_IND not tracking this device.", v18, v19, v20, v21, v22, v23, v24, v154);
    uint64_t v25 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100174484(unsigned __int16 *a1, unsigned __int8 *a2, unsigned int a3)
{
  int v99 = 0;
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_13;
  }
  uint64_t v7 = &word_100A152A0;
  while (*((unsigned __int16 **)v7 - 1) != a1)
  {
    v7 += 536;
    if (!--v3) {
      goto LABEL_13;
    }
  }
  if (*v7 == -1)
  {
LABEL_13:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"CAPS_IND not tracking this device.", v12, v13, v14, v15, v16, v17, v18, v98);
      uint64_t v19 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (!sub_1000E7430((uint64_t)a1))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"CAPS_IND not supposed to get a caps from the central.", v20, v21, v22, v23, v24, v25, v26, v98);
        uint64_t v27 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          *(void *)&uint8_t buf[4] = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v27, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      uint64_t v28 = (uint64_t)a1;
      char v29 = 2;
      goto LABEL_59;
    }
    uint64_t v8 = dword_100A1525C;
    if (!dword_100A1525C) {
      goto LABEL_26;
    }
    uint64_t v9 = &word_100A152A0;
    uint64_t v10 = dword_100A1525C;
    while (*((unsigned __int16 **)v9 - 1) != a1)
    {
      v9 += 536;
      if (!--v10)
      {
        int v11 = 0xFFFF;
        goto LABEL_21;
      }
    }
    int v11 = (unsigned __int16)*v9;
LABEL_21:
    uint64_t v30 = &dword_100A152C8;
    while (*((unsigned __int16 *)v30 - 20) != v11)
    {
      v30 += 268;
      if (!--v8) {
        goto LABEL_26;
      }
    }
    if (*v30 != 3)
    {
LABEL_26:
      if (sub_100058654())
      {
        uint64_t v31 = dword_100A1525C;
        if (dword_100A1525C)
        {
          uint64_t v32 = &word_100A152A0;
          uint64_t v33 = dword_100A1525C;
          while (*((unsigned __int16 **)v32 - 1) != a1)
          {
            v32 += 536;
            if (!--v33)
            {
              int v34 = 0xFFFF;
              goto LABEL_33;
            }
          }
          int v34 = (unsigned __int16)*v32;
LABEL_33:
          uint64_t v35 = (unsigned int *)&dword_100A152C8;
          while (*((unsigned __int16 *)v35 - 20) != v34)
          {
            v35 += 268;
            if (!--v31) {
              goto LABEL_36;
            }
          }
          unsigned int v36 = *v35;
        }
        else
        {
LABEL_36:
          unsigned int v36 = 0;
        }
        uint64_t v37 = sub_10016E6F8(v36);
        sub_100056E24((uint64_t)"CAPS_IND as central but the current state is %s", v38, v39, v40, v41, v42, v43, v44, (uint64_t)v37);
        uint64_t v45 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    uint64_t v46 = a3 - 4;
    if (a3 <= 4)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Wrong size for caps.", v47, v48, v49, v50, v51, v52, v53, v98);
        uint64_t v54 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      uint64_t v28 = (uint64_t)a1;
      char v29 = 3;
LABEL_59:
      sub_100176F7C(v28, 2, v29);
      return;
    }
    uint64_t v55 = dword_100A1525C;
    if (dword_100A1525C)
    {
      uint64_t v56 = &word_100A152A0;
      while (*((unsigned __int16 **)v56 - 1) != a1)
      {
        v56 += 536;
        if (!--v55) {
          goto LABEL_49;
        }
      }
      int v57 = (unsigned __int16)*v56;
    }
    else
    {
LABEL_49:
      int v57 = 0xFFFF;
    }
    sub_100170D50(v57, 4u);
    uint64_t v58 = *a2;
    int v59 = v58 | (a2[1] << 8) | (a2[2] << 16) | (a2[3] << 24);
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received CAPS_IND for lmhandle 0x%4x with version %d", v60, v61, v62, v63, v64, v65, v66, *a1);
      uint64_t v67 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v67, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v67, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v100 = 0;
    uint64_t v68 = sub_100176FFC(a2 + 4, v46, &v100, &v99);
    if (v68)
    {
      uint64_t v69 = v68;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"CAPS_IND parser error %!", v70, v71, v72, v73, v74, v75, v76, v69);
        uint64_t v77 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v77, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      uint64_t v28 = (uint64_t)a1;
      char v29 = v69;
      goto LABEL_59;
    }
    if (dword_100A1525C)
    {
      unsigned __int16 v78 = 0;
      while (1)
      {
        unsigned int v79 = v78;
        if ((unsigned __int16 *)qword_100A15298[134 * v78] == a1) {
          break;
        }
        ++v78;
        if (dword_100A1525C <= (unsigned __int16)(v79 + 1)) {
          goto LABEL_74;
        }
      }
      uint64_t v80 = &qword_100A15298[134 * v78];
      uint64_t v83 = (void *)v80[8];
      uint64_t v82 = v80 + 8;
      uint64_t v81 = v83;
      if (v83) {
        sub_100023010(v81);
      }
      *uint64_t v82 = v100;
      int v84 = v99;
      uint64_t v85 = &qword_100A15298[134 * v79];
      *((_DWORD *)v85 + 14) = v59;
      uint64_t v86 = v85 + 7;
      v86[4] = v84;
      if (sub_1001F7D74() == 15 && *v86 <= 1u)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Invoking TS WAR", v87, v88, v89, v90, v91, v92, v93, v98);
          uint64_t v94 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v94, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        sub_1001FBA68((uint64_t)a1, (uint64_t)sub_100177248);
      }
    }
LABEL_74:
    sub_1000E5010((uint64_t)a1);
    sub_1000E51B0((uint64_t)a1);
    uint64_t v95 = dword_100A1525C;
    if (dword_100A1525C)
    {
      int v96 = &word_100A152A0;
      while (*((unsigned __int16 **)v96 - 1) != a1)
      {
        v96 += 536;
        if (!--v95) {
          goto LABEL_78;
        }
      }
      int v97 = (unsigned __int16)*v96;
    }
    else
    {
LABEL_78:
      int v97 = 0xFFFF;
    }
    sub_100170D50(v97, 6u);
    if (xmmword_100A15270) {
      xmmword_100A15270(a1, v58, *((unsigned __int8 *)a1 + 26), *((_DWORD *)a1 + 37) == 2);
    }
    long long v102 = 0u;
    long long v103 = 0u;
    LOBYTE(v102) = 1;
    WORD1(v102) = 4;
    DWORD2(v102) = 3;
    LOBYTE(v103) = 1;
    WORD1(v103) = 4;
    DWORD2(v103) = v59;
    memcpy(buf, "state", sizeof(buf));
    sub_10010CA6C("Magnet Operation", (const char *)buf, &v102, 2);
  }
}

void sub_100174A64(uint64_t a1, unsigned __int8 *a2)
{
  uint64_t v2 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_13;
  }
  int v5 = &word_100A152A0;
  while (*((void *)v5 - 1) != a1)
  {
    v5 += 536;
    if (!--v2) {
      goto LABEL_13;
    }
  }
  if (*v5 == -1)
  {
LABEL_13:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Not tracking this device.", v7, v8, v9, v10, v11, v12, v13, *(uint64_t *)v30);
      uint64_t v14 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else if (sub_1000E7430(a1))
  {
    if (dword_100A1525C)
    {
      unsigned __int8 v6 = 0;
      while (qword_100A15298[134 * v6] != a1)
      {
        if (dword_100A1525C <= ++v6) {
          return;
        }
      }
      unsigned int v23 = qword_100A15298[134 * v6 + 9];
      if (v23)
      {
        unsigned __int8 v24 = 0;
        uint64_t v25 = qword_100A15298[134 * v6 + 8];
        while (*(unsigned __int8 *)(v25 + ((unint64_t)v24 << 6)) != *a2)
        {
          if (v23 <= ++v24) {
            return;
          }
        }
        unint64_t v26 = v25 + ((unint64_t)v24 << 6);
        *(unsigned char *)(v26 + 2) = a2[1] != 0;
        int v27 = a2[2];
        *(_DWORD *)(v26 + 4) = v27;
        int v28 = v27 | (a2[3] << 8);
        *(_DWORD *)(v26 + 4) = v28;
        int v29 = v28 | (a2[4] << 16);
        *(_DWORD *)(v26 + 4) = v29;
        *(_DWORD *)(v26 + 4) = v29 | (a2[5] << 24);
        *(_WORD *)(v26 + 8) = a2[6];
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"CAPS_CHANGED_IND not supposed to get a caps info response from the central.", v15, v16, v17, v18, v19, v20, v21, *(uint64_t *)v30);
    uint64_t v22 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)uint64_t v30 = 136446210;
      *(void *)&v30[4] = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", v30, 0xCu);
    }
  }
}

void sub_100174C8C(unsigned __int16 *a1, unsigned __int8 *a2, int a3)
{
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_12;
  }
  uint64_t v7 = &word_100A152A0;
  while (*((unsigned __int16 **)v7 - 1) != a1)
  {
    v7 += 536;
    if (!--v3) {
      goto LABEL_12;
    }
  }
  if (*v7 == -1)
  {
LABEL_12:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE not tracking this device.", v16, v17, v18, v19, v20, v21, v22, v74);
      unsigned int v23 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (sub_1000E7430((uint64_t)a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE not supposed to get a upgrade from the peripheral.", v8, v9, v10, v11, v12, v13, v14, v74);
      uint64_t v15 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    sub_100176F7C((uint64_t)a1, 17, 2);
    return;
  }
  if (!a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE wrong size for upgrade req.", v34, v35, v36, v37, v38, v39, v40, v74);
      uint64_t v41 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v42 = a1;
    int v43 = 3;
    int v44 = 0;
    goto LABEL_56;
  }
  int v26 = *a2;
  unsigned __int8 v24 = a2 + 1;
  int v25 = v26;
  unsigned __int8 v27 = a3 - 1;
  if ((_BYTE)a3 == 1) {
    uint64_t v28 = 0;
  }
  else {
    uint64_t v28 = (uint64_t)v24;
  }
  uint64_t v29 = dword_100A1525C;
  if (!dword_100A1525C)
  {
    LODWORD(v30) = 0;
    int v32 = 0;
LABEL_29:
    unsigned __int8 v33 = 4;
    goto LABEL_45;
  }
  uint64_t v30 = 0;
  uint64_t v31 = qword_100A15298;
  do
  {
    if ((unsigned __int16 *)*v31 == a1)
    {
      uint64_t v45 = &dword_100A152C8;
      while (*((unsigned __int16 *)v45 - 20) != *((unsigned __int16 *)v31 + 4))
      {
        v45 += 268;
        if (!--v29) {
          goto LABEL_40;
        }
      }
      if (*v45 == 6)
      {
        uint64_t v46 = *((unsigned int *)v31 + 18);
        if (v46)
        {
          uint64_t v47 = (unsigned __int8 *)(v31[8] + 1);
          while (*(v47 - 1) != v25)
          {
            v47 += 64;
            if (!--v46) {
              goto LABEL_39;
            }
          }
          int v32 = *v47;
        }
        else
        {
LABEL_39:
          int v32 = 0;
        }
        if (sub_1000E4F10(v30, 1u))
        {
          sub_100170D50(*((unsigned __int16 *)v31 + 4), 8u);
          *((unsigned char *)v31 + 77) = v32;
          goto LABEL_29;
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"RSSI is not sufficient for upgrade rssi=%d", v66, v67, v68, v69, v70, v71, v72, *((unsigned int *)v31 + 47));
          uint64_t v73 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v73, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        unsigned __int8 v33 = 8;
      }
      else
      {
LABEL_40:
        if (sub_100058654())
        {
          uint64_t v48 = sub_10016E6F8(*((_DWORD *)v31 + 12));
          sub_100056E24((uint64_t)"UPGRADE upgrade should only be received when in IDLE state. Current state is %s", v49, v50, v51, v52, v53, v54, v55, (uint64_t)v48);
          uint64_t v56 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        unsigned __int8 v33 = 5;
      }
      int v32 = 1;
      goto LABEL_45;
    }
    ++v30;
    v31 += 134;
  }
  while (dword_100A1525C != v30);
  int v32 = 0;
  unsigned __int8 v33 = 4;
  LODWORD(v30) = dword_100A1525C;
LABEL_45:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Received UPGRADE for lmhandle 0x%4x to transport ID %d (tech %s)", v57, v58, v59, v60, v61, v62, v63, *a1);
    uint64_t v64 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v64, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      *(void *)&uint8_t buf[4] = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v64, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  long long v76 = 0u;
  long long v77 = 0u;
  LOBYTE(v76) = 1;
  WORD1(v76) = 4;
  DWORD2(v76) = 4;
  LOBYTE(v77) = 1;
  WORD1(v77) = 4;
  DWORD2(v77) = v32;
  memcpy(buf, "state", sizeof(buf));
  sub_10010CA6C("Magnet Operation", (const char *)buf, &v76, 2);
  if (v32 == 1
    || (v32 != 2 ? (v65 = sub_10017750C(v32, a1, v28, v27, 0)) : (v65 = sub_10017285C((uint64_t)a1)), (unsigned __int8 v33 = v65) != 0))
  {
    BYTE5(qword_100A15298[134 * v30 + 9]) = 0;
  }
  else
  {
    sub_10010BC48((uint64_t)&qword_100A15298[134 * v30 + 19]);
    unsigned __int8 v33 = 0;
  }
  int v43 = v33;
  uint64_t v42 = a1;
  int v44 = v32;
LABEL_56:
  sub_1001772BC(v42, v43, v44);
}

void sub_1001751A8(unsigned __int16 *a1, unsigned __int8 *a2, int a3)
{
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_14;
  }
  uint64_t v7 = &word_100A152A0;
  while (*((unsigned __int16 **)v7 - 1) != a1)
  {
    v7 += 536;
    if (!--v3) {
      goto LABEL_14;
    }
  }
  if (*v7 == -1)
  {
LABEL_14:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_REQ not tracking this device.", v11, v12, v13, v14, v15, v16, v17, v101);
      uint64_t v18 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (!sub_1000E7430((uint64_t)a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_REQ not supposed to get a upgrade req from the central.", v19, v20, v21, v22, v23, v24, v25, v101);
      int v26 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v106 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v26, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v27 = (uint64_t)a1;
    char v28 = 2;
    goto LABEL_52;
  }
  if (!a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_REQ wrong size for upgrade req.", v29, v30, v31, v32, v33, v34, v35, v101);
      uint64_t v36 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v27 = (uint64_t)a1;
    char v28 = 3;
    goto LABEL_52;
  }
  if (!dword_100A1525C)
  {
    LODWORD(v8) = 0;
LABEL_30:
    int v10 = 0;
    goto LABEL_31;
  }
  uint64_t v8 = 0;
  uint64_t v9 = &dword_100A152E0;
  while (*((unsigned __int16 **)v9 - 9) != a1)
  {
    ++v8;
    v9 += 268;
    if (dword_100A1525C == v8)
    {
      int v10 = 0;
      LODWORD(v8) = dword_100A1525C;
      goto LABEL_31;
    }
  }
  uint64_t v37 = *v9;
  if (!v37) {
    goto LABEL_30;
  }
  uint64_t v38 = (unsigned __int8 *)(*((void *)v9 - 1) + 1);
  while (*(v38 - 1) != *a2)
  {
    v38 += 64;
    if (!--v37) {
      goto LABEL_30;
    }
  }
  int v10 = *v38;
LABEL_31:
  if (!sub_100058654()) {
    goto LABEL_47;
  }
  if (v10 <= 2)
  {
    if (v10 == 1)
    {
      uint64_t v46 = "LE";
      goto LABEL_45;
    }
    if (v10 == 2)
    {
      uint64_t v46 = "BT";
      goto LABEL_45;
    }
  }
  else
  {
    switch(v10)
    {
      case 3:
        uint64_t v46 = "WL";
        goto LABEL_45;
      case 16:
        uint64_t v46 = "USB";
        goto LABEL_45;
      case 17:
        uint64_t v46 = "AWDL";
        goto LABEL_45;
    }
  }
  uint64_t v46 = "??";
LABEL_45:
  sub_100056E24((uint64_t)"Received UPGRADE_REQ to tech %s (2) from lmhandle 0x%4x", v39, v40, v41, v42, v43, v44, v45, (uint64_t)v46);
  uint64_t v47 = sub_100050B4C(0x56u);
  if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)int buf = 136446210;
    uint64_t v106 = sub_100050714();
    _os_log_impl((void *)&_mh_execute_header, v47, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
  }
LABEL_47:
  if (!v10)
  {
    uint64_t v27 = (uint64_t)a1;
    char v28 = 4;
LABEL_52:
    sub_100176F7C(v27, 16, v28);
    return;
  }
  uint64_t v48 = &qword_100A15298[134 * v8];
  *((_DWORD *)v48 + 21) = v10;
  if (v10 == *((unsigned __int8 *)v48 + 76))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_REQ lmhandle 0x%4x already using tech %s", v49, v50, v51, v52, v53, v54, v55, *a1);
      uint64_t v73 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v73, OS_LOG_TYPE_DEFAULT))
      {
LABEL_76:
        uint64_t v91 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v106 = v91;
        goto LABEL_77;
      }
    }
  }
  else
  {
    uint64_t v56 = dword_100A1525C;
    if (!dword_100A1525C) {
      goto LABEL_68;
    }
    uint64_t v57 = &dword_100A152C8;
    while (*((unsigned __int16 *)v57 - 20) != LOWORD(qword_100A15298[134 * v8 + 1]))
    {
      v57 += 268;
      if (!--v56) {
        goto LABEL_68;
      }
    }
    if (*v57 == 6)
    {
      uint64_t v58 = &qword_100A15298[134 * v8];
      int v60 = *((_DWORD *)v58 + 40);
      uint64_t v59 = v58 + 20;
      if (v60 == v59[8]
        || (uint64_t v61 = &qword_100A15298[134 * v8],
            int v63 = *((unsigned __int16 *)v61 + 98),
            uint64_t v62 = (__int16 *)v61 + 98,
            uint64_t v64 = v62 - 16,
            (unsigned __int16)*(v62 - 16) == v63))
      {
        BOOL v65 = 0;
      }
      else
      {
        uint64_t v104 = 0;
        sub_10010BC48((uint64_t)&v104);
        unsigned int v92 = (1000 * (v104 - *v59) - *v64 + SWORD2(v104)) >> 2;
        BOOL v65 = v92 < 0x465;
        if (v92 >= 0x465)
        {
          uint64_t log = (1000 * (v104 - *v59) - *v64 + SWORD2(v104));
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"TS connection timeout detected %d mseconds ago, allow remote transport switch request", v93, v94, v95, v96, v97, v98, v99, log);
            loga = sub_100050B4C(0x56u);
            if (os_log_type_enabled(loga, OS_LOG_TYPE_DEFAULT))
            {
              uint64_t v100 = sub_100050714();
              *(_DWORD *)int buf = 136446210;
              uint64_t v106 = v100;
              _os_log_impl((void *)&_mh_execute_header, loga, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
          _DWORD *v59 = v59[8];
          *uint64_t v64 = *v62;
        }
      }
      if (v10 == 2 && (v65 | !sub_1000E4F10(v8, 1u)) == 1)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received UPGRADE_REQ to tech BT but RSSI was not sufficient or uncertainty was %d, ignoring", v66, v67, v68, v69, v70, v71, v72, v65);
          uint64_t v73 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v73, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v74 = sub_100050714();
            *(_DWORD *)int buf = 136446210;
            uint64_t v106 = v74;
LABEL_77:
            _os_log_impl((void *)&_mh_execute_header, v73, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
      }
      else
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received UPGRADE_REQ to tech BT. RSSI:  %d: %d", v82, v83, v84, v85, v86, v87, v88, HIDWORD(qword_100A15298[134 * v8 + 23]));
          uint64_t v89 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v89, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v90 = sub_100050714();
            *(_DWORD *)int buf = 136446210;
            uint64_t v106 = v90;
            _os_log_impl((void *)&_mh_execute_header, v89, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        sub_10016D074(a1, v10, 32);
      }
    }
    else
    {
LABEL_68:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"UPGRADE_REQ got a request when already switching (state %d) !", v75, v76, v77, v78, v79, v80, v81, LODWORD(qword_100A15298[134 * v8 + 6]));
        uint64_t v73 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v73, OS_LOG_TYPE_DEFAULT)) {
          goto LABEL_76;
        }
      }
    }
  }
}

void sub_1001758DC(unsigned __int16 *a1, unsigned __int8 *a2, int a3)
{
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_10;
  }
  uint64_t v7 = &word_100A152A0;
  while (*((unsigned __int16 **)v7 - 1) != a1)
  {
    v7 += 536;
    if (!--v3) {
      goto LABEL_10;
    }
  }
  if (*v7 == -1)
  {
LABEL_10:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_CFM not tracking this device.", v9, v10, v11, v12, v13, v14, v15, v38);
      uint64_t v16 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (sub_1000E7430((uint64_t)a1))
    {
      if (a3) {
        int v8 = *a2;
      }
      else {
        int v8 = 0;
      }
      unsigned __int8 v25 = a3 - 1;
      if ((_BYTE)a3 == 1) {
        uint64_t v26 = 0;
      }
      else {
        uint64_t v26 = (uint64_t)(a2 + 1);
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Received UPGRADE_CFM from lmhandle 0x%4x with %s", v27, v28, v29, v30, v31, v32, v33, *a1);
        uint64_t v34 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v40 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v34, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      if (dword_100A1525C)
      {
        uint64_t v35 = 0;
        uint64_t v36 = qword_100A15298;
        while ((unsigned __int16 *)*v36 != a1)
        {
          ++v35;
          v36 += 134;
          if (dword_100A1525C == v35)
          {
            int v37 = 0;
            LODWORD(v35) = dword_100A1525C;
            goto LABEL_30;
          }
        }
        sub_100173AD0(*((unsigned __int16 *)v36 + 4));
        if (v8)
        {
          *((unsigned char *)v36 + 77) = 1;
          sub_100170D50(*((unsigned __int16 *)v36 + 4), 6u);
          sub_100171078(a1);
          return;
        }
        sub_100170D50(*((unsigned __int16 *)v36 + 4), 8u);
        int v37 = *((unsigned __int8 *)v36 + 77);
        if (v37 == 2)
        {
          if (!sub_10017285C((uint64_t)a1)) {
            goto LABEL_36;
          }
          goto LABEL_31;
        }
      }
      else
      {
        LODWORD(v35) = 0;
        int v37 = 0;
      }
LABEL_30:
      if (!sub_10017750C(v37, a1, v26, v25, 1))
      {
LABEL_36:
        sub_10010BC48((uint64_t)&qword_100A15298[134 * v35 + 19]);
        return;
      }
LABEL_31:
      sub_100172AD0(a1, 1);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_CFM not supposed to get a upgrade CFM from the central.", v17, v18, v19, v20, v21, v22, v23, v38);
      uint64_t v24 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v40 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }
}

void sub_100175BCC(unsigned __int16 *a1, unsigned __int8 *a2, int a3)
{
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_9;
  }
  int v5 = &word_100A152A0;
  while (*((unsigned __int16 **)v5 - 1) != a1)
  {
    v5 += 536;
    if (!--v3) {
      goto LABEL_9;
    }
  }
  if (*v5 == -1)
  {
LABEL_9:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_COMPLETE not tracking this device.", v7, v8, v9, v10, v11, v12, v13, v34);
      uint64_t v14 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (a3) {
      int v6 = *a2;
    }
    else {
      int v6 = 0;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received UPGRADE_COMPLETE from lmhandle 0x%4x with %s", v15, v16, v17, v18, v19, v20, v21, *a1);
      uint64_t v22 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v36 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v23 = dword_100A1525C;
    if (dword_100A1525C)
    {
      for (unint64_t i = qword_100A15298; (unsigned __int16 *)*i != a1; i += 134)
      {
        if (!--v23) {
          return;
        }
      }
      sub_100173AD0(*((unsigned __int16 *)i + 4));
      sub_100170D50(*((unsigned __int16 *)i + 4), 0xAu);
      if (v6)
      {
        *((unsigned char *)i + 77) = 1;
        sub_10016F3B8((uint64_t)i);
LABEL_25:
        sub_100172C50(a1, v6);
        return;
      }
      if (sub_10016F3B8((uint64_t)i)) {
        goto LABEL_25;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Received UPGRADE_COMPLETE but the transport isn't up yet. Waiting until transport is up.", v25, v26, v27, v28, v29, v30, v31, v34);
        uint64_t v32 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v32, OS_LOG_TYPE_DEFAULT))
        {
          uint64_t v33 = sub_100050714();
          *(_DWORD *)int buf = 136446210;
          uint64_t v36 = v33;
          _os_log_impl((void *)&_mh_execute_header, v32, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }
  }
}

void sub_100175E2C(unsigned __int16 *a1, unsigned char *a2, int a3)
{
  uint64_t v3 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_11;
  }
  int v5 = &word_100A152A0;
  while (*((unsigned __int16 **)v5 - 1) != a1)
  {
    v5 += 536;
    if (!--v3) {
      goto LABEL_11;
    }
  }
  if (*v5 == -1)
  {
LABEL_11:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"UPGRADE_COMPLETE_CFM not tracking this device.", v14, v15, v16, v17, v18, v19, v20, v56);
      uint64_t v21 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (a3 && (int v6 = *a2, *a2))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Received UPGRADE_COMPLETE_CFM from lmhandle 0x%4x with %s", v7, v8, v9, v10, v11, v12, v13, *a1);
        uint64_t v31 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      int v30 = 0;
    }
    else
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Received UPGRADE_COMPLETE_CFM from lmhandle 0x%4x with %s", v22, v23, v24, v25, v26, v27, v28, *a1);
        uint64_t v29 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          *(void *)&uint8_t buf[4] = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      int v6 = 0;
      int v30 = 1;
    }
    if (dword_100A1525C)
    {
      uint64_t v32 = 0;
      unsigned int v33 = 0;
      while ((unsigned __int16 *)qword_100A15298[v32] != a1)
      {
        ++v33;
        v32 += 134;
        if (134 * dword_100A1525C == v32) {
          return;
        }
      }
      uint64_t v34 = &qword_100A15298[v32];
      sub_100173AD0(LOWORD(qword_100A15298[v32 + 1]));
      sub_100170D50(LOWORD(qword_100A15298[v32 + 1]), 6u);
      sub_100171078(a1);
      sub_1001713B0(v33, BYTE5(qword_100A15298[v32 + 9]));
      *((unsigned char *)v34 + 77) = 1;
      ++*((_DWORD *)v34 + 50);
      ++*((_WORD *)v34 + 526);
      sub_100026C30((uint64_t)&qword_100A15298[v32 + 16]);
      uint64_t v35 = sub_10016F3B8((uint64_t)&qword_100A15298[v32]);
      if (v6 == 4)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Disconnecting upgraded connection due to remote transport error", v36, v37, v38, v39, v40, v41, v42, v56);
          uint64_t v43 = sub_100050B4C(0x56u);
          if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
        sub_10017BD74(v35, 0x13u);
        goto LABEL_53;
      }
      sub_1000EAB1C((uint64_t)a1, 1);
      if (v35)
      {
        sub_100171078((unsigned __int16 *)v35);
        if (*(unsigned char *)(v35 + 2)) {
          uint64_t v44 = 17;
        }
        else {
          uint64_t v44 = 2;
        }
        if ((void)xmmword_100A15260) {
          int v45 = v30;
        }
        else {
          int v45 = 0;
        }
        if (v45 != 1) {
          goto LABEL_53;
        }
        if (sub_100197698(v35))
        {
          ((void (*)(unsigned __int16 *, uint64_t, uint64_t, void))xmmword_100A15260)(a1, v44, v35 + 48, *(unsigned __int8 *)(v35 + 278));
LABEL_53:
          long long v58 = 0u;
          long long v59 = 0u;
          LOBYTE(v58) = 1;
          WORD1(v58) = 4;
          DWORD2(v58) = 5;
          LOBYTE(v59) = 1;
          WORD1(v59) = 4;
          DWORD2(v59) = v6;
          memcpy(buf, "state", sizeof(buf));
          sub_10010CA6C("Magnet Operation", (const char *)buf, &v58, 2);
          return;
        }
      }
      else
      {
        if ((void)xmmword_100A15260) {
          char v46 = v30;
        }
        else {
          char v46 = 0;
        }
        if ((v46 & 1) == 0) {
          goto LABEL_53;
        }
        uint64_t v44 = 1;
      }
      if (sub_100058654())
      {
        uint64_t v54 = "Invalid";
        if (!v35) {
          uint64_t v54 = "Empty";
        }
        sub_100056E24((uint64_t)"%s alternate handle for Peer %d, connectionHandle=%p, pipeID=0x%4x", v47, v48, v49, v50, v51, v52, v53, (uint64_t)v54);
        uint64_t v55 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      ((void (*)(unsigned __int16 *, uint64_t, void, void))xmmword_100A15260)(a1, v44, 0, 0);
      goto LABEL_53;
    }
  }
}

uint64_t sub_10017627C(unsigned __int16 *a1)
{
  if (sub_1000E7430((uint64_t)a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DOWNGRADE not supposed to get a downgrade from the peripheral.", v2, v3, v4, v5, v6, v7, v8, v55);
      uint64_t v9 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    uint64_t v10 = (uint64_t)a1;
    char v11 = 2;
    return sub_100176F7C(v10, 32, v11);
  }
  uint64_t v12 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_23;
  }
  uint64_t v13 = qword_100A15298;
  while ((unsigned __int16 *)*v13 != a1)
  {
    v13 += 134;
    if (!--v12) {
      goto LABEL_23;
    }
  }
  int v14 = *((unsigned __int16 *)v13 + 4);
  if (*((unsigned char *)v13 + 10))
  {
    uint64_t v15 = (unsigned __int16 *)v13[2];
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DOWNGRADE no alternate handle to downgrade from.", v16, v17, v18, v19, v20, v21, v22, v55);
      uint64_t v23 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v15 = 0;
  }
  if (v14 == 0xFFFF)
  {
LABEL_23:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DOWNGRADE invalid handle for downgrade", v26, v27, v28, v29, v30, v31, v32, v55);
      unsigned int v33 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v10 = (uint64_t)a1;
    char v11 = 1;
    return sub_100176F7C(v10, 32, v11);
  }
  uint64_t v24 = dword_100A1525C;
  if (!dword_100A1525C) {
    goto LABEL_35;
  }
  uint64_t v25 = &dword_100A152C8;
  while (*((unsigned __int16 *)v25 - 20) != v14)
  {
    v25 += 268;
    if (!--v24) {
      goto LABEL_35;
    }
  }
  if (*v25 == 6)
  {
    if ((sub_100197698((uint64_t)v15)
       || sub_100197740((uint64_t)v15)
       || sub_100197770((uint64_t)v15)
       || sub_1001977A0((uint64_t)v15))
      && sub_10019E5A8((uint64_t)v15))
    {
      sub_100170974(v15);
      sub_100170D50(v14, 0xBu);
      return sub_10019E2C4(1, (uint64_t)v15, sub_100170EA0);
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received DOWNGRADE from lmhandle 0x%4x", v47, v48, v49, v50, v51, v52, v53, *a1);
      uint64_t v54 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v54, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v54, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    v57[0] = xmmword_1007B9D90;
    v57[1] = unk_1007B9DA0;
    memcpy(buf, "state", sizeof(buf));
    sub_10010CA6C("Magnet Operation", (const char *)buf, v57, 2);
    uint64_t v44 = a1;
    int v45 = 0;
    uint64_t v46 = (uint64_t)v15;
  }
  else
  {
LABEL_35:
    if (sub_100058654())
    {
      uint64_t v35 = sub_10016E6F8(*((_DWORD *)v13 + 12));
      sub_100056E24((uint64_t)"DOWNGRADE can't downgrade state isn't IDLE it's %s", v36, v37, v38, v39, v40, v41, v42, (uint64_t)v35);
      uint64_t v43 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v44 = a1;
    int v45 = 5;
    uint64_t v46 = 0;
  }
  return sub_100171154(v44, v45, v46);
}

void sub_100176610(unsigned __int16 *a1)
{
  if (sub_1000E7430((uint64_t)a1))
  {
    if (!dword_100A1525C) {
      goto LABEL_49;
    }
    uint64_t v2 = 0;
    while ((unsigned __int16 *)qword_100A15298[134 * v2] != a1)
    {
      if (++v2 == dword_100A1525C) {
        goto LABEL_49;
      }
    }
    char v11 = &qword_100A15298[134 * v2];
    uint64_t v12 = *((unsigned __int16 *)v11 + 4);
    uint64_t v13 = *((unsigned __int8 *)v11 + 10);
    int v14 = *((unsigned __int8 *)v11 + 76);
    sub_1001713B0(v2, 1u);
    sub_100173AD0(v12);
    uint64_t v15 = dword_100A1525C;
    if (!dword_100A1525C) {
      goto LABEL_17;
    }
    uint64_t v16 = &dword_100A152C8;
    while (*((unsigned __int16 *)v16 - 20) != v12)
    {
      v16 += 268;
      if (!--v15) {
        goto LABEL_17;
      }
    }
    if (*v16 != 12)
    {
LABEL_17:
      if (sub_100058654())
      {
        uint64_t v17 = sub_10016E6F8(qword_100A15298[134 * v2 + 6]);
        sub_100056E24((uint64_t)"ERROR ! Remote sent us a DOWNGRADE_CFM but we are in %s state, disconnecting.", v18, v19, v20, v21, v22, v23, v24, (uint64_t)v17);
        uint64_t v25 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_100223D18((uint64_t)a1);
    }
    sub_100170D50(v12, 6u);
    if (v13)
    {
      int v72 = v14;
      for (uint64_t i = 0; i != v13; ++i)
      {
        uint64_t v27 = &qword_100A15298[134 * v2 + 2 * i];
        uint64_t v29 = v27[2];
        uint64_t v28 = v27 + 2;
        sub_10016F46C(v29, (uint64_t)a1);
        BOOL v30 = sub_100197698(*v28);
        uint64_t v31 = *v28;
        if (v30)
        {
          if (*(_DWORD *)(v31 + 148)) {
            sub_100170424(v31, 19);
          }
        }
        else
        {
          if (*(unsigned char *)(v31 + 2) != 8) {
            sub_10025B8C0();
          }
          uint64_t v32 = byte_100A15258;
          if (byte_100A15258)
          {
            unsigned int v33 = (unsigned __int8 *)qword_100A15250;
            while (*(_DWORD *)(*v28 + 56) != *v33)
            {
              v33 += 64;
              if (!--v32) {
                goto LABEL_35;
              }
            }
            uint64_t v34 = (void (*)(void))*((void *)v33 + 6);
            if (v34) {
              v34(*(unsigned __int16 *)*v28);
            }
          }
        }
LABEL_35:
        ;
      }
      sub_1000EAB1C((uint64_t)a1, 0);
      sub_100171078(a1);
      int v14 = v72;
    }
    else
    {
      sub_1000EAB1C((uint64_t)a1, 0);
      sub_100171078(a1);
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"DOWNGRADE_CFM no alternate handle to downgrade from.", v35, v36, v37, v38, v39, v40, v41, v71);
        uint64_t v42 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    sub_1001715C4((unsigned __int16)v2, v14, 0);
    uint64_t v43 = &qword_100A15298[134 * v2];
    int v45 = *((unsigned __int8 *)v43 + 77);
    uint64_t v44 = (unsigned __int8 *)v43 + 77;
    if (v45 != 1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"DOWNGRADE_CFM upgrading transport since this downgrade was triggered by a upgrade to different alternate transport", v46, v47, v48, v49, v50, v51, v52, v71);
        uint64_t v53 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v74 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v53, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      sub_10016D074(a1, *v44, qword_100A15298[134 * v2 + 14]);
    }
    if (v12 == 0xFFFF)
    {
LABEL_49:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid handle for downgrade", v63, v64, v65, v66, v67, v68, v69, v71);
        uint64_t v70 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v70, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Got a downgrade confirmation from lmhandle 0x%4x", v54, v55, v56, v57, v58, v59, v60, *a1);
      uint64_t v61 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v61, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v62 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v74 = v62;
        _os_log_impl((void *)&_mh_execute_header, v61, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DOWNGRADE_CFM not supposed to get a downgrade CFM from the central.", v3, v4, v5, v6, v7, v8, v9, v71);
      uint64_t v10 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v74 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    sub_100176F7C((uint64_t)a1, 33, 2);
  }
}

void sub_100176A98(unsigned __int16 *a1)
{
  if (sub_1000E7430((uint64_t)a1))
  {
    uint64_t v2 = dword_100A1525C;
    if (dword_100A1525C)
    {
      uint64_t v3 = 0;
      uint64_t v4 = qword_100A15298;
      while ((unsigned __int16 *)*v4 != a1)
      {
        ++v3;
        v4 += 134;
        if (dword_100A1525C == v3)
        {
          BOOL v5 = 0;
          uint64_t v3 = dword_100A1525C;
          goto LABEL_22;
        }
      }
      *((_DWORD *)v4 + 21) = 1;
      int v14 = &dword_100A152C8;
      while (*((unsigned __int16 *)v14 - 20) != *((unsigned __int16 *)v4 + 4))
      {
        v14 += 268;
        if (!--v2) {
          goto LABEL_18;
        }
      }
      if (*v14 == 6)
      {
        BOOL v5 = *((_DWORD *)v4 + 29) == 0;
        goto LABEL_22;
      }
LABEL_18:
      if (sub_100058654())
      {
        uint64_t v15 = sub_10016E6F8(*((_DWORD *)v4 + 12));
        sub_100056E24((uint64_t)"DOWNGRADE_REQ not downgrading, state is %s", v16, v17, v18, v19, v20, v21, v22, (uint64_t)v15);
        uint64_t v23 = sub_100050B4C(0x56u);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v35 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      BOOL v5 = 0;
    }
    else
    {
      uint64_t v3 = 0;
      BOOL v5 = 0;
    }
LABEL_22:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received DOWNGRADE_REQ from peer %d, %s", v24, v25, v26, v27, v28, v29, v30, v3);
      uint64_t v31 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v32 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v35 = v32;
        _os_log_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    if (v5)
    {
      sub_10016DC1C(a1, 32);
    }
    else if (v3 == dword_100A1525C)
    {
      sub_10025B8C0();
    }
    else
    {
      sub_1000E4EA0(3, 0, (unsigned __int16)v3);
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"DOWNGRADE_REQ not supposed to get a downgrade request from the central.", v6, v7, v8, v9, v10, v11, v12, v33);
      uint64_t v13 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v35 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    sub_100176F7C((uint64_t)a1, 34, 2);
  }
}

void sub_100176D54(unsigned int a1)
{
  if (sub_100058654())
  {
    if (a1 > 8) {
      uint64_t v9 = "ERROR_Unknown";
    }
    else {
      uint64_t v9 = off_10099D580[(char)a1];
    }
    sub_100056E24((uint64_t)"Remote side sent fatal %s", v2, v3, v4, v5, v6, v7, v8, (uint64_t)v9);
    uint64_t v10 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      *(_DWORD *)int buf = 136446466;
      uint64_t v12 = sub_100050714();
      __int16 v13 = 1024;
      int v14 = 0xFFFF;
      _os_log_error_impl((void *)&_mh_execute_header, v10, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
    }
  }
  sub_10010B844(a1 + 5050, "TS Remote Error");
}

const char *sub_100176E24(int a1)
{
  if (a1 > 31)
  {
    if (a1 <= 33)
    {
      if (a1 == 32) {
        return "DOWNGRADE";
      }
      else {
        return "DOWNGRADE_CFM";
      }
    }
    else
    {
      switch(a1)
      {
        case 34:
          return "DOWNGRADE_REQ";
        case 254:
          return "FATAL_ERROR";
        case 255:
          return "ERROR";
        default:
          return "Unknown";
      }
    }
  }
  else
  {
    int v1 = a1 - 1;
    uint64_t result = "VERSION_IND";
    switch(v1)
    {
      case 0:
        return result;
      case 1:
        uint64_t result = "CAPS_IND";
        break;
      case 4:
        uint64_t result = "CAPS_CHANGED_IND";
        break;
      case 15:
        uint64_t result = "UPGRADE_REQ";
        break;
      case 16:
        uint64_t result = "UPGRADE";
        break;
      case 17:
        uint64_t result = "UPGRADE_CFM";
        break;
      case 18:
        uint64_t result = "UPGRADE_COMPLETE";
        break;
      case 19:
        uint64_t result = "COMPLETE_CFM";
        break;
      default:
        return "Unknown";
    }
  }
  return result;
}

uint64_t sub_100176F7C(uint64_t a1, char a2, char a3)
{
  __int16 v7 = 767;
  char v8 = a2;
  char v9 = a3;
  uint64_t v3 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v4 = &word_100A152A0;
    while (*((void *)v4 - 1) != a1)
    {
      v4 += 536;
      if (!--v3) {
        goto LABEL_5;
      }
    }
    uint64_t v5 = (unsigned __int16)*v4;
  }
  else
  {
LABEL_5:
    uint64_t v5 = 0xFFFFLL;
  }
  return sub_1000E8FC8(0, a1, v5, (char *)&v7, 4uLL, 0);
}

uint64_t sub_100176FFC(unsigned char *a1, uint64_t a2, void *a3, _DWORD *a4)
{
  *a4 = 0;
  *a3 = 0;
  uint64_t v4 = *a1;
  if (!*a1) {
    return 3;
  }
  if (13 * (int)v4 > a2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid size, got %d, expected %d", v6, v7, v8, v9, v10, v11, v12, a2);
      __int16 v13 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 3;
  }
  uint64_t v18 = (char *)sub_100022FE8((unint64_t)*a1 << 6);
  uint64_t result = 1;
  if (v18)
  {
    uint64_t v19 = 0;
    uint64_t v20 = qword_100A15250 + 16;
    uint64_t v21 = 1;
    while (1)
    {
      int v22 = a1[v21];
      if ((int)v21 + v22 > a2) {
        break;
      }
      uint64_t v23 = &v18[64 * v19];
      *uint64_t v23 = a1[(v21 + 1)];
      int v24 = a1[(v21 + 2)];
      v23[1] = v24;
      v23[2] = a1[(v21 + 3)] != 0;
      v23[12] = a1[(v21 + 4)] != 0;
      int v25 = a1[(v21 + 5)];
      *((_DWORD *)v23 + 1) = v25;
      int v26 = v25 | (a1[(v21 + 6)] << 8);
      *((_DWORD *)v23 + 1) = v26;
      int v27 = v26 | (a1[(v21 + 7)] << 16);
      *((_DWORD *)v23 + 1) = v27;
      *((_DWORD *)v23 + 1) = v27 | (a1[(v21 + 8)] << 24);
      LOWORD(v27) = a1[(v21 + 9)];
      *((_WORD *)v23 + 4) = v27;
      *((_WORD *)v23 + 4) = v27 | (a1[(v21 + 10)] << 8);
      LOWORD(v27) = a1[(v21 + 11)];
      *((_WORD *)v23 + 5) = v27;
      *((_WORD *)v23 + 5) = v27 | (a1[(v21 + 12)] << 8);
      uint64_t v28 = byte_100A15258;
      uint64_t v29 = (void *)v20;
      if (byte_100A15258)
      {
        while (*((unsigned __int8 *)v29 - 15) != v24)
        {
          v29 += 8;
          if (!--v28) {
            goto LABEL_15;
          }
        }
        uint64_t v30 = &v18[64 * v19];
        v30[13] = 1;
        *((void *)v30 + 2) = *v29;
      }
LABEL_15:
      uint64_t v21 = (v21 + 1 + v22);
      if (++v19 == v4) {
        goto LABEL_20;
      }
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"pos(%d) + transportSize(%d) > dataSize(%d)", v31, v32, v33, v34, v35, v36, v37, v21);
      uint64_t v38 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
LABEL_20:
    uint64_t result = 0;
    *a3 = v18;
    *a4 = v4;
  }
  return result;
}

void sub_100177248(uint64_t a1)
{
  if (a1 && sub_100058654())
  {
    sub_100056E24((uint64_t)"_writeLeRemotePublicAddressCB:  %d", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_1001772BC(unsigned __int16 *a1, int a2, int a3)
{
  char v3 = a2;
  uint64_t v5 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v6 = &word_100A152A0;
    while (*((unsigned __int16 **)v6 - 1) != a1)
    {
      v6 += 536;
      if (!--v5) {
        goto LABEL_5;
      }
    }
    uint64_t v7 = (unsigned __int16)*v6;
  }
  else
  {
LABEL_5:
    uint64_t v7 = 0xFFFFLL;
  }
  __len[0] = 0;
  if (a2)
  {
    sub_100170D50(v7, 6u);
LABEL_9:
    uint64_t v8 = 0;
    size_t v9 = 3;
    goto LABEL_10;
  }
  uint64_t v12 = byte_100A15258;
  if (!byte_100A15258) {
    goto LABEL_9;
  }
  uint64_t v13 = qword_100A15250;
  size_t v9 = 3;
  while (*(unsigned __int8 *)(v13 + 1) != a3)
  {
    v13 += 64;
    if (!--v12)
    {
      uint64_t v8 = 0;
      goto LABEL_10;
    }
  }
  if (!*(unsigned char *)(v13 + 12)) {
    goto LABEL_9;
  }
  uint64_t v8 = (char *)(*(uint64_t (**)(_WORD *))(v13 + 56))(__len);
  size_t v9 = __len[0] + 3;
LABEL_10:
  uint64_t v10 = (char *)sub_100022FE8(v9);
  if (v10)
  {
    uint64_t v11 = v10;
    *uint64_t v10 = 18;
    v10[1] = LOBYTE(__len[0]) + 1;
    v10[2] = v3;
    if (v8 && __len[0])
    {
      memmove(v10 + 3, v8, __len[0]);
    }
    else if (!v8)
    {
      goto LABEL_23;
    }
    sub_100023010(v8);
LABEL_23:
    uint64_t v14 = *a1;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Sending UPGRADE_CFM to lmhandle 0x%4x p:0x%4x with %s", v15, v16, v17, v18, v19, v20, v21, v14);
      int v22 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v23 = sub_100050714();
        *(_DWORD *)&__len[1] = 136446210;
        *(void *)&__len[3] = v23;
        _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", (uint8_t *)&__len[1], 0xCu);
      }
    }
    int v24 = sub_1000E8FC8(0, (uint64_t)a1, v7, v11, (unsigned __int16)(__len[0] + 3), 0);
    if (v24 == 412 || !v24) {
      sub_100170F7C(v7, 0x61A8u);
    }
    uint64_t v8 = v11;
    goto LABEL_30;
  }
  if (v8) {
LABEL_30:
  }
    sub_100023010(v8);
}

uint64_t sub_10017750C(int a1, unsigned __int16 *a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  sub_100170974(a2);
  uint64_t v10 = byte_100A15258;
  if (byte_100A15258)
  {
    uint64_t v11 = (unsigned __int8 (**)(unsigned __int16 *, uint64_t, uint64_t, uint64_t, void (*)(uint64_t, unsigned int, uint64_t), void (*)(int)))(qword_100A15250 + 40);
    while (*((unsigned __int8 *)v11 - 39) != a1)
    {
      v11 += 8;
      if (!--v10) {
        goto LABEL_8;
      }
    }
    if (*v11 && !(*v11)(a2, a5, a3, a4, sub_1001775E0, sub_100177718)) {
      return 0;
    }
  }
LABEL_8:
  sub_100171078(a2);
  return 4;
}

void sub_1001775E0(uint64_t a1, unsigned int a2, uint64_t a3)
{
  uint64_t v5 = (unsigned __int16 *)a1;
  if (!sub_100197770(a1)) {
    uint64_t v5 = 0;
  }
  if (sub_100197864(a2))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Error : collision between external transport LMHandle and exiting connection : %d already in use", v6, v7, v8, v9, v10, v11, v12, a2);
      uint64_t v13 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (sub_100197864(a2)) {
      sub_10025B8C0();
    }
  }
  else
  {
    if (a3)
    {
      uint64_t v14 = 0;
    }
    else
    {
      uint64_t v15 = sub_10019839C((uint64_t)v5);
      uint64_t v14 = (uint64_t)v15;
      if (v15)
      {
        *(_WORD *)uint64_t v15 = a2;
        v15[60] = 0;
        uint64_t v16 = byte_100A15258;
        if (byte_100A15258)
        {
          uint64_t v17 = (unsigned char *)(qword_100A15250 + 1);
          while (*v17 != 17)
          {
            v17 += 64;
            if (!--v16) {
              goto LABEL_12;
            }
          }
          *((_DWORD *)v15 + 14) = *(v17 - 1);
        }
      }
    }
LABEL_12:
    sub_10016FBE8(v5, v14, a3, 1);
  }
}

void sub_100177718(int a1)
{
  int v1 = sub_100197864(a1);
  if (v1)
  {
    uint64_t v2 = (unsigned __int16 *)v1;
    sub_100170478((uint64_t)v1, 0);
    sub_1001984E0(v2);
  }
  else
  {
    sub_10025B8C0();
  }
}

void sub_100177778(uint64_t a1)
{
  int v1 = **(unsigned __int16 **)(a1 + 8);
  uint64_t v2 = dword_100A1525C;
  if (dword_100A1525C)
  {
    char v3 = (unsigned int *)&dword_100A152C8;
    while (*((unsigned __int16 *)v3 - 20) != v1)
    {
      v3 += 268;
      if (!--v2) {
        goto LABEL_5;
      }
    }
    unsigned int v4 = *v3;
    unsigned int v6 = *v3 + 4993;
    if (v4 - 7 >= 6) {
      uint64_t v5 = 5014;
    }
    else {
      uint64_t v5 = v6;
    }
  }
  else
  {
LABEL_5:
    unsigned int v4 = 0;
    uint64_t v5 = 5014;
  }
  if (sub_100058654())
  {
    uint64_t v7 = sub_10016E6F8(v4);
    sub_100056E24((uint64_t)"Critical timeout elapsed during %s - disconnecting device, due to error %! on pipe ID 0x%2x", v8, v9, v10, v11, v12, v13, v14, (uint64_t)v7);
    uint64_t v15 = sub_100050B4C(0x56u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  uint64_t v16 = dword_100A1525C;
  if (dword_100A1525C)
  {
    uint64_t v17 = &word_100A152A0;
    while ((unsigned __int16)*v17 != v1)
    {
      v17 += 536;
      if (!--v16) {
        goto LABEL_16;
      }
    }
    uint64_t v18 = *((void *)v17 - 1);
  }
  else
  {
LABEL_16:
    uint64_t v18 = 0;
  }
  if (off_100A15288) {
    off_100A15288(v18, 81, 1273, v5);
  }
  if (v18 && sub_100197770(v18))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Disconnecting device %x", v19, v20, v21, v22, v23, v24, v25, v18);
      int v26 = sub_100050B4C(0x56u);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_100223D18(v18);
  }
}

uint64_t sub_100177900(uint64_t (*a1)(void), uint64_t (*a2)(void), void (*a3)(void), void (*a4)(uint64_t, const char *))
{
  off_100A19598 = 0;
  sub_10025C034();
  sub_10025B200();
  if (a3)
  {
    uint64_t v8 = sub_100050B4C(0x5Cu);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      int v26 = 136446210;
      int v27 = "Invoking customization callback\n";
      _os_log_impl((void *)&_mh_execute_header, v8, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v26, 0xCu);
    }
    a3();
  }
  if (sub_10025B470())
  {
    uint64_t v9 = sub_100050B4C(0x5Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      int v26 = 136446210;
      int v27 = "Support code initialization failed\n";
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v26, 0xCu);
    }
  }
  uint64_t v10 = sub_10025B218(0x30u);
  uint64_t v11 = sub_10010CDA0(v10);
  if (v11)
  {
    uint64_t v23 = v11;
    uint64_t v24 = sub_100050B4C(0x5Cu);
    if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
    {
      int v26 = 136446210;
      int v27 = "Memory Manager initialization failed\n";
      _os_log_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v26, 0xCu);
    }
    uint64_t v13 = sub_10010B394(v23);
    goto LABEL_36;
  }
  sub_10025BB04(0, a2);
  if ((sub_100114F7C(0) & 1) == 0)
  {
    uint64_t v12 = sub_100050B4C(0x5Cu);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      int v26 = 136446210;
      int v27 = "Sniffer initialization failed\n";
      _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v26, 0xCu);
    }
  }
  uint64_t v13 = sub_10017B7F4(0);
  if (v13)
  {
LABEL_36:
    uint64_t v15 = v13;
    uint64_t v25 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_45;
    }
    int v26 = 136446210;
    int v27 = "Device Manager initialization failed\n";
    goto LABEL_44;
  }
  uint64_t v14 = sub_10016AA48();
  uint64_t v15 = v14;
  if (!a1 && v14 == 109)
  {
    do
    {
      sub_1000232E0();
      sub_10010BDB0(100);
      sub_100023344();
      uint64_t v16 = sub_10016AAE8();
    }
    while (v16 == 109);
    uint64_t v15 = v16;
  }
  if (v15)
  {
    uint64_t v25 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_45;
    }
    int v26 = 136446210;
    int v27 = "Transport layer initialization failed\n";
    goto LABEL_44;
  }
  uint64_t v17 = sub_10018E60C(0);
  if (v17)
  {
    uint64_t v15 = v17;
    uint64_t v25 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_45;
    }
    int v26 = 136446210;
    int v27 = "OI_HCIAPI_Init_Vars failed\n";
    goto LABEL_44;
  }
  uint64_t v18 = sub_1001F7DC8();
  if (v18)
  {
    uint64_t v15 = v18;
    uint64_t v25 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_45;
    }
    int v26 = 136446210;
    int v27 = "BT VSC init failed\n";
LABEL_44:
    _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v26, 0xCu);
LABEL_45:
    sub_10010B394(v15);
  }
  if (a1)
  {
    off_100A19598 = a1;
    uint64_t v19 = sub_10018E794((uint64_t)sub_100177D78);
    if (!v19) {
      return v19;
    }
  }
  else
  {
    for (uint64_t i = sub_10018E794(0); ; uint64_t i = sub_10018E84C())
    {
      uint64_t v19 = i;
      if (i != 109) {
        break;
      }
      sub_1000232E0();
      sub_10010BDB0(10);
      sub_100023344();
    }
    if (!i)
    {
      sub_100177D78(0);
      return v19;
    }
  }
  uint64_t v21 = sub_100050B4C(0x5Cu);
  if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
  {
    int v26 = 136446210;
    int v27 = "HCI initialization failed\n";
    _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v26, 0xCu);
  }
  if (!a4) {
    sub_10010B844(v19, "HCI initialization failed");
  }
  a4(v19, "HCI initialization failed");
  return v19;
}

void sub_100177D78(NSObject *a1)
{
  if (a1)
  {
    unsigned int v6 = a1;
    uint64_t v5 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_23;
    }
    int v8 = 136446210;
    uint64_t v9 = "HCI initialization failed\n";
LABEL_22:
    _os_log_impl((void *)&_mh_execute_header, v5, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v8, 0xCu);
    goto LABEL_23;
  }
  uint64_t v1 = sub_10025CCEC(0);
  if (v1)
  {
    unsigned int v6 = v1;
    uint64_t v5 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_23;
    }
    int v8 = 136446210;
    uint64_t v9 = "Policy Manager initialization failed\n";
    goto LABEL_22;
  }
  uint64_t v2 = sub_1001E5C1C(0);
  if (v2)
  {
    unsigned int v6 = v2;
    uint64_t v5 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_23;
    }
    int v8 = 136446210;
    uint64_t v9 = "L2CAP initialization failed\n";
    goto LABEL_22;
  }
  uint64_t v3 = sub_1002530BC();
  if (v3)
  {
    unsigned int v6 = v3;
    uint64_t v5 = sub_100050B4C(0x5Cu);
    if (!os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT)) {
      goto LABEL_23;
    }
    int v8 = 136446210;
    uint64_t v9 = "Security Manager initialization failed\n";
    goto LABEL_22;
  }
  uint64_t v4 = sub_10022977C();
  if (v4)
  {
    unsigned int v6 = v4;
    uint64_t v5 = sub_100050B4C(0x5Cu);
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      int v8 = 136446210;
      uint64_t v9 = "LE GAP initialization failed\n";
      goto LABEL_22;
    }
LABEL_23:
    int v7 = sub_10010B394((uint64_t)v6);
LABEL_24:
    if (v7)
    {
      int v8 = 136446210;
      uint64_t v9 = "SDP Server initialization failed\n";
      _os_log_impl((void *)&_mh_execute_header, v6, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v8, 0xCu);
    }
    sub_10010B394((uint64_t)v5);
  }
  uint64_t v5 = sub_100250820(0);
  unsigned int v6 = sub_100050B4C(0x5Cu);
  int v7 = os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT);
  if (v5) {
    goto LABEL_24;
  }
  if (v7)
  {
    int v8 = 136446210;
    uint64_t v9 = "Stack initialization complete\n";
    _os_log_impl((void *)&_mh_execute_header, v6, OS_LOG_TYPE_DEFAULT, "%{public}s", (uint8_t *)&v8, 0xCu);
  }
  if (off_100A19598) {
    off_100A19598(0);
  }
}

uint64_t sub_100178034()
{
  return 0;
}

BOOL sub_100178064(int a1, void *a2)
{
  HIDWORD(v6) = 0x100000;
  if (!a2) {
    sub_10025B8C0();
  }
  LODWORD(v6) = a1;
  return *a2 == v6 && a2[1] == 0xFB349B5F80000080;
}

BOOL sub_1001780EC(uint64_t a1, uint64_t a2)
{
  if (*(unsigned char *)a1 != 3 || *(unsigned char *)a2 != 3) {
    return 0;
  }
  int v2 = *(unsigned __int16 *)(a1 + 2);
  if (v2 == 2)
  {
LABEL_6:
    int v3 = *(_DWORD *)(a1 + 8);
    if (*(_WORD *)(a2 + 2) == 16) {
      return sub_100178064(v3, *(void **)(a2 + 8));
    }
    return v3 == *(_DWORD *)(a2 + 8);
  }
  if (v2 != 16)
  {
    if (v2 == 4) {
      goto LABEL_6;
    }
    return 0;
  }
  if (*(_WORD *)(a2 + 2) != 16) {
    return sub_100178064(*(_DWORD *)(a2 + 8), *(void **)(a1 + 8));
  }
  uint64_t v4 = *(uint64_t **)(a1 + 8);
  uint64_t v5 = *(uint64_t **)(a2 + 8);
  uint64_t v7 = *v4;
  uint64_t v6 = v4[1];
  uint64_t v9 = *v5;
  uint64_t v8 = v5[1];
  return v7 == v9 && v6 == v8;
}

uint64_t sub_100178188(uint64_t a1)
{
  long long v4 = xmmword_1007B9570;
  if (*(unsigned char *)a1 != 3) {
    return 0;
  }
  int v1 = *(unsigned __int16 *)(a1 + 2);
  if (v1 == 2) {
    return *(unsigned int *)(a1 + 8);
  }
  if (v1 != 16)
  {
    if (v1 == 4) {
      return *(unsigned int *)(a1 + 8);
    }
    return 0;
  }
  int v3 = *(unsigned int **)(a1 + 8);
  LODWORD(v4) = *v3;
  if (*(_OWORD *)v3 == v4) {
    return *v3;
  }
  else {
    return 0;
  }
}

const char *sub_100178240(uint64_t a1)
{
  if (*(unsigned char *)a1 != 3) {
    sub_10025B8C0();
  }
  if (*(_WORD *)(a1 + 2) == 16)
  {
    int v2 = *(unsigned int **)(a1 + 8);
    return sub_100258B24(v2);
  }
  else
  {
    unint64_t v4 = *(unsigned int *)(a1 + 8);
    return sub_100258E24(v4);
  }
}

uint64_t sub_1001782B0(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v4 = a2;
  if (*(unsigned char *)a2 == 32) {
    uint64_t v4 = *(void *)(a2 + 8);
  }
  sub_1002634E0(a1, a3);
  sub_100057604(a1, "<");
  uint64_t v6 = *(unsigned __int16 *)(a1 + 4);
  switch(*(unsigned char *)v4)
  {
    case 0:
      uint64_t v7 = "null";
      goto LABEL_9;
    case 1:
      uint64_t v10 = "uint";
      goto LABEL_16;
    case 2:
      uint64_t v10 = "sint";
      goto LABEL_16;
    case 3:
      uint64_t v10 = "uuid";
LABEL_16:
      sub_100057604(a1, v10);
      sub_100263578(a1, 8 * *(unsigned __int16 *)(v4 + 2));
      break;
    case 4:
      uint64_t v8 = "text";
      goto LABEL_21;
    case 5:
      if (*(unsigned char *)(v4 + 8)) {
        uint64_t v7 = "true";
      }
      else {
        uint64_t v7 = "false";
      }
LABEL_9:
      sub_100057604(a1, v7);
      uint64_t v9 = "/>\n";
      goto LABEL_55;
    case 6:
      uint64_t v8 = "seq";
      goto LABEL_21;
    case 7:
      uint64_t v8 = "alt";
      goto LABEL_21;
    case 8:
      uint64_t v8 = "url";
      goto LABEL_21;
    case 0x11:
      uint64_t v8 = "bdaddr";
      goto LABEL_21;
    case 0x12:
      uint64_t v8 = "rawbytes";
      goto LABEL_21;
    case 0x13:
      uint64_t v8 = "status";
      goto LABEL_21;
    case 0x14:
      uint64_t v8 = "text16";
LABEL_21:
      sub_100057604(a1, v8);
      break;
    default:
      break;
  }
  __int16 v11 = *(_WORD *)(a1 + 4);
  sub_1001787E4(a1, (unsigned __int8 *)v4);
  sub_100057604(a1, ">");
  switch(*(unsigned char *)v4)
  {
    case 1:
    case 2:
      if (*(unsigned __int16 *)(v4 + 2) >= 5u)
      {
        sub_100057604(a1, "0x");
        uint64_t v12 = *(unsigned int **)(v4 + 8);
        if (*(_WORD *)(v4 + 2) == 8)
        {
          sub_100057698(a1, *v12, 8);
          unsigned int v13 = *(_DWORD *)(*(void *)(v4 + 8) + 4);
        }
        else
        {
          sub_100057698(a1, *v12, 8);
          sub_100057698(a1, *(_DWORD *)(*(void *)(v4 + 8) + 4), 8);
          sub_100057698(a1, *(_DWORD *)(*(void *)(v4 + 8) + 8), 8);
          unsigned int v13 = *(_DWORD *)(*(void *)(v4 + 8) + 12);
        }
        uint64_t v18 = a1;
        int v17 = 8;
        goto LABEL_48;
      }
      if (*(unsigned char *)v4 != 1) {
        goto LABEL_45;
      }
      sub_100057604(a1, "0x");
      unsigned int v13 = *(_DWORD *)(v4 + 8);
      unsigned int v15 = *(unsigned __int16 *)(v4 + 2);
      goto LABEL_44;
    case 3:
      sub_100057604(a1, "0x");
      unsigned int v15 = *(unsigned __int16 *)(v4 + 2);
      if (v15 > 4)
      {
        sub_100057698(a1, **(_DWORD **)(v4 + 8), 8);
        sub_100057604(a1, ",");
        for (uint64_t i = 4; i != 16; ++i)
        {
          sub_100057698(a1, *(unsigned __int8 *)(*(void *)(v4 + 8) + i), 2);
          unsigned int v20 = (i - 4);
          if (v20 <= 5 && ((1 << v20) & 0x2A) != 0) {
            sub_100057604(a1, ",");
          }
        }
      }
      else
      {
        unsigned int v13 = *(_DWORD *)(v4 + 8);
LABEL_44:
        int v17 = 2 * v15;
        uint64_t v18 = a1;
LABEL_48:
        sub_100057698(v18, v13, v17);
      }
      break;
    case 4:
    case 8:
      sub_1002631D8(a1, *(char **)(v4 + 8), *(unsigned __int16 *)(v4 + 2));
      break;
    case 6:
    case 7:
      sub_100057604(a1, "\n");
      if (*(_WORD *)(v4 + 2))
      {
        int v14 = 0;
        do
          sub_1001782B0(a1, *(void *)(v4 + 8) + 16 * v14++, (a3 + 4));
        while (*(unsigned __int16 *)(v4 + 2) > v14);
      }
      goto LABEL_40;
    case 0x11:
      for (uint64_t j = 0; j != 6; ++j)
      {
        if (j) {
          sub_100057604(a1, ":");
        }
        sub_100057698(a1, *(unsigned __int8 *)(*(void *)(v4 + 8) + j), 2);
      }
      break;
    case 0x12:
      sub_100178958(a1, *(void *)(v4 + 8), *(unsigned __int16 *)(v4 + 2), (a3 + 4));
      goto LABEL_40;
    case 0x13:
LABEL_45:
      sub_100263578(a1, *(_DWORD *)(v4 + 8));
      break;
    case 0x14:
      sub_100178888(a1, *(void *)(v4 + 8), *(unsigned __int16 *)(v4 + 2), (a3 + 4));
LABEL_40:
      sub_1002634E0(a1, a3);
      break;
    default:
      sub_100057604(a1, "!!!Corrupt Data Element!!!");
      break;
  }
  sub_100057604(a1, "</");
  sub_1002631D8(a1, (char *)(*(void *)(a1 + 8) + v6), (unsigned __int16)(v11 - v6));
  sub_100057604(a1, ">");
  uint64_t v9 = "\n";
LABEL_55:

  return sub_100057604(a1, v9);
}

uint64_t sub_1001787E4(uint64_t a1, unsigned __int8 *a2)
{
  int v3 = *a2;
  if (v3 == 3)
  {
    if (*((unsigned __int16 *)a2 + 1) > 4u) {
      return 0;
    }
    uint64_t v4 = sub_100258E24(*((unsigned int *)a2 + 2));
  }
  else
  {
    if (v3 != 19) {
      return 0;
    }
    sub_10025E0A8(*((unsigned int *)a2 + 2));
  }
  uint64_t v5 = (char *)v4;
  if (v4)
  {
    sub_100057604(a1, " id=\"");
    sub_100057604(a1, v5);
    sub_100057604(a1, "\"");
    sub_100057604(a1, "\t");
    return 1;
  }
  return 0;
}

uint64_t sub_100178888(uint64_t a1, uint64_t a2, int a3, int a4)
{
  sub_100057604(a1, "\n");
  sub_1002634E0(a1, a4);
  if (a3)
  {
    uint64_t v8 = 0;
    do
    {
      if (v8 && (v8 & 0xF) == 0)
      {
        sub_100057604(a1, "\n");
        sub_1002634E0(a1, a4);
      }
      sub_100057698(a1, *(unsigned __int16 *)(a2 + 2 * v8), 4);
      sub_1002634E0(a1, 1);
      ++v8;
    }
    while (a3 != v8);
  }

  return sub_100057604(a1, "\n");
}

uint64_t sub_100178958(uint64_t a1, uint64_t a2, int a3, int a4)
{
  sub_100057604(a1, "\n");
  sub_1002634E0(a1, a4);
  if (a3)
  {
    uint64_t v8 = 0;
    do
    {
      if (v8 && (v8 & 0x1F) == 0)
      {
        sub_100057604(a1, "\n");
        sub_1002634E0(a1, a4);
      }
      sub_100057698(a1, *(unsigned __int8 *)(a2 + v8), 2);
      sub_1002634E0(a1, 1);
      ++v8;
    }
    while (a3 != v8);
  }

  return sub_100057604(a1, "\n");
}

uint64_t sub_100178A28(uint64_t a1, uint64_t a2, int a3)
{
  sub_100057604(a1, "|");
  if (*(unsigned char *)a2 == 32) {
    a2 = *(void *)(a2 + 8);
  }
  sub_1002634E0(a1, a3);
  uint64_t v6 = "null";
  switch(*(unsigned char *)a2)
  {
    case 0:
      goto LABEL_57;
    case 1:
      uint64_t v7 = "uint";
      goto LABEL_14;
    case 2:
      uint64_t v7 = "sint";
      goto LABEL_14;
    case 3:
      uint64_t v7 = "uuid";
LABEL_14:
      sub_100057604(a1, v7);
      sub_100263578(a1, 8 * *(unsigned __int16 *)(a2 + 2));
      break;
    case 4:
      uint64_t v8 = "text";
      goto LABEL_19;
    case 5:
      if (*(unsigned char *)(a2 + 8)) {
        uint64_t v6 = "true";
      }
      else {
        uint64_t v6 = "false";
      }
      goto LABEL_57;
    case 6:
      uint64_t v8 = "seq";
      goto LABEL_19;
    case 7:
      uint64_t v8 = "alt";
      goto LABEL_19;
    case 8:
      uint64_t v8 = "url";
      goto LABEL_19;
    case 0x11:
      uint64_t v8 = "bdaddr";
      goto LABEL_19;
    case 0x12:
      uint64_t v8 = "rawbytes";
      goto LABEL_19;
    case 0x13:
      uint64_t v8 = "status";
      goto LABEL_19;
    case 0x14:
      uint64_t v8 = "text16";
LABEL_19:
      sub_100057604(a1, v8);
      break;
    default:
      break;
  }
  sub_1002634E0(a1, 3);
  int v9 = sub_1001787E4(a1, (unsigned __int8 *)a2);
  if (v9) {
    sub_100057604(a1, "(");
  }
  switch(*(unsigned char *)a2)
  {
    case 1:
    case 2:
      if (*(unsigned __int16 *)(a2 + 2) >= 5u)
      {
        sub_100057604(a1, "0x");
        uint64_t v10 = *(unsigned int **)(a2 + 8);
        if (*(_WORD *)(a2 + 2) == 8)
        {
          sub_100057698(a1, *v10, 8);
          unsigned int v11 = *(_DWORD *)(*(void *)(a2 + 8) + 4);
        }
        else
        {
          sub_100057698(a1, *v10, 8);
          sub_100057698(a1, *(_DWORD *)(*(void *)(a2 + 8) + 4), 8);
          sub_100057698(a1, *(_DWORD *)(*(void *)(a2 + 8) + 8), 8);
          unsigned int v11 = *(_DWORD *)(*(void *)(a2 + 8) + 12);
        }
        uint64_t v16 = a1;
        int v15 = 8;
        goto LABEL_48;
      }
      if (*(unsigned char *)a2 != 1) {
        goto LABEL_45;
      }
      sub_100057604(a1, "0x");
      unsigned int v11 = *(_DWORD *)(a2 + 8);
      unsigned int v13 = *(unsigned __int16 *)(a2 + 2);
      goto LABEL_44;
    case 3:
      sub_100057604(a1, "0x");
      unsigned int v13 = *(unsigned __int16 *)(a2 + 2);
      if (v13 > 4)
      {
        sub_100057698(a1, **(_DWORD **)(a2 + 8), 8);
        sub_100057604(a1, ",");
        for (uint64_t i = 4; i != 16; ++i)
        {
          sub_100057698(a1, *(unsigned __int8 *)(*(void *)(a2 + 8) + i), 2);
          unsigned int v18 = (i - 4);
          if (v18 <= 5 && ((1 << v18) & 0x2A) != 0) {
            sub_100057604(a1, ",");
          }
        }
      }
      else
      {
        unsigned int v11 = *(_DWORD *)(a2 + 8);
LABEL_44:
        int v15 = 2 * v13;
        uint64_t v16 = a1;
LABEL_48:
        sub_100057698(v16, v11, v15);
      }
      break;
    case 4:
    case 8:
      sub_1002631D8(a1, *(char **)(a2 + 8), *(unsigned __int16 *)(a2 + 2));
      break;
    case 6:
    case 7:
      sub_100057604(a1, "\n");
      if (*(_WORD *)(a2 + 2))
      {
        int v12 = 0;
        do
          sub_100178A28(a1, *(void *)(a2 + 8) + 16 * v12++, (a3 + 4), 0);
        while (*(unsigned __int16 *)(a2 + 2) > v12);
      }
      goto LABEL_40;
    case 0x11:
      for (uint64_t j = 0; j != 6; ++j)
      {
        if (j) {
          sub_100057604(a1, ":");
        }
        sub_100057698(a1, *(unsigned __int8 *)(*(void *)(a2 + 8) + j), 2);
      }
      break;
    case 0x12:
      sub_100178958(a1, *(void *)(a2 + 8), *(unsigned __int16 *)(a2 + 2), (a3 + 4));
      goto LABEL_40;
    case 0x13:
LABEL_45:
      sub_100263578(a1, *(_DWORD *)(a2 + 8));
      break;
    case 0x14:
      sub_100178888(a1, *(void *)(a2 + 8), *(unsigned __int16 *)(a2 + 2), (a3 + 4));
LABEL_40:
      sub_1002634E0(a1, a3);
      break;
    default:
      sub_100057604(a1, "!!!Corrupt Data Element!!!");
      break;
  }
  if (v9) {
    sub_100057604(a1, ")");
  }
  uint64_t v6 = "\n";
LABEL_57:

  return sub_100057604(a1, v6);
}

void sub_100178F28(uint64_t a1, char *__s)
{
  v8[0] = 0;
  v8[1] = 0;
  __int16 v4 = strlen(__s);
  sub_10026314C((uint64_t)v8, (unsigned __int16)(v4 + 1));
  sub_100057604((uint64_t)v8, "\n");
  unsigned __int16 v5 = strlen(__s);
  sub_1002631D8((uint64_t)v8, __s, v5);
  sub_100178A28((uint64_t)v8, a1, 5);
  uint64_t v6 = sub_100050B4C(0x5Cu);
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    uint64_t v7 = sub_1002639DC((uint64_t)v8);
    *(_DWORD *)int buf = 136446210;
    uint64_t v10 = v7;
    _os_log_impl((void *)&_mh_execute_header, v6, OS_LOG_TYPE_DEFAULT, "%{public}s", buf, 0xCu);
  }
  sub_10026319C((uint64_t)v8);
}

uint64_t sub_100179034(uint64_t a1, uint64_t a2, unsigned __int8 *a3)
{
  long long ptr = xmmword_1007BA0C0;
  uint64_t v84 = 0;
  LOWORD(ptr) = 0;
  int v4 = *(unsigned __int16 *)(a1 + 10);
  int v5 = *(unsigned __int16 *)(a1 + 12);
  unsigned __int16 v6 = v4 - v5;
  if (v4 == v5)
  {
    p_long long ptr = &ptr;
LABEL_3:
    if (a2) {
      sub_10025B8C0();
    }
    goto LABEL_5;
  }
  p_long long ptr = &ptr;
  while (2)
  {
    int v11 = *a3;
    if (v11 == 32)
    {
      a3 = (unsigned __int8 *)*((void *)a3 + 1);
      int v11 = *a3;
    }
    uint64_t v12 = *((unsigned __int16 *)a3 + 1);
    switch(v11)
    {
      case 0:
        if (a2)
        {
          a2 = (a2 - 1);
        }
        else
        {
          if (*(unsigned char *)(a1 + 15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_160:
            uint64_t v78 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_162:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 174, v78);
          }
          if ((unsigned __int16)v4 <= (unsigned __int16)v5) {
            goto LABEL_160;
          }
          if (*(unsigned char *)(a1 + 14) != 2)
          {
            uint64_t v78 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_162;
          }
          a2 = 0;
          uint64_t v44 = *(void *)a1;
          *(_WORD *)(a1 + 12) = v5 + 1;
          *(unsigned char *)(v44 + (unsigned __int16)v5) = 0;
        }
        goto LABEL_106;
      case 1:
      case 2:
      case 5:
      case 19:
        goto LABEL_12;
      case 3:
        if (v12 == 4)
        {
          if (*((_DWORD *)a3 + 2) >= 0x10000u) {
            LODWORD(v12) = 4;
          }
          else {
            LODWORD(v12) = 2;
          }
        }
LABEL_12:
        if ((int)a2 <= (int)v12)
        {
          switch((int)v12)
          {
            case 1:
              if (v6 < 2u) {
                goto LABEL_5;
              }
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_136:
                int v72 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_138:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 201, v72);
              }
              if ((unsigned __int16)v4 <= (unsigned __int16)v5) {
                goto LABEL_136;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                int v72 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                goto LABEL_138;
              }
              uint64_t v20 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v5 + 1;
              *(unsigned char *)(v20 + (unsigned __int16)v5) = 8 * v11;
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_140:
                uint64_t v73 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_142:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 202, v73);
              }
              uint64_t v21 = *(unsigned __int16 *)(a1 + 12);
              if (*(unsigned __int16 *)(a1 + 10) <= v21) {
                goto LABEL_140;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                uint64_t v73 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                goto LABEL_142;
              }
              int v22 = *((_DWORD *)a3 + 2);
              uint64_t v23 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v21 + 1;
              *(unsigned char *)(v23 + v21) = v22;
              break;
            case 2:
              if (v6 < 3u) {
                goto LABEL_5;
              }
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_152:
                uint64_t v76 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_154:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 208, v76);
              }
              if ((unsigned __int16)v4 <= (unsigned __int16)v5) {
                goto LABEL_152;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                uint64_t v76 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                goto LABEL_154;
              }
              uint64_t v42 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v5 + 1;
              *(unsigned char *)(v42 + (unsigned __int16)v5) = (8 * v11) | 1;
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_156:
                uint64_t v77 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 2";
LABEL_158:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 209, v77);
              }
              uint64_t v43 = *(unsigned __int16 *)(a1 + 12);
              if (*(unsigned __int16 *)(a1 + 10) - (int)v43 <= 1) {
                goto LABEL_156;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                uint64_t v77 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                goto LABEL_158;
              }
              *(unsigned char *)(*(void *)a1 + v43 + 1) = *((_DWORD *)a3 + 2);
              *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12)) = BYTE1(*((_DWORD *)a3 + 2));
              __int16 v40 = *(_WORD *)(a1 + 12) + 2;
              goto LABEL_86;
            case 3:
            case 5:
            case 6:
            case 7:
              goto LABEL_67;
            case 4:
              if (v6 < 5u) {
                goto LABEL_5;
              }
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_144:
                uint64_t v74 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_146:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 215, v74);
              }
              if ((unsigned __int16)v4 <= (unsigned __int16)v5) {
                goto LABEL_144;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                uint64_t v74 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                goto LABEL_146;
              }
              uint64_t v38 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v5 + 1;
              *(unsigned char *)(v38 + (unsigned __int16)v5) = (8 * v11) | 2;
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_148:
                uint64_t v75 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 4";
LABEL_150:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 216, v75);
              }
              uint64_t v39 = *(unsigned __int16 *)(a1 + 12);
              if (*(unsigned __int16 *)(a1 + 10) - (int)v39 <= 3) {
                goto LABEL_148;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                uint64_t v75 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                goto LABEL_150;
              }
              *(unsigned char *)(*(void *)a1 + v39 + 3) = *((_DWORD *)a3 + 2);
              *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12) + 2) = BYTE1(*((_DWORD *)a3 + 2));
              *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12) + 1) = *((_WORD *)a3 + 5);
              *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12)) = a3[11];
              __int16 v40 = *(_WORD *)(a1 + 12) + 4;
LABEL_86:
              *(_WORD *)(a1 + 12) = v40;
              goto LABEL_106;
            case 8:
              if (a2)
              {
                uint64_t v41 = (a2 - 1);
              }
              else
              {
                if (*(unsigned char *)(a1 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/data"
                                         "elem/marshaller.c");
LABEL_164:
                  uint64_t v79 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_166:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 222, v79);
                }
                if ((unsigned __int16)v4 <= (unsigned __int16)v5) {
                  goto LABEL_164;
                }
                if (*(unsigned char *)(a1 + 14) != 2)
                {
                  uint64_t v79 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_166;
                }
                uint64_t v41 = 0;
                uint64_t v45 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v5 + 1;
                *(unsigned char *)(v45 + (unsigned __int16)v5) = (8 * v11) | 3;
              }
              uint64_t v46 = sub_100179BD8(a1, v41, **((_DWORD **)a3 + 1));
              int v47 = *(_DWORD *)(*((void *)a3 + 1) + 4);
LABEL_105:
              a2 = sub_100179BD8(a1, v46, v47);
              if (a2 == -1) {
                goto LABEL_5;
              }
              goto LABEL_106;
            default:
              if (v12 != 16) {
                goto LABEL_67;
              }
              if (a2)
              {
                uint64_t v37 = (a2 - 1);
              }
              else
              {
                if (*(unsigned char *)(a1 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/data"
                                         "elem/marshaller.c");
LABEL_171:
                  uint64_t v81 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
LABEL_173:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 234, v81);
                }
                if ((unsigned __int16)v4 <= (unsigned __int16)v5) {
                  goto LABEL_171;
                }
                if (*(unsigned char *)(a1 + 14) != 2)
                {
                  uint64_t v81 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_173;
                }
                uint64_t v37 = 0;
                uint64_t v48 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v5 + 1;
                *(unsigned char *)(v48 + (unsigned __int16)v5) = (8 * v11) | 4;
                int v11 = *a3;
              }
              uint64_t v49 = (int *)*((void *)a3 + 1);
              if (v11 != 3)
              {
                uint64_t v56 = sub_100179BD8(a1, v37, *v49);
                uint64_t v57 = sub_100179BD8(a1, v56, *(_DWORD *)(*((void *)a3 + 1) + 4));
                uint64_t v46 = sub_100179BD8(a1, v57, *(_DWORD *)(*((void *)a3 + 1) + 8));
                int v47 = *(_DWORD *)(*((void *)a3 + 1) + 12);
                goto LABEL_105;
              }
              int v50 = sub_100179BD8(a1, v37, *v49);
              if (v50 == -1) {
                goto LABEL_5;
              }
              int v51 = v50;
              uint64_t v52 = *(unsigned __int16 *)(a1 + 12);
              LOWORD(v53) = *(_WORD *)(a1 + 10) - v52;
              uint64_t v54 = *((void *)a3 + 1);
              uint64_t v82 = *(void *)a1;
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
                int v55 = 0;
              }
              else
              {
                int v55 = *(unsigned __int16 *)(a1 + 10) - v52;
              }
              unsigned int v59 = (unsigned __int16)(12 - v51);
              unsigned int v60 = (unsigned __int16)v53;
              if (v59 >= (unsigned __int16)v53) {
                size_t v53 = (unsigned __int16)v53;
              }
              else {
                size_t v53 = (unsigned __int16)(12 - v51);
              }
              if (v55 < (int)v53)
              {
                uint64_t v80 = "ByteStream_NumReadBytesAvail(*ByteStream) >= ((((size) > (bytesAllowed)) ? (bytesAllowed) : (size)))";
                goto LABEL_169;
              }
              if (*(unsigned char *)(a1 + 14) != 2)
              {
                uint64_t v80 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_169:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 246, v80);
              }
              memmove((void *)(v82 + v52), (const void *)(v54 + v51 + 4), v53);
              *(_WORD *)(a1 + 12) += v53;
              if (v59 > v60) {
                goto LABEL_5;
              }
              a2 = 0;
              goto LABEL_106;
          }
        }
        else
        {
          a2 = (a2 + ~v12);
        }
        goto LABEL_106;
      case 4:
      case 8:
      case 17:
      case 18:
        unsigned int v13 = sub_100179CD4((uint64_t *)a1, a2, *((unsigned __int16 *)a3 + 1), v11);
        if (v13 == -1) {
          goto LABEL_5;
        }
        unsigned int v14 = v13;
        a2 = v13 - v12;
        if (v13 >= v12) {
          goto LABEL_106;
        }
        uint64_t v15 = *(unsigned __int16 *)(a1 + 12);
        LOWORD(v16) = *(_WORD *)(a1 + 10) - v15;
        uint64_t v17 = *(void *)a1;
        uint64_t v18 = *((void *)a3 + 1);
        if (*(unsigned char *)(a1 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
          int v19 = 0;
        }
        else
        {
          int v19 = *(unsigned __int16 *)(a1 + 10) - v15;
        }
        unsigned __int16 v34 = v12 - v14;
        unsigned int v35 = (unsigned __int16)(v12 - v14);
        unsigned int v36 = (unsigned __int16)v16;
        if ((unsigned __int16)v16 >= v34) {
          size_t v16 = v35;
        }
        else {
          size_t v16 = (unsigned __int16)v16;
        }
        if (v19 < (int)v16)
        {
          uint64_t v71 = "ByteStream_NumReadBytesAvail(*ByteStream) >= ((((size) > (bytesAllowed)) ? (bytesAllowed) : (size)))";
          goto LABEL_134;
        }
        if (*(unsigned char *)(a1 + 14) != 2)
        {
          uint64_t v71 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_134:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 278, v71);
        }
        memmove((void *)(v17 + v15), (const void *)(v18 + v14), v16);
        *(_WORD *)(a1 + 12) += v16;
        if (v36 < v35) {
          goto LABEL_5;
        }
        a2 = 0;
        goto LABEL_106;
      case 6:
      case 7:
        int v24 = sub_100179F4C(a3);
        if (!v24) {
          goto LABEL_5;
        }
        unsigned __int16 v25 = v24 - 2;
        if (((v24 - 2) & 0xFF00) != 0) {
          unsigned __int16 v25 = v24 - 3;
        }
        unsigned int v26 = v25;
        uint64_t v27 = sub_100179CD4((uint64_t *)a1, a2, v25, *a3);
        if (v27 == -1) {
          goto LABEL_5;
        }
        a2 = v27;
        if (v27 < v26)
        {
          if (!*((void *)a3 + 1) || !*((_WORD *)a3 + 1)) {
            goto LABEL_106;
          }
          uint64_t v28 = (long long *)sub_100022FE8(0x18uLL);
          if (!v28)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"MarshalElement: %!", v62, v63, v64, v65, v66, v67, v68, 106);
              uint64_t v69 = sub_100050B4C(0x2Bu);
              if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR)) {
                sub_1007495EC();
              }
            }
LABEL_5:
            if (p_ptr != &ptr)
            {
              do
              {
                uint64_t v8 = (long long *)*((void *)p_ptr + 2);
                sub_100023010(p_ptr);
                p_long long ptr = v8;
              }
              while (v8 != &ptr);
            }
            return 0xFFFFFFFFLL;
          }
          *((void *)p_ptr + 1) = a3;
          *((void *)v28 + 2) = p_ptr;
          __int16 v29 = *((_WORD *)a3 + 1);
          *(_WORD *)uint64_t v28 = v29;
          a3 = (unsigned __int8 *)*((void *)a3 + 1);
          p_long long ptr = v28;
LABEL_112:
          *(_WORD *)p_long long ptr = v29 - 1;
          int v4 = *(unsigned __int16 *)(a1 + 10);
          int v5 = *(unsigned __int16 *)(a1 + 12);
          unsigned __int16 v6 = v4 - v5;
          if (v4 == v5) {
            goto LABEL_3;
          }
          continue;
        }
        a2 = v27 - v26;
LABEL_106:
        if (p_ptr != &ptr)
        {
          if (!*(_WORD *)p_ptr)
          {
            do
            {
              uint64_t v58 = p_ptr;
              p_long long ptr = (long long *)*((void *)p_ptr + 2);
              sub_100023010(v58);
              if (p_ptr == &ptr) {
                goto LABEL_122;
              }
            }
            while (!*(_WORD *)p_ptr);
            a3 = (unsigned __int8 *)*((void *)p_ptr + 1);
          }
          a3 += 16;
          __int16 v29 = *(_WORD *)p_ptr;
          goto LABEL_112;
        }
LABEL_122:
        if ((a2 & 0x80000000) != 0) {
          sub_10025B8C0();
        }
        return a2;
      case 20:
        uint64_t v30 = sub_100179CD4((uint64_t *)a1, a2, 2 * (int)v12, 20);
        if (v30 == -1) {
          goto LABEL_5;
        }
        a2 = v30;
        if (!v12) {
          goto LABEL_106;
        }
        uint64_t v31 = 0;
        unsigned __int16 v32 = *(_WORD *)(a1 + 12);
        unsigned __int16 v33 = *(_WORD *)(a1 + 10) - v32;
        while (1)
        {
          if (a2)
          {
            a2 = (a2 - 2);
          }
          else
          {
            if (v33 < 2u) {
              goto LABEL_5;
            }
            if (*(unsigned char *)(a1 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_130:
              uint64_t v70 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 2";
LABEL_131:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 301, v70);
            }
            if (*(unsigned __int16 *)(a1 + 10) - v32 <= 1) {
              goto LABEL_130;
            }
            if (*(unsigned char *)(a1 + 14) != 2)
            {
              uint64_t v70 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_131;
            }
            a2 = 0;
            *(unsigned char *)(*(void *)a1 + v32 + 1) = *(unsigned char *)(*((void *)a3 + 1) + v31);
            *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12)) = *(unsigned char *)(*((void *)a3 + 1) + v31 + 1);
            unsigned __int16 v32 = *(_WORD *)(a1 + 12) + 2;
            *(_WORD *)(a1 + 12) = v32;
            v33 -= 2;
          }
          v31 += 2;
          if (2 * v12 == v31) {
            goto LABEL_106;
          }
        }
      default:
LABEL_67:
        sub_10025B8C0();
        goto LABEL_106;
    }
  }
}

uint64_t sub_100179BD8(uint64_t a1, uint64_t a2, int a3)
{
  if (a2 != -1)
  {
    if (a2 >= 4) {
      return (a2 - 4);
    }
    uint64_t v3 = *(unsigned __int16 *)(a1 + 12);
    int v4 = *(unsigned __int16 *)(a1 + 10) - v3;
    if ((v4 & 0xFFFC) == 0) {
      return 0xFFFFFFFFLL;
    }
    if (*(unsigned char *)(a1 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
    }
    else if (v4 > 3)
    {
      if (*(unsigned char *)(a1 + 14) == 2)
      {
        *(unsigned char *)(*(void *)a1 + v3 + 3) = a3;
        *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12) + 2) = BYTE1(a3);
        *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12) + 1) = BYTE2(a3);
        *(unsigned char *)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12)) = HIBYTE(a3);
        *(_WORD *)(a1 + 12) += 4;
        return a2;
      }
      unsigned __int16 v6 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_14:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 119, v6);
    }
    unsigned __int16 v6 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 4";
    goto LABEL_14;
  }
  return a2;
}

uint64_t sub_100179CD4(uint64_t *a1, int a2, unsigned int a3, char a4)
{
  if (a3 > 0xFFFE) {
    return 0xFFFFFFFFLL;
  }
  uint64_t v4 = *((unsigned __int16 *)a1 + 6);
  int v5 = *((unsigned __int16 *)a1 + 5) - v4;
  if (a3 < 0x100)
  {
    if ((v5 & 0xFFFE) == 0) {
      return 0xFFFFFFFFLL;
    }
    if (a2)
    {
      uint64_t v6 = (a2 - 2);
      if (a2 - 2 >= 0) {
        return v6;
      }
      return 0xFFFFFFFFLL;
    }
    if (*((unsigned char *)a1 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
    }
    else if (v5 > 0)
    {
      if (*((unsigned char *)a1 + 14) == 2)
      {
        uint64_t v8 = *a1;
        *((_WORD *)a1 + 6) = v4 + 1;
        *(unsigned char *)(v8 + v4) = (8 * a4) | 5;
        if (*((unsigned char *)a1 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
        }
        else
        {
          uint64_t v9 = *((unsigned __int16 *)a1 + 6);
          if (*((unsigned __int16 *)a1 + 5) > v9)
          {
            if (*((unsigned char *)a1 + 14) == 2)
            {
              uint64_t v6 = 0;
              uint64_t v10 = *a1;
              *((_WORD *)a1 + 6) = v9 + 1;
              *(unsigned char *)(v10 + v9) = a3;
              return v6;
            }
            unsigned int v14 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 92, v14);
          }
        }
        unsigned int v14 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
        goto LABEL_33;
      }
      unsigned int v13 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 91, v13);
    }
    unsigned int v13 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
    goto LABEL_29;
  }
  if ((unsigned __int16)(*((_WORD *)a1 + 5) - v4) < 3u) {
    return 0xFFFFFFFFLL;
  }
  if (!a2)
  {
    if (*((unsigned char *)a1 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
    }
    else if (v5 > 0)
    {
      if (*((unsigned char *)a1 + 14) == 2)
      {
        uint64_t v11 = *a1;
        *((_WORD *)a1 + 6) = v4 + 1;
        *(unsigned char *)(v11 + v4) = (8 * a4) | 6;
        if (*((unsigned char *)a1 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
        }
        else
        {
          uint64_t v12 = *((unsigned __int16 *)a1 + 6);
          if (*((unsigned __int16 *)a1 + 5) - (int)v12 > 1)
          {
            if (*((unsigned char *)a1 + 14) == 2)
            {
              uint64_t v6 = 0;
              *(unsigned char *)(*a1 + v12 + 1) = a3;
              *(unsigned char *)(*a1 + *((unsigned __int16 *)a1 + 6)) = BYTE1(a3);
              *((_WORD *)a1 + 6) += 2;
              return v6;
            }
            size_t v16 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 79, v16);
          }
        }
        size_t v16 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 2";
        goto LABEL_41;
      }
      uint64_t v15 = "(*ByteStream).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 78, v15);
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(*ByteStream) >= 1";
    goto LABEL_37;
  }
  uint64_t v6 = (a2 - 3);
  if (a2 - 3 < 0) {
    return 0xFFFFFFFFLL;
  }
  return v6;
}

uint64_t sub_100179F4C(unsigned __int8 *a1)
{
  long long ptr = xmmword_1007BA0C0;
  uint64_t v28 = 0;
  __int16 v2 = 1;
  p_long long ptr = &ptr;
LABEL_2:
  *(_WORD *)p_long long ptr = v2 - 1;
  __int16 v4 = *((_WORD *)p_ptr + 1) + 1;
  *((_WORD *)p_ptr + 1) = v4;
  int v5 = *a1;
  if (v5 == 32)
  {
    a1 = (unsigned __int8 *)*((void *)a1 + 1);
    int v5 = *a1;
  }
  unsigned int v6 = *((unsigned __int16 *)a1 + 1);
  switch(v5)
  {
    case 0:
      goto LABEL_24;
    case 1:
    case 2:
    case 5:
    case 19:
      goto LABEL_5;
    case 3:
      if (v6 == 4)
      {
        if (*((_DWORD *)a1 + 2) >= 0x10000u) {
          LOWORD(v6) = 4;
        }
        else {
          LOWORD(v6) = 2;
        }
      }
LABEL_5:
      __int16 v7 = v6 + v4;
      goto LABEL_23;
    case 4:
    case 8:
    case 17:
    case 18:
      __int16 v8 = v6 + v4;
      goto LABEL_19;
    case 6:
    case 7:
      if (*((void *)a1 + 1)) {
        BOOL v9 = v6 == 0;
      }
      else {
        BOOL v9 = 1;
      }
      if (v9) {
        goto LABEL_24;
      }
      uint64_t v10 = (long long *)sub_100022FE8(0x18uLL);
      if (v10)
      {
        *((void *)p_ptr + 1) = a1;
        *((void *)v10 + 2) = p_ptr;
        *(_DWORD *)uint64_t v10 = *((unsigned __int16 *)a1 + 1);
        a1 = (unsigned __int8 *)*((void *)a1 + 1);
        p_long long ptr = v10;
        goto LABEL_33;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_DataElement_MarshalledSize: %!", v17, v18, v19, v20, v21, v22, v23, 106);
        int v24 = sub_100050B4C(0x2Bu);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
        {
          unsigned int v26 = sub_100050714();
          *(_DWORD *)int buf = 136446466;
          uint64_t v30 = v26;
          __int16 v31 = 1024;
          int v32 = 106;
          _os_log_error_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
        }
      }
      if (p_ptr == &ptr) {
        return 0;
      }
      do
      {
        unsigned __int16 v25 = (long long *)*((void *)p_ptr + 2);
        sub_100023010(p_ptr);
        uint64_t result = 0;
        p_long long ptr = v25;
      }
      while (v25 != &ptr);
      return result;
    case 20:
      __int16 v8 = v4 + 2 * v6;
LABEL_19:
      if (v6 <= 0xFF) {
        __int16 v11 = 1;
      }
      else {
        __int16 v11 = 2;
      }
      __int16 v7 = v8 + v11;
LABEL_23:
      *((_WORD *)p_ptr + 1) = v7;
      goto LABEL_24;
    default:
      sub_10025B8C0();
LABEL_24:
      if (p_ptr == &ptr) {
        return WORD1(ptr);
      }
      if (*(_WORD *)p_ptr) {
        goto LABEL_32;
      }
      break;
  }
  while (1)
  {
    uint64_t v12 = p_ptr;
    unsigned int v13 = *((unsigned __int16 *)p_ptr + 1);
    __int16 v14 = v13 <= 0xFF ? 1 : 2;
    __int16 v15 = v14 + v13;
    *((_WORD *)p_ptr + 1) = v15;
    p_long long ptr = (long long *)*((void *)p_ptr + 2);
    *((_WORD *)p_ptr + 1) += v15;
    sub_100023010(v12);
    if (p_ptr == &ptr) {
      return WORD1(ptr);
    }
    if (*(_WORD *)p_ptr)
    {
      a1 = (unsigned __int8 *)*((void *)p_ptr + 1);
LABEL_32:
      a1 += 16;
LABEL_33:
      __int16 v2 = *(_WORD *)p_ptr;
      goto LABEL_2;
    }
  }
}

BOOL sub_10017A224(uint64_t a1, unsigned __int8 *a2)
{
  return sub_100179034(a1, 0, a2) == 0;
}

BOOL sub_10017A24C(uint64_t a1, _WORD *a2, unsigned __int8 *a3)
{
  int v4 = sub_100179034(a1, (unsigned __int16)*a2, a3);
  if (v4 == -1) {
    __int16 v5 = 0;
  }
  else {
    __int16 v5 = v4;
  }
  *a2 = v5;
  return v4 != -1;
}

uint64_t sub_10017A288(uint64_t a1, unsigned char *a2, __int16 *a3)
{
  if (*(unsigned char *)(a1 + 14) != 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 782, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
  }
  uint64_t v4 = *(unsigned __int16 *)(a1 + 12);
  if (*(unsigned char *)(a1 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_8:
    *(unsigned char *)(a1 + 15) = 1;
    uint64_t result = 843;
    goto LABEL_9;
  }
  if (*(unsigned __int16 *)(a1 + 10) <= v4) {
    goto LABEL_8;
  }
  uint64_t v6 = *(void *)a1;
  *(_WORD *)(a1 + 12) = v4 + 1;
  unsigned int v7 = *(unsigned __int8 *)(v6 + v4);
  *a2 = v7 >> 3;
  if (a3)
  {
    if (v7 >= 8)
    {
      int v10 = sub_10017A3B8((uint64_t *)a1, v7 & 7);
      *a3 = v10;
      int v11 = *(unsigned __int16 *)(a1 + 12);
      if (v11 - (int)v4 + v10 >= 0x10000) {
        return 808;
      }
      __int16 v8 = v10 - v4 + v11;
    }
    else
    {
      __int16 v8 = 1;
    }
    *a3 = v8;
  }
  if (*(unsigned char *)(a1 + 15)) {
    uint64_t result = 843;
  }
  else {
    uint64_t result = 0;
  }
LABEL_9:
  if (v4 > *(unsigned __int16 *)(a1 + 10)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 806, "(size_t)(pos) <= (size_t)((*ByteStream).__size)");
  }
  *(_WORD *)(a1 + 12) = v4;
  return result;
}

uint64_t sub_10017A3B8(uint64_t *a1, int a2)
{
  uint64_t result = 1;
  switch(a2)
  {
    case 0:
      return result;
    case 1:
      return 2;
    case 2:
      return 4;
    case 3:
      return 8;
    case 4:
      return 16;
    case 5:
      if (*((unsigned char *)a1 + 14) != 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 589, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
      }
      if (*((unsigned char *)a1 + 15)) {
        goto LABEL_17;
      }
      uint64_t v12 = *((unsigned __int16 *)a1 + 6);
      if (*((unsigned __int16 *)a1 + 5) <= v12) {
        goto LABEL_18;
      }
      uint64_t v13 = *a1;
      *((_WORD *)a1 + 6) = v12 + 1;
      return *(unsigned __int8 *)(v13 + v12);
    case 6:
      if (*((unsigned char *)a1 + 14) != 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 596, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
      }
      if (*((unsigned char *)a1 + 15)) {
        goto LABEL_17;
      }
      uint64_t v16 = *((unsigned __int16 *)a1 + 6);
      if (*((unsigned __int16 *)a1 + 5) - (int)v16 < 2) {
        goto LABEL_18;
      }
      uint64_t result = bswap32(*(unsigned __int16 *)(*a1 + v16)) >> 16;
      __int16 v15 = v16 + 2;
      goto LABEL_26;
    case 7:
      if (*((unsigned char *)a1 + 14) != 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 603, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
      }
      if (*((unsigned char *)a1 + 15))
      {
LABEL_17:
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_18:
        uint64_t result = 0;
        *((unsigned char *)a1 + 15) = 1;
        return result;
      }
      uint64_t v14 = *((unsigned __int16 *)a1 + 6);
      if (*((unsigned __int16 *)a1 + 5) - (int)v14 < 4) {
        goto LABEL_18;
      }
      uint64_t result = bswap32(*(unsigned __int16 *)(*a1 + v14 + 2)) >> 16;
      __int16 v15 = v14 + 4;
LABEL_26:
      *((_WORD *)a1 + 6) = v15;
      return result;
    default:
      *((unsigned char *)a1 + 15) = 1;
      uint64_t result = sub_100058654();
      if (result)
      {
        sub_100056E24((uint64_t)"Bad dataelement size index", v4, v5, v6, v7, v8, v9, v10, v17);
        int v11 = sub_100050B4C(0x2Bu);
        uint64_t result = os_log_type_enabled(v11, OS_LOG_TYPE_ERROR);
        if (result)
        {
          sub_100749678();
          return 0;
        }
      }
      return result;
  }
}

uint64_t sub_10017A5EC(uint64_t a1, _WORD *a2, _WORD *a3)
{
  if (*(unsigned char *)(a1 + 14) != 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 818, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
  }
  if (*(unsigned char *)(a1 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
LABEL_10:
    *(unsigned char *)(a1 + 15) = 1;
    return 843;
  }
  uint64_t v4 = *(unsigned __int16 *)(a1 + 12);
  if (*(unsigned __int16 *)(a1 + 10) <= v4) {
    goto LABEL_10;
  }
  uint64_t v5 = *(void *)a1;
  *(_WORD *)(a1 + 12) = v4 + 1;
  char v6 = *(unsigned char *)(v5 + v4);
  if ((v6 & 0xF0) != 0x30) {
    return 808;
  }
  int v7 = v6 & 7;
  if ((v7 - 5) > 2) {
    return 808;
  }
  *a2 = 0x500030002uLL >> (16 * (v7 - 5));
  *a3 = sub_10017A3B8((uint64_t *)a1, v7);
  if (*(unsigned char *)(a1 + 15)) {
    return 843;
  }
  else {
    return 0;
  }
}

uint64_t sub_10017A6E4(uint64_t a1, uint64_t a2, char a3)
{
  uint64_t v6 = a2;
  while (2)
  {
    while (2)
    {
      if (*(unsigned char *)v6 == 33)
      {
        uint64_t v6 = *(void *)(v6 + 8);
        goto LABEL_155;
      }
      if (*(unsigned char *)(a1 + 14) != 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 873, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
      }
      if (*(unsigned char *)(a1 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
        goto LABEL_169;
      }
      unsigned int v7 = *(unsigned __int16 *)(a1 + 10);
      uint64_t v8 = *(unsigned __int16 *)(a1 + 12);
      if (v7 <= v8)
      {
LABEL_169:
        *(unsigned char *)(a1 + 15) = 1;
        return 808;
      }
      uint64_t v9 = *(void *)a1;
      uint64_t v10 = v8 + 1;
      *(_WORD *)(a1 + 12) = v8 + 1;
      uint64_t v11 = *(unsigned __int8 *)(v9 + v8);
      unsigned int v12 = v11 >> 3;
      *(unsigned char *)uint64_t v6 = *(unsigned char *)(v9 + v8) >> 3;
      if (!v11)
      {
        *(_WORD *)(v6 + 2) = 0;
        goto LABEL_155;
      }
      if ((a3 & 1) == 0 && v12 - 17 <= 3)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Reserved BHAPI Desc Rxed, discarded: %2x\n", v106, v107, v108, v109, v110, v111, v112, v11);
          uint64_t v113 = sub_100050B4C(0x2Bu);
          if (os_log_type_enabled(v113, OS_LOG_TYPE_ERROR)) {
            goto LABEL_181;
          }
        }
        return 808;
      }
      unsigned int v13 = v11 & 7;
      switch(v12)
      {
        case 0u:
        case 5u:
          if ((v11 & 7) != 0) {
            return 808;
          }
LABEL_28:
          if (v7 <= (unsigned __int16)v10)
          {
            int v24 = 0;
            *(unsigned char *)(a1 + 15) = 1;
          }
          else
          {
            *(_WORD *)(a1 + 12) = v8 + 2;
            int v24 = *(unsigned __int8 *)(v9 + v10);
          }
          *(_DWORD *)(v6 + 8) = v24;
          *(_WORD *)(v6 + 2) = 1;
          goto LABEL_154;
        case 1u:
        case 2u:
        case 0x13u:
          goto LABEL_20;
        case 3u:
          BOOL v14 = (v11 & 7) == 0 || v13 == 3;
          if (v14) {
            return 808;
          }
LABEL_20:
          if (v13 > 4) {
            return 808;
          }
          break;
        case 4u:
        case 6u:
        case 7u:
        case 8u:
        case 0x11u:
        case 0x12u:
        case 0x14u:
          if (v13 < 5) {
            return 808;
          }
          break;
        default:
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Reserved Elem Desc Rxed, discarded: %2x\n", v114, v115, v116, v117, v118, v119, v120, v11);
            uint64_t v121 = sub_100050B4C(0x2Bu);
            if (os_log_type_enabled(v121, OS_LOG_TYPE_ERROR)) {
              goto LABEL_181;
            }
          }
          return 808;
      }
      switch(v11 & 7)
      {
        case 1:
          if ((int)(v7 - (unsigned __int16)v10) < 2)
          {
            unsigned int v25 = 0;
            *(unsigned char *)(a1 + 15) = 1;
          }
          else
          {
            unsigned int v25 = __rev16(*(unsigned __int16 *)(v9 + v10));
            *(_WORD *)(a1 + 12) = v8 + 3;
          }
          *(_DWORD *)(v6 + 8) = v25;
          *(_WORD *)(v6 + 2) = 2;
          goto LABEL_154;
        case 2:
          if ((int)(v7 - (unsigned __int16)v10) < 4)
          {
            unsigned int v26 = 0;
            *(unsigned char *)(a1 + 15) = 1;
          }
          else
          {
            unsigned int v26 = bswap32(*(_DWORD *)(v9 + v10));
            *(_WORD *)(a1 + 12) = v8 + 5;
          }
          *(_DWORD *)(v6 + 8) = v26;
          *(_WORD *)(v6 + 2) = 4;
          goto LABEL_154;
        case 3:
          uint64_t v27 = sub_100022FE8(8uLL);
          *(void *)(v6 + 8) = v27;
          if (!v27) {
            return 106;
          }
          if (*(unsigned char *)(a1 + 14) != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 988, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
          }
          if (*(unsigned char *)(a1 + 15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
            int v28 = *(unsigned __int8 *)(a1 + 14);
            *(unsigned char *)(a1 + 15) = 1;
            if (v28 != 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 989, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
            }
            goto LABEL_128;
          }
          uint64_t v56 = *(unsigned __int16 *)(a1 + 12);
          if (*(unsigned __int16 *)(a1 + 10) - (int)v56 <= 3)
          {
            *(unsigned char *)(a1 + 15) = 1;
LABEL_128:
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
            goto LABEL_129;
          }
          *uint64_t v27 = bswap32(*(_DWORD *)(*(void *)a1 + v56));
          *(_WORD *)(a1 + 12) = v56 + 4;
          if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v56 + 4) >= 4)
          {
            *(_DWORD *)(*(void *)(v6 + 8) + 4) = bswap32(*(_DWORD *)(*(void *)a1 + (unsigned __int16)(v56 + 4)));
            *(_WORD *)(a1 + 12) = v56 + 8;
            goto LABEL_130;
          }
LABEL_129:
          *(unsigned char *)(a1 + 15) = 1;
LABEL_130:
          __int16 v84 = 8;
          goto LABEL_153;
        case 4:
          __int16 v29 = sub_100022FE8(0x10uLL);
          *(void *)(v6 + 8) = v29;
          if (v12 == 3)
          {
            if (v29)
            {
              if (*(unsigned char *)(a1 + 14) != 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 998, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
              }
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
                int v30 = *(unsigned __int8 *)(a1 + 14);
                *(unsigned char *)(a1 + 15) = 1;
                if (v30 != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 999, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
                }
                goto LABEL_150;
              }
              uint64_t v73 = *(unsigned __int16 *)(a1 + 12);
              if (*(unsigned __int16 *)(a1 + 10) - (int)v73 > 3)
              {
                uint64_t v74 = *(void *)a1;
                _DWORD *v29 = bswap32(*(_DWORD *)(*(void *)a1 + v73));
                unsigned __int16 v75 = v73 + 4;
                *(_WORD *)(a1 + 12) = v75;
                if (*(unsigned __int16 *)(a1 + 10) - (unint64_t)v75 >= 0xC)
                {
                  uint64_t v76 = *(void *)(v6 + 8);
                  uint64_t v77 = v75;
                  unint64_t v78 = v76 + 16;
                  uint64_t v79 = (char *)(v74 + v77);
                  uint64_t v80 = (unsigned char *)(v76 + 4);
                  do
                  {
                    char v81 = *v79++;
                    *v80++ = v81;
                  }
                  while ((unint64_t)v80 < v78);
                  __int16 v82 = *(_WORD *)(a1 + 12) + 12;
                  goto LABEL_121;
                }
                goto LABEL_151;
              }
              *(unsigned char *)(a1 + 15) = 1;
              goto LABEL_150;
            }
            return 106;
          }
          if (!v29) {
            return 106;
          }
          if (*(unsigned char *)(a1 + 14) != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 1006, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
          }
          if (*(unsigned char *)(a1 + 15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
            int v49 = *(unsigned __int8 *)(a1 + 14);
            *(unsigned char *)(a1 + 15) = 1;
            if (v49 != 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 1007, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
            }
          }
          else
          {
            uint64_t v83 = *(unsigned __int16 *)(a1 + 12);
            if (*(unsigned __int16 *)(a1 + 10) - (int)v83 > 3)
            {
              _DWORD *v29 = bswap32(*(_DWORD *)(*(void *)a1 + v83));
              *(_WORD *)(a1 + 12) = v83 + 4;
              if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v83 + 4) > 3)
              {
                *(_DWORD *)(*(void *)(v6 + 8) + 4) = bswap32(*(_DWORD *)(*(void *)a1 + (unsigned __int16)(v83 + 4)));
                *(_WORD *)(a1 + 12) = v83 + 8;
                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v83 + 8) > 3)
                {
                  *(_DWORD *)(*(void *)(v6 + 8) + 8) = bswap32(*(_DWORD *)(*(void *)a1
                                                                             + (unsigned __int16)(v83 + 8)));
                  *(_WORD *)(a1 + 12) = v83 + 12;
                  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v83 + 12) >= 4)
                  {
                    *(_DWORD *)(*(void *)(v6 + 8) + 12) = bswap32(*(_DWORD *)(*(void *)a1
                                                                                + (unsigned __int16)(v83 + 12)));
                    __int16 v82 = v83 + 16;
LABEL_121:
                    *(_WORD *)(a1 + 12) = v82;
LABEL_152:
                    __int16 v84 = 16;
LABEL_153:
                    *(_WORD *)(v6 + 2) = v84;
                    goto LABEL_154;
                  }
LABEL_151:
                  *(unsigned char *)(a1 + 15) = 1;
                  goto LABEL_152;
                }
                *(unsigned char *)(a1 + 15) = 1;
LABEL_150:
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
                goto LABEL_151;
              }
              *(unsigned char *)(a1 + 15) = 1;
LABEL_149:
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
              int v95 = *(unsigned __int8 *)(a1 + 14);
              *(unsigned char *)(a1 + 15) = 1;
              if (v95 != 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 1009, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
              }
              goto LABEL_150;
            }
            *(unsigned char *)(a1 + 15) = 1;
          }
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
          int v94 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v94 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 1008, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
          }
          goto LABEL_149;
        case 5:
        case 6:
        case 7:
          uint64_t v15 = 808;
          switch(v12)
          {
            case 4u:
            case 8u:
              unsigned int v16 = sub_10017A3B8((uint64_t *)a1, v13);
              *(_WORD *)(v6 + 2) = v16;
              if (*(unsigned char *)(a1 + 15)) {
                return v15;
              }
              uint64_t v17 = sub_100022FE8(v16 + 2);
              *(void *)(v6 + 8) = v17;
              if (!v17) {
                return 106;
              }
              if (*(unsigned char *)(a1 + 14) != 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 694, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
              }
              uint64_t v18 = v17;
              uint64_t v19 = *(void *)a1;
              uint64_t v20 = *(unsigned __int16 *)(a1 + 12);
              uint64_t v21 = *(unsigned __int16 *)(v6 + 2);
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
                int v22 = 0;
              }
              else
              {
                int v22 = *(unsigned __int16 *)(a1 + 10) - v20;
              }
              int v23 = *(unsigned __int16 *)(v6 + 2);
              if (v22 >= v23)
              {
                if (v21)
                {
                  uint64_t v67 = (char *)(v19 + v20);
                  uint64_t v68 = &v18[v21];
                  do
                  {
                    char v69 = *v67++;
                    *v18++ = v69;
                  }
                  while (v18 < v68);
                  int v23 = *(unsigned __int16 *)(v6 + 2);
                }
                *(_WORD *)(a1 + 12) += v23;
              }
              else
              {
                *(unsigned char *)(a1 + 15) = 1;
              }
              *(unsigned char *)(*(void *)(v6 + 8) + v23) = 0;
              *(unsigned char *)(*(unsigned __int16 *)(v6 + 2) + *(void *)(v6 + 8) + 1) = 0;
              goto LABEL_114;
            case 6u:
            case 7u:
              int v31 = sub_10017A3B8((uint64_t *)a1, v13);
              if (*(unsigned char *)(a1 + 15))
              {
                if (!sub_100058654()) {
                  goto LABEL_50;
                }
                sub_100056E24((uint64_t)"UnmarshalListElement corrupt data element", v32, v33, v34, v35, v36, v37, v38, v122);
                uint64_t v39 = sub_100050B4C(0x2Bu);
                if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_50;
                }
                goto LABEL_167;
              }
              __int16 v57 = v31;
              *(_WORD *)(v6 + 2) = 0;
              *(void *)(v6 + 8) = 0;
              if (v31)
              {
                unsigned int v58 = *(unsigned __int16 *)(a1 + 12);
                unsigned __int16 v59 = v58 + v31;
                if (v58 >= (unsigned __int16)(v58 + v31))
                {
                  unsigned __int16 v60 = 0;
                  unsigned __int16 v62 = *(_WORD *)(a1 + 12);
                }
                else
                {
                  unsigned __int16 v60 = 0;
                  char v61 = 0;
                  unsigned __int16 v62 = *(_WORD *)(a1 + 12);
                  do
                  {
                    if (*(unsigned char *)(a1 + 15)) {
                      break;
                    }
                    if (*(unsigned char *)(a1 + 14) != 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 645, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
                    }
                    if (*(unsigned __int16 *)(a1 + 10) <= v62)
                    {
                      *(unsigned char *)(a1 + 15) = 1;
                    }
                    else
                    {
                      uint64_t v63 = *(void *)a1;
                      uint64_t v64 = v62++;
                      *(_WORD *)(a1 + 12) = v62;
                      char v61 = *(unsigned char *)(v63 + v64);
                    }
                    if (v61)
                    {
                      int v65 = sub_10017A3B8((uint64_t *)a1, v61 & 7);
                      if (*(unsigned char *)(a1 + 15))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestac"
                                               "k/dataelem/marshaller.c");
                        int v66 = 0;
                      }
                      else
                      {
                        int v66 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
                      }
                      if (v66 >= v65)
                      {
                        unsigned __int16 v62 = *(_WORD *)(a1 + 12) + v65;
                        *(_WORD *)(a1 + 12) = v62;
                      }
                      else
                      {
                        *(unsigned char *)(a1 + 15) = 1;
                        unsigned __int16 v62 = *(_WORD *)(a1 + 12);
                      }
                    }
                    ++v60;
                  }
                  while (v62 < v59);
                }
                if (v62 != v59) {
                  *(unsigned char *)(a1 + 15) = 1;
                }
                if (v58 > *(unsigned __int16 *)(a1 + 10)) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 665, "(size_t)(startPos) <= (size_t)((*ByteStream).__size)");
                }
                *(_WORD *)(a1 + 12) = v58;
                if (*(unsigned char *)(a1 + 15) || !v60)
                {
                  if (sub_100058654())
                  {
                    sub_100056E24((uint64_t)"UnmarshalListElement corrupt data element", v87, v88, v89, v90, v91, v92, v93, v122);
                    uint64_t v39 = sub_100050B4C(0x2Bu);
                    uint64_t v15 = 808;
                    if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
                    {
LABEL_50:
                      int v40 = 0;
                      goto LABEL_161;
                    }
LABEL_167:
                    uint64_t v96 = sub_100050714();
                    *(_DWORD *)int buf = 136446466;
                    uint64_t v124 = v96;
                    __int16 v125 = 1024;
                    int v126 = 808;
                    _os_log_error_impl((void *)&_mh_execute_header, v39, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
                    goto LABEL_50;
                  }
                  int v40 = 0;
                  uint64_t v15 = 808;
                }
                else
                {
                  uint64_t v85 = (char *)sub_10010CE48(16 * v60 + 16);
                  if (v85)
                  {
                    uint64_t v15 = 0;
                    uint64_t v86 = &v85[16 * v60];
                    *uint64_t v86 = 33;
                    *((_WORD *)v86 + 1) = v57;
                    *((void *)v86 + 1) = v6;
                    *(_WORD *)(v6 + 2) = v60;
                    *(void *)(v6 + 8) = v85;
                    int v40 = 1;
                  }
                  else
                  {
                    int v40 = 0;
                    uint64_t v15 = 106;
                  }
                }
              }
              else
              {
                uint64_t v15 = 0;
                int v40 = 1;
              }
LABEL_161:
              if (*(_WORD *)(v6 + 2))
              {
                uint64_t v6 = *(void *)(v6 + 8);
                if (v40) {
                  continue;
                }
              }
              else if (v40)
              {
                goto LABEL_154;
              }
              return v15;
            case 0x11u:
            case 0x12u:
              unsigned int v41 = sub_10017A3B8((uint64_t *)a1, v13);
              *(_WORD *)(v6 + 2) = v41;
              if (*(unsigned char *)(a1 + 15)) {
                return v15;
              }
              uint64_t v42 = sub_100022FE8(v41);
              *(void *)(v6 + 8) = v42;
              if (!v42) {
                return 106;
              }
              if (*(unsigned char *)(a1 + 14) != 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 762, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
              }
              uint64_t v43 = v42;
              uint64_t v44 = *(void *)a1;
              uint64_t v45 = *(unsigned __int16 *)(a1 + 12);
              uint64_t v46 = *(unsigned __int16 *)(v6 + 2);
              if (*(unsigned char *)(a1 + 15))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
                int v47 = 0;
              }
              else
              {
                int v47 = *(unsigned __int16 *)(a1 + 10) - v45;
              }
              int v48 = *(unsigned __int16 *)(v6 + 2);
              if (v47 < v48) {
                goto LABEL_169;
              }
              if (v46)
              {
                uint64_t v70 = (char *)(v44 + v45);
                uint64_t v71 = &v43[v46];
                do
                {
                  char v72 = *v70++;
                  *v43++ = v72;
                }
                while (v43 < v71);
                LOWORD(v48) = *(_WORD *)(v6 + 2);
              }
              *(_WORD *)(a1 + 12) += v48;
LABEL_114:
              if (*(unsigned char *)(a1 + 15)) {
                return 808;
              }
              goto LABEL_155;
            case 0x14u:
              unsigned int v50 = sub_10017A3B8((uint64_t *)a1, v13) >> 1;
              *(_WORD *)(v6 + 2) = v50;
              if (*(unsigned char *)(a1 + 15)) {
                return v15;
              }
              int v51 = sub_100022FE8(2 * (v50 + 2));
              *(void *)(v6 + 8) = v51;
              if (!v51) {
                return 106;
              }
              if (!*(_WORD *)(v6 + 2))
              {
                unint64_t v55 = 0;
                if (*(unsigned char *)(a1 + 15)) {
                  return 808;
                }
                goto LABEL_132;
              }
              unint64_t v52 = 0;
              break;
            default:
              return v15;
          }
          break;
        default:
          goto LABEL_28;
      }
      break;
    }
    do
    {
      if (*(unsigned char *)(a1 + 14) != 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c", 733, "(*ByteStream).__RWFlag == BYTESTREAM_READ");
      }
      if (*(unsigned char *)(a1 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/dataelem/marshaller.c");
      }
      else
      {
        uint64_t v53 = *(unsigned __int16 *)(a1 + 12);
        if (*(unsigned __int16 *)(a1 + 10) - (int)v53 >= 2)
        {
          int v54 = 0;
          *(_WORD *)(*(void *)(v6 + 8) + 2 * v52) = bswap32(*(unsigned __int16 *)(*(void *)a1 + v53)) >> 16;
          *(_WORD *)(a1 + 12) += 2;
          goto LABEL_75;
        }
      }
      int v54 = 1;
      *(unsigned char *)(a1 + 15) = 1;
LABEL_75:
      ++v52;
      unint64_t v55 = *(unsigned __int16 *)(v6 + 2);
    }
    while (v52 < v55);
    if (v54) {
      return 808;
    }
LABEL_132:
    *(_WORD *)(*(void *)(v6 + 8) + 2 * v55) = 0;
LABEL_154:
    if (*(unsigned char *)(a1 + 15))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Unmarshal error", v98, v99, v100, v101, v102, v103, v104, v122);
        unsigned int v105 = sub_100050B4C(0x2Bu);
        if (os_log_type_enabled(v105, OS_LOG_TYPE_ERROR)) {
LABEL_181:
        }
          sub_100749678();
      }
      return 808;
    }
LABEL_155:
    BOOL v14 = v6 == a2;
    v6 += 16;
    if (!v14) {
      continue;
    }
    return 0;
  }
}

void sub_10017B4A4(unsigned __int8 *a1)
{
  int v2 = 0;
  char v3 = 0;
  uint64_t v4 = a1;
  uint64_t v5 = a1;
LABEL_2:
  while (2)
  {
    int v6 = v2 + 1;
    unsigned int v7 = v5;
    do
    {
      uint64_t v8 = *v7;
      if (*v7 > 7u)
      {
        if (v8 > 0x20) {
          goto LABEL_18;
        }
        if (((1 << v8) & 0x160100) != 0) {
          goto LABEL_16;
        }
        if (v8 == 19)
        {
LABEL_13:
          if (*((unsigned __int16 *)v7 + 1) < 5u) {
            goto LABEL_18;
          }
          goto LABEL_16;
        }
        if (v8 == 32) {
          sub_10025B8C0();
        }
      }
      else
      {
        if ((v8 - 1) < 3) {
          goto LABEL_13;
        }
        if ((v8 - 6) >= 2)
        {
          if (v8 != 4) {
            goto LABEL_18;
          }
LABEL_16:
          uint64_t v9 = (void *)*((void *)v7 + 1);
          if (v9)
          {
            sub_100023010(v9);
            *((void *)v7 + 1) = 0;
          }
          goto LABEL_18;
        }
        uint64_t v5 = (unsigned __int8 *)*((void *)v7 + 1);
        if (v5)
        {
          int v2 = *((unsigned __int16 *)v7 + 1) - 1;
          char v3 = 1;
          uint64_t v4 = v7;
          if (!*((_WORD *)v7 + 1)) {
            goto LABEL_21;
          }
          goto LABEL_2;
        }
      }
LABEL_18:
      v7 += 16;
      --v6;
    }
    while (v6);
    if (v3)
    {
      unsigned int v7 = v4;
LABEL_21:
      sub_100023010(*((void **)v7 + 1));
      int v2 = 0;
      char v3 = 0;
      *unsigned int v7 = 0;
      uint64_t v4 = a1;
      uint64_t v5 = a1;
      continue;
    }
    break;
  }
  *uint64_t v4 = 0;
}

uint64_t sub_10017B5D4(uint64_t a1, unsigned __int8 *a2)
{
  if (!a2) {
    sub_10025B8C0();
  }
  *a2 = 0;
  uint64_t v4 = sub_10017A6E4(a1, (uint64_t)a2, 0);
  if (v4)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_DataElement_Unmarshal error status %!", v5, v6, v7, v8, v9, v10, v11, v4);
      unsigned int v12 = sub_100050B4C(0x2Bu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_10074932C();
      }
    }
    sub_10017B4A4(a2);
  }
  return v4;
}

void sub_10017B680(unsigned __int8 *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }

  sub_10017B4A4(a1);
}

uint64_t sub_10017B6D8(uint64_t result)
{
  byte_100A04608 = result;
  return result;
}

uint64_t sub_10017B6E4()
{
  uint64_t result = sub_1000262C4();
  if (result)
  {
    sub_100199570();
    return sub_10017B728();
  }
  return result;
}

uint64_t sub_10017B728()
{
  if ((uint64_t *)qword_100A04610 == &qword_100A04610) {
    unint64_t v0 = "empty";
  }
  else {
    unint64_t v0 = "";
  }
  sub_10025B778("RequestQueue: %s\n", v0);
  for (uint64_t i = (uint64_t *)qword_100A04610; i && i != &qword_100A04610; uint64_t i = (uint64_t *)*i)
    sub_10017F094((uint64_t)(i - 5));
  if (qword_100A04628)
  {
    sub_10025B778("Current Request: ");
    uint64_t v3 = qword_100A04628;
    return sub_10017F094(v3);
  }
  else
  {
    return sub_10025B778("Current Request: none\n");
  }
}

uint64_t sub_10017B7F4(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_DEVMGR_Init: configuration parameter is deprecated", v2, v3, v4, v5, v6, v7, v8, v11);
      uint64_t v9 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10025B260(a1, 44);
  }
  if (xmmword_100A19860) {
    return 140;
  }
  qword_100A195B0 = sub_10025B218(0x2Cu);
  if (!qword_100A195B0)
  {
    sub_10025B8C0();
    if (!qword_100A195B0) {
      return 127;
    }
  }
  byte_100A04621 = 0;
  byte_100A04622 = 0;
  byte_100A04623 = 0;
  byte_100A04670 = 0;
  byte_100A195B8 = 0;
  dword_100A04808 = 0;
  off_100A04638 = 0;
  qword_100A04630 = 0;
  off_100A04648 = 0;
  qword_100A04640 = 0;
  off_100A04678 = 0;
  off_100A04680 = 0;
  off_100A04650 = 0;
  qword_100A04660 = 0;
  unk_100A04668 = 0;
  qword_100A04658[0] = 0;
  sub_10025C0F0(&qword_100A04610);
  qword_100A04628 = 0;
  byte_100A19624 = 0;
  byte_100A19625 = 0;
  byte_100A19626 = 0;
  xmmword_100A195C0 = 0u;
  unk_100A195D0 = 0u;
  xmmword_100A195E0 = 0u;
  unk_100A195F0 = 0u;
  xmmword_100A19600 = 0u;
  *(_OWORD *)&byte_100A19610 = 0u;
  dword_100A19620 = 0;
  sub_10025C0F0(&qword_100A04610);
  byte_100A04620 = 0;
  sub_100182E04();
  sub_100182268();
  sub_100183D78();
  sub_100189AD0();
  sub_100187680();
  uint64_t result = 0;
  LODWORD(xmmword_100A19860) = 1;
  return result;
}

void sub_10017B998()
{
  byte_100A04621 = 1;
}

uint64_t sub_10017B9A8()
{
  return byte_100A04621;
}

void sub_10017B9B4()
{
  byte_100A04622 = 1;
}

uint64_t sub_10017B9C4(uint64_t a1, uint64_t a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v4 = sub_100022FE8(0x38uLL);
  *uint64_t v4 = 0;
  __int16 v5 = *(_WORD *)(a2 + 4);
  v4[2] = *(_DWORD *)a2;
  *((_WORD *)v4 + 6) = v5;
  *((void *)v4 + 2) = a1;
  sub_100026C30((uint64_t)(v4 + 8));
  v4[8] += *(unsigned __int8 *)(qword_100A195B0 + 6);
  uint64_t v6 = sub_10017BC08((uint64_t)v4);
  if (v6) {
    sub_100023010(v4);
  }
  return v6;
}

uint64_t sub_10017BA68(unsigned __int16 *a1)
{
  if (!sub_100197698((uint64_t)a1)) {
    return 414;
  }
  if (sub_100181F3C(*((unsigned __int8 *)a1 + 54)))
  {
    uint64_t v2 = sub_10019304C(5);
    uint64_t v3 = sub_10019F308((uint64_t)a1, v2);
    if (v3)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_Disconnect failed (%d)", v4, v5, v6, v7, v8, v9, v10, *a1);
        uint64_t v11 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    else
    {
      *((unsigned char *)a1 + 54) = 6;
      *((_DWORD *)a1 + 37) = 0;
    }
  }
  else
  {
    if (*((_DWORD *)a1 + 37)) {
      sub_10017BD74((uint64_t)a1, 0x13u);
    }
    return 1301;
  }
  return v3;
}

uint64_t sub_10017BB4C(uint64_t a1)
{
  if (*(_DWORD *)(a1 + 148) || !sub_100026E24(*(_DWORD *)(a1 + 72))) {
    return 0;
  }
  if (byte_100A04621)
  {
    int v2 = 0;
  }
  else if (*(unsigned __int16 *)(qword_100A195B0 + 4) <= *(unsigned __int16 *)(a1 + 274))
  {
    int v2 = *(unsigned __int16 *)(a1 + 274);
  }
  else
  {
    int v2 = *(unsigned __int16 *)(qword_100A195B0 + 4);
  }
  uint64_t v3 = sub_10025BC54(*(_DWORD *)(a1 + 72), v2);
  if (v3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_Dispatch_SetFuncTimeout failed", v5, v6, v7, v8, v9, v10, v11, v13);
      unsigned int v12 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v3;
}

uint64_t sub_10017BC08(uint64_t a1)
{
  sub_10025C10C((void *)(a1 + 40), (uint64_t)&qword_100A04610);
  uint64_t v1 = sub_100026DA8((uint64_t)sub_10017C43C, 0, 0);
  if (v1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed", v2, v3, v4, v5, v6, v7, v8, v11);
      uint64_t v9 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v1;
}

uint64_t sub_10017BCA0(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (byte_100A04623) {
    return 1319;
  }
  unsigned int v2 = *(unsigned __int8 *)(a1 + 54);
  if (v2 > 6)
  {
    sub_10025B8C0();
    return 105;
  }
  else
  {
    int v3 = 1 << v2;
    if ((v3 & 0x39) != 0)
    {
      sub_100181FC8(a1);
      return 0;
    }
    else
    {
      if ((v3 & 6) != 0)
      {
        sub_10025B8C0();
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Race condition - OI_LP_ConnectionAdded request while disconnect in progress", v4, v5, v6, v7, v8, v9, v10, v12);
        uint64_t v11 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 601;
    }
  }
}

uint64_t sub_10017BD74(uint64_t a1, unsigned __int8 a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (sub_100197698(a1))
  {
    switch(*(unsigned char *)(a1 + 54))
    {
      case 0:
      case 3:
      case 4:
      case 5:
        if (*(int *)(a1 + 148) < 1)
        {
          uint64_t result = sub_100058654();
          if (result)
          {
            sub_100056E24((uint64_t)"OI_LP_DisconnectReq %: reference count == 0 ignoring disconnect request", v22, v23, v24, v25, v26, v27, v28, a1 + 48);
            __int16 v29 = sub_100050B4C(0x2Cu);
            uint64_t result = os_log_type_enabled(v29, OS_LOG_TYPE_ERROR);
            if (result) {
              goto LABEL_33;
            }
          }
        }
        else
        {
          sub_100182088(a1);
          if (*(_DWORD *)(a1 + 148)) {
            return 0;
          }
          int v4 = *(unsigned __int16 *)(a1 + 324);
          if (!*(_WORD *)(a1 + 324)) {
            int v4 = *(unsigned __int16 *)(qword_100A195B0 + 2);
          }
          uint64_t result = sub_10017C014(a1, v4, a2);
        }
        break;
      case 1:
      case 2:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_LP_DisconnectReq, connection state ST_CONNECT_IN_PROGRESS", v14, v15, v16, v17, v18, v19, v20, v46);
          uint64_t v21 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        uint64_t result = 1310;
        break;
      case 6:
        uint64_t result = sub_100058654();
        if (result)
        {
          sub_100056E24((uint64_t)"OI_LP_DisconnectReq, disconnect already in progress", v30, v31, v32, v33, v34, v35, v36, v46);
          uint64_t v37 = sub_100050B4C(0x2Cu);
          uint64_t result = os_log_type_enabled(v37, OS_LOG_TYPE_ERROR);
          if (result) {
            goto LABEL_33;
          }
        }
        break;
      case 7:
        if (*(int *)(a1 + 148) >= 1)
        {
          sub_100182088(a1);
          if (!*(_DWORD *)(a1 + 148))
          {
            sub_100253FB8(a1, 0);
            sub_10024EAD4(a1);
            sub_1001984E0((unsigned __int16 *)a1);
          }
          return 0;
        }
        uint64_t result = sub_100058654();
        if (result)
        {
          sub_100056E24((uint64_t)"OI_LP_DisconnectReq %: reference count == 0 ignoring disconnect request", v38, v39, v40, v41, v42, v43, v44, a1 + 48);
          uint64_t v45 = sub_100050B4C(0x2Cu);
          uint64_t result = os_log_type_enabled(v45, OS_LOG_TYPE_ERROR);
          if (result) {
            goto LABEL_33;
          }
        }
        break;
      default:
        sub_10025B8C0();
        uint64_t result = 105;
        break;
    }
  }
  else
  {
    uint64_t result = sub_100058654();
    if (result)
    {
      sub_100056E24((uint64_t)"OI_LP_DisconnectReq %d already released, ignoring disconnect request", v6, v7, v8, v9, v10, v11, v12, a1);
      uint64_t v13 = sub_100050B4C(0x2Cu);
      uint64_t result = os_log_type_enabled(v13, OS_LOG_TYPE_ERROR);
      if (result)
      {
LABEL_33:
        sub_100744F6C();
        return 0;
      }
    }
  }
  return result;
}

uint64_t sub_10017C014(uint64_t a1, int a2, unsigned __int8 a3)
{
  uint64_t v6 = (int *)(a1 + 72);
  if (sub_100026E24(*(_DWORD *)(a1 + 72))) {
    sub_10025B8C0();
  }
  v18[0] = a1;
  v18[1] = a3;
  v19[1] = v18;
  v19[0] = (const void *)16;
  if (a2)
  {
    if (byte_100A04621) {
      int v7 = 0;
    }
    else {
      int v7 = a2;
    }
    uint64_t v8 = sub_1000268E4((uint64_t)sub_10017F1B8, v19, v7, v6);
    if (v8)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_Dispatch_RegisterTimedFunc failed", v9, v10, v11, v12, v13, v14, v15, v18[0]);
        uint64_t v16 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
  }
  else
  {
    sub_10017F1B8((uint64_t)v19);
    return 0;
  }
  return v8;
}

uint64_t sub_10017C104(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"ForceDisconnect (%:, reason %!)", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      int v47 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v10 = sub_100197A30(a1);
  if (!v10) {
    return 1310;
  }
  uint64_t v11 = (unsigned __int16 *)v10;
  uint64_t v45 = 0;
  uint64_t v19 = 0;
  while (sub_1001990B0((uint64_t *)&v45))
  {
    uint64_t v20 = v45;
    if (v45[6] == v11)
    {
      uint64_t v21 = sub_10019304C(5u, v12, v13, v14, v15, v16, v17, v18, (uint64_t)v45);
      uint64_t v22 = sub_10019F308((uint64_t)v20, v21);
      if (v22)
      {
        uint64_t v23 = v22;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCICMD_Disconnect SCO handle %d failed", v24, v25, v26, v27, v28, v29, v30, *(unsigned __int16 *)v45);
          uint64_t v31 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
          {
            uint64_t v32 = sub_100050714();
            *(_DWORD *)int buf = 136446466;
            int v47 = v32;
            __int16 v48 = 1024;
            int v49 = v23;
            _os_log_error_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
          }
        }
        uint64_t v19 = v23;
      }
    }
  }
  uint64_t v33 = sub_10019304C(5u, v12, v13, v14, v15, v16, v17, v18, (uint64_t)v11);
  uint64_t v34 = sub_10019F308((uint64_t)v11, v33);
  if (v34)
  {
    uint64_t v35 = v34;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_Disconnect ACL handle %d failed", v36, v37, v38, v39, v40, v41, v42, *v11);
      uint64_t v43 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    return v35;
  }
  return v19;
}

uint64_t sub_10017C380(uint64_t a1)
{
  return sub_10017C104(a1);
}

uint64_t sub_10017C388()
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!byte_100A04623) {
    return 117;
  }
  byte_100A04623 = 0;
  uint64_t v0 = sub_100026DA8((uint64_t)sub_10017C43C, 0, 0);
  if (v0)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed", v1, v2, v3, v4, v5, v6, v7, v10);
      uint64_t v8 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v0;
}

uint64_t sub_10017C43C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (qword_100A04628) {
    BOOL v4 = 0;
  }
  else {
    BOOL v4 = byte_100A04623 == 0;
  }
  if (v4 && (byte_100A04670 & 1) == 0 && (uint64_t *)qword_100A04610 != &qword_100A04610)
  {
    uint64_t v5 = sub_10025C1A4((void **)&qword_100A04610);
    int v6 = *(_DWORD *)(v5 - 40);
    qword_100A04628 = v5 - 40;
    if (v6 == 2)
    {
      a1 = sub_10017F828();
    }
    else if (v6 == 1)
    {
      uint64_t v25 = 0;
      sub_100182E98(v5 - 32, &v25);
      a1 = sub_10019304C(19);
      uint64_t v15 = a1;
      if (a1)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCICMD_RemoteNameRequest on %: failed", v16, v17, v18, v19, v20, v21, v22, qword_100A04628 + 8);
          uint64_t v23 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
        a1 = sub_10017DE90(v15, 0);
      }
    }
    else if (v6)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid request type %d", v7, v8, v9, v10, v11, v12, v13, *(unsigned int *)qword_100A04628);
        uint64_t v14 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      sub_10017F9F8(1343);
      sub_10025B8C0();
    }
    else
    {
      a1 = ((uint64_t (*)(void))loc_10017F354)();
    }
  }
  return ((uint64_t (*)(uint64_t, uint64_t, uint64_t, uint64_t))loc_10017FBF4)(a1, a2, a3, a4);
}

uint64_t sub_10017C5F0(void *a1, unsigned __int16 *a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!a1) {
    return 123;
  }
  if (!byte_100A04623) {
    return 117;
  }
  if (off_100A04648)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_DevMgr_BondingDisconnect - busy with previous disconnect", v3, v4, v5, v6, v7, v8, v9, v13);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1319;
  }
  else
  {
    uint64_t result = sub_10017BA68(a2);
    if (!result)
    {
      off_100A04648 = a1;
      qword_100A04640 = (uint64_t)a2;
    }
  }
  return result;
}

uint64_t sub_10017C6C4(uint64_t result, char a2)
{
  if (xmmword_100A19860) {
    *(unsigned char *)(result + 152) = a2;
  }
  return result;
}

void sub_10017C6DC(uint64_t a1, unsigned __int16 *a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (xmmword_100A19860) {
    BOOL v5 = byte_100A04608 == 0;
  }
  else {
    BOOL v5 = 0;
  }
  if (!v5) {
    return;
  }
  uint64_t v6 = a4;
  if (a2)
  {
    BOOL v12 = a4 == 1 || (a4 & 0xFE) == 240;
    if (!a1 && v12)
    {
      byte_100A195B8 = 0;
      sub_100253C64((uint64_t)a2, a5);
    }
    if (off_100A04650) {
      off_100A04650(a1, a2, a3, v6, a5);
    }
    if (!*((unsigned char *)a2 + 2))
    {
      for (uint64_t i = 0; i != 3; ++i)
      {
        uint64_t v14 = qword_100A04658[i];
        if (v14)
        {
          uint64_t v15 = *(void (**)(uint64_t, unsigned __int16 *, uint64_t, uint64_t, uint64_t))(v14 + 8);
          if (v15) {
            v15(a1, a2, a3, v6, a5);
          }
        }
      }
    }
    if (a1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCIEventHandler_ConnectionComplete with status %!, bdaddr %:, lm 0x%x, type %d, mode %d", v16, v17, v18, v19, v20, v21, v22, a1);
        uint64_t v23 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      if (!sub_10018A0F8(a3)) {
        LODWORD(v6) = 1;
      }
      if (a1 == 711)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Controller returned CONNECTION_ALREADY_EXISTS", v24, v25, v26, v27, v28, v29, v30, v111);
          uint64_t v31 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v113 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
      }
    }
    if (*((unsigned char *)a2 + 2))
    {
      uint64_t v32 = sub_100197A30(a3);
      *((void *)a2 + 6) = v32;
      if (v32)
      {
        sub_100189D58((uint64_t)a2, a3, v6, a1);
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCI_AclConnectionFromAddr failed: (%:)", v43, v44, v45, v46, v47, v48, v49, a3);
        unsigned int v50 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
          sub_10074976C();
        }
      }
      return;
    }
    if (*((unsigned __int8 *)a2 + 54) - 1 < 2)
    {
      if (a1)
      {
        sub_10017D334((uint64_t)a2, a1);
        return;
      }
      *((unsigned char *)a2 + 278) = 0;
      if ((v6 & 0xFE) == 0xF0)
      {
        *((unsigned char *)a2 + 278) = 1;
        if (byte_100A195A0) {
          int v68 = dword_100A195A4;
        }
        else {
          int v68 = *(unsigned __int16 *)(qword_100A195B0 + 8);
        }
        *((_DWORD *)a2 + 70) = v68;
        if (sub_10017CD88((uint64_t)(a2 + 24)))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_DEVMGR_HDRChangeConnPktType", v77, v78, v79, v80, v81, v82, v83, v111);
            __int16 v84 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v84, OS_LOG_TYPE_ERROR)) {
              goto LABEL_78;
            }
          }
        }
      }
      else
      {
        uint64_t v111 = (uint64_t)a2;
        if (sub_10019304C(14))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCICMD_ChangeConnectionPacketType", v69, v70, v71, v72, v73, v74, v75, (uint64_t)a2);
            uint64_t v76 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v76, OS_LOG_TYPE_ERROR)) {
LABEL_78:
            }
              sub_100748324();
          }
        }
      }
      *((unsigned char *)a2 + 54) = 3;
      int v85 = sub_100184288((void (*)(int))sub_10017CDE8, (uint64_t)a2);
      if (v85)
      {
        int v86 = v85;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_DEVMGR_ReadRemoteExtendedFeatures", v87, v88, v89, v90, v91, v92, v93, v111);
          int v94 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v94, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
        sub_10017CDE8(v86, a3, 0);
      }
      else if (sub_1001845C8((void (*)(int))sub_10017D100, (uint64_t)a2))
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_DEVMGR_ReadRemoteVersionInformation failed with %!", v95, v96, v97, v98, v99, v100, v101, 0);
          uint64_t v102 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v102, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
      else if ((v6 & 0xFE) == 0xF0)
      {
        if (sub_10017D260((uint64_t)(a2 + 24)))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_DEVMGR_ReadProprietaryRemoteFeatures", v103, v104, v105, v106, v107, v108, v109, v111);
            uint64_t v110 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v110, OS_LOG_TYPE_ERROR)) {
              sub_100748324();
            }
          }
        }
      }
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIEventHandler_ConnectionComplete %:, inconsistent state %d, dropping connection", v51, v52, v53, v54, v55, v56, v57, a3);
      unsigned int v58 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    uint64_t v59 = sub_10019304C(5);
    if (sub_10019F308((uint64_t)a2, v59))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_Disconnect failed (%d)", v60, v61, v62, v63, v64, v65, v66, *a2);
        uint64_t v67 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v67, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    sub_100189B04((uint64_t)a2, 1348);
    *((unsigned char *)a2 + 54) = 7;
    sub_100253FB8((uint64_t)a2, 1348);
    sub_10024EAD4((uint64_t)a2);
    sub_1001DED74((uint64_t)a2, 0x544u);
    sub_10019EEE0((uint64_t)a2);
    sub_1001984E0(a2);
  }
  else
  {
    BOOL v34 = a4 == 1 || (a4 & 0xFE) == 240;
    if (a1 || !v34)
    {
      if (!a1) {
        sub_10025B8C0();
      }
      sub_100189D58(0, a3, v6, a1);
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Ignoring ConnectionComplete for %: Unknown connection handle", v35, v36, v37, v38, v39, v40, v41, a3);
      uint64_t v42 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
        sub_1007496F0();
      }
    }
  }
}

uint64_t sub_10017CD88(uint64_t a1)
{
  if (!a1) {
    return 101;
  }
  if (!sub_100197A30(a1)) {
    return 1301;
  }

  return sub_1001FE1B8();
}

void sub_10017CDE8(int a1, uint64_t a2, uint64_t *a3)
{
  uint64_t v6 = (unsigned __int16 *)sub_100197A30(a2);
  if (sub_100197698((uint64_t)v6))
  {
    int v7 = *((unsigned __int8 *)v6 + 54);
    if (v7 != 3 && v7 != 6)
    {
      sub_10025B8C0();
      int v7 = *((unsigned __int8 *)v6 + 54);
    }
    if (v7 != 6)
    {
      if (v7 == 3)
      {
        if (a1 || !a3)
        {
          *((unsigned char *)v6 + 224) = 1;
          *((unsigned char *)v6 + 227) = 1;
          return;
        }
        int v9 = *((char *)a3 + 7);
        uint64_t v10 = *a3;
        *(void *)(v6 + 129) = *a3;
        *((unsigned char *)v6 + 224) = *((unsigned char *)a3 + 3) >> 7;
        *((unsigned char *)v6 + 225) = (*((unsigned char *)a3 + 1) & 0x30) != 0;
        *((unsigned char *)v6 + 227) = *((unsigned char *)a3 + 3) & 6;
        *((unsigned char *)v6 + 226) = (v10 & 0x600380000000) == 0x80000000;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Remote classic supported features: %@", v11, v12, v13, v14, v15, v16, v17, (uint64_t)(v6 + 129));
          uint64_t v18 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v57 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        if (v9 < 0)
        {
          int v46 = sub_100184414((void (*)(int))sub_100180064, (uint64_t)v6);
          if (!v46) {
            goto LABEL_17;
          }
          int v19 = v46;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_DEVMGR_ReadRemoteExtendedFeatures", v47, v48, v49, v50, v51, v52, v53, v55);
            uint64_t v54 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
              sub_100748324();
            }
          }
        }
        else
        {
          int v19 = 102;
        }
        sub_100180064(v19, a2, 0, 0, 0);
LABEL_17:
        if (!*((_DWORD *)v6 + 37) && *(_WORD *)(qword_100A195B0 + 4))
        {
          if (*(unsigned __int16 *)(qword_100A195B0 + 4) <= v6[137]) {
            int v20 = v6[137];
          }
          else {
            int v20 = *(unsigned __int16 *)(qword_100A195B0 + 4);
          }
          if (sub_10017C014((uint64_t)v6, v20, 0x14u) && sub_100058654())
          {
            sub_100056E24((uint64_t)"postDisconnectTimeout failed", v21, v22, v23, v24, v25, v26, v27, v55);
            uint64_t v28 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
              sub_100748324();
            }
          }
        }
        return;
      }
      if (sub_100058654())
      {
        uint64_t v37 = *v6;
        sub_1001991F8(*((unsigned __int8 *)v6 + 54));
        sub_100056E24((uint64_t)"orphaned newConnectionReadFeaturesCb, handle %d, state %s", v38, v39, v40, v41, v42, v43, v44, v37);
        uint64_t v45 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"newConnectionReadFeaturesCb: connection has gone away", v29, v30, v31, v32, v33, v34, v35, v55);
    uint64_t v36 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

void sub_10017D100(uint64_t a1, uint64_t a2, char a3, __int16 a4, __int16 a5)
{
  uint64_t v9 = sub_100197A30(a2);
  if (sub_100197698(v9))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Remote classic version information: status=%!, addr=%: LMPVersion=%x, mfgrName=%x, LMPSubVersion=%x", v10, v11, v12, v13, v14, v15, v16, a1);
      uint64_t v17 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v28 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v17, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    *(_WORD *)(v9 + 20) = a4;
    *(unsigned char *)(v9 + 24) = a3;
    *(_WORD *)(v9 + 22) = a5;
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"newConnectionReadRemoteVersionInformationCb: connection has gone away", v18, v19, v20, v21, v22, v23, v24, v26);
    uint64_t v25 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

uint64_t sub_10017D260(uint64_t a1)
{
  if (!a1) {
    return 101;
  }
  if (!sub_100197A30(a1)) {
    return 1301;
  }

  return sub_1001FE12C();
}

void sub_10017D2B8(uint64_t a1, int a2, int a3)
{
  uint64_t v4 = sub_100197864(a2);
  if (sub_100197698((uint64_t)v4))
  {
    *((_DWORD *)v4 + 73) = a3;
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Device disconnected during the read of remote features. Ignoring event.", v5, v6, v7, v8, v9, v10, v11, v13);
    uint64_t v12 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10017D334(uint64_t a1, uint64_t a2)
{
  if (!a2) {
    *(unsigned char *)(a1 + 54) = 0;
  }
  if (*(unsigned char *)(a1 + 198))
  {
    *(unsigned char *)(a1 + 198) = 0;
    sub_100187790(a1);
  }
  if (qword_100A04628)
  {
    if ((*(_DWORD *)qword_100A04628 == 3 || *(_DWORD *)qword_100A04628 == 0)
      && *(_DWORD *)(a1 + 48) == *(_DWORD *)(qword_100A04628 + 8)
      && *(unsigned __int16 *)(a1 + 52) == *(unsigned __int16 *)(qword_100A04628 + 12))
    {
      sub_10017FE58(a1, a2);
      if (!a2) {
        return;
      }
      goto LABEL_18;
    }
  }
  if (sub_100197698(a1)) {
    sub_10016F9A4(a2, (int *)(a1 + 48), a1);
  }
  if (a2)
  {
LABEL_18:
    if (*(unsigned char *)(a1 + 54) != 3)
    {
      sub_100253FB8(a1, a2);
      sub_10024EAD4(a1);
      sub_1001984E0((unsigned __int16 *)a1);
    }
  }
}

void sub_10017D434(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (xmmword_100A19860)
  {
    if (!byte_100A04623)
    {
      if ((a3 & 0xFFFFFFFD) == 0)
      {
        sub_10018A6A0(a1, a2, a3);
LABEL_16:
        byte_100A04670 = 0;
        return;
      }
      if ((a3 - 240) < 2 || a3 == 1)
      {
        if (byte_100A04620)
        {
LABEL_14:
          sub_10019304C(9);
          return;
        }
        for (uint64_t i = 0; i != 384; i += 6)
        {
          uint64_t v16 = (char *)&xmmword_100A04688 + i;
          BOOL v17 = !*(_DWORD *)((char *)&xmmword_100A04688 + i) && *(_WORD *)((char *)&xmmword_100A04688 + i + 4) == 0;
          if (v17) {
            break;
          }
          int v18 = *(_DWORD *)v16;
          int v19 = *((unsigned __int16 *)v16 + 2);
          if (v18 == *(_DWORD *)a1 && v19 == *(unsigned __int16 *)(a1 + 4)) {
            goto LABEL_14;
          }
        }
        uint64_t v21 = sub_100197A30(a1);
        if (v21)
        {
          uint64_t v22 = v21;
          int v23 = *(unsigned __int8 *)(v21 + 54);
          if (v23 == 2)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Duplicate incoming connection requests detected, ignore duplicate", v40, v41, v42, v43, v44, v45, v46, v85);
              uint64_t v47 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
                sub_100745764();
              }
            }
            goto LABEL_16;
          }
          if (v23 == 1)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Overlapping Local/Remote Connection requests", v24, v25, v26, v27, v28, v29, v30, v85);
              uint64_t v31 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
                sub_100745764();
              }
            }
            byte_100A04670 = 1;
            sub_10017C6DC(1339, (unsigned __int16 *)v22, a1, a3, 0);
          }
          else
          {
            if (sub_100058654())
            {
              uint64_t v48 = sub_1001991F8(*(unsigned __int8 *)(v22 + 54));
              sub_100056E24((uint64_t)"Incoming connection requested on same handle during state %s", v49, v50, v51, v52, v53, v54, v55, (uint64_t)v48);
              uint64_t v56 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
                sub_100745764();
              }
            }
            sub_10017D8BC(0, (unsigned __int16 *)v22, 1339);
          }
        }
        uint64_t v57 = sub_100197D8C(a1, 2);
        if (v57)
        {
          uint64_t v58 = v57;
          uint64_t v59 = 0;
          char v60 = 0;
          do
          {
            while (1)
            {
              uint64_t v61 = (void (**)(uint64_t, uint64_t))qword_100A04658[v59];
              if (!v61) {
                break;
              }
              uint64_t v62 = *v61;
              if (!v62) {
                break;
              }
              v62(a1, a2);
              char v60 = 1;
              BOOL v17 = v59++ == 2;
              if (v17) {
                goto LABEL_55;
              }
            }
            ++v59;
          }
          while (v59 != 3);
          if (v60)
          {
LABEL_55:
            dword_100A195BC = a2;
            *(_DWORD *)(v58 + 48) = 0;
            *(_WORD *)(v58 + 52) = 0;
          }
          else
          {
            *(_DWORD *)(v58 + 56) = a2;
            *(unsigned char *)(v58 + 327) = 1;
            if (sub_100182230() && !*(unsigned char *)(qword_100A195B0 + 14)) {
              sub_100188C44();
            }
            if (!sub_10019304C(8))
            {
              if ((a2 & 0x1F00) == 0x100)
              {
                *(_WORD *)(v58 + 138) = *(_WORD *)(sub_10025B218(0x2Cu) + 10);
                sub_10001BDE0(49, (uint64_t)nullsub_104, v79, v80, v81, v82, v83, v84, v58);
              }
              goto LABEL_16;
            }
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"OI_HCICMD_AcceptConnectionRequest failed (%:)", v71, v72, v73, v74, v75, v76, v77, a1);
              uint64_t v78 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v78, OS_LOG_TYPE_ERROR)) {
                sub_100748324();
              }
            }
          }
          sub_1001984E0((unsigned __int16 *)v58);
          goto LABEL_16;
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Cannot accept ACL connection - connection list is full!", v63, v64, v65, v66, v67, v68, v69, v85);
          uint64_t v70 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v70, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCIEventHandler_ConnectionRequested: (%d)", v32, v33, v34, v35, v36, v37, v38, a3);
        uint64_t v39 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          sub_1007497EC();
        }
      }
    }
    if (a3 == 2) {
      uint64_t v5 = 29;
    }
    else {
      uint64_t v5 = 9;
    }
    if (sub_10019304C(v5) && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_RejectConnectionRequest failed", v6, v7, v8, v9, v10, v11, v12, a1);
      uint64_t v13 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    goto LABEL_16;
  }
}

void sub_10017D8BC(uint64_t a1, unsigned __int16 *a2, uint64_t a3)
{
  if (a2)
  {
    if (xmmword_100A19860)
    {
      if (!*((unsigned char *)a2 + 2))
      {
        for (uint64_t i = 0; i != 3; ++i)
        {
          uint64_t v7 = qword_100A04658[i];
          if (v7)
          {
            uint64_t v8 = *(void (**)(uint64_t, unsigned __int16 *, uint64_t))(v7 + 16);
            if (v8) {
              v8(a1, a2, a3);
            }
          }
        }
      }
      if (a1 == 702) {
        a3 = 702;
      }
      else {
        a3 = a3;
      }
      if (a1 == 702) {
        a1 = 0;
      }
      else {
        a1 = a1;
      }
      sub_10018AFEC(a1, (uint64_t)a2, a3);
      sub_100187CB0(1);
      if (!*((unsigned char *)a2 + 2))
      {
        if (a1)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCIEventHandler_DisconnectionComplete error (%d)", v19, v20, v21, v22, v23, v24, v25, *a2);
            uint64_t v26 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
              sub_100748324();
            }
          }
          if (*((unsigned char *)a2 + 54) == 6) {
            *((unsigned char *)a2 + 54) = 0;
          }
        }
        else
        {
          sub_100188A44((uint64_t)a2);
          sub_100253FB8((uint64_t)a2, a3);
          sub_10024EAD4((uint64_t)a2);
          if (qword_100A04628
            && !sub_100026E24(dword_100A04808)
            && (*(_DWORD *)qword_100A04628 == 3 || !*(_DWORD *)qword_100A04628)
            && *((_DWORD *)a2 + 12) == *(_DWORD *)(qword_100A04628 + 8)
            && a2[26] == *(unsigned __int16 *)(qword_100A04628 + 12))
          {
            (*(void (**)(uint64_t))(qword_100A04628 + 16))(a3);
            sub_10017F9F8(1344);
          }
          int v28 = *((_DWORD *)a2 + 12);
          unsigned __int16 v29 = a2[26];
          sub_100170424((uint64_t)a2, a3);
          sub_1001DED74((uint64_t)a2, a3);
          sub_10025D97C((uint64_t)&v28);
        }
      }
      uint64_t v9 = (void (*)(uint64_t, unsigned __int16 *))off_100A04638;
      if (off_100A04638 && (unsigned __int16 *)qword_100A04630 == a2)
      {
        off_100A04638 = 0;
        v9(a1, a2);
      }
      if (byte_100A04623)
      {
        uint64_t v10 = (void (*)(uint64_t, unsigned __int16 *))off_100A04648;
        if (off_100A04648)
        {
          if ((unsigned __int16 *)qword_100A04640 == a2)
          {
            off_100A04648 = 0;
            v10(a1, a2);
          }
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIEventHandler_DisconnectionComplete no connection handle: reason %! ignoring", v11, v12, v13, v14, v15, v16, v17, a3);
    int v18 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

uint64_t sub_10017DB50(uint64_t a1, uint64_t a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!a1) {
    return 123;
  }
  uint64_t v4 = sub_100022FE8(0x38uLL);
  *uint64_t v4 = 1;
  __int16 v5 = *(_WORD *)(a2 + 4);
  v4[2] = *(_DWORD *)a2;
  *((_WORD *)v4 + 6) = v5;
  *((void *)v4 + 2) = a1;
  *((void *)v4 + 3) = 0;
  sub_100026C30((uint64_t)(v4 + 8));
  v4[8] += *(unsigned __int8 *)(qword_100A195B0 + 6);
  uint64_t v6 = sub_10017BC08((uint64_t)v4);
  if (v6) {
    sub_100023010(v4);
  }
  return v6;
}

uint64_t sub_10017DC04(uint64_t a1, uint64_t a2, int a3, uint64_t a4)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!a1) {
    return 123;
  }
  uint64_t v8 = sub_100022FE8(0x38uLL);
  *uint64_t v8 = 1;
  __int16 v9 = *(_WORD *)(a2 + 4);
  void v8[2] = *(_DWORD *)a2;
  *((_WORD *)v8 + 6) = v9;
  *((void *)v8 + 2) = a1;
  *((void *)v8 + 3) = a4;
  sub_100026C30((uint64_t)(v8 + 8));
  v8[8] += a3;
  uint64_t v10 = sub_10017BC08((uint64_t)v8);
  if (v10) {
    sub_100023010(v8);
  }
  return v10;
}

uint64_t sub_10017DCBC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!qword_100A04628) {
    return 1359;
  }
  if (*(_DWORD *)qword_100A04628 == 1
    && *(_DWORD *)a1 == *(_DWORD *)(qword_100A04628 + 8)
    && *(unsigned __int16 *)(a1 + 4) == *(unsigned __int16 *)(qword_100A04628 + 12))
  {
    return sub_10001BDE0(20, 0, a3, a4, a5, a6, a7, a8, a1);
  }
  __int16 v9 = (uint64_t *)qword_100A04610;
  for (BOOL i = qword_100A04610 == 0; !i && v9 != &qword_100A04610; BOOL i = v9 == 0)
  {
    if (*((_DWORD *)v9 - 10) == 1
      && *(_DWORD *)a1 == *((_DWORD *)v9 - 8)
      && *(unsigned __int16 *)(a1 + 4) == *((unsigned __int16 *)v9 - 14))
    {
      uint64_t v14 = (void (*)(uint64_t, uint64_t *, void, void))*(v9 - 3);
      if (!v14)
      {
        sub_10025B8C0();
        uint64_t v14 = (void (*)(uint64_t, uint64_t *, void, void))*(v9 - 3);
      }
      v14(1362, v9 - 4, 0, *(v9 - 2));
      sub_10025C120(v9);
      return 1358;
    }
    __int16 v9 = (uint64_t *)*v9;
  }
  return 1358;
}

void sub_10017DDCC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIEventHandler_RemoteNameRequestComplete: (%:)", v6, v7, v8, v9, v10, v11, v12, a2);
      uint64_t v13 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  if (qword_100A04628
    && *(_DWORD *)qword_100A04628 == 1
    && *(_DWORD *)a2 == *(_DWORD *)(qword_100A04628 + 8)
    && *(unsigned __int16 *)(a2 + 4) == *(unsigned __int16 *)(qword_100A04628 + 12))
  {
    sub_10017DE90(a1, a3);
  }
}

uint64_t sub_10017DE90(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = qword_100A04628;
  if (!qword_100A04628)
  {
    sub_10025B8C0();
    uint64_t v4 = qword_100A04628;
  }
  if (*(_DWORD *)v4 != 1)
  {
    sub_10025B8C0();
    uint64_t v4 = qword_100A04628;
  }
  __int16 v5 = *(void (**)(uint64_t, uint64_t, uint64_t, void))(v4 + 16);
  if (!v5)
  {
    sub_10025B8C0();
    uint64_t v4 = qword_100A04628;
    __int16 v5 = *(void (**)(uint64_t, uint64_t, uint64_t, void))(qword_100A04628 + 16);
  }
  v5(a1, v4 + 8, a2, *(void *)(v4 + 24));

  return sub_10017F9F8(1346);
}

void sub_10017DF20(int a1)
{
  if (sub_100058654()
    && (uint64_t v2 = sub_10025B7F8(a1),
        sub_100056E24((uint64_t)"OI_HCIEventHandler_DataBufferOverflow, linkType %s", v3, v4, v5, v6, v7, v8, v9, (uint64_t)v2), uint64_t v10 = sub_100050B4C(0x2Cu), os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)))
  {
    sub_100744F6C();
    if (a1) {
      return;
    }
  }
  else if (a1)
  {
    return;
  }
  if (xmmword_100A19860) {
    sub_10018B1B8();
  }
}

uint64_t sub_10017DFB0()
{
  if (off_100A04680) {
    return off_100A04680();
  }
  return result;
}

uint64_t sub_10017DFC4(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (a1)
  {
    for (uint64_t i = 0; i != 3; ++i)
    {
      if (!qword_100A04658[i])
      {
        uint64_t result = 0;
        qword_100A04658[i] = a1;
        return result;
      }
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"All callbacks used up", v3, v4, v5, v6, v7, v8, v9, v20);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1317;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Extra callbacks cannot be null", v12, v13, v14, v15, v16, v17, v18, v20);
      uint64_t v19 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 101;
  }
}

uint64_t sub_10017E0B8(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  for (uint64_t i = 0; i != 3; ++i)
  {
    if (qword_100A04658[i] == a1)
    {
      uint64_t result = 0;
      qword_100A04658[i] = 0;
      return result;
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Cannot unregister extra callbacks that are not registered", v2, v3, v4, v5, v6, v7, v8, v11);
    uint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return 120;
}

uint64_t sub_10017E160(uint64_t (*a1)(void, void, void, void, void))
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (a1)
  {
    if (off_100A04650)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Extra callbacks already registered", v2, v3, v4, v5, v6, v7, v8, v19);
        uint64_t v9 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 119;
    }
    else
    {
      uint64_t result = 0;
      off_100A04650 = a1;
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Extra callbacks cannot be null", v11, v12, v13, v14, v15, v16, v17, v19);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 101;
  }
  return result;
}

uint64_t sub_10017E240(uint64_t (*a1)(void, void, void, void, void))
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (off_100A04650 == a1)
  {
    uint64_t result = 0;
    off_100A04650 = 0;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Cannot unregister extra callbacks that are not registered", v1, v2, v3, v4, v5, v6, v7, v10);
      uint64_t v8 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 120;
  }
  return result;
}

uint64_t sub_10017E2D4(uint64_t a1, uint64_t *a2)
{
  uint64_t result = 101;
  if (a1 && a2)
  {
    uint64_t v5 = sub_100197A30(a1);
    if (v5)
    {
      uint64_t v6 = v5;
      uint64_t result = 0;
      *a2 = v6;
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E328(uint64_t a1, uint64_t *a2)
{
  uint64_t result = 101;
  if (a1 && a2)
  {
    uint64_t v5 = sub_100197A88(a1);
    if (v5)
    {
      uint64_t v6 = v5;
      uint64_t result = 0;
      *a2 = v6;
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E37C(uint64_t a1, uint64_t a2)
{
  if (!a2) {
    return 101;
  }
  uint64_t v3 = a1;
  if (sub_100197698(a1))
  {
LABEL_5:
    uint64_t result = 0;
    int v5 = *(_DWORD *)(v3 + 48);
    *(_WORD *)(a2 + 4) = *(_WORD *)(v3 + 52);
    *(_DWORD *)a2 = v5;
    return result;
  }
  if (sub_100197740(v3))
  {
    uint64_t v3 = *(void *)(v3 + 48);
    goto LABEL_5;
  }
  return 1301;
}

uint64_t sub_10017E3E4(uint64_t a1, uint64_t a2)
{
  uint64_t result = 101;
  if (a1 && a2)
  {
    uint64_t v5 = sub_100197A30(a1);
    if (v5)
    {
      uint64_t v6 = v5;
      uint64_t result = 0;
      *(unsigned char *)a2 = *(unsigned char *)(v6 + 227);
      *(unsigned char *)(a2 + 1) = *(unsigned char *)(v6 + 144);
      *(unsigned char *)(a2 + 2) = *(unsigned char *)(v6 + 152);
      *(_WORD *)(a2 + 4) = *(_WORD *)(v6 + 140);
      *(_WORD *)(a2 + 6) = *(_WORD *)(v6 + 136);
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E45C(uint64_t a1, unsigned char *a2)
{
  uint64_t result = 101;
  if (a1 && a2)
  {
    uint64_t v5 = sub_100197A88(a1);
    if (v5)
    {
      uint64_t v6 = v5;
      uint64_t result = 0;
      *a2 = *(unsigned char *)(v6 + 58);
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E4B4(void *a1)
{
  if (!a1) {
    return 101;
  }
  uint64_t result = sub_1001FD57C();
  if (!result) {
    *(void *)((char *)&xmmword_100A195E0 + 4) = *a1;
  }
  return result;
}

uint64_t sub_10017E500(uint64_t a1, void *a2, void *a3)
{
  uint64_t result = 101;
  if (a1 && a2)
  {
    uint64_t v7 = sub_100197A30(a1);
    if (v7)
    {
      uint64_t v8 = (void *)v7;
      uint64_t result = 0;
      uint64_t v8 = (void *)((char *)v8 + 258);
      *a2 = *v8;
      *a3 = v8[1];
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E568(uint64_t a1, _WORD *a2, unsigned char *a3, _WORD *a4)
{
  uint64_t result = 101;
  if (a1 && a2 && a3 && a4)
  {
    uint64_t v9 = (__int16 *)sub_100197A30(a1);
    if (v9)
    {
      uint64_t v10 = v9;
      if (*v9 == -1)
      {
        return 103;
      }
      else
      {
        uint64_t result = 0;
        *a2 = v10[10];
        *a3 = *((unsigned char *)v10 + 24);
        *a4 = v10[11];
      }
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E5FC(_DWORD *a1, void *a2)
{
  uint64_t result = 101;
  if (a1 && a2)
  {
    uint64_t v5 = sub_100197B34(a1);
    if (v5)
    {
      uint64_t v6 = v5;
      uint64_t result = 0;
      *a2 = *(void *)(v6 + 170);
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E654(_DWORD *a1, _WORD *a2, unsigned char *a3, _WORD *a4)
{
  uint64_t result = 101;
  if (a1 && a2 && a3 && a4)
  {
    uint64_t v9 = sub_100197B34(a1);
    if (v9)
    {
      uint64_t v10 = v9;
      uint64_t result = 0;
      *a2 = *(_WORD *)(v10 + 20);
      *a3 = *(unsigned char *)(v10 + 24);
      *a4 = *(_WORD *)(v10 + 22);
    }
    else
    {
      return 1301;
    }
  }
  return result;
}

uint64_t sub_10017E6D4()
{
  return (BYTE4(xmmword_100A195E0) >> 5) & 1;
}

uint64_t sub_10017E6E4()
{
  return BYTE5(xmmword_100A195E0) & 1;
}

uint64_t sub_10017E6F4()
{
  return (BYTE5(xmmword_100A195E0) >> 6) & 1;
}

BOOL sub_10017E704()
{
  return (BYTE8(xmmword_100A195E0) & 6) != 0;
}

uint64_t sub_10017E718()
{
  return byte_100A195DD & 1;
}

BOOL sub_10017E728()
{
  return (dword_100A195FC & 6) != 0;
}

uint64_t sub_10017E73C()
{
  return (dword_100A195FC >> 6) & 1;
}

void sub_10017E74C(uint64_t a1)
{
  if (!*(unsigned char *)(a1 + 257)) {
    sub_10025B8C0();
  }
  *(unsigned char *)(a1 + 257) = 0;
}

uint64_t sub_10017E77C(uint64_t a1)
{
  if (a1)
  {
    uint64_t v1 = sub_100197A30(a1);
    if (v1)
    {
      uint64_t v2 = v1;
      if (sub_100058654())
      {
        uint64_t v9 = sub_1001F7D74();
        sub_100056E24((uint64_t)"Setting flush timeout, chipId:%lu", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          unsigned __int16 v29 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v17, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      return sub_10001BDE0(85, 0, v3, v4, v5, v6, v7, v8, v2);
    }
    uint64_t v18 = 1301;
  }
  else
  {
    uint64_t v18 = 101;
  }
  if (sub_100058654())
  {
    sub_1001F7D74();
    sub_100056E24((uint64_t)"Setting flush timeout skipped, status:%!, chipId:%lu", v19, v20, v21, v22, v23, v24, v25, v18);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return v18;
}

uint64_t sub_10017E8E0(uint64_t a1, int a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v4 = sub_100197A30(a1);
  if (!v4) {
    return 1301;
  }
  uint64_t v5 = v4;
  if (sub_100058654())
  {
    sub_100198D88();
    sub_100198E60();
    sub_100056E24((uint64_t)"Accept RS on single-conn for device %: enabled %d with switch-enable %d, numAcl %d, numLE %d", v6, v7, v8, v9, v10, v11, v12, a1);
    uint64_t v13 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v36 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  *(unsigned char *)(v5 + 199) = a2;
  if (!a2) {
    return 0;
  }
  if (*(_WORD *)(v5 + 138)) {
    return 0;
  }
  int v14 = sub_100198D88();
  if (sub_100198E60() + v14 > 1) {
    return 0;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Enabling Switch policy", v15, v16, v17, v18, v19, v20, v21, v34);
    uint64_t v22 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v23 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      uint64_t v36 = v23;
      _os_log_impl((void *)&_mh_execute_header, v22, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  *(_WORD *)(v5 + 138) |= 1u;
  uint64_t v24 = sub_10001BDE0(49, 0, v16, v17, v18, v19, v20, v21, v5);
  if (v24)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not write link settings to Central only %!", v25, v26, v27, v28, v29, v30, v31, v24);
      uint64_t v32 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  return v24;
}

uint64_t sub_10017EAFC(uint64_t a1, char a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v4 = sub_100197A30(a1);
  if (!v4) {
    return 1301;
  }
  uint64_t v5 = v4;
  if (sub_100058654())
  {
    sub_100198D88();
    sub_100198E60();
    sub_100056E24((uint64_t)"Disable RS on single-conn for device %: enabled %d numAcl %d, numLE %d", v6, v7, v8, v9, v10, v11, v12, a1);
    uint64_t v13 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v16 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t result = 0;
  *(unsigned char *)(v5 + 200) = a2;
  return result;
}

uint64_t sub_10017EC08(uint64_t a1, __int16 a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v4 = sub_100197A30(a1);
  if (!v4) {
    return 1301;
  }
  uint64_t v5 = v4;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Increasing disconnection timeout override for device %:", v6, v7, v8, v9, v10, v11, v12, a1);
    uint64_t v13 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v16 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t result = 0;
  *(_WORD *)(v5 + 324) = 10 * a2;
  return result;
}

uint64_t sub_10017ED08(uint64_t a1, _WORD *a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v3 = sub_100197A30(a1);
  if (!v3) {
    return 1301;
  }
  uint64_t v4 = v3;
  uint64_t result = 0;
  *a2 = *(_WORD *)(v4 + 20);
  return result;
}

uint64_t sub_10017ED58(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_DEVMGR_AddDeviceToDenylist %:", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v16 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v10 = 0;
  while (1)
  {
    uint64_t v11 = (char *)&xmmword_100A04688 + v10;
    if (!*(_DWORD *)((char *)&xmmword_100A04688 + v10) && *(_WORD *)((char *)&xmmword_100A04688 + v10 + 4) == 0) {
      break;
    }
    v10 += 6;
    if (v10 == 384) {
      return 104;
    }
  }
  uint64_t result = 0;
  int v14 = *(_DWORD *)a1;
  *((_WORD *)v11 + 2) = *(_WORD *)(a1 + 4);
  *(_DWORD *)uint64_t v11 = v14;
  return result;
}

uint64_t sub_10017EE78(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_DEVMGR_RemoveDeviceFromDenylist %:", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v19 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v10 = 0;
  while (1)
  {
    uint64_t v11 = (char *)&xmmword_100A04688 + v10;
    if (*(_DWORD *)((char *)&xmmword_100A04688 + v10) || *(_WORD *)((char *)&xmmword_100A04688 + v10 + 4) != 0)
    {
      int v13 = *(_DWORD *)v11;
      int v14 = *((unsigned __int16 *)v11 + 2);
      if (*(_DWORD *)a1 == v13 && *(unsigned __int16 *)(a1 + 4) == v14) {
        break;
      }
    }
    v10 += 6;
    if (v10 == 384) {
      return 120;
    }
  }
  uint64_t result = 0;
  uint64_t v17 = (char *)&xmmword_100A04688 + v10;
  *((_WORD *)v17 + 2) = 0;
  *(_DWORD *)uint64_t v17 = 0;
  return result;
}

void sub_10017EFB0()
{
  byte_100A04620 = 1;
}

double sub_10017EFC0()
{
  double result = 0.0;
  xmmword_100A047E8 = 0u;
  unk_100A047F8 = 0u;
  xmmword_100A047C8 = 0u;
  unk_100A047D8 = 0u;
  xmmword_100A047A8 = 0u;
  unk_100A047B8 = 0u;
  xmmword_100A04788 = 0u;
  unk_100A04798 = 0u;
  xmmword_100A04768 = 0u;
  unk_100A04778 = 0u;
  xmmword_100A04748 = 0u;
  unk_100A04758 = 0u;
  xmmword_100A04728 = 0u;
  unk_100A04738 = 0u;
  xmmword_100A04708 = 0u;
  unk_100A04718 = 0u;
  xmmword_100A046E8 = 0u;
  unk_100A046F8 = 0u;
  xmmword_100A046C8 = 0u;
  unk_100A046D8 = 0u;
  xmmword_100A046A8 = 0u;
  unk_100A046B8 = 0u;
  xmmword_100A04688 = 0u;
  unk_100A04698 = 0u;
  return result;
}

void sub_10017F000()
{
  byte_100A04620 = 0;
}

uint64_t sub_10017F00C(uint64_t result)
{
  byte_100A195A0 = result;
  return result;
}

uint64_t sub_10017F018(uint64_t result)
{
  dword_100A195A4 = result;
  return result;
}

uint64_t sub_10017F024(uint64_t result)
{
  byte_100A195A8 = result;
  return result;
}

uint64_t sub_10017F030(uint64_t result)
{
  byte_1009F9428 = result;
  return result;
}

uint64_t sub_10017F03C()
{
  return BYTE11(xmmword_100A19600);
}

uint64_t sub_10017F048(uint64_t a1, char a2)
{
  if (!a1) {
    return 101;
  }
  if (!sub_100197A30(a1)) {
    return 1301;
  }
  uint64_t result = 0;
  BYTE11(xmmword_100A19600) = a2;
  return result;
}

uint64_t sub_10017F094(uint64_t a1)
{
  uint64_t v3 = 0;
  uint64_t result = sub_100026C30((uint64_t)&v3);
  switch(*(_DWORD *)a1)
  {
    case 0:
      uint64_t result = sub_10025B778("DEVMGR_OP_ACL_CONNECT,  bdaddr: %:, now %d:%d, expires %d:%d, cb 0x%x\n", a1 + 8, v3 & 0x1FFF, SWORD2(v3), *(_DWORD *)(a1 + 32) & 0x1FFF, *(__int16 *)(a1 + 36), *(void *)(a1 + 16));
      break;
    case 1:
      uint64_t result = sub_10025B778("DEVMGR_OP_READ_NAME,    bdaddr: %:, now %d:%d, expires %d:%d, cb 0x%x\n", a1 + 8, v3 & 0x1FFF, SWORD2(v3), *(_DWORD *)(a1 + 32) & 0x1FFF, *(__int16 *)(a1 + 36), *(void *)(a1 + 16));
      break;
    case 2:
      uint64_t result = sub_10025B778("DEVMGR_OP_BOND_ENTER");
      break;
    case 3:
      uint64_t result = sub_10025B778("DEVMGR_OP_BOND_CONNECT, bdaddr: %:, now %d:%d, expires %d:%d, cb 0x%x\n", a1 + 8, v3 & 0x1FFF, SWORD2(v3), *(_DWORD *)(a1 + 32) & 0x1FFF, *(__int16 *)(a1 + 36), *(void *)(a1 + 16));
      break;
    default:
      return result;
  }
  return result;
}

void sub_10017F1B8(uint64_t a1)
{
  uint64_t v1 = *(uint64_t **)(a1 + 8);
  if (!sub_100197698(*v1)) {
    sub_10025B8C0();
  }
  if (*(_DWORD *)(*v1 + 148)) {
    return;
  }
  if (!sub_100181F3C(*(unsigned __int8 *)(*v1 + 54)))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"disconnectTimeoutCb - connection state no longer connected", v12, v13, v14, v15, v16, v17, v18, v28);
      uint64_t v19 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (sub_1002536E8(*v1) && (byte_100A04621 & 1) == 0)
  {
    if (!sub_10017C014(*v1, *(unsigned __int16 *)(qword_100A195B0 + 2), *((unsigned __int8 *)v1 + 8))) {
      return;
    }
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"postDisconnectTimeout failed", v20, v21, v22, v23, v24, v25, v26, v28);
    uint64_t v27 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_11:
    sub_100748324();
    return;
  }
  sub_100188A44(*v1);
  uint64_t v2 = *v1;
  uint64_t v3 = sub_10019304C(5);
  if (!sub_10019F308(v2, v3))
  {
    *(unsigned char *)(*v1 + 54) = 6;
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCICMD_Disconnect failed (%d)", v4, v5, v6, v7, v8, v9, v10, *(unsigned __int16 *)*v1);
    uint64_t v11 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      goto LABEL_11;
    }
  }
}

uint64_t sub_10017F828()
{
  uint64_t v0 = (_DWORD *)qword_100A04628;
  if (!qword_100A04628)
  {
    sub_10025B8C0();
    uint64_t v0 = (_DWORD *)qword_100A04628;
  }
  if (*v0 != 2) {
    sub_10025B8C0();
  }
  byte_100A04623 = 1;
  if (!sub_100181D2C()) {
    goto LABEL_15;
  }
  while (1)
  {
    if (sub_100262A50(qword_100A04628 + 32))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Enter bonding attempt deferred too long, giving up", v1, v2, v3, v4, v5, v6, v7, v32);
        uint64_t v8 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    uint64_t result = sub_1000268E4((uint64_t)sub_10017F828, 0, 1, 0);
    if (!result) {
      break;
    }
    uint64_t v10 = result;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed: %!", v11, v12, v13, v14, v15, v16, v17, v10);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10010B394(v10);
LABEL_15:
    uint64_t v19 = sub_100181CD4();
    if (!v19)
    {
      return sub_10017FF34(0);
    }
    uint64_t v20 = v19;
    uint64_t v32 = v19;
    uint64_t v21 = sub_10019304C(5);
    uint64_t v22 = sub_10019F308(v20, v21);
    if (v22)
    {
      uint64_t v23 = v22;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_Disconnect failed", v24, v25, v26, v27, v28, v29, v30, v32);
        uint64_t v31 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      return sub_10017FF34(v23);
    }
    *(unsigned char *)(v20 + 54) = 6;
  }
  return result;
}

uint64_t sub_10017F9F8(int a1)
{
  uint64_t v2 = (void *)qword_100A04628;
  int v30 = *(_DWORD *)(qword_100A04628 + 8);
  __int16 v31 = *(_WORD *)(qword_100A04628 + 12);
  if (a1 == 704)
  {
    uint64_t v3 = (uint64_t *)qword_100A04610;
    if (qword_100A04610 && qword_100A04610 != (void)&qword_100A04610)
    {
      do
      {
        if (v30 == *((_DWORD *)v3 - 8) && v31 == *((_WORD *)v3 - 14))
        {
          v29[1] = v3 - 5;
          v29[0] = 704;
          v28[1] = v29;
          v28[0] = (const void *)16;
          uint64_t v6 = sub_100026DA8((uint64_t)sub_10017FFAC, v28, 0);
          if (v6)
          {
            uint64_t v7 = v6;
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Dispatch Register failed with %!", v8, v9, v10, v11, v12, v13, v14, v7);
              uint64_t v15 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
                sub_1007498EC(&v32, &v33);
              }
            }
          }
          sub_10025C120(v3);
        }
        uint64_t v3 = (uint64_t *)*v3;
        if (v3) {
          BOOL v16 = v3 == &qword_100A04610;
        }
        else {
          BOOL v16 = 1;
        }
      }
      while (!v16);
      uint64_t v2 = (void *)qword_100A04628;
    }
  }
  sub_100023010(v2);
  qword_100A04628 = 0;
  uint64_t result = sub_100026DA8((uint64_t)sub_10017C43C, 0, 0);
  if (result)
  {
    uint64_t v18 = result;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed!", v19, v20, v21, v22, v23, v24, v25, v27);
      uint64_t v26 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10010B394(v18);
  }
  return result;
}

uint64_t sub_10017FE58(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = qword_100A04628;
  if (!qword_100A04628)
  {
    sub_10025B8C0();
    uint64_t v4 = qword_100A04628;
  }
  if (*(void *)(v4 + 16))
  {
    if (a1) {
      goto LABEL_5;
    }
  }
  else
  {
    sub_10025B8C0();
    if (a1)
    {
LABEL_5:
      if (*(_DWORD *)(a1 + 48) != *(_DWORD *)(qword_100A04628 + 8)
        || *(unsigned __int16 *)(a1 + 52) != *(unsigned __int16 *)(qword_100A04628 + 12))
      {
        sub_10025B8C0();
      }
      if (!a2) {
        goto LABEL_16;
      }
LABEL_14:
      a1 = 0;
      goto LABEL_17;
    }
  }
  if (a2) {
    goto LABEL_14;
  }
  sub_10025B8C0();
LABEL_16:
  sub_100181FC8(a1);
LABEL_17:
  if (sub_100026E24(dword_100A04808)) {
    sub_100026DB4(dword_100A04808);
  }
  (*(void (**)(uint64_t, uint64_t, uint64_t))(qword_100A04628 + 16))(a2, qword_100A04628 + 8, a1);

  return sub_10017F9F8(a2);
}

uint64_t sub_10017FF34(uint64_t a1)
{
  uint64_t v2 = qword_100A04628;
  if (!qword_100A04628)
  {
    sub_10025B8C0();
    uint64_t v2 = qword_100A04628;
  }
  if (*(_DWORD *)v2 != 2)
  {
    sub_10025B8C0();
    uint64_t v2 = qword_100A04628;
  }
  byte_100A04623 = a1 == 0;
  (*(void (**)(uint64_t))(v2 + 8))(a1);

  return sub_10017F9F8(1345);
}

void sub_10017FFAC(uint64_t a1)
{
  uint64_t v1 = *(unsigned int **)(a1 + 8);
  uint64_t v2 = *v1;
  uint64_t v3 = (void *)*((void *)v1 + 1);
  if (v3)
  {
    uint64_t v4 = (void (*)(uint64_t, void *, void))v3[2];
    if (v4) {
      v4(v2, v3 + 1, 0);
    }
    sub_100023010(v3);
  }
  else
  {
    sub_10025B8C0();
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Request is NULL, status is %!", v5, v6, v7, v8, v9, v10, v11, v2);
      uint64_t v12 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
}

void sub_100180064(int a1, uint64_t a2, int a3, uint64_t a4, void *a5)
{
  uint64_t v8 = (unsigned __int16 *)sub_100197A30(a2);
  if (sub_100197698((uint64_t)v8))
  {
    int v15 = *((unsigned __int8 *)v8 + 54);
    if (v15 != 3 && v15 != 6)
    {
      sub_10025B8C0();
      int v15 = *((unsigned __int8 *)v8 + 54);
    }
    if (v15 != 6)
    {
      if (v15 == 3)
      {
        if (!a1 && a3 == 1 && a5)
        {
          *(void *)(v8 + 133) = *a5;
          *((unsigned char *)v8 + 277) = *(unsigned char *)a5 & 1;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Remote classic extended features page 1: %@", v17, v9, v10, v11, v12, v13, v14, (uint64_t)(v8 + 133));
            uint64_t v18 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
            {
              *(_DWORD *)int buf = 136446210;
              uint64_t v49 = sub_100050714();
              _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
            }
          }
        }
        else
        {
          *((unsigned char *)v8 + 277) = 0;
        }
        uint64_t v36 = sub_10001BDE0(46, (uint64_t)sub_1001802B8, v9, v10, v11, v12, v13, v14, (uint64_t)v8);
        if (v36)
        {
          uint64_t v37 = v36;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCICMD_RoleDiscovery", v38, v39, v40, v41, v42, v43, v44, v47);
            uint64_t v45 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
              sub_100748324();
            }
          }
          sub_10018048C((uint64_t)v8, v37);
        }
        *((unsigned char *)v8 + 212) = 1;
      }
      else if (sub_100058654())
      {
        uint64_t v27 = *v8;
        sub_1001991F8(*((unsigned __int8 *)v8 + 54));
        sub_100056E24((uint64_t)"orphaned newConnectionReadExtendedFeaturesCb, handle %d, state %s", v28, v29, v30, v31, v32, v33, v34, v27);
        uint64_t v35 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"newConnectionReadExtendedFeaturesCb: connection has gone away", v19, v20, v21, v22, v23, v24, v25, v46);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

void sub_1001802B8(uint64_t a1, unsigned __int16 *a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!a2)
  {
    if (sub_100058654()
      && (sub_100056E24((uint64_t)"newConnectionReadRoleCb: connection has gone away", v21, v22, v23, v24, v25, v26, v27, v47), uint64_t v28 = sub_100050B4C(0x2Cu), os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)))
    {
      sub_100748324();
      if (a1) {
        return;
      }
    }
    else if (a1)
    {
      return;
    }
    sub_10025B8C0();
    return;
  }
  char v9 = a3;
  int v11 = *((unsigned __int8 *)a2 + 54);
  if (v11 != 3 && v11 != 6)
  {
    sub_10025B8C0();
    int v11 = *((unsigned __int8 *)a2 + 54);
  }
  if (v11 != 6)
  {
    if (v11 == 3)
    {
      if (a1)
      {
        if (!sub_100058654()) {
          goto LABEL_24;
        }
        sub_100056E24((uint64_t)"newConnectionReadRoleCb failed", v13, v14, v15, v16, v17, v18, v19, v47);
        uint64_t v20 = sub_100050B4C(0x2Cu);
        if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          goto LABEL_24;
        }
      }
      else
      {
        *((unsigned char *)a2 + 144) = v9;
        uint64_t v38 = sub_10001BDE0(49, (uint64_t)sub_100180534, a3, a4, a5, a6, a7, a8, (uint64_t)a2);
        if (!v38) {
          return;
        }
        a1 = v38;
        a2[69] = -1;
        if (!sub_100058654()) {
          goto LABEL_24;
        }
        sub_100056E24((uint64_t)"OI_HCICMD_WriteLinkPolicySettings failed", v39, v40, v41, v42, v43, v44, v45, v48);
        uint64_t v46 = sub_100050B4C(0x2Cu);
        if (!os_log_type_enabled(v46, OS_LOG_TYPE_ERROR)) {
          goto LABEL_24;
        }
      }
      sub_100748324();
LABEL_24:
      sub_10018048C((uint64_t)a2, a1);
      return;
    }
    if (sub_100058654())
    {
      uint64_t v29 = *a2;
      sub_1001991F8(*((unsigned __int8 *)a2 + 54));
      sub_100056E24((uint64_t)"orphaned newConnectionReadRoleCb, handle %d, state %s", v30, v31, v32, v33, v34, v35, v36, v29);
      uint64_t v37 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_10018048C(uint64_t a1, uint64_t a2)
{
  uint64_t v4 = sub_10019304C(5);
  if (sub_10019F308(a1, v4))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_Disconnect failed", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  sub_10017D334(a1, a2);
}

void sub_100180534(uint64_t a1, unsigned __int16 *a2)
{
  int v2 = a1;
  if (!a2)
  {
    if (sub_100058654()
      && (sub_100056E24((uint64_t)"newConnectionWritePolicyCb: connection has gone away", v4, v5, v6, v7, v8, v9, v10, v22), uint64_t v11 = sub_100050B4C(0x2Cu), os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)))
    {
      sub_100748324();
      if (v2) {
        return;
      }
    }
    else if (v2)
    {
      return;
    }
    sub_10025B8C0();
    return;
  }
  if (a1)
  {
    a2[69] = -1;
    sub_10018048C((uint64_t)a2, a1);
  }
  else
  {
    int v12 = *((unsigned __int8 *)a2 + 54);
    if (v12 != 3 && v12 != 6)
    {
      sub_10025B8C0();
      int v12 = *((unsigned __int8 *)a2 + 54);
    }
    if (v12 != 6)
    {
      if (v12 == 3)
      {
        sub_10017D334((uint64_t)a2, 0);
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Unexpected writeLinkPolicy callback, handle: %d", v14, v15, v16, v17, v18, v19, v20, *a2);
        uint64_t v21 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
}

uint64_t sub_100180684(long long *a1, uint64_t *a2, _WORD *a3)
{
  uint64_t v4 = 0;
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t v5 = *a2;
  v15[0] = 0;
  v15[1] = v5;
  long long v14 = *a1;
  unint64_t v6 = 0xF00000000;
  do
  {
    char v7 = *((unsigned char *)v15 + v4);
    *((unsigned char *)v15 + v4) = *((unsigned char *)v15 + HIDWORD(v6));
    *((unsigned char *)v15 + HIDWORD(v6)) = v7;
    ++v4;
    v6 -= 0x100000000;
  }
  while (v4 != 8);
  uint64_t v8 = 0;
  unint64_t v9 = 0xF00000000;
  do
  {
    char v10 = *((unsigned char *)&v15[-1] + v8);
    *((unsigned char *)&v15[-1] + v8) = *((unsigned char *)&v15[-1] + HIDWORD(v9));
    *((unsigned char *)&v15[-1] + HIDWORD(v9)) = v10;
    ++v8;
    v9 -= 0x100000000;
  }
  while (v8 != 8);
  uint64_t result = sub_10010BDC0(a1, 0x10uLL, v15, 0x10u, &v12, 0x10u);
  if (!result) {
    *a3 = bswap32(HIWORD(v13)) >> 16;
  }
  return result;
}

uint64_t sub_100180780(long long *a1, __int16 *a2, uint64_t a3)
{
  memset(v29, 0, sizeof(v29));
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  if (a1 && a2)
  {
    uint64_t v4 = 0;
    __int16 v30 = *a2;
    char v31 = *((unsigned char *)a2 + 2);
    long long key = *a1;
    unint64_t v5 = 0xF00000000;
    do
    {
      char v6 = v29[v4 - 8];
      v29[v4 - 8] = v29[HIDWORD(v5) - 8];
      v29[HIDWORD(v5) - 8] = v6;
      ++v4;
      v5 -= 0x100000000;
    }
    while (v4 != 8);
    uint64_t v7 = sub_10010BDC0(&key, 0x10uLL, v29, 0x10u, &v26, 0x10u);
    if (v7)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"AES128Encrypt returned %d irk:%@ r:%@", v8, v9, v10, v11, v12, v13, v14, v7);
        uint64_t v15 = sub_100050B4C(0x43u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_1007456E8();
        }
      }
    }
    else
    {
      *(_WORD *)a3 = *(_WORD *)((char *)&v27 + 5);
      *(unsigned char *)(a3 + 2) = HIBYTE(v27);
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"No IRK key available - can't run AH.", v16, v17, v18, v19, v20, v21, v22, v25);
      uint64_t v23 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4828;
  }
  return v7;
}

uint64_t sub_100180914(long long *a1, int8x16_t *a2, int8x16_t *a3, int8x16_t *a4, int8x16_t *a5, int a6, void *a7)
{
  uint64_t v9 = 0;
  int8x16_t v50 = 0uLL;
  int8x16_t v49 = 0uLL;
  int8x16_t v48 = 0uLL;
  if (!a6) {
    a4 = a5;
  }
  int8x16_t v49 = veorq_s8(*a4, *a2);
  long long key = *a1;
  unint64_t v11 = 0xF00000000;
  do
  {
    char v12 = *((unsigned char *)&key + v9);
    *((unsigned char *)&key + v9) = *((unsigned char *)&key + HIDWORD(v11));
    *((unsigned char *)&key + HIDWORD(v11)) = v12;
    ++v9;
    v11 -= 0x100000000;
  }
  while (v9 != 8);
  uint64_t v13 = 0;
  unint64_t v14 = 0xF00000000;
  do
  {
    __int8 v15 = v49.i8[v13];
    v49.i8[v13] = v49.i8[HIDWORD(v14)];
    v49.i8[HIDWORD(v14)] = v15;
    ++v13;
    v14 -= 0x100000000;
  }
  while (v13 != 8);
  uint64_t v16 = sub_10010BDC0(&key, 0x10uLL, &v49, 0x10u, &v50, 0x10u);
  if (v16)
  {
    uint64_t v17 = v16;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to run AES 128 encryption %!.", v18, v19, v20, v21, v22, v23, v24, v17);
      uint64_t v25 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    uint64_t v26 = 0;
    unint64_t v27 = 0xF00000000;
    do
    {
      __int8 v28 = v50.i8[v26];
      v50.i8[v26] = v50.i8[HIDWORD(v27)];
      v50.i8[HIDWORD(v27)] = v28;
      ++v26;
      v27 -= 0x100000000;
    }
    while (v26 != 8);
    uint64_t v29 = 0;
    int8x16_t v48 = veorq_s8(*a3, v50);
    unint64_t v30 = 0xF00000000;
    do
    {
      __int8 v31 = v48.i8[v29];
      v48.i8[v29] = v48.i8[HIDWORD(v30)];
      v48.i8[HIDWORD(v30)] = v31;
      ++v29;
      v30 -= 0x100000000;
    }
    while (v29 != 8);
    uint64_t v32 = sub_10010BDC0(&key, 0x10uLL, &v48, 0x10u, a7, 0x10u);
    if (v32)
    {
      uint64_t v17 = v32;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to run AES 128 encryption %!.", v33, v34, v35, v36, v37, v38, v39, v17);
        uint64_t v40 = sub_100050B4C(0x43u);
        if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      uint64_t v41 = 0;
      unint64_t v42 = 0xF00000000;
      do
      {
        char v43 = *((unsigned char *)a7 + v41);
        *((unsigned char *)a7 + v41) = *((unsigned char *)a7 + HIDWORD(v42));
        *((unsigned char *)a7 + HIDWORD(v42)) = v43;
        ++v41;
        v42 -= 0x100000000;
      }
      while (v41 != 8);
      uint64_t v44 = 0;
      unint64_t v45 = 0xF00000000;
      do
      {
        char v46 = *((unsigned char *)&key + v44);
        *((unsigned char *)&key + v44) = *((unsigned char *)&key + HIDWORD(v45));
        *((unsigned char *)&key + HIDWORD(v45)) = v46;
        ++v44;
        v45 -= 0x100000000;
      }
      while (v44 != 8);
      return 0;
    }
  }
  return v17;
}

uint64_t sub_100180BC0(long long *a1, uint64_t *a2, void *a3, void *a4)
{
  uint64_t v5 = *a2;
  v27[0] = *a3;
  v27[1] = v5;
  long long key = *a1;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Running S1 on key=%@, r1=%@, r2=%@, r'=%@", v6, v7, v8, v9, v10, v11, v12, (uint64_t)&key);
    uint64_t v13 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_INFO))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v25 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v13, OS_LOG_TYPE_INFO, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v14 = 0;
  unint64_t v15 = 0xF00000000;
  do
  {
    char v16 = *((unsigned char *)&v27[-1] + v14);
    *((unsigned char *)&v27[-1] + v14) = *((unsigned char *)&v27[-1] + HIDWORD(v15));
    *((unsigned char *)&v27[-1] + HIDWORD(v15)) = v16;
    ++v14;
    v15 -= 0x100000000;
  }
  while (v14 != 8);
  uint64_t v17 = 0;
  unint64_t v18 = 0xF00000000;
  do
  {
    char v19 = *((unsigned char *)v27 + v17);
    *((unsigned char *)v27 + v17) = *((unsigned char *)v27 + HIDWORD(v18));
    *((unsigned char *)v27 + HIDWORD(v18)) = v19;
    ++v17;
    v18 -= 0x100000000;
  }
  while (v17 != 8);
  uint64_t result = sub_10010BDC0(&key, 0x10uLL, v27, 0x10u, a4, 0x10u);
  if (!result)
  {
    uint64_t v21 = 0;
    unint64_t v22 = 0xF00000000;
    do
    {
      char v23 = *((unsigned char *)a4 + v21);
      *((unsigned char *)a4 + v21) = *((unsigned char *)a4 + HIDWORD(v22));
      *((unsigned char *)a4 + HIDWORD(v22)) = v23;
      ++v21;
      v22 -= 0x100000000;
    }
    while (v21 != 8);
  }
  return result;
}

uint64_t sub_100180D78(long long *a1, __int16 a2, __int16 a3, void *a4)
{
  uint64_t v5 = 0;
  int v17 = 0;
  uint64_t v16 = 0;
  char v18 = HIBYTE(a3);
  char v19 = a3;
  char v20 = HIBYTE(a2);
  char v21 = a2;
  long long v15 = *a1;
  unint64_t v6 = 0xF00000000;
  do
  {
    char v7 = *((unsigned char *)&v15 + v5);
    *((unsigned char *)&v15 + v5) = *((unsigned char *)&v15 + HIDWORD(v6));
    *((unsigned char *)&v15 + HIDWORD(v6)) = v7;
    ++v5;
    v6 -= 0x100000000;
  }
  while (v5 != 8);
  uint64_t v8 = 0;
  unint64_t v9 = 0xF00000000;
  do
  {
    char v10 = *((unsigned char *)&v16 + v8);
    *((unsigned char *)&v16 + v8) = *((unsigned char *)&v16 + HIDWORD(v9));
    *((unsigned char *)&v16 + HIDWORD(v9)) = v10;
    ++v8;
    v9 -= 0x100000000;
  }
  while (v8 != 8);
  uint64_t result = sub_10010BDC0(a1, 0x10uLL, &v16, 0x10u, a4, 0x10u);
  if (!result)
  {
    uint64_t v12 = 0;
    unint64_t v13 = 0xF00000000;
    do
    {
      char v14 = *((unsigned char *)a4 + v12);
      *((unsigned char *)a4 + v12) = *((unsigned char *)a4 + HIDWORD(v13));
      *((unsigned char *)a4 + HIDWORD(v13)) = v14;
      ++v12;
      v13 -= 0x100000000;
    }
    while (v12 != 8);
  }
  return result;
}

uint64_t sub_100180EA8(_OWORD *a1, _OWORD *a2, long long *a3, char a4, void *a5)
{
  uint64_t v6 = 0;
  long long v7 = a1[1];
  v22[0] = *a1;
  v22[1] = v7;
  long long v8 = a2[1];
  v23[0] = *a2;
  v23[1] = v8;
  char v24 = a4;
  unint64_t v9 = 0x1F00000000;
  do
  {
    char v10 = *((unsigned char *)v22 + v6);
    *((unsigned char *)v22 + v6) = *((unsigned char *)v22 + HIDWORD(v9));
    *((unsigned char *)v22 + HIDWORD(v9)) = v10;
    ++v6;
    v9 -= 0x100000000;
  }
  while (v6 != 16);
  unint64_t v11 = 0x1F00000000;
  for (uint64_t i = 32; i != 48; ++i)
  {
    char v13 = *((unsigned char *)v22 + i);
    *((unsigned char *)v22 + i) = *((unsigned char *)v23 + HIDWORD(v11));
    *((unsigned char *)v23 + HIDWORD(v11)) = v13;
    v11 -= 0x100000000;
  }
  uint64_t v14 = 0;
  long long v21 = *a3;
  unint64_t v15 = 0xF00000000;
  do
  {
    char v16 = *((unsigned char *)&v22[-1] + v14);
    *((unsigned char *)&v22[-1] + v14) = *((unsigned char *)&v22[-1] + HIDWORD(v15));
    *((unsigned char *)&v22[-1] + HIDWORD(v15)) = v16;
    ++v14;
    v15 -= 0x100000000;
  }
  while (v14 != 8);
  uint64_t result = sub_10010BFB0(&v21, 0x10uLL, v22, 0x41u, a5, 0x10u);
  if (!result)
  {
    uint64_t v18 = 0;
    unint64_t v19 = 0xF00000000;
    do
    {
      char v20 = *((unsigned char *)a5 + v18);
      *((unsigned char *)a5 + v18) = *((unsigned char *)a5 + HIDWORD(v19));
      *((unsigned char *)a5 + HIDWORD(v19)) = v20;
      ++v18;
      v19 -= 0x100000000;
    }
    while (v18 != 8);
  }
  return result;
}

uint64_t sub_100181008(_OWORD *a1, _OWORD *a2, _OWORD *a3, int a4, uint64_t a5, uint64_t a6, char *a7, int a8)
{
  if (a8 != 32) {
    return 101;
  }
  uint64_t v14 = 0;
  uint64_t v27 = 0;
  v28[0] = 0;
  *(void *)((char *)v28 + 5) = 0;
  long long v15 = a1[1];
  v26[0] = *a1;
  v26[1] = v15;
  unint64_t v16 = 0x1F00000000;
  do
  {
    char v17 = *((unsigned char *)v26 + v14);
    *((unsigned char *)v26 + v14) = *((unsigned char *)v26 + HIDWORD(v16));
    *((unsigned char *)v26 + HIDWORD(v16)) = v17;
    ++v14;
    v16 -= 0x100000000;
  }
  while (v14 != 16);
  v29[0] = 0;
  v29[1] = 0;
  if (sub_10010BFB0(&unk_1007BA0D8, 0x10uLL, v26, 0x20u, v29, 0x10u)) {
    return 4829;
  }
  sub_1001811EC((uint64_t)v26, 0, a4, a2, a3, a5, a6);
  if (!sub_10010BFB0(v29, 0x10uLL, v26, 0x35u, a7, 0x10u))
  {
    uint64_t v19 = 0;
    unint64_t v20 = 0xF00000000;
    do
    {
      char v21 = a7[v19];
      a7[v19] = a7[HIDWORD(v20)];
      a7[HIDWORD(v20)] = v21;
      ++v19;
      v20 -= 0x100000000;
    }
    while (v19 != 8);
  }
  sub_1001811EC((uint64_t)v26, 1, a4, a2, a3, a5, a6);
  unint64_t v22 = a7 + 16;
  uint64_t result = sub_10010BFB0(v29, 0x10uLL, v26, 0x35u, v22, 0x10u);
  if (!result)
  {
    uint64_t v23 = 0;
    unint64_t v24 = 0xF00000000;
    do
    {
      char v25 = *((unsigned char *)v22 + v23);
      *((unsigned char *)v22 + v23) = *((unsigned char *)v22 + HIDWORD(v24));
      *((unsigned char *)v22 + HIDWORD(v24)) = v25;
      ++v23;
      v24 -= 0x100000000;
    }
    while (v23 != 8);
    return 0;
  }
  return result;
}

uint64_t sub_1001811EC(uint64_t result, char a2, int a3, _OWORD *a4, _OWORD *a5, uint64_t a6, uint64_t a7)
{
  uint64_t v7 = 0;
  *(unsigned char *)uint64_t result = a2;
  *(unsigned char *)(result + 1) = HIBYTE(a3);
  *(unsigned char *)(result + 2) = BYTE2(a3);
  *(unsigned char *)(result + 3) = BYTE1(a3);
  *(unsigned char *)(result + 4) = a3;
  uint64_t v8 = result + 5;
  *(_OWORD *)(result + 5) = *a4;
  uint64_t v9 = result + 21;
  *(_OWORD *)(result + 21) = *a5;
  *(unsigned char *)(result + 37) = *(unsigned char *)a6;
  int v10 = *(_DWORD *)(a6 + 1);
  *(_WORD *)(result + 42) = *(_WORD *)(a6 + 5);
  *(_DWORD *)(result + 38) = v10;
  *(unsigned char *)(result + 44) = *(unsigned char *)a7;
  int v11 = *(_DWORD *)(a7 + 1);
  *(_WORD *)(result + 49) = *(_WORD *)(a7 + 5);
  *(_DWORD *)(result + 45) = v11;
  *(_WORD *)(result + 51) = 1;
  unint64_t v12 = 0xF00000000;
  do
  {
    char v13 = *(unsigned char *)(v8 + v7);
    *(unsigned char *)(v8 + v7) = *(unsigned char *)(v8 + HIDWORD(v12));
    *(unsigned char *)(v8 + HIDWORD(v12)) = v13;
    ++v7;
    v12 -= 0x100000000;
  }
  while (v7 != 8);
  uint64_t v14 = 0;
  unint64_t v15 = 0xF00000000;
  do
  {
    char v16 = *(unsigned char *)(v9 + v14);
    *(unsigned char *)(v9 + v14) = *(unsigned char *)(v9 + HIDWORD(v15));
    *(unsigned char *)(v9 + HIDWORD(v15)) = v16;
    ++v14;
    v15 -= 0x100000000;
  }
  while (v14 != 8);
  return result;
}

uint64_t sub_1001812C0(long long *a1, long long *a2, long long *a3, long long *a4, __int16 *a5, char *a6, char *a7, void *a8)
{
  uint64_t v9 = 0;
  long long v10 = *a3;
  long long v28 = *a2;
  long long v29 = v10;
  long long v11 = *a4;
  __int16 v31 = *a5;
  long long v30 = v11;
  char v32 = *((unsigned char *)a5 + 2);
  char v33 = *a6;
  __int16 v35 = *(_WORD *)(a6 + 5);
  int v34 = *(_DWORD *)(a6 + 1);
  char v36 = *a7;
  int v37 = *(_DWORD *)(a7 + 1);
  unint64_t v12 = 0xF00000000;
  __int16 v38 = *(_WORD *)(a7 + 5);
  do
  {
    char v13 = *((unsigned char *)&v28 + v9);
    *((unsigned char *)&v28 + v9) = *((unsigned char *)&v28 + HIDWORD(v12));
    *((unsigned char *)&v28 + HIDWORD(v12)) = v13;
    ++v9;
    v12 -= 0x100000000;
  }
  while (v9 != 8);
  unint64_t v14 = 0xF00000000;
  for (uint64_t i = 16; i != 24; ++i)
  {
    char v16 = *((unsigned char *)&v28 + i);
    *((unsigned char *)&v28 + i) = *((unsigned char *)&v29 + HIDWORD(v14));
    *((unsigned char *)&v29 + HIDWORD(v14)) = v16;
    v14 -= 0x100000000;
  }
  unint64_t v17 = 0xF00000000;
  for (uint64_t j = 32; j != 40; ++j)
  {
    char v19 = *((unsigned char *)&v28 + j);
    *((unsigned char *)&v28 + j) = *((unsigned char *)&v30 + HIDWORD(v17));
    *((unsigned char *)&v30 + HIDWORD(v17)) = v19;
    v17 -= 0x100000000;
  }
  uint64_t v20 = 0;
  long long v27 = 0uLL;
  long long v27 = *a1;
  unint64_t v21 = 0xF00000000;
  do
  {
    char v22 = *((unsigned char *)&v27 + v20);
    *((unsigned char *)&v27 + v20) = *((unsigned char *)&v27 + HIDWORD(v21));
    *((unsigned char *)&v27 + HIDWORD(v21)) = v22;
    ++v20;
    v21 -= 0x100000000;
  }
  while (v20 != 8);
  uint64_t result = sub_10010BFB0(&v27, 0x10uLL, &v28, 0x41u, a8, 0x10u);
  if (!result)
  {
    uint64_t v24 = 0;
    unint64_t v25 = 0xF00000000;
    do
    {
      char v26 = *((unsigned char *)a8 + v24);
      *((unsigned char *)a8 + v24) = *((unsigned char *)a8 + HIDWORD(v25));
      *((unsigned char *)a8 + HIDWORD(v25)) = v26;
      ++v24;
      v25 -= 0x100000000;
    }
    while (v24 != 8);
  }
  return result;
}

uint8x8_t sub_10018149C(_OWORD *a1, _OWORD *a2, long long *a3, long long *a4, _DWORD *a5)
{
  uint64_t v6 = 0;
  long long v7 = a1[1];
  v25[0] = *a1;
  v25[1] = v7;
  long long v8 = a2[1];
  v26[0] = *a2;
  v26[1] = v8;
  long long v27 = *a4;
  unint64_t v9 = 0x1F00000000;
  do
  {
    char v10 = *((unsigned char *)v25 + v6);
    *((unsigned char *)v25 + v6) = *((unsigned char *)v25 + HIDWORD(v9));
    *((unsigned char *)v25 + HIDWORD(v9)) = v10;
    ++v6;
    v9 -= 0x100000000;
  }
  while (v6 != 16);
  unint64_t v11 = 0x1F00000000;
  for (uint64_t i = 32; i != 48; ++i)
  {
    char v13 = *((unsigned char *)v25 + i);
    *((unsigned char *)v25 + i) = *((unsigned char *)v26 + HIDWORD(v11));
    *((unsigned char *)v26 + HIDWORD(v11)) = v13;
    v11 -= 0x100000000;
  }
  unint64_t v14 = 0xF00000000;
  for (uint64_t j = 64; j != 72; ++j)
  {
    char v16 = *((unsigned char *)v25 + j);
    *((unsigned char *)v25 + j) = *((unsigned char *)&v27 + HIDWORD(v14));
    *((unsigned char *)&v27 + HIDWORD(v14)) = v16;
    v14 -= 0x100000000;
  }
  uint64_t v17 = 0;
  long long v22 = *a3;
  unint64_t v18 = 0xF00000000;
  do
  {
    char v19 = *((unsigned char *)&v22 + v17);
    *((unsigned char *)&v22 + v17) = *((unsigned char *)&v22 + HIDWORD(v18));
    *((unsigned char *)&v22 + HIDWORD(v18)) = v19;
    ++v17;
    v18 -= 0x100000000;
  }
  while (v17 != 8);
  uint64_t v23 = 0;
  uint64_t v24 = 0;
  if (!sub_10010BFB0(&v22, 0x10uLL, v25, 0x50u, &v23, 0x10u))
  {
    result.i32[0] = HIDWORD(v24);
    int16x8_t v21 = (int16x8_t)vmovl_u8(result);
    *(int16x4_t *)v21.i8 = vrev64_s16(*(int16x4_t *)v21.i8);
    uint8x8_t result = (uint8x8_t)vmovn_s16(v21);
    *a5 = result.i32[0];
  }
  return result;
}

uint64_t sub_100181620(long long *a1, unsigned int a2, void *a3)
{
  uint64_t v4 = 0;
  long long v21 = *a1;
  unint64_t v5 = 0xF00000000;
  do
  {
    char v6 = *((unsigned char *)&v21 + v4);
    *((unsigned char *)&v21 + v4) = *((unsigned char *)&v21 + HIDWORD(v5));
    *((unsigned char *)&v21 + HIDWORD(v5)) = v6;
    ++v4;
    v5 -= 0x100000000;
  }
  while (v4 != 8);
  unsigned int v20 = bswap32(a2);
  uint64_t v7 = sub_10010BFB0(&v21, 0x10uLL, &v20, 4u, a3, 0x10u);
  if (v7)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed h6() with error %!", v8, v9, v10, v11, v12, v13, v14, v7);
      unint64_t v15 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  uint64_t v16 = 0;
  unint64_t v17 = 0xF00000000;
  do
  {
    char v18 = *((unsigned char *)a3 + v16);
    *((unsigned char *)a3 + v16) = *((unsigned char *)a3 + HIDWORD(v17));
    *((unsigned char *)a3 + HIDWORD(v17)) = v18;
    ++v16;
    v17 -= 0x100000000;
  }
  while (v16 != 8);
  return v7;
}

uint64_t sub_10018175C(long long *a1, long long *a2, void *a3)
{
  uint64_t v4 = 0;
  long long v24 = *a1;
  unint64_t v5 = 0xF00000000;
  do
  {
    char v6 = *((unsigned char *)&v24 + v4);
    *((unsigned char *)&v24 + v4) = *((unsigned char *)&v24 + HIDWORD(v5));
    *((unsigned char *)&v24 + HIDWORD(v5)) = v6;
    ++v4;
    v5 -= 0x100000000;
  }
  while (v4 != 8);
  uint64_t v7 = 0;
  long long v23 = *a2;
  unint64_t v8 = 0xF00000000;
  do
  {
    char v9 = *((unsigned char *)&v23 + v7);
    *((unsigned char *)&v23 + v7) = *((unsigned char *)&v23 + HIDWORD(v8));
    *((unsigned char *)&v23 + HIDWORD(v8)) = v9;
    ++v7;
    v8 -= 0x100000000;
  }
  while (v7 != 8);
  uint64_t v10 = sub_10010BFB0(&v23, 0x10uLL, &v24, 0x10u, a3, 0x10u);
  if (v10)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed h7() with error %!", v11, v12, v13, v14, v15, v16, v17, v10);
      char v18 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  uint64_t v19 = 0;
  unint64_t v20 = 0xF00000000;
  do
  {
    char v21 = *((unsigned char *)a3 + v19);
    *((unsigned char *)a3 + v19) = *((unsigned char *)a3 + HIDWORD(v20));
    *((unsigned char *)a3 + HIDWORD(v20)) = v21;
    ++v19;
    v20 -= 0x100000000;
  }
  while (v19 != 8);
  return v10;
}

uint64_t sub_1001818CC(_OWORD *a1, _OWORD *a2)
{
  uint64_t v4 = sub_10010C494(a1, a2);
  if (v4)
  {
    uint64_t v5 = v4;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to generate public/private key %!", v6, v7, v8, v9, v10, v11, v12, v5);
      uint64_t v13 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_1007456E8();
      }
    }
  }
  else
  {
    uint64_t v14 = 0;
    unint64_t v15 = 0x1F00000000;
    do
    {
      char v16 = *((unsigned char *)a2 + v14);
      *((unsigned char *)a2 + v14) = *((unsigned char *)a2 + HIDWORD(v15));
      *((unsigned char *)a2 + HIDWORD(v15)) = v16;
      ++v14;
      v15 -= 0x100000000;
    }
    while (v14 != 16);
    uint64_t v17 = 0;
    char v18 = a2 + 2;
    unint64_t v19 = 0x1F00000000;
    do
    {
      char v20 = *((unsigned char *)v18 + v17);
      *((unsigned char *)v18 + v17) = *((unsigned char *)v18 + HIDWORD(v19));
      *((unsigned char *)v18 + HIDWORD(v19)) = v20;
      ++v17;
      v19 -= 0x100000000;
    }
    while (v17 != 16);
    uint64_t v21 = 0;
    long long v22 = a2 + 4;
    unint64_t v23 = 0x1F00000000;
    do
    {
      char v24 = *((unsigned char *)v22 + v21);
      *((unsigned char *)v22 + v21) = *((unsigned char *)v22 + HIDWORD(v23));
      *((unsigned char *)v22 + HIDWORD(v23)) = v24;
      ++v21;
      v23 -= 0x100000000;
    }
    while (v21 != 16);
    uint64_t v25 = 0;
    unint64_t v26 = 0x1F00000000;
    do
    {
      char v27 = *((unsigned char *)a1 + v25);
      *((unsigned char *)a1 + v25) = *((unsigned char *)a1 + HIDWORD(v26));
      *((unsigned char *)a1 + HIDWORD(v26)) = v27;
      ++v25;
      v26 -= 0x100000000;
    }
    while (v25 != 16);
    uint64_t v28 = 0;
    long long v29 = a1 + 2;
    unint64_t v30 = 0x1F00000000;
    do
    {
      char v31 = *((unsigned char *)v29 + v28);
      *((unsigned char *)v29 + v28) = *((unsigned char *)v29 + HIDWORD(v30));
      *((unsigned char *)v29 + HIDWORD(v30)) = v31;
      ++v28;
      v30 -= 0x100000000;
    }
    while (v28 != 16);
    return 0;
  }
  return v5;
}

uint64_t sub_100181A54(const void *a1, unsigned int a2, const void *a3, unsigned int a4, void *a5)
{
  size_t v10 = a2;
  __chkstk_darwin();
  uint64_t v12 = (char *)&v39 - v11;
  bzero((char *)&v39 - v11, v10);
  __chkstk_darwin();
  uint64_t v14 = (char *)&v39 - v13;
  bzero((char *)&v39 - v13, a4);
  memmove(v12, a1, v10);
  uint64_t v15 = 0;
  unint64_t v16 = 0x1F00000000;
  do
  {
    char v17 = v12[v15];
    v12[v15] = v12[HIDWORD(v16)];
    v12[HIDWORD(v16)] = v17;
    ++v15;
    v16 -= 0x100000000;
  }
  while (v15 != 16);
  char v18 = v12 + 32;
  unint64_t v19 = 0x1F00000000;
  for (uint64_t i = 32; i != 48; ++i)
  {
    char v21 = v12[i];
    v12[i] = v18[HIDWORD(v19)];
    v18[HIDWORD(v19)] = v21;
    v19 -= 0x100000000;
  }
  memmove(v14, a3, a4);
  uint64_t v22 = 0;
  unint64_t v23 = 0x1F00000000;
  do
  {
    char v24 = v14[v22];
    v14[v22] = v14[HIDWORD(v23)];
    v14[HIDWORD(v23)] = v24;
    ++v22;
    v23 -= 0x100000000;
  }
  while (v22 != 16);
  uint64_t v25 = v14 + 32;
  unint64_t v26 = 0x1F00000000;
  for (uint64_t j = 32; j != 48; ++j)
  {
    char v28 = v14[j];
    v14[j] = v25[HIDWORD(v26)];
    v25[HIDWORD(v26)] = v28;
    v26 -= 0x100000000;
  }
  long long v29 = v14 + 64;
  unint64_t v30 = 0x1F00000000;
  for (uint64_t k = 64; k != 80; ++k)
  {
    char v32 = v14[k];
    v14[k] = v29[HIDWORD(v30)];
    v29[HIDWORD(v30)] = v32;
    v30 -= 0x100000000;
  }
  uint64_t v33 = sub_10010C29C((uint64_t)v12, a2, (uint64_t)v14, a4, a5);
  if (v33)
  {
    uint64_t v34 = v33;
    sub_10025B778("Error: DHKey generation failed %!", v33);
  }
  else
  {
    uint64_t v35 = 0;
    unint64_t v36 = 0x1F00000000;
    do
    {
      char v37 = *((unsigned char *)a5 + v35);
      *((unsigned char *)a5 + v35) = *((unsigned char *)a5 + HIDWORD(v36));
      *((unsigned char *)a5 + HIDWORD(v36)) = v37;
      ++v35;
      v36 -= 0x100000000;
    }
    while (v35 != 16);
    return 0;
  }
  return v34;
}

uint64_t sub_100181CD4()
{
  uint64_t v2 = 0;
  BOOL v0 = sub_100198DE0(&v2);
  uint64_t result = 0;
  if (v0)
  {
    while (1)
    {
      uint64_t result = v2;
      if (!*(_DWORD *)(v2 + 148) && !*(unsigned char *)(v2 + 54)) {
        break;
      }
      if (!sub_100198DE0(&v2)) {
        return 0;
      }
    }
  }
  return result;
}

BOOL sub_100181D2C()
{
  uint64_t v3 = 0;
  BOOL result = sub_100198DE0(&v3);
  if (result)
  {
    do
    {
      int v1 = *(unsigned __int8 *)(v3 + 54);
      if (v1 != 7 && v1 != 0) {
        return 1;
      }
    }
    while (sub_100198DE0(&v3));
    return 0;
  }
  return result;
}

uint64_t sub_100181D84(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 0;
  }
  uint64_t result = sub_100197A30(a1);
  if (result) {
    return *(unsigned char *)(result + 144) == 0;
  }
  return result;
}

uint64_t sub_100181DC4(uint64_t a1, unsigned char *a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v3 = sub_100197A30(a1);
  if (!v3) {
    return 1301;
  }
  uint64_t v4 = v3;
  uint64_t result = 0;
  *a2 = *(unsigned char *)(v4 + 152) & 0x7F;
  return result;
}

uint64_t sub_100181E20(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 0;
  }
  uint64_t v6 = 0;
  if (sub_100182E98(a1, &v6)) {
    unsigned int v2 = *(_DWORD *)(v6 + 8);
  }
  else {
    unsigned int v2 = 0;
  }
  uint64_t v4 = sub_100197A30(a1);
  if (v4) {
    unsigned int v5 = *(_DWORD *)(v4 + 56);
  }
  else {
    unsigned int v5 = 0;
  }
  if (v2) {
    return v2;
  }
  else {
    return v5;
  }
}

uint64_t sub_100181EA0(uint64_t a1, int a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v13 = 0;
  uint64_t result = sub_10017E2D4(a1, &v13);
  if (!result)
  {
    if ((a2 & 0x1FFC) == 0 && sub_100058654())
    {
      sub_100056E24((uint64_t)"SetRemoteDeviceClass is zero !!!!!!", v4, v5, v6, v7, v8, v9, v10, v12);
      uint64_t v11 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t result = 0;
    *(_DWORD *)(v13 + 56) = a2;
  }
  return result;
}

uint64_t sub_100181F3C(uint64_t a1)
{
  if (a1 < 8) {
    return (0x39u >> a1) & 1;
  }
  sub_10025B8C0();
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"unknown connection state %d", v3, v4, v5, v6, v7, v8, v9, a1);
    uint64_t v10 = sub_100050B4C(0x2Cu);
    uint64_t result = os_log_type_enabled(v10, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100744F6C();
      return 0;
    }
  }
  return result;
}

void sub_100181FC8(uint64_t a1)
{
  if ((sub_100181F3C(*(unsigned __int8 *)(a1 + 54)) & 1) == 0) {
    sub_10025B8C0();
  }
  uint64_t v2 = *(unsigned int *)(a1 + 72);
  if (*(_DWORD *)(a1 + 148))
  {
    if (sub_100026E24(v2)) {
      sub_10025B8C0();
    }
  }
  else
  {
    sub_100026DB4(v2);
    *(_DWORD *)(a1 + 72) = 0;
  }
  if (*(int *)(a1 + 148) < 255)
  {
    atomic_fetch_add_explicit((atomic_uint *volatile)(a1 + 148), 1u, memory_order_relaxed);
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Reached max connection retain count. Not incrementing ref count", v3, v4, v5, v6, v7, v8, v9, v11);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (*(int *)(a1 + 148) <= 254) {
      sub_10025B8C0();
    }
  }
}

void sub_100182088(uint64_t a1)
{
  int v2 = *(_DWORD *)(a1 + 148);
  if (v2 < 255)
  {
    if (v2)
    {
      atomic_fetch_add_explicit((atomic_uint *volatile)(a1 + 148), 0xFFFFFFFF, memory_order_relaxed);
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Device attempted to decrement when reference count is already zero", v11, v12, v13, v14, v15, v16, v17, v19);
      char v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Reached max connection retain count. Not decrementing ref count", v3, v4, v5, v6, v7, v8, v9, v19);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (*(int *)(a1 + 148) <= 254) {
      sub_10025B8C0();
    }
  }
}

uint64_t sub_10018215C()
{
  uint64_t v3 = 0;
  uint64_t v4 = 0;
  if (sub_100198DE0(&v4))
  {
    unsigned int v0 = 0;
    int v1 = 0;
    do
    {
      if (!*(unsigned char *)(v4 + 54))
      {
        if (*(unsigned char *)(v4 + 144)) {
          ++v0;
        }
        else {
          ++v1;
        }
      }
    }
    while (sub_100198DE0(&v4));
  }
  else
  {
    int v1 = 0;
    unsigned int v0 = 0;
  }
  while (sub_100198EB8(&v3))
  {
    if (*(unsigned char *)(v3 + 124) != 7)
    {
      if (*(unsigned char *)(v3 + 70)) {
        ++v0;
      }
      else {
        ++v1;
      }
    }
  }
  if (v1) {
    return v0 + 1;
  }
  else {
    return v0;
  }
}

BOOL sub_10018220C(uint64_t a1)
{
  return *(unsigned char *)(a1 + 144) == 1 && *(unsigned char *)(a1 + 226);
}

BOOL sub_100182230()
{
  unsigned int v0 = *(unsigned __int8 *)(qword_100A195B0 + 12);
  return sub_10018215C() < v0;
}

double sub_100182268()
{
  off_100A04870 = 0;
  double result = 0.0;
  xmmword_100A04850 = 0u;
  *(_OWORD *)&qword_100A04860 = 0u;
  xmmword_100A04830 = 0u;
  *(_OWORD *)&qword_100A04840 = 0u;
  xmmword_100A04810 = 0u;
  *(_OWORD *)&qword_100A04820 = 0u;
  return result;
}

uint64_t sub_100182288(uint64_t a1, void **a2, uint64_t a3)
{
  uint64_t v6 = *(unsigned __int8 *)(qword_100A195B0 + 7);
  if (a1)
  {
    if (*(unsigned char *)(qword_100A195B0 + 7)) {
      goto LABEL_3;
    }
LABEL_14:
    sub_10025B8C0();
    if (a2) {
      goto LABEL_4;
    }
    goto LABEL_15;
  }
  sub_10025B8C0();
  if (!v6) {
    goto LABEL_14;
  }
LABEL_3:
  if (a2) {
    goto LABEL_4;
  }
LABEL_15:
  sub_10025B8C0();
LABEL_4:
  uint64_t v7 = *a2;
  if (*a2)
  {
    if (!v6) {
      return 1317;
    }
    uint64_t v8 = 0;
    LODWORD(v9) = 0;
    do
    {
      if (v7[v8] == a1) {
        uint64_t v9 = 1316;
      }
      else {
        uint64_t v9 = v9;
      }
      v8 += 2;
    }
    while (2 * v6 != v8);
    if (v9) {
      return v9;
    }
  }
  else
  {
    uint64_t v7 = sub_10010CE48(16 * v6);
    *a2 = v7;
    if (!v7) {
      return 106;
    }
  }
  if (!v6) {
    return 1317;
  }
  unsigned int v10 = 0;
  while (*v7)
  {
    ++v10;
    v7 += 2;
    if (v10 >= v6) {
      return 1317;
    }
  }
  uint64_t v9 = 0;
  *uint64_t v7 = a1;
  v7[1] = a3;
  return v9;
}

uint64_t sub_100182374(uint64_t a1, void **a2)
{
  uint64_t v4 = *(unsigned __int8 *)(qword_100A195B0 + 7);
  uint64_t v5 = *a2;
  if (!a1)
  {
    sub_10025B8C0();
    if (v4) {
      goto LABEL_3;
    }
LABEL_15:
    sub_10025B8C0();
    if (!v5) {
      return 1318;
    }
    int v7 = 0;
    goto LABEL_17;
  }
  if (!*(unsigned char *)(qword_100A195B0 + 7)) {
    goto LABEL_15;
  }
LABEL_3:
  if (!v5) {
    return 1318;
  }
  int v6 = 0;
  int v7 = 0;
  uint64_t v8 = v5;
  do
  {
    if (*v8 == a1)
    {
      ++v7;
      *uint64_t v8 = 0;
      v8[1] = 0;
    }
    else if (*v8)
    {
      ++v6;
    }
    v8 += 2;
    --v4;
  }
  while (v4);
  if (v6)
  {
    if (!v7) {
      return 1318;
    }
    return 0;
  }
LABEL_17:
  sub_100023010(v5);
  *a2 = 0;
  if (v7) {
    return 0;
  }
  return 1318;
}

uint64_t sub_10018243C(uint64_t a1, uint64_t a2)
{
  return sub_100182288(a1, (void **)&qword_100A04820, a2);
}

uint64_t sub_10018244C(uint64_t a1, uint64_t a2)
{
  return sub_100182288(a1, (void **)&qword_100A04828, a2);
}

uint64_t sub_10018245C(uint64_t a1, uint64_t a2)
{
  return sub_100182288(a1, (void **)&xmmword_100A04830, a2);
}

uint64_t sub_10018246C(uint64_t a1, uint64_t a2)
{
  return sub_100182288(a1, (void **)&xmmword_100A04850 + 1, a2);
}

uint64_t sub_10018247C(uint64_t a1)
{
  return sub_100182374(a1, (void **)&xmmword_100A04850 + 1);
}

void *sub_100182488(void *result)
{
  off_100A04870 = result;
  return result;
}

uint64_t sub_100182494(uint64_t result, uint64_t a2)
{
  uint64_t v2 = xmmword_100A04810;
  if ((void)xmmword_100A04810)
  {
    uint64_t v3 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v5 = result;
      uint64_t v6 = 0;
      unint64_t v7 = 0;
      do
      {
        uint64_t v8 = *(uint64_t (**)(uint64_t, uint64_t, void))(v2 + v6);
        if (v8)
        {
          double result = v8(v5, a2, *(void *)(v2 + v6 + 8));
          uint64_t v2 = xmmword_100A04810;
          uint64_t v3 = qword_100A195B0;
        }
        ++v7;
        v6 += 16;
      }
      while (v7 < *(unsigned __int8 *)(v3 + 7));
    }
  }
  return result;
}

uint64_t sub_100182528(uint64_t result, uint64_t a2)
{
  uint64_t v2 = *((void *)&xmmword_100A04810 + 1);
  if (*((void *)&xmmword_100A04810 + 1))
  {
    uint64_t v3 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v5 = result;
      uint64_t v6 = 0;
      unint64_t v7 = 0;
      do
      {
        uint64_t v8 = *(uint64_t (**)(uint64_t, uint64_t, void))(v2 + v6);
        if (v8)
        {
          double result = v8(v5, a2, *(void *)(v2 + v6 + 8));
          uint64_t v2 = *((void *)&xmmword_100A04810 + 1);
          uint64_t v3 = qword_100A195B0;
        }
        ++v7;
        v6 += 16;
      }
      while (v7 < *(unsigned __int8 *)(v3 + 7));
    }
  }
  return result;
}

uint64_t sub_1001825BC(uint64_t result, uint64_t a2, uint64_t a3)
{
  uint64_t v3 = qword_100A04820;
  if (qword_100A04820)
  {
    uint64_t v4 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v7 = result;
      uint64_t v8 = 0;
      unint64_t v9 = 0;
      do
      {
        unsigned int v10 = *(uint64_t (**)(uint64_t, uint64_t, void, uint64_t))(v3 + v8);
        if (v10)
        {
          double result = v10(v7, a2, *(void *)(v3 + v8 + 8), a3);
          uint64_t v3 = qword_100A04820;
          uint64_t v4 = qword_100A195B0;
        }
        ++v9;
        v8 += 16;
      }
      while (v9 < *(unsigned __int8 *)(v4 + 7));
    }
  }
  return result;
}

void sub_100182660(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"%! (%d)", v2, v3, v4, v5, v6, v7, v8, 1305);
    unint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100748B78(v9);
    }
  }
  uint64_t v10 = qword_100A04828;
  if (qword_100A04828)
  {
    uint64_t v11 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v12 = 0;
      unint64_t v13 = 0;
      do
      {
        uint64_t v14 = *(void (**)(uint64_t, void))(v10 + v12);
        if (v14)
        {
          v14(a1, *(void *)(v10 + v12 + 8));
          uint64_t v10 = qword_100A04828;
          uint64_t v11 = qword_100A195B0;
        }
        ++v13;
        v12 += 16;
      }
      while (v13 < *(unsigned __int8 *)(v11 + 7));
    }
  }
}

uint64_t sub_100182740(uint64_t result, uint64_t a2)
{
  uint64_t v2 = xmmword_100A04830;
  if ((void)xmmword_100A04830)
  {
    uint64_t v3 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v5 = result;
      uint64_t v6 = 0;
      unint64_t v7 = 0;
      do
      {
        uint64_t v8 = *(uint64_t (**)(uint64_t, uint64_t, void))(v2 + v6);
        if (v8)
        {
          double result = v8(v5, a2, *(void *)(v2 + v6 + 8));
          uint64_t v2 = xmmword_100A04830;
          uint64_t v3 = qword_100A195B0;
        }
        ++v7;
        v6 += 16;
      }
      while (v7 < *(unsigned __int8 *)(v3 + 7));
    }
  }
  return result;
}

void sub_1001827D4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (sub_100197698(a2))
  {
    if (a1)
    {
      sub_10017C6C4(a2, *(unsigned char *)(a2 + 152) & 0x7F);
    }
    else
    {
      *(_WORD *)(a2 + 136) = a4;
      if (*(unsigned __int8 *)(a2 + 152) != a3) {
        sub_10017C6C4(a2, a3);
      }
      if (!a3) {
        sub_100189730();
      }
    }
    if (off_100A04870) {
      off_100A04870(a1, a2, a3, a4);
    }
    uint64_t v16 = *((void *)&xmmword_100A04850 + 1);
    if (*((void *)&xmmword_100A04850 + 1))
    {
      uint64_t v17 = qword_100A195B0;
      if (*(unsigned char *)(qword_100A195B0 + 7))
      {
        uint64_t v18 = 0;
        unint64_t v19 = 0;
        uint64_t v20 = a2 + 48;
        do
        {
          char v21 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, void))(v16 + v18);
          if (v21)
          {
            v21(a1, v20, a3, a4, *(void *)(v16 + v18 + 8));
            uint64_t v16 = *((void *)&xmmword_100A04850 + 1);
            uint64_t v17 = qword_100A195B0;
          }
          ++v19;
          v18 += 16;
        }
        while (v19 < *(unsigned __int8 *)(v17 + 7));
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIEventHandler_ModeChange Bad Handle: %x", v8, v9, v10, v11, v12, v13, v14, a2);
    uint64_t v15 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100182938(uint64_t a1, uint64_t a2)
{
  if (sub_100197698(a1))
  {
    uint64_t v4 = *((void *)&xmmword_100A04830 + 1);
    if (*((void *)&xmmword_100A04830 + 1))
    {
      uint64_t v5 = qword_100A195B0;
      if (*(unsigned char *)(qword_100A195B0 + 7))
      {
        uint64_t v6 = 0;
        unint64_t v7 = 0;
        uint64_t v8 = a1 + 48;
        do
        {
          uint64_t v9 = *(void (**)(uint64_t, uint64_t, void))(v4 + v6);
          if (v9)
          {
            v9(v8, a2, *(void *)(v4 + v6 + 8));
            uint64_t v4 = *((void *)&xmmword_100A04830 + 1);
            uint64_t v5 = qword_100A195B0;
          }
          ++v7;
          v6 += 16;
        }
        while (v7 < *(unsigned __int8 *)(v5 + 7));
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIEventHandler_MaxSlotsChange Bad Handle: %x", v10, v11, v12, v13, v14, v15, v16, a1);
    uint64_t v17 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100182A28(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"ConnectionPacketTypeChanged ERROR: %!", v6, v7, v8, v9, v10, v11, v12, a1);
      uint64_t v13 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  if (sub_100197698(a2) || sub_100197740(a2))
  {
    uint64_t v14 = qword_100A04840;
    if (qword_100A04840)
    {
      uint64_t v15 = qword_100A195B0;
      if (*(unsigned char *)(qword_100A195B0 + 7))
      {
        uint64_t v16 = 0;
        unint64_t v17 = 0;
        do
        {
          uint64_t v18 = *(void (**)(uint64_t, uint64_t, uint64_t, void))(v14 + v16);
          if (v18)
          {
            v18(a1, a2, a3, *(void *)(v14 + v16 + 8));
            uint64_t v14 = qword_100A04840;
            uint64_t v15 = qword_100A195B0;
          }
          ++v17;
          v16 += 16;
        }
        while (v17 < *(unsigned __int8 *)(v15 + 7));
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"ConnectionPacketTypeChanged, Unknown Handle: %d", v19, v20, v21, v22, v23, v24, v25, a2);
    unint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100182B7C(uint64_t result, uint64_t a2)
{
  uint64_t v2 = qword_100A04848;
  if (qword_100A04848)
  {
    uint64_t v3 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v5 = result;
      uint64_t v6 = 0;
      unint64_t v7 = 0;
      do
      {
        uint64_t v8 = *(uint64_t (**)(uint64_t, uint64_t, void))(v2 + v6);
        if (v8)
        {
          double result = v8(v5, a2, *(void *)(v2 + v6 + 8));
          uint64_t v2 = qword_100A04848;
          uint64_t v3 = qword_100A195B0;
        }
        ++v7;
        v6 += 16;
      }
      while (v7 < *(unsigned __int8 *)(v3 + 7));
    }
  }
  return result;
}

uint64_t sub_100182C10(uint64_t result, uint64_t a2)
{
  uint64_t v2 = xmmword_100A04850;
  if ((void)xmmword_100A04850)
  {
    uint64_t v3 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v5 = result;
      uint64_t v6 = 0;
      unint64_t v7 = 0;
      do
      {
        uint64_t v8 = *(uint64_t (**)(uint64_t, uint64_t, void))(v2 + v6);
        if (v8)
        {
          double result = v8(v5, a2, *(void *)(v2 + v6 + 8));
          uint64_t v2 = xmmword_100A04850;
          uint64_t v3 = qword_100A195B0;
        }
        ++v7;
        v6 += 16;
      }
      while (v7 < *(unsigned __int8 *)(v3 + 7));
    }
  }
  return result;
}

uint64_t sub_100182CA4(uint64_t result, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  if (a2) {
    uint64_t v6 = a2 + 48;
  }
  else {
    uint64_t v6 = 0;
  }
  uint64_t v7 = qword_100A04860;
  if (qword_100A04860)
  {
    uint64_t v8 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v13 = result;
      uint64_t v14 = 0;
      unint64_t v15 = 0;
      do
      {
        uint64_t v16 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, void))(v7 + v14);
        if (v16)
        {
          double result = v16(v13, v6, a3, a4, a5, a6, *(void *)(v7 + v14 + 8));
          uint64_t v7 = qword_100A04860;
          uint64_t v8 = qword_100A195B0;
        }
        ++v15;
        v14 += 16;
      }
      while (v15 < *(unsigned __int8 *)(v8 + 7));
    }
  }
  return result;
}

uint64_t sub_100182D70(uint64_t result, uint64_t a2)
{
  uint64_t v2 = qword_100A04868;
  if (qword_100A04868)
  {
    uint64_t v3 = qword_100A195B0;
    if (*(unsigned char *)(qword_100A195B0 + 7))
    {
      uint64_t v5 = result;
      uint64_t v6 = 0;
      unint64_t v7 = 0;
      do
      {
        uint64_t v8 = *(uint64_t (**)(uint64_t, uint64_t, void))(v2 + v6);
        if (v8)
        {
          double result = v8(v5, a2, *(void *)(v2 + v6 + 8));
          uint64_t v2 = qword_100A04868;
          uint64_t v3 = qword_100A195B0;
        }
        ++v7;
        v6 += 16;
      }
      while (v7 < *(unsigned __int8 *)(v3 + 7));
    }
  }
  return result;
}

void sub_100182E04()
{
  unsigned int v0 = *(unsigned __int16 *)qword_100A195B0;
  if (!*(_WORD *)qword_100A195B0)
  {
    sub_10025B8C0();
    unsigned int v0 = *(unsigned __int16 *)qword_100A195B0;
  }
  int v1 = sub_10010CE48(16 * v0);
  qword_100A04878 = (uint64_t)v1;
  if (!v1)
  {
    sub_10025B8C0();
    int v1 = (void *)qword_100A04878;
  }
  dword_100A04880 = 0;
  off_100A04888 = 0;
  off_100A04890 = 0;
  dword_100A048B0 = 0;
  size_t v2 = 16 * *(unsigned __int16 *)qword_100A195B0;

  bzero(v1, v2);
}

BOOL sub_100182E98(uint64_t a1, uint64_t *a2)
{
  unsigned int v2 = *(unsigned __int16 *)qword_100A195B0;
  BOOL v3 = *(_WORD *)qword_100A195B0 != 0;
  if (*(_WORD *)qword_100A195B0)
  {
    unsigned int v4 = 0;
    for (uint64_t i = qword_100A04878;
          *(_DWORD *)a1 != *(_DWORD *)i || *(unsigned __int16 *)(a1 + 4) != *(unsigned __int16 *)(i + 4);
          i += 16)
    {
      BOOL v3 = ++v4 < v2;
      if (v4 >= v2) {
        return v3;
      }
    }
    *a2 = i;
  }
  return v3;
}

uint64_t sub_100182F00(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t (*a4)(void, void), void *a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (dword_100A04880)
  {
    if (dword_100A04880 == 1) {
      return 1311;
    }
    if (dword_100A04880 == 2) {
      return 1312;
    }
    sub_10025B8C0();
    return 103;
  }
  off_100A04888 = a4;
  off_100A04890 = a5;
  qword_100A04898 = a6;
  dword_100A04880 = 1;
  uint64_t result = sub_10019304C(0, a2, a3, (uint64_t)a4, (uint64_t)a5, a6, a7, a8, a1);
  if (result) {
    dword_100A04880 = 0;
  }
  return result;
}

uint64_t sub_100182FAC(uint64_t (*a1)(void, void), uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (xmmword_100A19860)
  {
    switch(dword_100A04880)
    {
      case 0:
        return 1313;
      case 1:
        off_100A048A0 = a1;
        qword_100A048A8 = a2;
        uint64_t result = sub_10001BDE0(1, (uint64_t)sub_10018303C, a3, a4, a5, a6, a7, a8, v9);
        dword_100A04880 = 0;
        return result;
      case 2:
        return 1312;
    }
    sub_10025B8C0();
  }
  return 103;
}

uint64_t sub_10018303C(uint64_t result)
{
  if (off_100A048A0) {
    return off_100A048A0(result, qword_100A048A8);
  }
  return result;
}

uint64_t sub_100183058(uint64_t result)
{
  if (xmmword_100A19860)
  {
    if (result != 621) {
      goto LABEL_7;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Inquiry not finished in time... Cancelling.", v1, v2, v3, v4, v5, v6, v7, v9);
      uint64_t v8 = sub_100050B4C(0x3Fu);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
        sub_1007457DC(v8);
      }
    }
    uint64_t result = sub_10001BDE0(1, (uint64_t)sub_100183058, v2, v3, v4, v5, v6, v7, v9);
    if (result)
    {
LABEL_7:
      if (off_100A04890)
      {
        if (dword_100A04880 != 2)
        {
          if (dword_100A04880 != 1) {
            return result;
          }
          dword_100A04880 = 0;
        }
        return ((uint64_t (*)(void))off_100A04890)();
      }
    }
  }
  return result;
}

uint64_t sub_10018311C(uint64_t result)
{
  if (xmmword_100A19860)
  {
    if ((dword_100A04880 - 1) <= 1 && off_100A04888 != 0)
    {
      uint64_t v2 = result;
      uint64_t result = off_100A04888(result, qword_100A04898);
      int v3 = dword_100A048B0;
      uint64_t v4 = qword_100A04878 + 16 * dword_100A048B0;
      int v5 = *(_DWORD *)v2;
      *(_WORD *)(v4 + 4) = *(_WORD *)(v2 + 4);
      *(_DWORD *)uint64_t v4 = v5;
      *(_DWORD *)(v4 + 8) = *(_DWORD *)(v2 + 8);
      *(unsigned char *)(v4 + 12) = *(unsigned char *)(v2 + 6);
      *(unsigned char *)(v4 + 13) = *(unsigned char *)(v2 + 12);
      *(_WORD *)(v4 + 14) = *(_WORD *)(v2 + 14);
      if (v3 + 1 < *(unsigned __int16 *)qword_100A195B0) {
        int v6 = v3 + 1;
      }
      else {
        int v6 = 0;
      }
      dword_100A048B0 = v6;
    }
  }
  return result;
}

uint64_t sub_1001831DC(uint64_t a1, uint64_t a2, unsigned int a3)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v4 = sub_100197A30(a1);
  if (!v4) {
    return 1301;
  }
  uint64_t v5 = v4;
  if (!*(unsigned char *)(v4 + 144) && *(_WORD *)(v4 + 140) && *(unsigned __int16 *)(v4 + 140) < a3) {
    return 1337;
  }
  if ((*(_WORD *)(v4 + 138) & 4) == 0) {
    return 1333;
  }
  uint64_t result = sub_10019304C(41);
  if (!result) {
    *(unsigned char *)(v5 + 152) |= 0x80u;
  }
  return result;
}

uint64_t sub_1001832BC(uint64_t a1, __int16 a2, unsigned int a3, unsigned int a4, __int16 a5, __int16 a6)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v11 = sub_100197A30(a1);
  if (!v11) {
    return 1301;
  }
  if (*(_DWORD *)(v11 + 176)) {
    return 119;
  }
  if (!*(unsigned char *)(v11 + 144))
  {
    unsigned int v13 = *(unsigned __int16 *)(v11 + 140);
    if (v13 < a4) {
      return 1337;
    }
    if (v13 < a3) {
      LOWORD(a3) = *(_WORD *)(v11 + 140);
    }
  }
  if ((*(_WORD *)(v11 + 138) & 4) == 0) {
    return 1333;
  }
  uint64_t v19 = 0;
  v20[0] = 0;
  *(unsigned char *)(v11 + 192) = 0;
  uint64_t v14 = v11;
  __int16 v15 = a2;
  __int16 v16 = a3;
  __int16 v17 = a4;
  __int16 v18 = a5;
  LOWORD(v19) = a6;
  v20[1] = &v14;
  LOWORD(v20[0]) = 24;
  return sub_1000268E4((uint64_t)sub_1001833C4, v20, 2 * ((5 * a2) & 0x7FFFu), (int *)(v11 + 176));
}

void sub_1001833C4(uint64_t a1)
{
  uint64_t v1 = *(uint64_t **)(a1 + 8);
  *(_DWORD *)(*v1 + 176) = 0;
  uint64_t v2 = *v1;
  if (*(unsigned char *)(*v1 + 192)
    || (BOOL v3 = sub_10018A0F8(v2 + 48), v2 = *v1, v3)
    || (uint64_t v4 = sub_100197A88(v2 + 48), v2 = *v1, v4))
  {
    v24[0] = 0;
    *(unsigned char *)(v2 + 192) = 0;
    long long v5 = *(_OWORD *)v1;
    uint64_t v26 = v1[2];
    long long v25 = v5;
    v24[1] = &v25;
    LOWORD(v24[0]) = 24;
    if (sub_1000268E4((uint64_t)sub_1001833C4, v24, 2 * ((5 * *((_WORD *)v1 + 4)) & 0x7FFFu), (int *)(*v1 + 176))&& sub_100058654())
    {
      sub_100056E24((uint64_t)"Error registering automatic sniff", v6, v7, v8, v9, v10, v11, v12, v22);
      unsigned int v13 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_10074932C();
      }
    }
  }
  else if (!*(unsigned char *)(v2 + 152))
  {
    uint64_t v23 = *v1;
    if (sub_10019304C(41))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Automatic sniff failed", v14, v15, v16, v17, v18, v19, v20, v23);
        uint64_t v21 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_10074932C();
        }
      }
    }
    else
    {
      *(unsigned char *)(*v1 + 152) |= 0x80u;
    }
  }
}

uint64_t sub_10018354C(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v1 = sub_100197A30(a1);
  if (!v1) {
    return 1301;
  }
  uint64_t v2 = v1;
  if (*(char *)(v1 + 152) < 0) {
    return 0;
  }
  *(unsigned char *)(v1 + 192) = 1;
  uint64_t result = sub_10019304C(42);
  if (!result) {
    *(unsigned char *)(v2 + 152) |= 0x80u;
  }
  return result;
}

uint64_t sub_1001835D0(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v1 = sub_100197A30(a1);
  if (!v1) {
    return 1301;
  }
  uint64_t v2 = v1;
  uint64_t result = *(unsigned int *)(v1 + 176);
  if (result)
  {
    uint64_t result = sub_100026DB4(result);
    if (!result) {
      *(_DWORD *)(v2 + 176) = 0;
    }
  }
  return result;
}

uint64_t sub_10018362C(uint64_t a1, uint64_t *a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v3 = sub_100197A30(a1);
  if (!v3)
  {
    uint64_t v6 = 1301;
    if ((sub_100058654() & 1) == 0) {
      return v6;
    }
    uint64_t v16 = 0;
    goto LABEL_16;
  }
  uint64_t v4 = (unsigned __int16 *)v3;
  uint64_t v5 = sub_10018246C((uint64_t)sub_100183758, 0);
  if (v5 != 1316)
  {
    uint64_t v6 = v5;
    if (v5)
    {
      if ((sub_100058654() & 1) == 0) {
        return v6;
      }
      goto LABEL_15;
    }
  }
  uint64_t v7 = v4 + 90;
  if (a2)
  {
    uint64_t v8 = *a2;
    *((_DWORD *)v4 + 47) = *((_DWORD *)a2 + 2);
    *uint64_t v7 = v8;
  }
  else
  {
    *(_DWORD *)uint64_t v7 = 0;
  }
  uint64_t v6 = sub_1001837CC((uint64_t)v4, 1);
  if (v6 && sub_100058654())
  {
LABEL_15:
    uint64_t v16 = *v4;
LABEL_16:
    sub_100056E24((uint64_t)"Could not apply power-saving policy for handle 0x%x: %!", v9, v10, v11, v12, v13, v14, v15, v16);
    uint64_t v17 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100749944();
    }
  }
  return v6;
}

uint64_t sub_100183758(int a1, uint64_t a2)
{
  uint64_t result = sub_100197A30(a2);
  if (result && (a1 - 725) >= 2 && a1 != 712 && (a1 != 736 || *(_DWORD *)(result + 180) == 2))
  {
    return sub_1001837CC(result, 0);
  }
  return result;
}

uint64_t sub_1001837CC(uint64_t a1, int a2)
{
  if (*(char *)(a1 + 152) < 0) {
    return 0;
  }
  uint64_t v4 = a1 + 48;
  if (!*(_DWORD *)(a1 + 176) || (uint64_t result = sub_1001835D0(a1 + 48), !result))
  {
    int v6 = *(_DWORD *)(a1 + 180);
    if ((v6 - 2) >= 2)
    {
      if (v6 == 1) {
        goto LABEL_8;
      }
      if (v6)
      {
        sub_10025B8C0();
      }
      else if (a2)
      {
LABEL_8:
        if (*(unsigned char *)(a1 + 152) != 2) {
          return 0;
        }
        goto LABEL_13;
      }
      return 0;
    }
    if (*(unsigned char *)(a1 + 152) == 2)
    {
      if (!a2 || *(unsigned __int16 *)(a1 + 136) == *(unsigned __int16 *)(a1 + 184)) {
        return 0;
      }
LABEL_13:
      return sub_10018354C(v4);
    }
    if (*(unsigned __int8 *)(a1 + 54) > 5u)
    {
      int v9 = sub_100058654();
      uint64_t result = 0;
      if (!v9) {
        return result;
      }
      uint64_t v10 = sub_1001991F8(*(unsigned __int8 *)(a1 + 54));
      sub_100056E24((uint64_t)"Tried to sniff while in state %s. Ignoring.", v11, v12, v13, v14, v15, v16, v17, (uint64_t)v10);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      BOOL v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
      uint64_t result = 0;
      if (!v19) {
        return result;
      }
      *(_DWORD *)int buf = 136446210;
      long long v25 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      return 0;
    }
    if (v6 == 2 || *(unsigned char *)(a1 + 193))
    {
      *(unsigned char *)(a1 + 193) = 0;
      uint64_t v7 = *(unsigned __int16 *)(a1 + 184);
      unsigned int v8 = *(unsigned __int16 *)(a1 + 184);
      return sub_1001831DC(v4, v7, v8);
    }
    else
    {
      __int16 v20 = *(_WORD *)(a1 + 190);
      unsigned int v21 = *(unsigned __int16 *)(a1 + 184);
      __int16 v22 = *(_WORD *)(a1 + 186);
      __int16 v23 = *(_WORD *)(a1 + 188);
      return sub_1001832BC(v4, v20, v21, v21, v22, v23);
    }
  }
  return result;
}

uint64_t sub_100183A34()
{
  uint64_t v2 = 0;
  char v0 = 1;
  while (sub_100198DE0(&v2))
  {
    if (*(_DWORD *)(v2 + 176) && *(unsigned char *)(v2 + 152) != 2)
    {
      sub_1001831DC(v2 + 48, *(unsigned __int16 *)(v2 + 184), *(unsigned __int16 *)(v2 + 184));
      char v0 = 0;
    }
  }
  return v0 & 1;
}

uint64_t sub_100183AB0(uint64_t result)
{
  word_1009F9448 = result;
  return result;
}

uint64_t sub_100183ABC(uint64_t result)
{
  byte_1009F944C = result;
  return result;
}

uint64_t sub_100183AC8(uint64_t result)
{
  word_1009F943C = result;
  return result;
}

uint64_t sub_100183AD4(_DWORD *a1)
{
  if (byte_100A048C8) {
    return 118;
  }
  if (!a1) {
    return 0;
  }
  uint64_t result = 0;
  *a1 = dword_100A048C0;
  return result;
}

uint64_t sub_100183B0C(uint64_t (*a1)(void, void), int a2)
{
  if (DWORD1(xmmword_100A19860))
  {
    if (byte_100A048C8 == 1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid Connectability State=%d\n", v4, v5, v6, v7, v8, v9, v10, byte_100A048C8);
        uint64_t v11 = sub_100050B4C(0x2Du);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100748B78(v11);
        }
      }
      return 118;
    }
  }
  else
  {
    byte_100A048C8 = 0;
    byte_100A048D0 = 0;
    dword_100A048C0 = 3;
    DWORD1(xmmword_100A19860) = 1;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Set ConnectabilitySpeedScenario %d -> %d", v13, v14, v15, v16, v17, v18, v19, dword_100A048C0);
    __int16 v20 = sub_100050B4C(0x2Du);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      __int16 v22 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  off_100A048B8 = a1;
  dword_100A048C0 = a2;
  uint64_t result = sub_10001BDE0(111, (uint64_t)sub_100183CC0, v14, v15, v16, v17, v18, v19, LOBYTE(word_1009F942A[3 * a2 + 2]));
  if (!result) {
    byte_100A048C8 = 1;
  }
  return result;
}

uint64_t sub_100183CC0(int a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (a1
    || (uint64_t result = sub_10001BDE0(73, (uint64_t)sub_100183D5C, a3, a4, a5, a6, a7, a8, word_1009F942A[3 * dword_100A048C0]),
        result))
  {
    byte_100A048C8 = 0;
    uint64_t v9 = (uint64_t (*)(void))off_100A048B8;
    return v9();
  }
  return result;
}

uint64_t sub_100183D5C(uint64_t a1)
{
  byte_100A048C8 = 0;
  return off_100A048B8(a1, dword_100A048C0);
}

void sub_100183D78()
{
  byte_100A048DA = 0;
  byte_100A0495C = 0;
  byte_100A04911 = 0;
  byte_100A0495D = 0;
  byte_100A04950 = 0;
  byte_100A0495A = -1;
  byte_100A04945 = 0;
  byte_100A04944 = 0;
  byte_100A04910 = 0;
  byte_100A04920 = 0;
  byte_100A048D9 = 0;
  byte_100A048D8 = 0;
  dword_100A04940 = 0;
  off_100A048F0 = 0;
  off_100A048F8 = 0;
  off_100A04900 = 0;
  off_100A04908 = 0;
  word_100A04958 = 96;
  dword_100A04954 = 0;
  qword_100A04960 = 0;
}

uint64_t sub_100183E24()
{
  if (byte_100A048D9 || (sub_10017B9A8() & 1) != 0)
  {
    uint64_t v6 = 0;
    char v7 = 2;
  }
  else
  {
    byte_100A048D9 = 1;
    uint64_t v6 = sub_10001BDE0(81, (uint64_t)sub_1001857CC, v0, v1, v2, v3, v4, v5, dword_100A04954);
    if (!v6) {
      return v6;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteClassofDevice failed", v9, v10, v11, v12, v13, v14, v15, v17);
      uint64_t v16 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    char v7 = 0;
  }
  byte_100A048D9 = v7;
  return v6;
}

uint64_t sub_100183EF4(uint64_t a1)
{
  int v1 = xmmword_100A195C0;
  *(_WORD *)(a1 + 4) = WORD2(xmmword_100A195C0);
  *(_DWORD *)a1 = v1;
  return 0;
}

uint64_t sub_100183F14()
{
  return BYTE8(xmmword_100A195C0);
}

uint64_t sub_100183F24(void (*a1)(int a1), uint64_t a2)
{
  uint64_t result = 1325;
  if ((byte_100A048DA & 1) == 0)
  {
    BOOL v4 = !byte_100A04910 && byte_100A04920 == 0;
    if (v4 && (byte_100A04944 & 1) == 0 && !byte_100A04945)
    {
      uint64_t v6 = sub_10025B218(0x2Cu);
      uint64_t result = sub_10001BDE0(51, (uint64_t)sub_100184028, v7, v8, v9, v10, v11, v12, *(_WORD *)(v6 + 10) & 6 | 1u);
      if (result == 628) {
        uint64_t result = sub_100026DA8((uint64_t)sub_100184214, 0, 0);
      }
      if (!result)
      {
        byte_100A048DA = 1;
        dword_100A048DC = 0;
        qword_100A048E0 = a2;
        if (a1) {
          uint64_t v13 = a1;
        }
        else {
          uint64_t v13 = sub_10018421C;
        }
        off_100A048E8 = (uint64_t (*)(void, void))v13;
      }
    }
  }
  return result;
}

void sub_100184028(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeDefaultLinkPolicyCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Default_Link_Policy, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(67, (uint64_t)sub_10018586C, a3, a4, a5, a6, a7, a8, *(unsigned __int16 *)qword_100A048E0);
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_10018586C(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageTimeout", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    char v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeDefaultLinkPolicyCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  char v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100184214(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
}

void sub_10018421C(int a1)
{
  if (a1 && sub_100058654())
  {
    sub_100056E24((uint64_t)"devmgrCommandCompleteCallback", v1, v2, v3, v4, v5, v6, v7, v9);
    uint64_t v8 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

uint64_t sub_100184288(void (*a1)(int a1), uint64_t a2)
{
  if (!sub_100197698(a2)) {
    sub_10025B8C0();
  }
  if (off_100A048F0) {
    return 1319;
  }
  uint64_t result = sub_10019304C(21);
  if (!result)
  {
    if (a1) {
      uint64_t v4 = a1;
    }
    else {
      uint64_t v4 = sub_10018421C;
    }
    off_100A048F0 = v4;
  }
  return result;
}

void sub_100184308(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!off_100A048F0)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"orphan event - ReadRemoteSupportedFeaturesComplete", v6, v7, v8, v9, v10, v11, v12, v22);
    uint64_t v13 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_11:
    sub_100744F6C();
    return;
  }
  uint64_t v23 = (void (*)(uint64_t, uint64_t, uint64_t))off_100A048F0;
  off_100A048F0 = 0;
  if (!sub_100197698(a2))
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"Device disconnected during the name request. Ignoring event.", v14, v15, v16, v17, v18, v19, v20, v22);
    uint64_t v21 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_11;
  }

  v23(a1, a2 + 48, a3);
}

uint64_t sub_100184414(void (*a1)(int a1), uint64_t a2)
{
  if (!sub_100197698(a2)) {
    sub_10025B8C0();
  }
  if (off_100A048F8) {
    return 1319;
  }
  uint64_t result = sub_10019304C(22);
  if (!result)
  {
    if (a1) {
      uint64_t v4 = a1;
    }
    else {
      uint64_t v4 = sub_10018421C;
    }
    off_100A048F8 = v4;
  }
  return result;
}

void sub_10018449C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  char v27 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))off_100A048F8;
  if (sub_100197698(a2))
  {
    if (v27)
    {
      off_100A048F8 = 0;
      v27(a1, a2 + 48, a3, a4, a5);
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"orphan event - OI_HCIEventHandler_ReadRemoteExtendedFeaturesComplete", v18, v19, v20, v21, v22, v23, v24, v26);
      uint64_t v25 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"NULL handle - OI_HCIEventHandler_ReadRemoteExtendedFeaturesComplete", v10, v11, v12, v13, v14, v15, v16, v26);
      uint64_t v17 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    off_100A048F8 = 0;
  }
}

uint64_t sub_1001845C8(void (*a1)(int a1), uint64_t a2)
{
  if (!sub_100197698(a2)) {
    sub_10025B8C0();
  }
  if (off_100A04900) {
    return 1319;
  }
  uint64_t result = sub_10019304C(23);
  if (!result)
  {
    if (a1) {
      uint64_t v4 = a1;
    }
    else {
      uint64_t v4 = sub_10018421C;
    }
    off_100A04900 = v4;
  }
  return result;
}

void sub_100184648(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (!off_100A04900)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"orphan event - ReadRemoteVersionInformationComplete", v10, v11, v12, v13, v14, v15, v16, v26);
    uint64_t v17 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_11:
    sub_100744F6C();
    return;
  }
  char v27 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))off_100A04900;
  off_100A04900 = 0;
  if (!sub_100197698(a2))
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"Device disconnected during the version request. Ignoring event.", v18, v19, v20, v21, v22, v23, v24, v26);
    uint64_t v25 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_11;
  }

  v27(a1, a2 + 48, a3, a4, a5);
}

void sub_100184770(uint64_t a1, uint64_t a2)
{
  uint64_t v2 = (void (*)(uint64_t, uint64_t))off_100A04908;
  if (off_100A04908)
  {
    off_100A04908 = 0;
    uint64_t v3 = a2 + 48;
    v2(a1, v3);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"orphan event - ReadClockOffsetComplete", v4, v5, v6, v7, v8, v9, v10, v12);
    uint64_t v11 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_1001847FC(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  int v10 = byte_100A04910;
  BOOL v11 = 1;
  if ((byte_100A048DA & 1) == 0)
  {
    BOOL v12 = !byte_100A04910 && byte_100A04920 == 0;
    if (v12 && (byte_100A04944 & 1) == 0) {
      BOOL v11 = byte_100A04945 != 0;
    }
  }
  if (v11 && byte_100A04911)
  {
    if (--byte_100A04911) {
      return;
    }
    if (a1)
    {
      if (byte_100A0495A == 1) {
        byte_100A0495A = -1;
      }
      if (byte_100A04910 == 1)
      {
        int v10 = 2;
        byte_100A04910 = 2;
      }
      if (byte_100A04945 == 1) {
        byte_100A04945 = 2;
      }
      if (byte_100A04920 == 1) {
        byte_100A04920 = 2;
      }
    }
    else
    {
      int v21 = (byte_100A0495B & byte_100A0495C) | a2 & ~byte_100A0495C;
      byte_100A0495B = byte_100A0495B & byte_100A0495C | a2 & ~byte_100A0495C;
      byte_100A0495A = 0;
      if (v21 == a2)
      {
        if (byte_100A04945 == 1) {
          byte_100A04945 = 2;
        }
        if (byte_100A04920 == 1) {
          byte_100A04920 = 2;
        }
      }
      else
      {
        if (!(byte_100A04945 | byte_100A04920))
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"readScanEnableCb - LC settings don't match last write (%2x != %2x)\n", v22, a3, a4, a5, a6, a7, a8, byte_100A0495B);
            uint64_t v23 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
        uint64_t v24 = sub_10001BDE0(71, (uint64_t)sub_100187080, a3, a4, a5, a6, a7, a8, byte_100A0495B);
        if (v24)
        {
          uint64_t v25 = v24;
          if (byte_100A04945 == 1)
          {
            byte_100A04968 &= ~2u;
            byte_100A04945 = 0;
            off_100A04948(v24, byte_100A04969 != 0);
          }
          if (byte_100A04920 == 1)
          {
            byte_100A04968 &= ~1u;
            sub_100187290(v25);
          }
        }
        else
        {
          ++byte_100A0495D;
        }
      }
      int v10 = byte_100A04910;
      if (byte_100A04910 == 1) {
        goto LABEL_41;
      }
    }
    if (v10 != 2)
    {
LABEL_48:
      if (byte_100A04944 == 1)
      {
        byte_100A04944 = 0;
        off_100A04948(a1, (a2 >> 1) & 1);
      }
      if (byte_100A04945 == 2)
      {
        byte_100A04968 &= ~2u;
        byte_100A04945 = 0;
        off_100A04948(a1, byte_100A04969 != 0);
      }
      if (byte_100A04920 == 2)
      {
        byte_100A04968 &= ~1u;
        sub_100187290(a1);
      }
      return;
    }
LABEL_41:
    byte_100A04910 = 0;
    if (a1 || (a2 & 1) == 0)
    {
      ((void (*)(uint64_t, void))off_100A04918)(a1, 0);
    }
    else
    {
      if (dword_100A04940) {
        uint64_t v26 = 1;
      }
      else {
        uint64_t v26 = 2;
      }
      ((void (*)(void, uint64_t))off_100A04918)(0, v26);
    }
    goto LABEL_48;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"readScanEnableCb - orphan callback", v13, v14, v15, v16, v17, v18, v19, v27);
    uint64_t v20 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100184B74(void (*a1)(int a1), int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t result = 1325;
  if ((byte_100A048DA & 1) == 0 && !byte_100A04920)
  {
    uint64_t v11 = 1;
    if (a2 && a2 != 2)
    {
      if (a2 != 1) {
        return 101;
      }
      word_100A04922 = 600;
      qword_100A04928 = (uint64_t)sub_100184CC0;
      uint64_t v11 = 2;
    }
    uint64_t result = sub_10001BDE0(100, (uint64_t)sub_100184D34, a3, a4, a5, a6, a7, a8, v11);
    if (!result)
    {
      byte_100A04920 = 1;
      dword_100A04930 = a2;
      BOOL v12 = a1 ? a1 : sub_10018421C;
      off_100A04938 = v12;
      uint64_t result = dword_100A04940;
      if (dword_100A04940)
      {
        if (sub_100026DB4(dword_100A04940) && sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_Dispatch_CancelFunc", v13, v14, v15, v16, v17, v18, v19, v21);
          uint64_t v20 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
        uint64_t result = 0;
        dword_100A04940 = 0;
      }
    }
  }
  return result;
}

void sub_100184CC0()
{
  if (sub_100184B74(0, 2) && sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_DEVMGR_WriteDiscoverability", v0, v1, v2, v3, v4, v5, v6, v8);
    uint64_t v7 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

void sub_100184D34(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = a1;
  if (byte_100A04920 == 1)
  {
    if (a1)
    {
LABEL_3:
      sub_100187290(v8);
      return;
    }
    uint64_t v17 = word_100A0495B & 0xFE | (dword_100A04930 != 0);
    word_100A0495B = __PAIR16__(HIBYTE(word_100A0495B), word_100A0495B & 0xFE | (dword_100A04930 != 0)) | 0x100;
    if (byte_100A0495A != 1)
    {
      if (byte_100A0495A == 255)
      {
        uint64_t v8 = sub_10001BDE0(70, (uint64_t)sub_1001847FC, a3, a4, a5, a6, a7, a8, v36);
        if (v8) {
          goto LABEL_3;
        }
        ++byte_100A04911;
        byte_100A0495A = 1;
      }
      else
      {
        uint64_t v18 = sub_10001BDE0(71, (uint64_t)sub_100187080, a3, a4, a5, a6, a7, a8, v17);
        if (v18)
        {
          uint64_t v8 = v18;
          if (!sub_100058654()) {
            goto LABEL_3;
          }
          sub_100056E24((uint64_t)"OI_HCICMD_WriteScanEnable", v19, v20, v21, v22, v23, v24, v25, v36);
          uint64_t v26 = sub_100050B4C(0x2Cu);
          if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
            goto LABEL_3;
          }
LABEL_15:
          sub_100748324();
          goto LABEL_3;
        }
        ++byte_100A0495D;
      }
    }
    byte_100A04968 |= 1u;
    if (dword_100A04930 == 1)
    {
      uint64_t v27 = sub_1000268E4((uint64_t)sub_1001872F4, 0, (unsigned __int16)word_100A04922, &dword_100A04940);
      if (v27)
      {
        uint64_t v8 = v27;
        if (!sub_100058654()) {
          goto LABEL_3;
        }
        sub_100056E24((uint64_t)"OI_Dispatch_RegisterTimedFunc", v28, v29, v30, v31, v32, v33, v34, v36);
        uint64_t v35 = sub_100050B4C(0x2Cu);
        if (!os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
          goto LABEL_3;
        }
        goto LABEL_15;
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"wrdiscWriteIacLapCb - orphan callback", v9, v10, v11, v12, v13, v14, v15, v36);
    uint64_t v16 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

uint64_t sub_100184F58(void (*a1)(int a1), int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v41[0] = 0;
  if (a2)
  {
    if (byte_100A04950)
    {
      uint64_t v9 = sub_100022FE8(0x10uLL);
      long long ptr = v9;
      if (v9)
      {
        *(void *)uint64_t v9 = a1;
        v9[8] = 1;
        char v10 = byte_100A04950 + 1;
LABEL_13:
        byte_100A04950 = v10;
        goto LABEL_14;
      }
      return 0;
    }
    uint64_t v11 = sub_100185150(a1, 1, a3, a4, a5, a6, a7, a8);
    if (v11)
    {
      if (!sub_100058654()) {
        return v11;
      }
      sub_100056E24((uint64_t)"_OI_DEVMGR_SetLocalDeviceConnectability", v29, v30, v31, v32, v33, v34, v35, v39);
      uint64_t v36 = sub_100050B4C(0x2Cu);
      if (!os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
        return v11;
      }
      goto LABEL_9;
    }
    char v37 = byte_100A04950 + 1;
    goto LABEL_26;
  }
  if (byte_100A04950 == 1)
  {
    uint64_t v11 = sub_100185150(a1, 0, a3, a4, a5, a6, a7, a8);
    if (v11)
    {
      if (!sub_100058654()) {
        return v11;
      }
      sub_100056E24((uint64_t)"_OI_DEVMGR_SetLocalDeviceConnectability", v12, v13, v14, v15, v16, v17, v18, v39);
      uint64_t v19 = sub_100050B4C(0x2Cu);
      if (!os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        return v11;
      }
LABEL_9:
      sub_100748324();
      return v11;
    }
    char v37 = byte_100A04950 - 1;
LABEL_26:
    byte_100A04950 = v37;
    return v11;
  }
  uint64_t v20 = sub_100022FE8(0x10uLL);
  long long ptr = v20;
  if (!v20) {
    return 0;
  }
  *(void *)uint64_t v20 = a1;
  v20[8] = 0;
  if (byte_100A04950)
  {
    char v10 = byte_100A04950 - 1;
    goto LABEL_13;
  }
  sub_10025B8C0();
LABEL_14:
  v41[1] = &ptr;
  LOWORD(v41[0]) = 8;
  uint64_t v11 = sub_1000268E4((uint64_t)sub_1001852F4, v41, 0, 0);
  if (v11)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to dispatch fake connectable CB", v21, v22, v23, v24, v25, v26, v27, v39);
      uint64_t v28 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_100023010(ptr);
  }
  return v11;
}

uint64_t sub_100185150(void (*a1)(int a1), int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = 1325;
  if ((byte_100A048DA & 1) != 0 || (byte_100A04944 & 1) != 0 || byte_100A04945) {
    return v8;
  }
  char v9 = a2;
  HIBYTE(word_100A0495B) |= 2u;
  if (a2) {
    int v11 = 2;
  }
  else {
    int v11 = 0;
  }
  uint64_t v12 = word_100A0495B & 0xFD | v11;
  LOBYTE(word_100A0495B) = word_100A0495B & 0xFD | v11;
  if (byte_100A0495A == 1) {
    goto LABEL_16;
  }
  if (byte_100A0495A == 255)
  {
    uint64_t v8 = sub_10001BDE0(70, (uint64_t)sub_1001847FC, a3, a4, a5, a6, a7, a8, v24);
    if (v8) {
      return v8;
    }
    ++byte_100A04911;
    byte_100A0495A = 1;
    goto LABEL_16;
  }
  uint64_t v13 = sub_10001BDE0(71, (uint64_t)sub_100187080, a3, a4, a5, a6, a7, a8, v12);
  if (!v13)
  {
    ++byte_100A0495D;
LABEL_16:
    uint64_t v8 = 0;
    byte_100A04945 = 1;
    byte_100A04969 = v9;
    if (a1) {
      uint64_t v22 = a1;
    }
    else {
      uint64_t v22 = sub_10018421C;
    }
    off_100A04948 = (uint64_t (*)(void, void))v22;
    byte_100A04968 |= 2u;
    return v8;
  }
  uint64_t v8 = v13;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCICMD_WriteScanEnable", v14, v15, v16, v17, v18, v19, v20, v25);
    uint64_t v21 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  return v8;
}

void sub_1001852F4(uint64_t a1)
{
  uint64_t v1 = **(unsigned __int8 ***)(a1 + 8);
  if (v1)
  {
    if (*(void *)v1) {
      (*(void (**)(void, void))v1)(0, v1[8]);
    }
    sub_100023010(v1);
  }
}

uint64_t sub_100185350(int a1)
{
  return sub_100185358(a1, 1);
}

uint64_t sub_100185358(int a1, int a2)
{
  if ((a1 & 0xFF001FFF) != 0) {
    return 101;
  }
  uint64_t v3 = 0;
  char v4 = 0;
  int v5 = dword_100A04954;
  do
  {
    int v6 = 1 << (v3 + 16);
    if ((v6 & a1) == 0) {
      goto LABEL_13;
    }
    int v7 = *((unsigned __int8 *)&qword_100A04960 + v3);
    if (a2)
    {
      if (v7 == 255) {
        return 104;
      }
      *((unsigned char *)&qword_100A04960 + v3) = v7 + 1;
      if (!v7)
      {
        v5 |= v6;
LABEL_12:
        dword_100A04954 = v5;
        char v4 = 1;
      }
    }
    else
    {
      if (!*((unsigned char *)&qword_100A04960 + v3)) {
        return 121;
      }
      char v8 = v7 - 1;
      *((unsigned char *)&qword_100A04960 + v3) = v8;
      if (!v8)
      {
        v5 &= ~v6;
        goto LABEL_12;
      }
    }
LABEL_13:
    ++v3;
  }
  while (v3 != 8);
  if (v4) {
    return sub_100183E24();
  }
  else {
    return 0;
  }
}

uint64_t sub_100185404(int a1)
{
  return sub_100185358(a1, 0);
}

uint64_t sub_10018540C(__int16 a1, char a2)
{
  dword_100A04954 = a2 & 0xFC | a1 & 0x1F00 | dword_100A04954 & 0xFFE000;
  return sub_100183E24();
}

uint64_t sub_100185430()
{
  return (unsigned __int16)word_100A04958;
}

uint64_t sub_10018543C(char a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (a1) {
    uint64_t v8 = 0;
  }
  else {
    uint64_t v8 = *(unsigned __int8 *)(qword_100A048E0 + 18);
  }
  uint64_t v9 = sub_10001BDE0(107, (uint64_t)sub_1001854F8, a3, a4, a5, a6, a7, a8, v8);
  uint64_t v10 = v9;
  if (v9)
  {
    if (v9 == 628)
    {
      sub_1001854F8(628);
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryScanType", v11, v12, v13, v14, v15, v16, v17, v20);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v10;
}

void sub_1001854F8(int a1)
{
  if (a1 == 717 || a1 == 628)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeInqScanInterlaceTypeCb", v1, v2, v3, v4, v5, v6, v7, v25);
      uint64_t v8 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
LABEL_13:
      }
        sub_100748324();
    }
  }
  else if ((a1 - 701) > 0x44)
  {
    if (a1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"writeInqScanInterlaceTypeCb", v17, v18, v19, v20, v21, v22, v23, v25);
        uint64_t v24 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
          goto LABEL_13;
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeInqScanInterlaceTypeCb", v9, v10, v11, v12, v13, v14, v15, v25);
    uint64_t v16 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      goto LABEL_13;
    }
  }
}

uint64_t sub_100185604(char a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (a1) {
    uint64_t v8 = 0;
  }
  else {
    uint64_t v8 = *(unsigned __int8 *)(qword_100A048E0 + 20);
  }
  uint64_t v9 = sub_10001BDE0(111, (uint64_t)sub_1001856C0, a3, a4, a5, a6, a7, a8, v8);
  uint64_t v10 = v9;
  if (v9)
  {
    if (v9 == 628)
    {
      sub_1001856C0(628);
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanType", v11, v12, v13, v14, v15, v16, v17, v20);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v10;
}

void sub_1001856C0(int a1)
{
  if (a1 == 717 || a1 == 628)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writePageScanInterlaceTypeCb", v1, v2, v3, v4, v5, v6, v7, v25);
      uint64_t v8 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR)) {
LABEL_13:
      }
        sub_100748324();
    }
  }
  else if ((a1 - 701) > 0x44)
  {
    if (a1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"writePageScanInterlaceTypeCb", v17, v18, v19, v20, v21, v22, v23, v25);
        uint64_t v24 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
          goto LABEL_13;
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writePageScanInterlaceTypeCb", v9, v10, v11, v12, v13, v14, v15, v25);
    uint64_t v16 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      goto LABEL_13;
    }
  }
}

void sub_1001857CC(int a1)
{
  if (!byte_100A048D9)
  {
    sub_10025B8C0();
    if (a1) {
      goto LABEL_3;
    }
LABEL_7:
    byte_100A048D8 = 0;
    goto LABEL_8;
  }
  if (!a1) {
    goto LABEL_7;
  }
LABEL_3:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"devmgrWriteClassOfDeviceCB failed", v2, v3, v4, v5, v6, v7, v8, v11);
    uint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
LABEL_8:
  int v10 = byte_100A048D9;
  byte_100A048D9 = 0;
  if (v10 == 2) {
    sub_100183E24();
  }
}

void sub_10018586C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeConnectionAcceptTimeoutCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Cnct_Accept_Timeout, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(69, (uint64_t)sub_100185A58, a3, a4, a5, a6, a7, a8, *(unsigned __int16 *)(qword_100A048E0 + 2));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100185A58(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageTimeout", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeConnectionAcceptTimeoutCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100185A58(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writePageTimeoutCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Page_Timeout, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(73, (uint64_t)sub_100185C48, a3, a4, a5, a6, a7, a8, *(unsigned __int16 *)(qword_100A048E0 + 4));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100185C48(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanActivity", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writePageTimeoutCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100185C48(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writePageScanActivityCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_PageScan_Activity, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(75, (uint64_t)sub_100185E38, a3, a4, a5, a6, a7, a8, *(unsigned __int16 *)(qword_100A048E0 + 8));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100185E38(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryScanActivity", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writePageScanActivityCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100185E38(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeInquiryScanActivityCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_InquiryScan_Activity, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(83, (uint64_t)sub_100186024, a3, a4, a5, a6, a7, a8, *(unsigned __int16 *)(qword_100A048E0 + 12));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100186024(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteVoiceSetting", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeInquiryScanActivityCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100186024(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeVoiceSettingCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Voice_Setting, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    word_100A04958 = *(_WORD *)(qword_100A048E0 + 12);
    uint64_t v29 = sub_10001BDE0(87, (uint64_t)sub_10018621C, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 14));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_10018621C(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteNumBroadcastRetransmissions", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeVoiceSettingCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_10018621C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeNumBroadcastRetransmissionsCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Num_Broadcast_Retransmissions, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(89, (uint64_t)sub_100186408, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 15));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100186408(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteHoldModeActivity", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeNumBroadcastRetransmissionsCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100186408(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeHoldModeActivityCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Hold_Mode_Activity, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      int v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(92, (uint64_t)sub_1001865F4, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 16));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_1001865F4(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteSCOFlowControlEnable", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeHoldModeActivityCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_1001865F4(int a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA == 1)
  {
    if (a1)
    {
      if (a1 != 628)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Write_Sco_Flow_Control_Enable failed, ignoring error", v8, a3, a4, a5, a6, a7, a8, v35);
          uint64_t v9 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
      }
    }
    uint64_t v10 = sub_10001BDE0(102, (uint64_t)sub_100186768, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 17));
    if (v10)
    {
      uint64_t v18 = v10;
      if (v10 == 628)
      {
        sub_100186768(628, v11, v12, v13, v14, v15, v16, v17);
      }
      else
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanPeriodMode", v27, v28, v29, v30, v31, v32, v33, v36);
          uint64_t v34 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
        byte_100A048DA = 0;
        if (off_100A048E8) {
          off_100A048E8(v18, qword_100A048E0);
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeSCOFlowControlEnableCb - orphan callback", v19, v20, v21, v22, v23, v24, v25, v35);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100186768(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writePageScanPeriodModeCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Page_Scan_Period_Mode, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(107, (uint64_t)sub_100186954, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 18));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100186954(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryScanType", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writePageScanPeriodModeCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100186954(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeInquiryScanTypeCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Inquiry_Scan_Type, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(109, (uint64_t)sub_100186B40, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 19));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100186B40(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryMode", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeInquiryScanTypeCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100186B40(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeInquiryModeCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v45);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Inquiry_Mode, ignoring error", v9, a3, a4, a5, a6, a7, a8, v45);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(111, (uint64_t)sub_100186D2C, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 20));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100186D2C(628, v30, v31, v32, v33, v34, v35, v36);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanType", v37, v38, v39, v40, v41, v42, v43, v46);
      uint64_t v44 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeInquiryModeCb", v19, v20, v21, v22, v23, v24, v25, v45);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100186D2C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A048DA != 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writePageScanTypeCb - orphan callback", v11, v12, v13, v14, v15, v16, v17, v38);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  uint64_t v8 = a1;
  if (a1 == 628) {
    goto LABEL_17;
  }
  if ((a1 - 701) <= 0x44)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write_Page_Scan_Type, ignoring error", v9, a3, a4, a5, a6, a7, a8, v38);
      uint64_t v10 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    dword_100A048DC = v8;
LABEL_17:
    uint64_t v29 = sub_10001BDE0(113, (uint64_t)sub_100186F18, a3, a4, a5, a6, a7, a8, *(unsigned __int8 *)(qword_100A048E0 + 21));
    if (!v29) {
      return;
    }
    uint64_t v8 = v29;
    if (v29 == 628)
    {
      sub_100186F18(0x274u);
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteAfhChannelAssessmentMode", v30, v31, v32, v33, v34, v35, v36, v39);
      uint64_t v37 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    byte_100A048DA = 0;
    uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
    if (off_100A048E8)
    {
      uint64_t v28 = qword_100A048E0;
      goto LABEL_25;
    }
    return;
  }
  if (!a1) {
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writePageScanTypeCb", v19, v20, v21, v22, v23, v24, v25, v38);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  byte_100A048DA = 0;
  uint64_t v27 = (void (*)(uint64_t, uint64_t))off_100A048E8;
  if (off_100A048E8)
  {
    uint64_t v28 = qword_100A048E0;
LABEL_25:
    v27(v8, v28);
  }
}

void sub_100186F18(unsigned int a1)
{
  if (byte_100A048DA == 1)
  {
    unsigned int v1 = a1;
    if (a1 == 628)
    {
      unsigned int v1 = 0;
    }
    else
    {
      if (a1 - 701 <= 0x44)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Write_AFH_Channel_Assessment_Mode, ignoring error", v11, v12, v13, v14, v15, v16, v17, v28);
          uint64_t v18 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
        dword_100A048DC = v1;
        int v2 = 1;
        unsigned int v1 = 0;
        goto LABEL_18;
      }
      if (a1)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"writeAfhChannelAssessmentModeCb", v19, v20, v21, v22, v23, v24, v25, v28);
          uint64_t v26 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
        int v2 = 0;
        goto LABEL_18;
      }
    }
    int v2 = 1;
LABEL_18:
    byte_100A048DA = 0;
    if (off_100A048E8)
    {
      if (v2) {
        uint64_t v27 = dword_100A048DC;
      }
      else {
        uint64_t v27 = v1;
      }
      off_100A048E8(v27, qword_100A048E0);
    }
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeAfhChannelAssessmentModeCb - orphan callback", v3, v4, v5, v6, v7, v8, v9, v28);
    uint64_t v10 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100187080(uint64_t a1)
{
  int v1 = byte_100A04945;
  if (byte_100A048DA & 1 | (byte_100A04910 != 0) | (byte_100A04920 != 0) | byte_100A04944 & 1 | (byte_100A04945 != 0)
    && byte_100A0495D)
  {
    if (--byte_100A0495D) {
      return;
    }
    uint64_t v2 = a1;
    if (byte_100A04920 == 1)
    {
      int v3 = byte_100A04945;
      if (byte_100A04968)
      {
        byte_100A04968 &= ~1u;
        if (a1)
        {
LABEL_22:
          sub_100187290(a1);
          int v3 = byte_100A04945;
          goto LABEL_23;
        }
        unsigned int v4 = dword_100A04954;
        if (dword_100A04930 != 2)
        {
          if (dword_100A04930 == 1)
          {
            a1 = 0;
            int v5 = dword_100A04954;
            unsigned int v4 = dword_100A04954 | 0x2000;
LABEL_20:
            if (v4 != v5)
            {
              dword_100A04954 = v4;
              a1 = sub_100183E24();
            }
            goto LABEL_22;
          }
          if (dword_100A04930)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"invalid discoSettingContext %d", v14, v15, v16, v17, v18, v19, v20, dword_100A04930);
              uint64_t v21 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
                sub_100744F6C();
              }
            }
            sub_10025B8C0();
            int v5 = dword_100A04954;
            a1 = 105;
            goto LABEL_20;
          }
        }
        a1 = 0;
        int v5 = dword_100A04954;
        unsigned int v4 = dword_100A04954 & 0xFFFFDFFF;
        goto LABEL_20;
      }
    }
    else
    {
      int v3 = byte_100A04945;
    }
LABEL_23:
    if (v3 == 1 && (byte_100A04968 & 2) != 0 && v1 == 1)
    {
      byte_100A04968 &= ~2u;
      byte_100A04945 = 0;
      off_100A04948(v2, byte_100A04969 != 0);
    }
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"writeScanEnableCb - orphan callback", v6, v7, v8, v9, v10, v11, v12, v22);
    uint64_t v13 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100187290(uint64_t a1)
{
  if (!byte_100A04920) {
    sub_10025B8C0();
  }
  uint64_t v2 = (uint64_t (*)(uint64_t))off_100A04938;
  if (!off_100A04938)
  {
    sub_10025B8C0();
    uint64_t v2 = (uint64_t (*)(uint64_t))off_100A04938;
  }
  byte_100A04920 = 0;

  return v2(a1);
}

void sub_1001872F4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  dword_100A04940 = 0;
  if (byte_100A04920)
  {
    sub_10025B8C0();
    if (byte_100A04920)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"discoLimitedTimeoutCb, !discoWriteSettingsState", v8, v9, v10, v11, v12, v13, v14, v25);
        uint64_t v15 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return;
    }
  }
  uint64_t v16 = byte_100A0495B & 0xFE;
  byte_100A0495B &= ~1u;
  if (byte_100A0495A == 1)
  {
LABEL_12:
    dword_100A04930 = 0;
    byte_100A04920 = 1;
    off_100A04938 = (_UNKNOWN *)qword_100A04928;
    byte_100A04968 |= 1u;
    return;
  }
  if (!sub_10001BDE0(71, (uint64_t)sub_100187080, a3, a4, a5, a6, a7, a8, v16))
  {
    ++byte_100A0495D;
    goto LABEL_12;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCICMD_WriteScanEnable", v17, v18, v19, v20, v21, v22, v23, v26);
    uint64_t v24 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
}

void sub_100187440(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, unsigned int a7)
{
  int v10 = sub_100058654();
  if (a2)
  {
    if (v10)
    {
      sub_100056E24((uint64_t)"_qosSetupCompleteCB: status %!, role %s, lmhandle 0x%x, retries %d, flags 0x%x, serviceType 0x%x, tokenRate 0x%x, peakBandwidth 0x%x, latency 0x%x, delayVariation 0x%x", v11, v12, v13, v14, v15, v16, v17, a1);
      uint64_t v18 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v31 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    if (!a1 && a7 >= 0x4E21 && *(unsigned char *)(a2 + 144) == 1)
    {
      unsigned int v19 = ++*(unsigned char *)(a2 + 154);
      if (v19 > 2)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"QOS setup retry limited exceeded", v21, v22, v23, v24, v25, v26, v27, v29);
          uint64_t v28 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
            sub_1007456E8();
          }
        }
      }
      else
      {
        sub_10018C210(a2);
      }
    }
  }
  else if (v10)
  {
    sub_100056E24((uint64_t)"qosSetupCompleteCB connection was released, exiting", v11, v12, v13, v14, v15, v16, v17, v29);
    uint64_t v20 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v31 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
}

void sub_100187680()
{
  byte_100A0496A = 0;
}

uint64_t sub_10018768C(uint64_t a1, int a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v4 = 0;
  uint64_t result = sub_10017E2D4(a1, &v4);
  if (!result) {
    *(_WORD *)(v4 + 142) = (858993460 * (unint64_t)(8 * a2)) >> 32;
  }
  return result;
}

uint64_t sub_1001876F0(uint64_t a1, char a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v4 = 0;
  uint64_t result = sub_10017E2D4(a1, &v4);
  if (!result) {
    *(unsigned char *)(v4 + 196) = a2;
  }
  return result;
}

uint64_t sub_100187740(uint64_t a1, char a2)
{
  if (!a1) {
    return 101;
  }
  uint64_t v4 = 0;
  uint64_t result = sub_10017E2D4(a1, &v4);
  if (!result) {
    *(unsigned char *)(v4 + 328) = a2;
  }
  return result;
}

uint64_t sub_100187790(uint64_t a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)(a1 + 54) == 3)
  {
    if (*(unsigned __int8 *)(a1 + 144) == 255 && !*(unsigned char *)(a1 + 196)) {
      *(unsigned char *)(a1 + 198) = 1;
    }
    return 1342;
  }
  if (*(unsigned char *)(a1 + 54) || *(unsigned char *)(a1 + 196) || *(unsigned char *)(a1 + 144) != 1) {
    return 1342;
  }
  if (sub_1002536E8(a1))
  {
    *(unsigned char *)(a1 + 194) = 1;
    return 1342;
  }
  if (sub_100197A88(a1 + 48)) {
    return 1342;
  }
  if (*(_DWORD *)(a1 + 248))
  {
    *(unsigned char *)(a1 + 197) = 1;
    return 1342;
  }
  if (*(unsigned char *)(a1 + 200) && sub_100198D88() == 1 && !sub_100198E60() || sub_1001F1054(a1)) {
    return 1342;
  }
  if (*(unsigned char *)(a1 + 195))
  {
    int v4 = *(_DWORD *)(a1 + 320);
    uint64_t v2 = 1342;
    if (v4 == 733 || v4 == 736) {
      return v2;
    }
    if (sub_100198E54()
      || sub_100199058()
      || sub_100198D88() == 1 && !sub_100198E60())
    {
      return 1342;
    }
  }
  if (!*(_DWORD *)(a1 + 148))
  {
    uint64_t v13 = sub_10017BB4C(a1);
    if (v13)
    {
      uint64_t v14 = v13;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_DevMgr_aclActivity failed with %!", v15, v16, v17, v18, v19, v20, v21, v14);
        uint64_t v22 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  uint64_t v2 = sub_100187974((uint64_t)sub_100187A5C, a1, 0);
  if (v2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"startRoleSwitch failed %!", v5, v6, v7, v8, v9, v10, v11, v2);
      uint64_t v12 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  return v2;
}

uint64_t sub_100187974(uint64_t a1, uint64_t a2, char a3)
{
  if (*(char *)(a2 + 152) < 0) {
    return 0;
  }
  unsigned int v6 = *(unsigned __int8 *)(a2 + 152);
  if (v6 >= 2)
  {
    if (v6 == 2)
    {
      uint64_t result = sub_10018246C((uint64_t)sub_100188F08, 0);
      if (result == 1316 || !result)
      {
        *(unsigned char *)(a2 + 213) = 1;
        *(void *)(a2 + 216) = a1;
        *(unsigned char *)(a2 + 276) = a3;
        uint64_t result = sub_10019304C(42);
        if (result) {
          *(unsigned char *)(a2 + 213) = 0;
        }
        else {
          *(unsigned char *)(a2 + 152) |= 0x80u;
        }
      }
    }
    else
    {
      return 101;
    }
  }
  else
  {
    return sub_100188D00(a1, a2, a3);
  }
  return result;
}

void sub_100187A5C(int a1, uint64_t a2, int a3)
{
  uint64_t v5 = sub_100197A30(a2);
  if (!v5)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"gentlyCentralrRsCb Orphaned!  %!", v23, v24, v25, v26, v27, v28, v29, 105);
      uint64_t v30 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    goto LABEL_19;
  }
  uint64_t v12 = v5;
  if (a3)
  {
    *(unsigned char *)(v5 + 195) = 1;
    *(_DWORD *)(v5 + 320) = a1;
    uint64_t v13 = sub_10018C1D4(sub_100187440, 0);
    if (v13)
    {
      uint64_t v14 = v13;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCIAPI_RegisterQosCallback failed with %!", v15, v16, v17, v18, v19, v20, v21, v14);
        uint64_t v22 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          sub_1007456E8();
        }
      }
    }
    else
    {
      *(unsigned char *)(v12 + 154) = 0;
      sub_10018C210(v12);
    }
  }
  else
  {
    *(unsigned char *)(v5 + 195) = 0;
    *(_DWORD *)(v5 + 320) = 0xFFFF;
    if (!*(unsigned char *)(v5 + 199) || (int v31 = sub_100198D88(), sub_100198E60() + v31 >= 2))
    {
      *(_WORD *)(v12 + 138) &= ~1u;
      uint64_t v32 = sub_10001BDE0(49, (uint64_t)nullsub_105, v6, v7, v8, v9, v10, v11, v12);
      if (v32)
      {
        uint64_t v33 = v32;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Could not write link settings to Central only %!", v34, v35, v36, v37, v38, v39, v40, v33);
          uint64_t v41 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
  if (!*(_DWORD *)(v12 + 148))
  {
    uint64_t v42 = sub_10017BB4C(v12);
    if (v42)
    {
      uint64_t v43 = v42;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_DevMgr_aclActivity failed with %!", v44, v45, v46, v47, v48, v49, v50, v43);
        uint64_t v51 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  if (!sub_100187E90(v12)) {
LABEL_19:
  }
    byte_100A195B8 = 1;
}

BOOL sub_100187CA4(uint64_t a1)
{
  return sub_100187CB0(**(_DWORD **)(a1 + 8));
}

BOOL sub_100187CB0(int a1)
{
  uint64_t v27 = 0;
  unsigned int v1 = a1 != 0;
  BOOL result = sub_100198DE0(&v27);
  if (result)
  {
    while (1)
    {
      uint64_t v9 = v27;
      if (!*(unsigned char *)(v27 + 54) && !*(unsigned char *)(v27 + 144)) {
        break;
      }
LABEL_14:
      BOOL result = sub_100198DE0(&v27);
      if (!result) {
        goto LABEL_15;
      }
    }
    int v10 = *(unsigned __int16 *)(v27 + 138);
    if (*(unsigned char *)(v27 + 199))
    {
      int v11 = sub_100198D88();
      int v12 = sub_100198E60();
      uint64_t v9 = v27;
      int v13 = *(unsigned __int16 *)(v27 + 138);
      if (v12 + v11 <= v1)
      {
        int v14 = v13 | 1;
LABEL_9:
        *(_WORD *)(v9 + 138) = v14;
        if (v10 != v14)
        {
          uint64_t v15 = sub_10001BDE0(49, (uint64_t)nullsub_105, v3, v4, v5, v6, v7, v8, v9);
          if (v15)
          {
            uint64_t v16 = v15;
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Could not write link settings to Central only %!", v17, v18, v19, v20, v21, v22, v23, v16);
              uint64_t v24 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
              {
                uint64_t v25 = sub_100050714();
                *(_DWORD *)int buf = 136446466;
                uint64_t v29 = v25;
                __int16 v30 = 1024;
                int v31 = 0xFFFF;
                _os_log_error_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
              }
            }
          }
        }
        goto LABEL_14;
      }
    }
    else
    {
      LOWORD(v13) = *(_WORD *)(v27 + 138);
    }
    int v14 = v13 & 0xFFFE;
    goto LABEL_9;
  }
LABEL_15:
  if (*(unsigned char *)(qword_100A195B0 + 15))
  {
    char v26 = 1;
  }
  else
  {
    BOOL result = sub_100187E90(0);
    char v26 = !result;
  }
  byte_100A195B8 = v26;
  return result;
}

BOOL sub_100187E90(uint64_t a1)
{
  uint64_t v3 = a1;
  do
    BOOL v1 = sub_100198DE0(&v3);
  while (v1 && sub_100187790(v3));
  return v1;
}

uint64_t sub_100187ED8(uint64_t a1, uint64_t a2, char a3, __int16 a4, int a5)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (a1 && a2)
  {
    uint64_t v10 = sub_100197A30(a2);
    if (v10)
    {
      v14[0] = 0;
      long long v15 = 0u;
      v13[0] = 0;
      v14[1] = a1;
      DWORD1(v15) = a5;
      BYTE2(v15) = a3;
      LOWORD(v15) = a4;
      LODWORD(v14[0]) = *(_DWORD *)a2;
      WORD2(v14[0]) = *(_WORD *)(a2 + 4);
      if (((2684355 * (unint64_t)(*(unsigned __int16 *)(v10 + 140) + 1599)) >> 32) <= 2) {
        int v11 = 2;
      }
      else {
        int v11 = (2684355 * (unint64_t)(*(unsigned __int16 *)(v10 + 140) + 1599)) >> 32;
      }
      sub_100026C30((uint64_t)&v15 + 8);
      DWORD2(v15) += v11;
      v13[1] = v14;
      LOWORD(v13[0]) = 32;
      return sub_100026DA8((uint64_t)sub_100187FF0, v13, 0);
    }
    else
    {
      return 1301;
    }
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
}

uint64_t sub_100187FF0(uint64_t a1)
{
  uint64_t v2 = *(void *)(a1 + 8);
  uint64_t v3 = sub_100197A30(v2);
  if (!v3)
  {
    if (sub_100058654())
    {
      uint64_t v13 = 1301;
      sub_100056E24((uint64_t)"deferredEnforceLinkPolicy orphaned %!", v14, v15, v16, v17, v18, v19, v20, 1301);
      uint64_t v21 = sub_100050B4C(0x2Cu);
      if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        return (*(uint64_t (**)(uint64_t, uint64_t, void))(v2 + 8))(v13, v2, *(unsigned int *)(v2 + 20));
      }
      sub_100744F6C();
    }
    uint64_t v13 = 1301;
    return (*(uint64_t (**)(uint64_t, uint64_t, void))(v2 + 8))(v13, v2, *(unsigned int *)(v2 + 20));
  }
  uint64_t v4 = v3;
  if (!*(unsigned char *)(v3 + 54))
  {
    uint64_t v22 = sub_100022FE8(0x10uLL);
    *(void *)(v4 + 128) = v22;
    if (v22)
    {
      *uint64_t v22 = *(_OWORD *)(v2 + 8);
      if (*(unsigned char *)(*(void *)(v4 + 128) + 10) && *(unsigned char *)(v4 + 144))
      {
        uint64_t result = sub_100187974((uint64_t)sub_1001890D4, v4, 0);
        if (!result) {
          return result;
        }
        uint64_t v13 = result;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"startRoleSwitch failed %!", v24, v25, v26, v27, v28, v29, v30, v13);
          int v31 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        goto LABEL_28;
      }
      return sub_100189198(v4);
    }
    if (sub_100058654())
    {
      uint64_t v13 = 106;
      sub_100056E24((uint64_t)"OI_Malloc failed %!", v32, v33, v34, v35, v36, v37, v38, 106);
      uint64_t v39 = sub_100050B4C(0x2Cu);
      if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
        goto LABEL_28;
      }
      sub_100744F6C();
    }
    uint64_t v13 = 106;
LABEL_28:
    uint64_t v40 = *(void **)(v4 + 128);
    if (v40)
    {
      sub_100023010(v40);
      *(void *)(v4 + 128) = 0;
    }
    return (*(uint64_t (**)(uint64_t, uint64_t, void))(v2 + 8))(v13, v2, *(unsigned int *)(v2 + 20));
  }
  if (sub_100262A50(v2 + 24))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Enforce policy on %: deferral timed out, giving up", v5, v6, v7, v8, v9, v10, v11, v4 + 48);
      int v12 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v13 = 118;
    goto LABEL_28;
  }
  uint64_t result = sub_1000268E4((uint64_t)sub_100187FF0, (const void **)a1, 1, 0);
  uint64_t v13 = result;
  if (result) {
    goto LABEL_28;
  }
  return result;
}

void sub_10018823C(uint64_t a1, uint64_t a2, int a3)
{
  if (!xmmword_100A19860) {
    return;
  }
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIEventHandler_RoleChange: %! (%:)", v5, v6, v7, v8, v9, v10, v11, a1);
      int v12 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v13 = sub_100197A30(a2);
    if (!v13) {
      goto LABEL_17;
    }
  }
  else
  {
    uint64_t v15 = sub_100197A30(a2);
    if (!v15)
    {
LABEL_17:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCIEventHandler_RoleChange, no connection to %:", v19, v20, v21, v22, v23, v24, v25, a2);
        uint64_t v26 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return;
    }
    uint64_t v13 = v15;
    *(unsigned char *)(v15 + 144) = a3;
    sub_10017DFB0();
    if (!a3 && sub_100181F3C(*(unsigned __int8 *)(v13 + 54))) {
      sub_1001884A4(v13, *(unsigned __int16 *)(v13 + 140));
    }
  }
  if (*(unsigned char *)(v13 + 54) == 5)
  {
    uint64_t v16 = *(unsigned char **)(v13 + 120);
    if (!v16)
    {
      sub_10025B8C0();
      uint64_t v16 = *(unsigned char **)(v13 + 120);
    }
    switch(*v16)
    {
      case 0:
        uint64_t v17 = v13;
        uint64_t v18 = a1;
        goto LABEL_24;
      case 1:
      case 3:
        return;
      case 2:
        uint64_t v35 = sub_10019304C(16);
        if (v35)
        {
          uint64_t v36 = v35;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCICMD_SetConnectionEncryption failed %!, forcing disconnect", v37, v38, v39, v40, v41, v42, v43, v36);
            uint64_t v44 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
          sub_100188578(v13, v36);
          sub_10017C104(a2, 14);
        }
        else
        {
          **(unsigned char **)(v13 + 120) = 3;
        }
        break;
      default:
        sub_10025B8C0();
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCIEventHandler_RoleChange %!", v27, v28, v29, v30, v31, v32, v33, 105);
          uint64_t v34 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        uint64_t v17 = v13;
        uint64_t v18 = 105;
LABEL_24:
        sub_100188578(v17, v18);
        break;
    }
  }
}

uint64_t sub_1001884A4(uint64_t a1, unsigned int a2)
{
  if (!sub_100197698(a1)) {
    return 1301;
  }
  if (sub_10017B9A8()) {
    unsigned int v10 = 800;
  }
  else {
    unsigned int v10 = a2;
  }
  if (v10 <= *(unsigned __int16 *)(a1 + 142)) {
    LOWORD(v10) = *(_WORD *)(a1 + 142);
  }
  *(_WORD *)(a1 + 140) = v10;
  if (*(unsigned char *)(a1 + 144)) {
    return 0;
  }
  uint64_t v11 = sub_10001BDE0(97, (uint64_t)sub_100188628, v4, v5, v6, v7, v8, v9, a1);
  if (v11)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteLinkSupervisionTimeout failed %!", v13, v14, v15, v16, v17, v18, v19, v11);
      uint64_t v20 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  return v11;
}

void sub_100188578(uint64_t a1, uint64_t a2)
{
  if (!sub_100197698(a1)) {
    sub_10025B8C0();
  }
  uint64_t v4 = *(void **)(a1 + 120);
  if (!v4)
  {
    sub_10025B8C0();
    uint64_t v4 = *(void **)(a1 + 120);
  }
  uint64_t v7 = (void (*)(uint64_t, uint64_t, uint64_t))v4[1];
  sub_100023010(v4);
  *(void *)(a1 + 120) = 0;
  int v5 = *(unsigned __int8 *)(a1 + 54);
  if ((v5 - 6) >= 2)
  {
    if (v5 == 5) {
      *(unsigned char *)(a1 + 54) = 0;
    }
    else {
      sub_10025B8C0();
    }
  }
  if (v7)
  {
    uint64_t v6 = *(unsigned __int8 *)(a1 + 144);
    v7(a2, a1 + 48, v6);
  }
}

void sub_100188628(uint64_t a1)
{
  if (a1 && sub_100058654())
  {
    sub_100056E24((uint64_t)"Failed to write LinkTO %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744FE4();
    }
  }
}

void sub_1001886A0(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v57 = a2;
  if (xmmword_100A19860)
  {
    if (*(unsigned char *)(a2 + 54) == 5)
    {
      uint64_t v6 = *(unsigned char **)(a2 + 120);
      if (!v6)
      {
        sub_10025B8C0();
        uint64_t v6 = *(unsigned char **)(a2 + 120);
      }
      switch(*v6)
      {
        case 0:
        case 2:
          return;
        case 1:
          if (a1 || a3)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Failed to disable encryption %! %:, encrypt = %d", v36, v37, v38, v39, v40, v41, v42, a1);
              uint64_t v43 = sub_100050B4C(0x2Cu);
              if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
LABEL_28:
              }
                sub_100744F6C();
            }
LABEL_29:
            uint64_t v25 = a2;
            uint64_t v26 = 1335;
LABEL_38:
            sub_100188578(v25, v26);
          }
          else
          {
            if (*(unsigned __int8 *)(a2 + 144) == v6[1])
            {
              uint64_t v7 = sub_10019304C(16);
              if (v7)
              {
                uint64_t v8 = v7;
                if (!sub_100058654()) {
                  goto LABEL_37;
                }
                sub_100056E24((uint64_t)"OI_HCICMD_SetConnectionEncryption failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
                uint64_t v16 = sub_100050B4C(0x2Cu);
                if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_37;
                }
                goto LABEL_36;
              }
              uint64_t v53 = *(char **)(a2 + 120);
              char v54 = 3;
            }
            else
            {
              uint64_t v44 = sub_10019304C(47);
              if (v44)
              {
                uint64_t v8 = v44;
                if (!sub_100058654()) {
                  goto LABEL_37;
                }
                sub_100056E24((uint64_t)"OI_HCICMD_SwitchRole failed %!", v45, v46, v47, v48, v49, v50, v51, v8);
                uint64_t v52 = sub_100050B4C(0x2Cu);
                if (!os_log_type_enabled(v52, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_37;
                }
LABEL_36:
                sub_100744F6C();
LABEL_37:
                uint64_t v25 = a2;
                uint64_t v26 = v8;
                goto LABEL_38;
              }
              uint64_t v53 = *(char **)(a2 + 120);
              char v54 = 2;
            }
            *uint64_t v53 = v54;
          }
          break;
        case 3:
          uint64_t v27 = *(unsigned int *)(a2 + 244);
          if (v27)
          {
            sub_100026DB4(v27);
            *(_DWORD *)(a2 + 244) = 0;
          }
          if (a1 || a3)
          {
            sub_100188578(a2, a1);
            return;
          }
          if (!sub_100058654()) {
            goto LABEL_29;
          }
          sub_100056E24((uint64_t)"Failed to re-enable encryption after role switch", v28, v29, v30, v31, v32, v33, v34, v55);
          uint64_t v35 = sub_100050B4C(0x2Cu);
          if (!os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
            goto LABEL_29;
          }
          goto LABEL_28;
        default:
          sub_10025B8C0();
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCIEventHandler_RoleChange %!", v17, v18, v19, v20, v21, v22, v23, 105);
            uint64_t v24 = sub_100050B4C(0x2Cu);
            if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
          uint64_t v25 = a2;
          uint64_t v26 = 105;
          goto LABEL_38;
      }
    }
    else if (!a3)
    {
      v56[1] = &v57;
      v56[0] = (const void *)8;
      sub_1000268E4((uint64_t)sub_1001889A4, v56, 10, (int *)(a2 + 244));
    }
  }
}

void sub_1001889A4(uint64_t a1)
{
  uint64_t v1 = **(void **)(a1 + 8);
  if (sub_100197698(v1))
  {
    if (sub_100253590(v1))
    {
      *(_DWORD *)(v1 + 244) = 0;
    }
    else if (sub_10019304C(16) && sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not re-enable encryption on the link.", v2, v3, v4, v5, v6, v7, v8, v1);
      uint64_t v9 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

void sub_100188A44(uint64_t a1)
{
  unsigned int v2 = *(unsigned __int8 *)(a1 + 54);
  if (*(void *)(a1 + 120))
  {
    sub_100188578(a1, 1301);
    if (v2 != 5)
    {
      if (sub_100058654())
      {
        uint64_t v3 = sub_1001991F8(v2);
        sub_100056E24((uint64_t)"Connection Handle state inconsistent: %s", v4, v5, v6, v7, v8, v9, v10, (uint64_t)v3);
        uint64_t v11 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
  if (*(void *)(a1 + 128))
  {
    sub_100188B48(a1, 1301);
    if (v2 != 4)
    {
      if (sub_100058654())
      {
        uint64_t v12 = sub_1001991F8(v2);
        sub_100056E24((uint64_t)"Connection Handle state inconsistent: %s", v13, v14, v15, v16, v17, v18, v19, (uint64_t)v12);
        uint64_t v20 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
  }
}

uint64_t sub_100188B48(uint64_t a1, uint64_t a2)
{
  if (!sub_100197698(a1)) {
    sub_10025B8C0();
  }
  uint64_t v4 = *(void **)(a1 + 128);
  if (!v4)
  {
    sub_10025B8C0();
    uint64_t v4 = *(void **)(a1 + 128);
  }
  if (!*v4) {
    sub_10025B8C0();
  }
  int v5 = *(unsigned __int8 *)(a1 + 54);
  if ((v5 - 6) >= 2 && v5 != 0)
  {
    if (v5 == 4) {
      *(unsigned char *)(a1 + 54) = 0;
    }
    else {
      sub_10025B8C0();
    }
  }
  uint64_t v7 = *(unsigned int **)(a1 + 128);
  uint64_t v10 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t))v7;
  uint64_t v8 = v7[3];
  sub_100023010(v7);
  *(void *)(a1 + 128) = 0;

  return v10(a2, a1 + 48, v8);
}

BOOL sub_100188C08(BOOL result)
{
  char v1 = result;
  if (result && !byte_100A0496A) {
    uint64_t result = sub_100187E90(0);
  }
  byte_100A0496A = v1;
  return result;
}

uint64_t sub_100188C44()
{
  return byte_100A0496A;
}

void sub_100188C50(uint64_t a1, int a2)
{
  int v13 = a2;
  v12[1] = &v13;
  v12[0] = (const void *)4;
  if (a1)
  {
    if (*(unsigned char *)(a1 + 54) != 5)
    {
      uint64_t v2 = sub_100026DA8((uint64_t)sub_100187CA4, v12, 0);
      if (v2)
      {
        uint64_t v3 = v2;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Gentle Central dispatch failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
          uint64_t v11 = sub_100050B4C(0x2Cu);
          if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
            sub_1007456E8();
          }
        }
      }
    }
  }
}

uint64_t sub_100188D00(uint64_t a1, uint64_t a2, int a3)
{
  if (!sub_100197698(a2)) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)(a2 + 54)) {
    sub_10025B8C0();
  }
  if (*(unsigned __int8 *)(a2 + 144) == a3) {
    sub_10025B8C0();
  }
  if (*(void *)(a2 + 120)) {
    sub_10025B8C0();
  }
  uint64_t v6 = sub_100022FE8(0x10uLL);
  *(void *)(a2 + 120) = v6;
  if (v6)
  {
    v6[1] = a3;
    *(void *)(*(void *)(a2 + 120) + 8) = a1;
    if (sub_100253590(a2)
      && (*(unsigned char *)(qword_100A195B0 + 13) || (*(unsigned char *)(a2 + 263) & 4) == 0 || (byte_100A195D1 & 4) == 0))
    {
      uint64_t v7 = sub_10019304C(16);
      if (!v7)
      {
        *(unsigned char *)(a2 + 54) = 5;
        **(unsigned char **)(a2 + 120) = 1;
        return v7;
      }
      if (!sub_100058654()) {
        goto LABEL_26;
      }
      sub_100056E24((uint64_t)"OI_HCICMD_SetConnectionEncryption failed %!", v8, v9, v10, v11, v12, v13, v14, v7);
      uint64_t v15 = sub_100050B4C(0x2Cu);
      if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        goto LABEL_26;
      }
      goto LABEL_25;
    }
    uint64_t v7 = sub_10019304C(47);
    if (!v7)
    {
      *(unsigned char *)(a2 + 54) = 5;
      **(unsigned char **)(a2 + 120) = 0;
      return v7;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_SwitchRole failed %!", v24, v25, v26, v27, v28, v29, v30, v7);
      uint64_t v31 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
LABEL_25:
      }
        sub_100744F6C();
    }
  }
  else
  {
    if (sub_100058654())
    {
      uint64_t v7 = 106;
      sub_100056E24((uint64_t)"OI_Malloc failed %!", v16, v17, v18, v19, v20, v21, v22, 106);
      uint64_t v23 = sub_100050B4C(0x2Cu);
      if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        goto LABEL_26;
      }
      sub_100744F6C();
    }
    uint64_t v7 = 106;
  }
LABEL_26:
  uint64_t v32 = *(void **)(a2 + 120);
  if (v32) {
    sub_100023010(v32);
  }
  return v7;
}

void sub_100188F08(uint64_t a1, uint64_t a2, int a3)
{
  if (!a2)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"roleChangeCb : NULL address", v19, v20, v21, v22, v23, v24, v25, v43);
    uint64_t v26 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_11:
    sub_100744F6C();
    return;
  }
  uint64_t v6 = sub_100197A30(a2);
  if (!v6)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"roleChangeCb : The connection is gone.", v27, v28, v29, v30, v31, v32, v33, v43);
    uint64_t v34 = sub_100050B4C(0x2Cu);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_11;
  }
  uint64_t v7 = v6;
  if (!*(unsigned char *)(v6 + 213)) {
    return;
  }
  *(unsigned char *)(v6 + 213) = 0;
  uint64_t v8 = *(void *)(v6 + 216);
  uint64_t v44 = *(void (**)(void))(v7 + 216);
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"roleChangeCb : Cound not change mode : %!", v9, v10, v11, v12, v13, v14, v15, a1);
      uint64_t v16 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v17 = *(unsigned __int8 *)(v7 + 144);
    uint64_t v18 = a1;
LABEL_20:
    ((void (*)(uint64_t, uint64_t, uint64_t))v44)(v18, a2, v17);
    return;
  }
  if (a3)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"roleChangeCb : why didn't we unsniff ? We want to change role !", v35, v36, v37, v38, v39, v40, v41, v43);
      uint64_t v42 = sub_100050B4C(0x2Cu);
      if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v17 = *(unsigned __int8 *)(v7 + 144);
    uint64_t v18 = 0;
    goto LABEL_20;
  }
  if (sub_100188D00(v8, v7, *(unsigned __int8 *)(v7 + 276)))
  {
    v44();
  }
}

void sub_1001890D4(uint64_t a1, uint64_t a2)
{
  uint64_t v3 = sub_100197A30(a2);
  if (v3)
  {
    if (a1)
    {
      sub_100188B48(v3, a1);
    }
    else
    {
      sub_100189198(v3);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"enforcePolicyRsCb Orphaned!  %!", v4, v5, v6, v7, v8, v9, v10, 105);
    uint64_t v11 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_100189198(uint64_t a1)
{
  if (!sub_100197698(a1)) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)(a1 + 54)) {
    sub_10025B8C0();
  }
  uint64_t v8 = *(void *)(a1 + 128);
  if (!v8)
  {
    sub_10025B8C0();
    uint64_t v8 = *(void *)(a1 + 128);
  }
  int v9 = *(_WORD *)(v8 + 8) & 6;
  int v10 = *(unsigned __int16 *)(a1 + 138);
  if (*(unsigned char *)(v8 + 10)) {
    int v11 = 0;
  }
  else {
    int v11 = v10 & 1;
  }
  int v12 = v9 | v11;
  *(unsigned char *)(a1 + 54) = 4;
  if (v12 == v10)
  {
    return sub_100188B48(a1, 0);
  }
  else
  {
    *(_WORD *)(a1 + 138) = v12;
    uint64_t result = sub_10001BDE0(49, (uint64_t)sub_1001892CC, v2, v3, v4, v5, v6, v7, a1);
    if (result)
    {
      uint64_t v14 = result;
      *(_WORD *)(a1 + 138) = -1;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WriteLinkPolicySettings failed %!", v15, v16, v17, v18, v19, v20, v21, v14);
        uint64_t v22 = sub_100050B4C(0x2Cu);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return sub_100188B48(a1, v14);
    }
  }
  return result;
}

void sub_1001892CC(uint64_t a1, uint64_t a2)
{
  if (a1)
  {
    if (sub_100058654()
      && (sub_100056E24((uint64_t)"enforcementWriteLinkPolicyCb failed %!", v4, v5, v6, v7, v8, v9, v10, a1),
          int v11 = sub_100050B4C(0x2Cu),
          os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)))
    {
      sub_100744F6C();
      if (a2) {
        goto LABEL_5;
      }
    }
    else if (a2)
    {
LABEL_5:
      *(_WORD *)(a2 + 138) = -1;
LABEL_7:
      sub_100188B48(a2, a1);
      return;
    }
  }
  else if (a2)
  {
    goto LABEL_7;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"enforcementWriteLinkPolicyCb orphaned!  %!", v12, v13, v14, v15, v16, v17, v18, 1301);
    uint64_t v19 = sub_100050B4C(0x2Cu);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_1001893B4(uint64_t a1, uint64_t a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!a1) {
    return 101;
  }
  if (!a2)
  {
    uint64_t v4 = &qword_100A04970;
    if (qword_100A04970) {
      return 1327;
    }
LABEL_10:
    uint64_t result = 0;
    *uint64_t v4 = a1;
    return result;
  }
  uint64_t v3 = sub_100197A30(a2);
  if (v3)
  {
    uint64_t v4 = (uint64_t *)(v3 + 80);
    if (*(void *)(v3 + 80)) {
      return 1327;
    }
    goto LABEL_10;
  }
  return 1301;
}

uint64_t sub_10018943C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!a1) {
    return 101;
  }
  if (a2)
  {
    uint64_t v5 = sub_100197A30(a2);
    if (v5)
    {
      uint64_t v6 = v5;
      if (!*(void *)(v5 + 88))
      {
        uint64_t result = 0;
        *(void *)(v6 + 88) = a1;
        *(void *)(v6 + 96) = a3;
        return result;
      }
      return 1327;
    }
    return 1301;
  }
  else
  {
    if (qword_100A04978) {
      return 1327;
    }
    uint64_t result = 0;
    qword_100A04978 = a1;
  }
  return result;
}

uint64_t sub_1001894D0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!a3)
  {
    qword_100A04980 = a1;
    uint64_t v6 = &qword_100A04988;
    goto LABEL_7;
  }
  uint64_t v5 = sub_100197A30(a3);
  if (v5)
  {
    *(void *)(v5 + 104) = a1;
    uint64_t v6 = (uint64_t *)(v5 + 112);
LABEL_7:
    uint64_t result = 0;
    *uint64_t v6 = a2;
    return result;
  }
  return 1301;
}

uint64_t sub_100189548(uint64_t result)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (result)
  {
    uint64_t v1 = sub_100197A30(result);
    if (v1)
    {
      uint64_t v2 = v1;
      uint64_t result = 0;
      *(void *)(v2 + 104) = 0;
      *(void *)(v2 + 112) = 0;
    }
    else
    {
      return 1301;
    }
  }
  else
  {
    qword_100A04980 = 0;
    qword_100A04988 = 0;
  }
  return result;
}

uint64_t sub_1001895A8(uint64_t a1)
{
  uint64_t v4 = 0;
  if (!xmmword_100A19860) {
    return 103;
  }
  uint64_t v1 = sub_100197A30(a1);
  if (!v1) {
    return 1301;
  }
  uint64_t v2 = v1;
  if (sub_1001990B0(&v4))
  {
    while (*(void *)(v4 + 48) != v2 || *(unsigned char *)(v4 + 56))
    {
      if (!sub_1001990B0(&v4)) {
        goto LABEL_7;
      }
    }
    return 141;
  }
  else
  {
LABEL_7:
    uint64_t result = 0;
    *(void *)(v2 + 80) = 0;
  }
  return result;
}

uint64_t sub_10018963C(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (a1)
  {
    if (sub_100197A88(a1))
    {
      return 141;
    }
    else
    {
      uint64_t result = sub_100197A30(a1);
      if (result)
      {
        uint64_t v3 = result;
        uint64_t result = 0;
        *(void *)(v3 + 88) = 0;
        *(void *)(v3 + 96) = 0;
      }
    }
  }
  else
  {
    uint64_t result = 0;
    qword_100A04978 = 0;
  }
  return result;
}

uint64_t sub_1001896B4(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (!sub_100197740(a1)) {
    return 1301;
  }
  uint64_t v9 = sub_10019304C(5u, v2, v3, v4, v5, v6, v7, v8, a1);
  uint64_t result = sub_10019F308(a1, v9);
  if (!result) {
    byte_100A0499B = 1;
  }
  return result;
}

uint64_t sub_100189730()
{
  uint64_t result = dword_100A0499C;
  if (dword_100A0499C) {
    return sub_10025BE30(dword_100A0499C);
  }
  return result;
}

uint64_t sub_100189744(uint64_t a1)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (HIBYTE(word_100A04991)) {
    return 1319;
  }
  if ((_BYTE)word_100A04991)
  {
    if (*(_DWORD *)a1 != dword_100A04995 || *(unsigned __int16 *)(a1 + 4) != (unsigned __int16)word_100A04999) {
      return 1319;
    }
  }
  unsigned int v5 = sub_100198E54();
  if (v5 >= *(unsigned __int8 *)(sub_10025B218(0x28u) + 1))
  {
    if (sub_100058654())
    {
      sub_10025B218(0x28u);
      uint64_t v1 = 1309;
      sub_100056E24((uint64_t)"OI_DEVMGR_ScoCreateConnection: %! (%d) %:", v7, v8, v9, v10, v11, v12, v13, 1309);
      uint64_t v14 = sub_100050B4C(0x3Eu);
      if (!os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        return v1;
      }
      sub_100744F6C();
    }
    return 1309;
  }
  if (!qword_100A04970)
  {
    uint64_t v15 = sub_100197A30(a1);
    if (!v15 || !*(void *)(v15 + 80)) {
      return 1328;
    }
  }
  uint64_t v1 = sub_10017B9C4((uint64_t)sub_1001898B8, a1);
  if (!v1)
  {
    *(__int16 *)((char *)&word_100A04991 + 1) = 1;
    int v6 = *(_DWORD *)a1;
    word_100A04999 = *(_WORD *)(a1 + 4);
    dword_100A04995 = v6;
    dword_100A0499C = 0;
    byte_100A04994 = 0;
  }
  return v1;
}

void sub_1001898B8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (HIBYTE(word_100A04991))
  {
    sub_10018A16C(a1, a3, 3, 0);
  }
  else
  {
    if (!a1) {
      sub_10025B8C0();
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Orphan connectAclForScoCb", v3, v4, v5, v6, v7, v8, v9, v11);
      uint64_t v10 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

uint64_t sub_100189950(unsigned __int16 *a1, char *a2, size_t a3, char a4)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (byte_100A0499B)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Sco Disconnect is in progress", v4, v5, v6, v7, v8, v9, v10, v13);
      uint64_t v11 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 1347;
  }
  else
  {
    return sub_10019DF4C(a1, a2, a3, a4);
  }
}

uint64_t sub_1001899F0()
{
  return byte_100A0499B;
}

uint64_t sub_1001899FC(_WORD *a1, _WORD *a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (a1 && a2)
  {
    sub_10019E2E8(a1);
    __int16 v3 = sub_10019E51C();
    uint64_t result = 0;
    *a2 = v3;
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
  return result;
}

uint64_t sub_100189A5C(int a1, int a2)
{
  if (!xmmword_100A19860) {
    return 103;
  }
  if (a1 && a2)
  {
    return sub_10019E32C(a1, a2);
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
}

uint64_t sub_100189AB4()
{
  if (xmmword_100A19860) {
    return sub_10019E374();
  }
  else {
    return 103;
  }
}

void sub_100189AD0()
{
  word_100A04991 = 0;
  byte_100A0499B = 0;
  qword_100A04970 = 0;
  qword_100A04978 = 0;
  qword_100A04980 = 0;
  qword_100A04988 = 0;
}

uint64_t sub_100189B04(uint64_t a1, uint64_t a2)
{
  uint64_t v5 = a1 + 48;
  int v4 = *(_DWORD *)(a1 + 48);
  uint64_t v33 = 0;
  int v6 = 0;
  if (dword_100A04995 == v4 && word_100A04999 == *(_WORD *)(a1 + 52))
  {
    byte_100A0499B = 0;
    if (HIBYTE(word_100A04991)) {
      BOOL v8 = 1;
    }
    else {
      BOOL v8 = word_100A04991 == 1;
    }
    if (v8)
    {
      uint64_t v9 = sub_100197D1C((uint64_t)&dword_100A04995);
      sub_100189D58((uint64_t)v9, v5, 0, a2);
      int v6 = HIBYTE(word_100A04991);
    }
    word_100A04991 = 0;
  }
  uint64_t v10 = *(void *)(a1 + 80);
  uint64_t v11 = qword_100A04970;
  uint64_t result = sub_1001990B0((uint64_t *)&v33);
  if (result)
  {
    if (v10) {
      uint64_t v13 = v10;
    }
    else {
      uint64_t v13 = v11;
    }
    uint64_t v32 = 136446210;
    do
    {
      if (*((void *)v33 + 6) == a1)
      {
        if (v13) {
          (*(void (**)(void))(v13 + 8))(0);
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Disconnecting SCO riding on top of ACL", v14, v15, v16, v17, v18, v19, v20, v32);
          uint64_t v21 = sub_100050B4C(0x3Eu);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
          {
            uint64_t v22 = sub_100050714();
            *(_DWORD *)int buf = v32;
            uint64_t v35 = v22;
            _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        sub_10019E2C0();
        sub_10017BD74(a1, 2u);
        sub_1001984E0(v33);
        uint64_t v33 = 0;
      }
      uint64_t result = sub_1001990B0((uint64_t *)&v33);
    }
    while ((result & 1) != 0);
  }
  if (v6 == 1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received disconnect while OB SCO connection was in progress", v23, v24, v25, v26, v27, v28, v29, v32);
      uint64_t v30 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v31 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v35 = v31;
        _os_log_impl((void *)&_mh_execute_header, v30, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    return sub_10017BD74(a1, 2u);
  }
  return result;
}

void sub_100189D58(uint64_t a1, uint64_t a2, int a3, uint64_t a4)
{
  if (a1)
  {
    *(unsigned char *)(a1 + 58) = a3;
    uint64_t v7 = *(void *)(a1 + 48);
    if (word_100A04991 != 2)
    {
      int v8 = HIBYTE(word_100A04991);
      BOOL v10 = v7
         && HIBYTE(word_100A04991) | word_100A04991
         && *(_DWORD *)(v7 + 48) == dword_100A04995
         && *(unsigned __int16 *)(v7 + 52) == (unsigned __int16)word_100A04999;
      goto LABEL_25;
    }
  }
  else
  {
    int v11 = word_100A04991;
    if (word_100A04991 != 2)
    {
LABEL_68:
      if (byte_100A04990) {
        --byte_100A04990;
      }
      if ((v11 - 3) <= 1)
      {
        LOBYTE(word_100A04991) = 0;
        uint64_t v44 = sub_100197A30(a2);
        if (v44)
        {
          uint64_t v45 = *(void (***)(uint64_t, void, uint64_t))(v44 + 80);
          if (v45)
          {
            uint64_t v46 = *v45;
            if (*v45)
            {
              v46(a4, 0, a2);
            }
          }
        }
      }
      return;
    }
    uint64_t v7 = 0;
  }
  if (a4)
  {
    LOBYTE(word_100A04991) = 0;
    return;
  }
  BOOL v10 = 0;
  int v8 = HIBYTE(word_100A04991);
  if (v7 && HIBYTE(word_100A04991)) {
    BOOL v10 = *(_DWORD *)(v7 + 48) == dword_100A04995 && *(unsigned __int16 *)(v7 + 52) == (unsigned __int16)word_100A04999;
  }
  if (!a1)
  {
    int v11 = 2;
    goto LABEL_68;
  }
LABEL_25:
  if (a3 == 2 && a4 && v10 && v8 && ((a4 - 702) > 8 || ((1 << (a4 + 66)) & 0x1C1) == 0))
  {
    sub_10018A16C(0, v7, 0, a4);
    return;
  }
  if (a4 && v10)
  {
    if (dword_100A0499C)
    {
      sub_100026DB4(dword_100A0499C);
      dword_100A0499C = 0;
    }
    uint64_t v13 = sub_10017BD74(v7, 0x13u);
    if (v13)
    {
      uint64_t v14 = v13;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_LP_DisconnectReq failed: %! (%d)", v15, v16, v17, v18, v19, v20, v21, v14);
        uint64_t v22 = sub_100050B4C(0x3Eu);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
        {
          sub_100744F6C();
          if (!v10) {
            goto LABEL_52;
          }
          goto LABEL_49;
        }
      }
    }
LABEL_48:
    if (!v10) {
      goto LABEL_52;
    }
    goto LABEL_49;
  }
  if (v10 || a4 != 0) {
    goto LABEL_48;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIEventHandler_ConnectionComplete - unknown SCO connection (%:)", v23, v24, v25, v26, v27, v28, v29, v7 + 48);
    uint64_t v30 = sub_100050B4C(0x3Eu);
    if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR))
    {
      sub_100744F6C();
      if (v7) {
        goto LABEL_45;
      }
      goto LABEL_44;
    }
  }
  if (!v7) {
LABEL_44:
  }
    sub_10025B8C0();
LABEL_45:
  uint64_t v31 = sub_10017BCA0(v7);
  if (!v31) {
    goto LABEL_48;
  }
  uint64_t v32 = v31;
  if (!sub_100058654()) {
    goto LABEL_48;
  }
  sub_100056E24((uint64_t)"OI_LP_ConnectionAdded failed: %! (%d)", v33, v34, v35, v36, v37, v38, v39, v32);
  uint64_t v40 = sub_100050B4C(0x3Eu);
  if (!os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
    goto LABEL_48;
  }
  sub_100744F6C();
  if (!v10) {
    goto LABEL_52;
  }
LABEL_49:
  if (HIBYTE(word_100A04991)) {
    HIBYTE(word_100A04991) = 0;
  }
  else {
    LOBYTE(word_100A04991) = 0;
  }
LABEL_52:
  if (v7) {
    uint64_t v41 = *(void (***)(uint64_t, uint64_t, uint64_t))(v7 + 80);
  }
  else {
    uint64_t v41 = 0;
  }
  if (!v41) {
    uint64_t v41 = (void (**)(uint64_t, uint64_t, uint64_t))qword_100A04970;
  }
  if (v41)
  {
    uint64_t v42 = *v41;
    if (v42)
    {
      if (a4 && HIBYTE(word_100A04991) == 1) {
        goto LABEL_66;
      }
      if (v7) {
        uint64_t v43 = v7 + 48;
      }
      else {
        uint64_t v43 = 0;
      }
      v42(a4, a1, v43);
    }
  }
  if (a4) {
LABEL_66:
  }
    sub_1001984E0((unsigned __int16 *)a1);
}

BOOL sub_10018A0F8(uint64_t a1)
{
  if (word_100A04991 == 2) {
    return 1;
  }
  if (a1)
  {
    if (dword_100A04995 != *(_DWORD *)a1 || word_100A04999 != *(_WORD *)(a1 + 4)) {
      return 0;
    }
  }
  if (byte_100A0499B) {
    return 1;
  }
  return (word_100A04991 & 0xFB) != 0 && word_100A04991 != 3 || HIBYTE(word_100A04991) != 0;
}

void sub_10018A16C(uint64_t a1, uint64_t a2, int a3, uint64_t a4)
{
  sub_100185430();
  if (!HIBYTE(word_100A04991)) {
    sub_10025B8C0();
  }
  uint64_t v40 = 0;
  uint64_t v41 = 0;
  uint64_t v38 = 0;
  uint64_t v39 = 0;
  if (!sub_100197698(a2)) {
    a2 = 0;
  }
  if (a1 || !a2)
  {
    if (!a1) {
      return;
    }
LABEL_71:
    HIBYTE(word_100A04991) = 0;
    if (!a2)
    {
      uint64_t v26 = 0;
      goto LABEL_74;
    }
LABEL_72:
    uint64_t v26 = *(void (***)(uint64_t, uint64_t, int *))(a2 + 80);
LABEL_74:
    if (!v26) {
      uint64_t v26 = (void (**)(uint64_t, uint64_t, int *))qword_100A04970;
    }
    if (v26)
    {
      uint64_t v27 = *v26;
      if (v27) {
        v27(a1, a2, &dword_100A04995);
      }
    }
    return;
  }
  if (!sub_100197698(a2)) {
    sub_10025B8C0();
  }
  if (*(_DWORD *)(a2 + 48) != dword_100A04995 || *(unsigned __int16 *)(a2 + 52) != (unsigned __int16)word_100A04999) {
    sub_10025B8C0();
  }
  int v9 = *(char *)(a2 + 152);
  if ((v9 & 0x80000000) == 0)
  {
    if (*(unsigned char *)(sub_10025B218(0x28u) + 10) && (*(unsigned char *)(a2 + 152) & 0x7F) == 2)
    {
      if (dword_100A0499C)
      {
        if (!a3) {
          goto LABEL_32;
        }
LABEL_23:
        LODWORD(v41) = a3 - 1;
        uint64_t v39 = &v40;
        uint64_t v40 = a2;
        LOWORD(v38) = 16;
        sub_1000268E4((uint64_t)sub_10018B824, &v38, (42949673 * (unint64_t)(*(unsigned __int16 *)(a2 + 136) + 99)) >> 32, &dword_100A0499C);
        return;
      }
      uint64_t v37 = a2;
      if (!sub_10019304C(42))
      {
        *(unsigned char *)(a2 + 152) |= 0x80u;
        if (a3) {
          goto LABEL_23;
        }
      }
    }
LABEL_32:
    dword_100A0499C = 0;
    uint64_t v12 = (void *)qword_100A04980;
    if (!qword_100A04980) {
      uint64_t v12 = &unk_1007BA0F0;
    }
    if (*(void *)(a2 + 104)) {
      uint64_t v12 = *(void **)(a2 + 104);
    }
    if (byte_100A04993)
    {
      int v13 = 0;
      while (1)
      {
        uint64_t v14 = (void *)*v12;
        if (!*v12) {
          break;
        }
        ++v13;
        uint64_t v12 = (void *)*v12;
        if (byte_100A04993 <= v13) {
          goto LABEL_43;
        }
      }
      uint64_t v14 = v12;
      a1 = a4;
      if (a4) {
        goto LABEL_52;
      }
    }
    else
    {
      uint64_t v14 = v12;
    }
LABEL_43:
    ++byte_100A04993;
    if (!*((_WORD *)v14 + 9)) {
      sub_100185430();
    }
    if (*(unsigned char *)(a2 + 224))
    {
      sub_10018220C(a2);
      if (*(unsigned char *)(a2 + 278))
      {
        uint64_t v15 = sub_1001FE244();
      }
      else
      {
        uint64_t v37 = a2;
        uint64_t v15 = sub_10019304C(26);
      }
      a1 = v15;
      if (!v15) {
        goto LABEL_79;
      }
    }
    else
    {
      a1 = 1360;
    }
LABEL_52:
    if (byte_100A04994 > 2u) {
      goto LABEL_65;
    }
    ++byte_100A04994;
    byte_100A04993 = -1;
    do
      uint64_t v14 = (void *)*v14;
    while (v14);
    if (!*(unsigned char *)(a2 + 225) && sub_100198D88() > 1)
    {
      a1 = 13;
LABEL_65:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"SCO/eSCO connection failed, decrementing ACL reference counter and releasing SCO connection for addr=%:", v17, v18, v19, v20, v21, v22, v23, (uint64_t)&dword_100A04995);
        uint64_t v24 = sub_100050B4C(0x3Eu);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v43 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v24, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      uint64_t v25 = (unsigned __int16 *)sub_100197A88((uint64_t)&dword_100A04995);
      if (v25) {
        sub_1001984E0(v25);
      }
      sub_10017BD74(a2, 0x13u);
      goto LABEL_71;
    }
    if (*(unsigned char *)(a2 + 278))
    {
      unsigned int v16 = sub_1001FE244();
    }
    else
    {
      uint64_t v37 = a2;
      unsigned int v16 = sub_10019304C(26);
    }
    if (v16 == 628) {
      a1 = a1;
    }
    else {
      a1 = v16;
    }
    if (a1) {
      goto LABEL_65;
    }
LABEL_79:
    if (a4) {
      return;
    }
    uint64_t v28 = sub_1001980F8((uint64_t)&dword_100A04995);
    if (v28)
    {
      *((void *)v28 + 6) = a2;
      return;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not allocate sco connection handle", v29, v30, v31, v32, v33, v34, v35, v37);
      uint64_t v36 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    HIBYTE(word_100A04991) = 0;
    a1 = 106;
    goto LABEL_72;
  }
  if ((v9 & 0x7F) != 0) {
    goto LABEL_23;
  }
  sub_10017BD74(a2, 0x13u);
  HIBYTE(word_100A04991) = 0;
  BOOL v10 = *(void (***)(uint64_t, uint64_t, int *))(a2 + 80);
  if (!v10) {
    BOOL v10 = (void (**)(uint64_t, uint64_t, int *))qword_100A04970;
  }
  if (v10)
  {
    int v11 = *v10;
    if (*v10)
    {
      v11(1336, a2, &dword_100A04995);
    }
  }
}

uint64_t sub_10018A6A0(uint64_t a1, uint64_t a2, int a3)
{
  if (a3)
  {
    if (a3 != 2) {
      sub_10025B8C0();
    }
    char v5 = 4;
  }
  else
  {
    char v5 = 3;
  }
  uint64_t v6 = sub_100197A30(a1);
  if (!v6)
  {
    if (!sub_100058654()) {
      goto LABEL_37;
    }
    sub_100056E24((uint64_t)"Cannot accept SCO connection, no ACL connection record for %:", v23, v24, v25, v26, v27, v28, v29, a1);
    uint64_t v30 = sub_100050B4C(0x3Eu);
    if (!os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
      goto LABEL_37;
    }
    goto LABEL_36;
  }
  if ((_BYTE)word_100A04991)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Cannot accept SCO connection, Incoming sco connection already in progress (%:)", v7, v8, v9, v10, v11, v12, v13, (uint64_t)&dword_100A04995);
      uint64_t v14 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (!sub_100058654()) {
      goto LABEL_37;
    }
    sub_100056E24((uint64_t)"ob: %d\nib: %d", v15, v16, v17, v18, v19, v20, v21, HIBYTE(word_100A04991));
    uint64_t v22 = sub_100050B4C(0x3Eu);
    if (!os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      goto LABEL_37;
    }
LABEL_36:
    sub_100744F6C();
LABEL_37:
    char v54 = word_100A04991;
    LOBYTE(word_100A04991) = v5;
    uint64_t result = sub_10018A98C(a1, 0);
    LOBYTE(word_100A04991) = v54;
    ++byte_100A04990;
    return result;
  }
  uint64_t v31 = v6;
  if (HIBYTE(word_100A04991) && !*(unsigned char *)(v6 + 144))
  {
    if (!sub_100058654()) {
      goto LABEL_37;
    }
    sub_100056E24((uint64_t)"Cannot accept SCO connection, Outgoing sco connection already in progress (%:)", v46, v47, v48, v49, v50, v51, v52, (uint64_t)&dword_100A04995);
    uint64_t v53 = sub_100050B4C(0x3Eu);
    if (!os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
      goto LABEL_37;
    }
    goto LABEL_36;
  }
  unsigned int v32 = sub_100198E54();
  if (v32 >= *(unsigned __int8 *)(sub_10025B218(0x28u) + 1))
  {
    if (!sub_100058654()) {
      goto LABEL_37;
    }
    sub_10025B218(0x28u);
    sub_100056E24((uint64_t)"Cannot accept SCO connection from %:, already reached max SCO connections (%d)", v38, v39, v40, v41, v42, v43, v44, a1);
    uint64_t v45 = sub_100050B4C(0x3Eu);
    if (!os_log_type_enabled(v45, OS_LOG_TYPE_ERROR)) {
      goto LABEL_37;
    }
    goto LABEL_36;
  }
  if (HIBYTE(word_100A04991))
  {
    if (*(unsigned char *)(v31 + 144) == 1)
    {
      HIBYTE(word_100A04991) = 0;
      uint64_t v33 = (unsigned __int16 *)sub_100197A88(a1);
      if (v33)
      {
        sub_1001984E0(v33);
        sub_100182088(v31);
      }
    }
  }
  uint64_t v34 = *(void *)(v31 + 80);
  if (!v34) {
    uint64_t v34 = qword_100A04970;
  }
  if (!v34) {
    goto LABEL_37;
  }
  uint64_t v35 = *(uint64_t (**)(uint64_t, uint64_t))(v34 + 16);
  if (!v35) {
    goto LABEL_37;
  }
  LOBYTE(word_100A04991) = v5;
  int v36 = *(_DWORD *)a1;
  word_100A04999 = *(_WORD *)(a1 + 4);
  dword_100A04995 = v36;

  return v35(a1, a2);
}

uint64_t sub_10018A98C(uint64_t a1, int a2)
{
  uint64_t v70 = 0;
  int v4 = word_100A04991;
  if (word_100A04991 - 5 <= 0xFFFFFFFD)
  {
    if (a2)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Cannot accept a Sco connection at this time (%:)", v5, v6, v7, v8, v9, v10, v11, a1);
        uint64_t v12 = sub_100050B4C(0x3Eu);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    return 1310;
  }
  if (!a2) {
    goto LABEL_20;
  }
  if (*(_DWORD *)a1 != dword_100A04995 || *(unsigned __int16 *)(a1 + 4) != (unsigned __int16)word_100A04999)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Cannot accept SCO for %:", v15, v16, v17, v18, v19, v20, v21, a1);
      uint64_t v22 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
LABEL_19:
    int v4 = word_100A04991;
LABEL_20:
    if (v4 == 4) {
      uint64_t v31 = 29;
    }
    else {
      uint64_t v31 = 9;
    }
    uint64_t v32 = sub_10019304C(v31);
    if (v32)
    {
      uint64_t v13 = v32;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD to reject sco connect request failed %! (%:)", v33, v34, v35, v36, v37, v38, v39, v13);
        uint64_t v40 = sub_100050B4C(0x3Eu);
        if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      LOBYTE(word_100A04991) = 0;
    }
    else
    {
      LOBYTE(word_100A04991) = 2;
      if (a2) {
        return 1310;
      }
      else {
        return 0;
      }
    }
    return v13;
  }
  if (sub_10017E2D4(a1, &v70))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Cannot accept SCO connection, no ACL connection record for %:", v23, v24, v25, v26, v27, v28, v29, a1);
      uint64_t v30 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    goto LABEL_19;
  }
  uint64_t v42 = sub_10018AC8C(v70, 3);
  if (v42)
  {
    uint64_t v13 = v42;
    if (!sub_100058654()) {
      return v13;
    }
    sub_100056E24((uint64_t)"OI_DEVMGR_ScoConnectAccept failed: %! (%:)", v43, v44, v45, v46, v47, v48, v49, v13);
    uint64_t v50 = sub_100050B4C(0x3Eu);
    if (!os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
      return v13;
    }
LABEL_35:
    sub_100744F6C();
    return v13;
  }
  uint64_t v51 = sub_1001980F8(a1);
  if (v51)
  {
    uint64_t v52 = v51;
    uint64_t v13 = sub_10017BCA0(v70);
    if (!v13)
    {
      *((void *)v52 + 6) = v70;
      return v13;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_LP_ConnectionAdded failed: %! (%:)", v53, v54, v55, v56, v57, v58, v59, v13);
      char v60 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR)) {
        goto LABEL_35;
      }
    }
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not allocate sco connection handle", v61, v62, v63, v64, v65, v66, v67, v69);
      uint64_t v68 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v68, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 106;
  }
  return v13;
}

uint64_t sub_10018AC8C(uint64_t a1, int a2)
{
  if (word_100A04991 - 3 >= 2) {
    sub_10025B8C0();
  }
  if (!a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Can't find ACL connection for SCO!\n", v5, v6, v7, v8, v9, v10, v11, v41);
      uint64_t v12 = sub_100050B4C(0x3Eu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    LOBYTE(word_100A04991) = 0;
    if (sub_100058654())
    {
      uint64_t v4 = 1301;
      sub_100056E24((uint64_t)"Accept sco connect request failed %! (unk)", v13, v14, v15, v16, v17, v18, v19, 1301);
      uint64_t v20 = sub_100050B4C(0x3Eu);
      if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        return v4;
      }
      sub_100744F6C();
    }
    return 1301;
  }
  if (*(unsigned char *)(sub_10025B218(0x28u) + 10) && *(unsigned char *)(a1 + 152) == 2)
  {
    if (dword_100A0499C)
    {
      if (a2)
      {
LABEL_8:
        v43[0] = a1;
        v43[1] = (a2 - 1);
        v42[1] = v43;
        v42[0] = (const void *)16;
        return sub_1000268E4((uint64_t)sub_10018B8BC, v42, (42949673 * (unint64_t)(*(unsigned __int16 *)(a1 + 136) + 99)) >> 32, &dword_100A0499C);
      }
    }
    else if (!sub_10019304C(42))
    {
      *(unsigned char *)(a1 + 152) |= 0x80u;
      if (a2) {
        goto LABEL_8;
      }
    }
  }
  dword_100A0499C = 0;
  if (*(void *)(a1 + 112)) {
    uint64_t v21 = *(void *)(a1 + 112);
  }
  else {
    uint64_t v21 = qword_100A04988;
  }
  if (v21)
  {
    if (!*(_WORD *)(v21 + 10)) {
      sub_100185430();
    }
    if (*(unsigned char *)(a1 + 278)) {
      goto LABEL_27;
    }
LABEL_28:
    uint64_t v22 = sub_10019304C(28);
    goto LABEL_29;
  }
  sub_100185430();
  sub_10018220C(a1);
  if (!*(unsigned char *)(a1 + 278)) {
    goto LABEL_28;
  }
LABEL_27:
  uint64_t v22 = sub_1001FE2D0();
LABEL_29:
  uint64_t v4 = v22;
  if (!v22)
  {
    LOBYTE(word_100A04991) = 1;
    return v4;
  }
  LOBYTE(word_100A04991) = 0;
  uint64_t v23 = sub_10017BD74(a1, 0x13u);
  if (sub_100058654()
    && (sub_100056E24((uint64_t)"Accept sco connect request failed %! (%:)", v24, v25, v26, v27, v28, v29, v30, v4),
        uint64_t v31 = sub_100050B4C(0x3Eu),
        os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)))
  {
    sub_100744F6C();
    if (!v23) {
      return v4;
    }
  }
  else if (!v23)
  {
    return v4;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_LP_DisconnectReq failed: %!", v32, v33, v34, v35, v36, v37, v38, v23);
    uint64_t v39 = sub_100050B4C(0x3Eu);
    if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  return v4;
}

uint64_t sub_10018AFEC(uint64_t result, uint64_t a2, uint64_t a3)
{
  if (!result)
  {
    if (*(unsigned char *)(a2 + 2))
    {
      byte_100A0499B = 0;
      uint64_t v5 = *(void *)(*(void *)(a2 + 48) + 80);
      uint64_t v6 = sub_10017BD74(*(void *)(a2 + 48), 0x13u);
      if (v6)
      {
        uint64_t v7 = v6;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_LP_DisconnectReq failed: %! (%d)", v8, v9, v10, v11, v12, v13, v14, v7);
          uint64_t v15 = sub_100050B4C(0x3Eu);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
      uint64_t v16 = qword_100A04970;
      if (v5) {
        uint64_t v16 = v5;
      }
      if (v16)
      {
        uint64_t v17 = *(void (**)(void, uint64_t, uint64_t))(v16 + 8);
        if (v17) {
          v17(0, a2, a3);
        }
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Disconnecting SCO", v18, v19, v20, v21, v22, v23, v24, v26);
        uint64_t v25 = sub_100050B4C(0x3Eu);
        if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v28 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
      sub_10019E2C0();
      return sub_100218E88(0);
    }
    else
    {
      return sub_100189B04(a2, a3);
    }
  }
  return result;
}

uint64_t sub_10018B1B8()
{
  uint64_t v3 = 0;
  uint64_t result = sub_1001990B0(&v3);
  if (result)
  {
    do
    {
      if (!sub_100197698(*(void *)(v3 + 48))) {
        sub_10025B8C0();
      }
      uint64_t v1 = *(void (***)(void))(*(void *)(v3 + 48) + 88);
      if (v1)
      {
        uint64_t v2 = *v1;
        if (v2) {
          v2();
        }
      }
      uint64_t result = sub_1001990B0(&v3);
    }
    while ((result & 1) != 0);
  }
  if (qword_100A04978)
  {
    if (*(void *)qword_100A04978) {
      return (*(uint64_t (**)(void))qword_100A04978)();
    }
  }
  return result;
}

void sub_10018B238()
{
  if (xmmword_100A19860)
  {
    if (!sub_100197740(qword_100A049A0)) {
      qword_100A049A0 = 0;
    }
    do
    {
      if (!sub_1001990B0(&qword_100A049A0)) {
        break;
      }
      if (!sub_100197698(*(void *)(qword_100A049A0 + 48))) {
        sub_10025B8C0();
      }
      uint64_t v0 = *(void *)(*(void *)(qword_100A049A0 + 48) + 88);
      if (!v0) {
        uint64_t v0 = qword_100A04978;
      }
      if (v0)
      {
        uint64_t v1 = *(void (**)(void))(v0 + 16);
        if (v1) {
          v1();
        }
      }
    }
    while ((sub_10019E5B0() & 1) != 0);
  }
}

void sub_10018B2DC(uint64_t a1, uint64_t a2)
{
  if (sub_100197740(a1))
  {
    if (xmmword_100A19860)
    {
      if (!sub_100197698(*(void *)(a1 + 48))) {
        sub_10025B8C0();
      }
      uint64_t v4 = *(void *)(*(void *)(a1 + 48) + 88);
      if (!v4) {
        uint64_t v4 = qword_100A04978;
      }
      if (v4)
      {
        uint64_t v5 = *(void (**)(uint64_t, uint64_t))(v4 + 24);
        if (v5)
        {
          v5(a1, a2);
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIEventHandler_ScoPacketComplete - %! 0x%x", v6, v7, v8, v9, v10, v11, v12, 1338);
    uint64_t v13 = sub_100050B4C(0x3Eu);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10018B3C4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  if (sub_100197740(a2))
  {
    if (xmmword_100A19860)
    {
      if (!sub_100197698(*(void *)(a2 + 48))) {
        sub_10025B8C0();
      }
      uint64_t v12 = *(void *)(a2 + 48);
      uint64_t v13 = *(void *)(v12 + 88);
      uint64_t v14 = *(void *)(v12 + 96);
      uint64_t v15 = qword_100A04978;
      if (v13)
      {
        uint64_t v15 = v13;
        uint64_t v16 = v14;
      }
      else
      {
        uint64_t v16 = 0;
      }
      if (v15)
      {
        uint64_t v17 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, void, uint64_t))(v15 + 32);
        if (v17) {
          v17(a1, a2, a3, a4, a5, a6, *(unsigned __int8 *)(a2 + 57), v16);
        }
      }
      *(unsigned char *)(a2 + 60) = a3;
      *(unsigned char *)(a2 + 61) = a4;
      sub_100218E88(1u);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIEventHandler_ScoConfigChanged - %! 0x%x", v18, v19, v20, v21, v22, v23, v24, 1338);
    uint64_t v25 = sub_100050B4C(0x3Eu);
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10018B500(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (!sub_100197740(a1)) {
    sub_10025B8C0();
  }
  if (xmmword_100A19860)
  {
    if (!sub_100197740(a1)) {
      sub_10025B8C0();
    }
    if (*(unsigned char *)(a5 + 8))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCIEventHandler_ScoDataPacketReceived: wakeupCause SCO Packet from BT Controller (handle=0x%hX erroneous=%hhu len=%hu)\n", v10, v11, v12, v13, v14, v15, v16, a1);
        uint64_t v17 = sub_100050B4C(0x3Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v34 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v17, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }
    if (!a4 || !*(unsigned char *)(a1 + 59))
    {
      uint64_t v18 = *(void *)(a1 + 48);
      uint64_t v19 = *(void *)(v18 + 88);
      uint64_t v20 = *(void *)(v18 + 96);
      uint64_t v21 = qword_100A04978;
      if (v19)
      {
        uint64_t v21 = v19;
        uint64_t v22 = v20;
      }
      else
      {
        uint64_t v22 = 0;
      }
      if (v21)
      {
        uint64_t v23 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(v21 + 8);
        if (v23) {
          v23(a1, a4, a2, a3, v22, a5);
        }
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)" OI_STATUS_NOT_INITIALIZED", v24, v25, v26, v27, v28, v29, v30, v32);
    uint64_t v31 = sub_100050B4C(0x3Eu);
    if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
      sub_1007456E8();
    }
  }
}

void sub_10018B6B4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, unsigned int a5, unsigned int a6, uint64_t a7, uint64_t a8, unsigned __int8 a9)
{
  BOOL v17 = sub_100197740(a2);
  if (a1 || v17)
  {
    sub_10017C6DC(a1, (unsigned __int16 *)a2, a3, a4, 0);
    if (a1) {
      return;
    }
  }
  else
  {
    sub_10025B8C0();
    sub_10017C6DC(0, (unsigned __int16 *)a2, a3, a4, 0);
  }
  sub_10019E2BC(a9);
  *(unsigned char *)(a2 + 58) = a4;
  if (a5 | a4) {
    uint64_t v18 = a6;
  }
  else {
    uint64_t v18 = 0;
  }
  if (a5 | a4) {
    uint64_t v19 = a5;
  }
  else {
    uint64_t v19 = 6;
  }
  *(unsigned char *)(a2 + 57) = a9;

  sub_10018B3C4(0, a2, v19, v18, a7, a8);
}

uint64_t sub_10018B7C0(uint64_t a1)
{
  if (HIBYTE(word_100A04991) != 1 || dword_100A0499C == 0) {
    return 1301;
  }
  sub_100026DB4(dword_100A0499C);
  dword_100A0499C = 0;
  HIBYTE(word_100A04991) = 0;
  uint64_t v3 = sub_100197A30(a1);
  sub_10017BD74(v3, 2u);
  return 0;
}

void sub_10018B824(uint64_t a1)
{
  if (HIBYTE(word_100A04991))
  {
    uint64_t v1 = *(uint64_t **)(a1 + 8);
    uint64_t v2 = *v1;
    uint64_t v3 = *((unsigned int *)v1 + 2);
    sub_10018A16C(0, v2, v3, 0);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Orphan deferredConnectScoCb", v4, v5, v6, v7, v8, v9, v10, v12);
    uint64_t v11 = sub_100050B4C(0x3Eu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_10018B8BC(uint64_t result)
{
  if (dword_100A0499C)
  {
    uint64_t v1 = *(uint64_t **)(result + 8);
    uint64_t v2 = *v1;
    uint64_t result = sub_10018AC8C(*v1, *((unsigned int *)v1 + 2));
    if (v2 && result != 0)
    {
      uint64_t v4 = *(uint64_t (***)(uint64_t, uint64_t, uint64_t))(v2 + 80);
      if (!v4) {
        uint64_t v4 = (uint64_t (**)(uint64_t, uint64_t, uint64_t))qword_100A04970;
      }
      if (v4)
      {
        uint64_t v5 = *v4;
        if (*v4)
        {
          return v5(result, v2, v2 + 48);
        }
      }
    }
  }
  return result;
}

void sub_10018B948(int a1, void *a2, uint64_t a3)
{
  uint64_t v5 = sub_100160AC0(a1);

  sub_100161C50((uint64_t)v5, a2, a3);
}

uint64_t sub_10018B988(uint64_t a1, char a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, _WORD *a8, uint64_t a9)
{
  if (a1 && a5 && a6 && a8 && a9)
  {
    BOOL v17 = sub_10010CE48(0x120uLL);
    if (v17)
    {
      uint64_t v18 = (uint64_t)v17;
      v17[64] = 200;
      v17[38] = 200;
      size_t v19 = *(unsigned __int16 *)(sub_10025B218(0x17u) + 8);
      *(_WORD *)(v18 + 74) = v19;
      uint64_t v20 = sub_100022FE8(v19);
      *(void *)(v18 + 8) = v20;
      if (v20)
      {
        *(void *)(v18 + 40) = 0;
        *(_DWORD *)(v18 + 4) = 0;
        int v21 = *(_DWORD *)a1;
        *(_WORD *)(v18 + 108) = *(_WORD *)(a1 + 4);
        *(_DWORD *)(v18 + 104) = v21;
        *(_DWORD *)(v18 + 276) = 1;
        *(void *)(v18 + 136) = a6;
        *(unsigned char *)(v18 + 56) = 0;
        *(_DWORD *)(v18 + 260) = -1;
        *(void *)(v18 + 152) = a5;
        *(_DWORD *)(v18 + 272) = a3;
        if (a3 || a7)
        {
          uint64_t v22 = sub_10010CE48(0x9BuLL);
          *(void *)(v18 + 64) = v22;
          if (!v22)
          {
            uint64_t v25 = 106;
            goto LABEL_28;
          }
          if (a3 == 2) {
            v22[59] = 1;
          }
          if (!a7)
          {
            uint64_t v25 = 1721;
            goto LABEL_28;
          }
          *(void *)(v18 + 144) = a7;
        }
        if (a4)
        {
          unsigned int v23 = *(unsigned __int8 *)(a4 + 8);
          if (v23 >= 5)
          {
            sub_10025B8C0();
            unsigned int v23 = *(unsigned __int8 *)(a4 + 8);
          }
          memmove((void *)(v18 + 160), *(const void **)a4, 24 * v23);
          char v24 = *(unsigned char *)(a4 + 8);
        }
        else
        {
          char v24 = 0;
        }
        *(unsigned char *)(v18 + 256) = v24;
        sub_100160A2C(v18);
        uint64_t v27 = sub_10025B218(0x17u);
        uint64_t v25 = sub_1002460C8((uint64_t)sub_10018BC14, off_10099D5C8, a1, a2, *(unsigned __int16 *)(v27 + 8), 0, (_WORD *)v18, a9);
        if (!v25)
        {
          *a8 = *(_WORD *)(v18 + 280);
          ++dword_100A1980C;
          return v25;
        }
LABEL_28:
        sub_100160B50(*(unsigned __int16 *)(v18 + 280));
        return v25;
      }
      sub_100023010((void *)v18);
    }
    return 104;
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
}

void sub_10018BB78(int a1, uint64_t a2)
{
  uint64_t v3 = sub_100160AC0(a1);
  if (v3)
  {
    if (!a2)
    {
      if (*((_DWORD *)v3 + 69) <= 3u) {
        a2 = 0;
      }
      else {
        a2 = 1709;
      }
    }
    sub_100160BF0((uint64_t)v3, a2);
  }
}

void sub_10018BBD4(int a1, void *a2, size_t a3)
{
  uint64_t v5 = sub_100160AC0(a1);

  sub_1001614E8((uint64_t)v5, a2, a3);
}

void sub_10018BC14(int a1, __int16 a2, uint64_t a3)
{
  uint64_t v5 = sub_100160AC0(a1);
  if (v5)
  {
    uint64_t v6 = (uint64_t)v5;
    if (*((_DWORD *)v5 + 69) != 1) {
      sub_10025B8C0();
    }
    if (a3)
    {
LABEL_5:
      sub_100160D58((unsigned __int16 *)v6, a3);
      return;
    }
    *(_WORD *)(v6 + 72) = a2;
    *(_DWORD *)(v6 + 276) = 2;
    if (!*(_DWORD *)(v6 + 272))
    {
      a3 = sub_100161244(v6, 200);
      if (!a3) {
        return;
      }
      goto LABEL_5;
    }
    uint64_t v15 = *(void (**)(uint64_t, uint64_t))(v6 + 144);
    uint64_t v16 = *(unsigned __int16 *)(v6 + 280);
    uint64_t v17 = *(unsigned __int8 *)(*(void *)(v6 + 64) + 59);
    v15(v16, v17);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Error: null connection handle!", v7, v8, v9, v10, v11, v12, v13, v18);
    uint64_t v14 = sub_100050B4C(0x17u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_1007457DC(v14);
    }
  }
}

uint64_t sub_10018BD24(unsigned __int8 *a1, void *a2, unsigned char *a3, char *a4)
{
  uint64_t v4 = 101;
  if (a3 && a2 && a4)
  {
    if (a1)
    {
      int v5 = 240;
      uint64_t v6 = a1;
      do
      {
        uint64_t v7 = *v6;
        if (!*v6) {
          break;
        }
        if (v6[1] == 9)
        {
          if (v5 > v7)
          {
            char v10 = 1;
LABEL_21:
            uint64_t v4 = 0;
            *a3 = v7 - 1;
            *a4 = v10;
            *a2 = v6 + 2;
            return v4;
          }
          break;
        }
        uint64_t v8 = v7 + 1;
        v6 += v8;
        BOOL v9 = __OFSUB__(v5, v8);
        v5 -= v8;
      }
      while (!((v5 < 0) ^ v9 | (v5 == 0)));
      int v11 = 240;
      do
      {
        uint64_t v7 = *a1;
        if (!*a1) {
          break;
        }
        if (a1[1] == 8)
        {
          if (v11 <= v7) {
            return 120;
          }
          char v10 = 0;
          uint64_t v6 = a1;
          goto LABEL_21;
        }
        a1 += v7 + 1;
        BOOL v9 = __OFSUB__(v11, v7 + 1);
        v11 -= v7 + 1;
      }
      while (!((v11 < 0) ^ v9 | (v11 == 0)));
    }
    return 120;
  }
  return v4;
}

uint64_t sub_10018BDDC(unsigned __int8 *a1, int a2, int *a3)
{
  if (!a3) {
    return 101;
  }
  int v3 = 0;
  int v4 = 0;
  *a3 = 0;
  unsigned __int8 v5 = 2;
  char v6 = 15;
  do
  {
    if (!a1) {
      goto LABEL_42;
    }
    int v7 = 240;
    uint64_t v8 = a1;
    while (1)
    {
      uint64_t v9 = *v8;
      if (!*v8) {
        goto LABEL_42;
      }
      if (v8[1] == v5) {
        break;
      }
      uint64_t v10 = v9 + 1;
      v8 += v10;
      BOOL v11 = __OFSUB__(v7, v10);
      v7 -= v10;
      if ((v7 < 0) ^ v11 | (v7 == 0)) {
        goto LABEL_42;
      }
    }
    if (v7 <= v9) {
      goto LABEL_42;
    }
    uint64_t v12 = (v9 - 1);
    if (v5 < 6u)
    {
      if (v5 < 4u)
      {
        if (((_BYTE)v9 - 1))
        {
LABEL_49:
          int v21 = 0;
          uint64_t result = 131;
          goto LABEL_48;
        }
      }
      else if ((((_BYTE)v9 - 1) & 3) != 0)
      {
        goto LABEL_49;
      }
    }
    else if ((((_BYTE)v9 - 1) & 0xF) != 0)
    {
      goto LABEL_49;
    }
    if (v5)
    {
      v6 -= v5;
      if (v3) {
        goto LABEL_23;
      }
      int v3 = 3;
    }
    else
    {
      int v3 = 2;
    }
    *a3 = v3;
LABEL_23:
    uint64_t v13 = (unsigned __int16 *)(v8 + 2);
    while ((_BYTE)v12)
    {
      uint64_t v14 = v13 + 8;
      LODWORD(v15) = v12;
      while (v5 - 6 < 2)
      {
        uint64_t v15 = (v15 - 16);
        if (*((void *)v14 - 2) == 0x800000805F9B34FBLL && *((_DWORD *)v14 - 2) == 4096)
        {
          int v4 = *((_DWORD *)v14 - 1);
          goto LABEL_40;
        }
        v14 += 8;
        if (!(_BYTE)v15) {
          goto LABEL_42;
        }
      }
      if (v5 - 4 < 2)
      {
        int v18 = *(_DWORD *)v13;
        v13 += 2;
        int v4 = v18;
        uint64_t v15 = (v12 - 4);
      }
      else if (v5 - 2 > 1)
      {
        uint64_t v15 = v12;
      }
      else
      {
        int v17 = *v13++;
        int v4 = v17;
        uint64_t v15 = (v12 - 2);
      }
      uint64_t v14 = v13;
LABEL_40:
      uint64_t v12 = v15;
      uint64_t v13 = v14;
      if (v4 == a2)
      {
        uint64_t result = 0;
        goto LABEL_47;
      }
    }
LABEL_42:
    unsigned int v19 = v5++;
  }
  while (v19 < 7);
  uint64_t result = 120;
  if (v3 == 3 && !v6)
  {
LABEL_47:
    int v21 = 1;
LABEL_48:
    *a3 = v21;
  }
  return result;
}

uint64_t sub_10018BF80(unsigned __int8 *a1, uint64_t a2, int *a3, uint8x8_t a4)
{
  uint64_t v4 = 101;
  if (!a2 || !a3) {
    return v4;
  }
  if (*(void *)(a2 + 4) != 0x8000008000100000 || *(_DWORD *)(a2 + 12) != -80438433)
  {
    *a3 = 0;
    for (unsigned __int8 i = 7; i > 5u; --i)
    {
      if (a1)
      {
        int v7 = 240;
        uint64_t v8 = a1;
        do
        {
          uint64_t v9 = *v8;
          if (!*v8) {
            break;
          }
          if (v8[1] == i)
          {
            if (v7 <= v9) {
              break;
            }
            int v12 = v9 - 1;
            if (i == 6) {
              int v13 = 2;
            }
            else {
              int v13 = 1;
            }
            *a3 = v13;
            if ((v12 & 0xF) != 0)
            {
              *a3 = 0;
              return 131;
            }
            else
            {
              if (!(_BYTE)v12) {
                break;
              }
              uint64_t v14 = v8 + 7;
              while (1)
              {
                LODWORD(v19) = *(_DWORD *)(v14 + 7);
                a4.i32[0] = *(_DWORD *)(v14 + 3);
                int16x8_t v15 = (int16x8_t)vmovl_u8(a4);
                *(int16x4_t *)v15.i8 = vrev64_s16(*(int16x4_t *)v15.i8);
                a4 = (uint8x8_t)vmovn_s16(v15);
                HIDWORD(v19) = a4.i32[0];
                if (v19 == *(void *)a2)
                {
                  HIBYTE(v20) = *(v14 - 5);
                  BYTE6(v20) = *(v14 - 4);
                  BYTE5(v20) = *(v14 - 3);
                  BYTE4(v20) = *(v14 - 2);
                  BYTE3(v20) = *(v14 - 1);
                  BYTE2(v20) = *v14;
                  BYTE1(v20) = v14[1];
                  LOBYTE(v20) = v14[2];
                  BOOL v16 = v20 == *(void *)(a2 + 8);
                }
                else
                {
                  BOOL v16 = 0;
                }
                if (v16) {
                  break;
                }
                v14 += 16;
                v12 -= 16;
                if (!(_BYTE)v12) {
                  goto LABEL_27;
                }
              }
              uint64_t v4 = 0;
              *a3 = 1;
            }
            return v4;
          }
          uint64_t v10 = v9 + 1;
          v8 += v10;
          BOOL v11 = __OFSUB__(v7, v10);
          v7 -= v10;
        }
        while (!((v7 < 0) ^ v11 | (v7 == 0)));
      }
LABEL_27:
      ;
    }
    return 120;
  }
  int v17 = *(_DWORD *)a2;

  return sub_10018BDDC(a1, v17, a3);
}

uint64_t sub_10018C15C(unsigned __int8 *a1, int a2, unsigned char *a3, unsigned __int8 **a4)
{
  uint64_t v4 = 101;
  if (a3 && a4)
  {
    if (a1)
    {
      int v5 = 240;
      do
      {
        uint64_t v6 = *a1;
        if (!*a1) {
          break;
        }
        if (a1[1] == a2)
        {
          if (v5 <= v6) {
            break;
          }
          *a3 = v6 - 1;
          uint64_t v9 = a1 + 2;
          goto LABEL_13;
        }
        uint64_t v7 = v6 + 1;
        a1 += v7;
        BOOL v8 = __OFSUB__(v5, v7);
        v5 -= v7;
      }
      while (!((v5 < 0) ^ v8 | (v5 == 0)));
    }
    uint64_t v9 = 0;
LABEL_13:
    *a4 = v9;
    if (v9) {
      return 0;
    }
    else {
      return 120;
    }
  }
  return v4;
}

uint64_t sub_10018C1CC()
{
  return 102;
}

uint64_t sub_10018C1D4(void *a1, void *a2)
{
  if (!DWORD2(xmmword_100A19860)) {
    return 103;
  }
  if (a2) {
    *a2 = off_100A19640;
  }
  uint64_t v2 = 0;
  off_100A19640 = a1;
  return v2;
}

uint64_t sub_10018C210(uint64_t a1)
{
  if (sub_100197698(a1)) {
    return sub_10019304C(45);
  }
  else {
    return 101;
  }
}

uint64_t sub_10018C298(uint64_t (*a1)(void, void, void, void, void))
{
  if (qword_100A049A8) {
    sub_10025B8C0();
  }
  if (!sub_10017E718())
  {
    byte_100A049B0 = 0;
    return 4831;
  }
  byte_100A049B0 = sub_1001F10B0();
  if ((byte_100A049B0 & 1) == 0) {
    return 4831;
  }
  off_100A19768 = a1;
  uint64_t v2 = sub_1001DEA28(7u, 1, 8, 8u, &qword_100A049A8, (uint64_t)sub_1001F0A1C);
  if (v2 || !qword_100A049A8)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not register the Classic SecurityManager : %!", v11, v12, v13, v14, v15, v16, v17, v2);
      int v18 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_1007456E8();
      }
    }
    goto LABEL_16;
  }
  *(_WORD *)sub_1001E688C((unsigned int *)qword_100A049A8) = 65;
  *(_WORD *)(sub_1001E688C((unsigned int *)qword_100A049A8) + 2) = -1;
  uint64_t v2 = sub_1001E50D4((uint64_t)sub_10018C41C, 7);
  if (v2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_ConnectMan_Register_FixedChannelInfo_callback returned %!", v3, v4, v5, v6, v7, v8, v9, v2);
      uint64_t v10 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
LABEL_16:
    sub_10025B8C0();
  }
  return v2;
}

uint64_t sub_10018C41C(uint64_t a1)
{
  uint64_t v2 = 0;
  uint64_t result = sub_10017E2D4(a1, &v2);
  if (!result)
  {
    if (byte_100A049B0) {
      *(unsigned char *)(v2 + 304) = 1;
    }
  }
  return result;
}

uint64_t sub_10018C460()
{
  if (!byte_100A049B0) {
    return 4831;
  }
  uint64_t result = qword_100A049A8;
  if (qword_100A049A8)
  {
    sub_1001DEC18(qword_100A049A8);
    uint64_t result = 0;
    qword_100A049A8 = 0;
  }
  return result;
}

uint64_t sub_10018C4A8(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"StartPairing was called", v2, v3, v4, v5, v6, v7, v8, v81);
    uint64_t v9 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v83 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (!byte_100A049B0)
  {
    if (!sub_100058654()) {
      return 117;
    }
    sub_100056E24((uint64_t)"Controller does not support Secured Connections", v20, v21, v22, v23, v24, v25, v26, v81);
    uint64_t v27 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
      return 117;
    }
LABEL_20:
    sub_100744F6C();
    return 117;
  }
  if (!sub_100197698(a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Connection is invalid", v28, v29, v30, v31, v32, v33, v34, v81);
      uint64_t v35 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 414;
  }
  if (!*(unsigned char *)(a1 + 304))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Remote does not support BR/EDR SMP", v36, v37, v38, v39, v40, v41, v42, v81);
      uint64_t v43 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v43, OS_LOG_TYPE_DEFAULT))
      {
        uint64_t v44 = sub_100050714();
        *(_DWORD *)int buf = 136446210;
        uint64_t v83 = v44;
        _os_log_impl((void *)&_mh_execute_header, v43, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    return 414;
  }
  if (!off_100A19768)
  {
    if (!sub_100058654()) {
      return 117;
    }
    sub_100056E24((uint64_t)"Local device does not support BR/EDR SMP", v46, v47, v48, v49, v50, v51, v52, v81);
    uint64_t v53 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v53, OS_LOG_TYPE_ERROR)) {
      return 117;
    }
    goto LABEL_20;
  }
  uint64_t v10 = sub_10023F520();
  if (v10) {
    return v10;
  }
  *(_WORD *)int buf = 1;
  if (byte_100A049B1) {
    uint8_t v11 = 0;
  }
  else {
    uint8_t v11 = 32;
  }
  buf[2] = 0;
  buf[3] = v11;
  LOWORD(v83) = 784;
  BYTE2(v83) = 3;
  if (sub_100197698(a1))
  {
    if (*(unsigned char *)(a1 + 144))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"You cannot send this command when peripheral.", v12, v13, v14, v15, v16, v17, v18, v81);
        uint64_t v19 = sub_100050B4C(0x43u);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 4821;
    }
    uint64_t v62 = sub_1001F0BBC(a1);
    if (v62)
    {
      uint64_t v63 = (unsigned char *)v62;
      if (*(unsigned __int8 *)(v62 + 8) >= 0x11u)
      {
        if (sub_100058654())
        {
          uint64_t v64 = sub_1001F10E8();
          sub_100056E24((uint64_t)"Cannot ask for pairing, device is already in state %s.", v65, v66, v67, v68, v69, v70, v71, (uint64_t)v64);
          uint64_t v72 = sub_100050B4C(0x43u);
          if (os_log_type_enabled(v72, OS_LOG_TYPE_ERROR)) {
            sub_1007456E8();
          }
        }
        return 4804;
      }
LABEL_44:
      v63[72] = v11;
      uint64_t v10 = sub_1001F0C08(*(void *)v63, (char *)buf, 7uLL, 1);
      if (v10)
      {
        sub_1001F0828(v63, v10, 1);
      }
      else
      {
        sub_1001F10F4((uint64_t)v63, 17);
        *(_DWORD *)(v63 + 579) = *(_DWORD *)buf;
        *(_WORD *)(v63 + 583) = (_WORD)v83;
        v63[585] = BYTE2(v83);
      }
      return v10;
    }
    uint64_t v63 = sub_1001F0EE8(a1);
    if (v63) {
      goto LABEL_44;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not allocate a pairing record for handle 0x%x", v73, v74, v75, v76, v77, v78, v79, a1);
      uint64_t v80 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v80, OS_LOG_TYPE_ERROR)) {
        sub_1007456E8();
      }
    }
    return 104;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Invalid connection handle.", v54, v55, v56, v57, v58, v59, v60, v81);
      uint64_t v61 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4820;
  }
}

void sub_10018C8EC()
{
  byte_100A049B1 = 1;
}

void sub_10018C8FC()
{
  byte_100A049B2 = 1;
}

void sub_10018C90C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6 = (char *)sub_1001F0BBC(a1);
  if (a3 != 6)
  {
    if (!sub_100058654()) {
      goto LABEL_14;
    }
    sub_100056E24((uint64_t)"Invalid Pairing Request size %d.", v16, v17, v18, v19, v20, v21, v22, a3);
    uint64_t v23 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
      goto LABEL_14;
    }
LABEL_13:
    sub_100744F6C();
LABEL_14:
    char v15 = 8;
LABEL_22:
    sub_10018E0DC(a1, v15, v6);
    return;
  }
  if (!off_100A19768)
  {
    if (!sub_100058654()) {
      goto LABEL_21;
    }
    sub_100056E24((uint64_t)"Local device does not support BR/EDR SMP", v24, v25, v26, v27, v28, v29, v30, v102);
    uint64_t v31 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
      goto LABEL_21;
    }
LABEL_20:
    sub_100744F6C();
LABEL_21:
    char v15 = 14;
    goto LABEL_22;
  }
  if (!byte_100A049B0)
  {
    if (!sub_100058654()) {
      goto LABEL_21;
    }
    sub_100056E24((uint64_t)"Controller does not support Secured Connections", v32, v33, v34, v35, v36, v37, v38, v102);
    uint64_t v39 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
      goto LABEL_21;
    }
    goto LABEL_20;
  }
  if (!sub_100197698(a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Connection is invalid", v40, v41, v42, v43, v44, v45, v46, v102);
      uint64_t v47 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  *(unsigned char *)(a1 + 304) = 1;
  if (!*(unsigned char *)(a1 + 144))
  {
    if (!sub_100058654()) {
      goto LABEL_14;
    }
    sub_100056E24((uint64_t)"You cannot send this command when peripheral.", v48, v49, v50, v51, v52, v53, v54, v102);
    uint64_t v55 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
      goto LABEL_14;
    }
    goto LABEL_13;
  }
  if (v6)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Classic SMP pairing is already in progress", v7, v8, v9, v10, v11, v12, v13, v102);
      uint64_t v14 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    char v15 = 13;
    goto LABEL_22;
  }
  uint64_t v56 = sub_1001F0EE8(a1);
  if (!v56)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Could not allocate new device...", v94, v95, v96, v97, v98, v99, v100, v102);
      uint64_t v101 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v101, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v6 = 0;
    goto LABEL_14;
  }
  uint64_t v6 = v56;
  sub_1001F0F88((uint64_t)v56, *(unsigned char *)a2, *(unsigned char *)(a2 + 1), *(unsigned char *)(a2 + 2), *(unsigned __int8 *)(a2 + 3), *(unsigned char *)(a2 + 4), *(unsigned char *)(a2 + 5));
  unsigned int v57 = v6[82];
  if (v57 >= 8 || (unsigned int v58 = v6[83], v58 >= 8))
  {
    if (!sub_100058654()) {
      goto LABEL_21;
    }
    sub_100056E24((uint64_t)"Invalid key distribution parameters initiator:0x%x, responder:0xx", v86, v87, v88, v89, v90, v91, v92, v6[82]);
    uint64_t v93 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v93, OS_LOG_TYPE_ERROR)) {
      goto LABEL_21;
    }
    goto LABEL_20;
  }
  v6[74] = v57 & 3;
  v6[75] = 0;
  v6[76] = v58 & 3;
  v6[77] = 0;
  sub_1001F10F4((uint64_t)v6, 17);
  v6[72] = 0;
  if ((byte_100A049B1 & 1) == 0 && (v6[80] & 0x20) != 0)
  {
    v6[72] = 32;
    v6[593] = 1;
  }
  if (byte_100A049B2 == 1 && !v6[593])
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Force replying with CT2=1", v59, v60, v61, v62, v63, v64, v65, v102);
      uint64_t v66 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v66, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v104 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v66, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    v6[72] |= 0x20u;
    v6[593] = 1;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"authReq=%x isSecuredConnectionControllerSupported=%d expectedKeys=%x requestedKeys=%x", v67, v68, v69, v70, v71, v72, v73, v6[72]);
    uint64_t v74 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
    {
      uint64_t v75 = sub_100050714();
      *(_DWORD *)int buf = 136446210;
      uint64_t v104 = v75;
      _os_log_impl((void *)&_mh_execute_header, v74, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  uint64_t v76 = sub_10018DC68(a1, v6[72], v6[74], v6[76]);
  if (v76)
  {
    uint64_t v77 = v76;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"smpSendPairingResponse failed with error %!", v78, v79, v80, v81, v82, v83, v84, v77);
      uint64_t v85 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v85, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    goto LABEL_14;
  }
  if ((v6[76] & 2) != 0)
  {
    sub_10018DE68((uint64_t)v6);
    sub_10018DFE4((uint64_t)v6);
    v6[77] |= 2u;
    sub_1001F10F4((uint64_t)v6, 67);
  }
  if ((v6[74] & 2) == 0)
  {
    sub_1001F10F4((uint64_t)v6, 65);
    sub_1001F0828(v6, 0, 1);
  }
}

void sub_10018CE58(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6 = sub_1001F0BBC(a1);
  if (!off_100A19768)
  {
    if (!sub_100058654()) {
      goto LABEL_19;
    }
    sub_100056E24((uint64_t)"Local device does not support BR/EDR SMP", v15, v16, v17, v18, v19, v20, v21, v90);
    uint64_t v22 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      goto LABEL_19;
    }
    goto LABEL_18;
  }
  if (a3 != 6)
  {
    if (!sub_100058654()) {
      goto LABEL_15;
    }
    sub_100056E24((uint64_t)"Invalid Pairing Request size %d.", v23, v24, v25, v26, v27, v28, v29, a3);
    uint64_t v30 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
      goto LABEL_15;
    }
    goto LABEL_14;
  }
  if (!byte_100A049B0)
  {
    if (!sub_100058654()) {
      goto LABEL_19;
    }
    sub_100056E24((uint64_t)"Controller does not support Secured Connections", v32, v33, v34, v35, v36, v37, v38, v90);
    uint64_t v39 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
      goto LABEL_19;
    }
    goto LABEL_18;
  }
  if (sub_100197698(a1))
  {
    *(unsigned char *)(a1 + 304) = 1;
    if (*(unsigned char *)(a1 + 144))
    {
      if (!sub_100058654()) {
        goto LABEL_15;
      }
      sub_100056E24((uint64_t)"This command should only be received if we are central.", v7, v8, v9, v10, v11, v12, v13, v90);
      uint64_t v14 = sub_100050B4C(0x43u);
      if (!os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
        goto LABEL_15;
      }
      goto LABEL_14;
    }
    if (v6)
    {
      if (sub_1001F11E4(v6, 17))
      {
        sub_1001F0F88(v6, *(unsigned char *)a2, *(unsigned char *)(a2 + 1), *(unsigned char *)(a2 + 2), *(unsigned __int8 *)(a2 + 3), *(unsigned char *)(a2 + 4), *(unsigned char *)(a2 + 5));
        sub_1001F0FFC((uint64_t *)v6);
        if ((*(unsigned char *)(v6 + 80) & 0xDF) != 0)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Invalid authentication requirements 0x%x.", v48, v49, v50, v51, v52, v53, v54, *(unsigned __int8 *)(v6 + 80));
            uint64_t v55 = sub_100050B4C(0x43u);
            if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
        unsigned int v56 = *(unsigned __int8 *)(v6 + 82);
        if (v56 <= 7)
        {
          unsigned int v57 = *(unsigned __int8 *)(v6 + 83);
          if (v57 < 8)
          {
            *(unsigned char *)(v6 + 76) = v56 & 3;
            *(unsigned char *)(v6 + 75) = 0;
            *(unsigned char *)(v6 + 74) = v57 & 3;
            *(unsigned char *)(v6 + 77) = 0;
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"We got those keys : requested(aka initiator)=0x%x expected(aka responder)=0x%x", v58, v59, v60, v61, v62, v63, v64, *(unsigned __int8 *)(v6 + 76));
              uint64_t v65 = sub_100050B4C(0x43u);
              if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
              {
                *(_DWORD *)int buf = 136446210;
                uint64_t v92 = sub_100050714();
                _os_log_impl((void *)&_mh_execute_header, v65, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
              }
            }
            if ((*(unsigned char *)(v6 + 80) & 0x20) != 0 && (*(unsigned char *)(v6 + 72) & 0x20) != 0) {
              *(unsigned char *)(v6 + 593) = 1;
            }
            sub_1001F10F4(v6, 18);
            if ((*(unsigned char *)(v6 + 74) & 2) == 0)
            {
              sub_1001F10F4(v6, 67);
              if ((*(unsigned char *)(v6 + 76) & 2) != 0)
              {
                sub_1001F10F4(v6, 67);
                sub_10018DE68(v6);
                sub_10018DFE4(v6);
                *(unsigned char *)(v6 + 77) |= 2u;
              }
              else
              {
                sub_1001F10F4(v6, 65);
              }
              sub_1001F0828((char *)v6, 0, 1);
            }
            return;
          }
        }
        if (!sub_100058654()
          || (sub_100056E24((uint64_t)"Invalid key distribution parameters initiator:0x%x, responder:0xx", v82, v83, v84, v85, v86, v87, v88, *(unsigned __int8 *)(v6 + 82)), uint64_t v89 = sub_100050B4C(0x43u), !os_log_type_enabled(v89, OS_LOG_TYPE_ERROR)))
        {
LABEL_19:
          char v31 = 14;
          goto LABEL_20;
        }
LABEL_18:
        sub_100744F6C();
        goto LABEL_19;
      }
      if (!sub_100058654()) {
        goto LABEL_15;
      }
      sub_100056E24((uint64_t)"Pairing response was received without a pairing request for handle %d.", v74, v75, v76, v77, v78, v79, v80, a1);
      uint64_t v81 = sub_100050B4C(0x43u);
      if (!os_log_type_enabled(v81, OS_LOG_TYPE_ERROR)) {
        goto LABEL_15;
      }
    }
    else
    {
      if (!sub_100058654()) {
        goto LABEL_15;
      }
      sub_100056E24((uint64_t)"We're not in pairing yet.", v66, v67, v68, v69, v70, v71, v72, v90);
      uint64_t v73 = sub_100050B4C(0x43u);
      if (!os_log_type_enabled(v73, OS_LOG_TYPE_ERROR)) {
        goto LABEL_15;
      }
    }
LABEL_14:
    sub_100744F6C();
LABEL_15:
    char v31 = 8;
LABEL_20:
    sub_10018E0DC(a1, v31, (char *)v6);
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Connection is invalid", v40, v41, v42, v43, v44, v45, v46, v90);
    uint64_t v47 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10018D2F4(uint64_t a1, unsigned __int8 *a2, uint64_t a3)
{
  uint64_t v5 = (uint64_t *)sub_1001F0BBC(a1);
  if (v5)
  {
    uint64_t v6 = (char *)v5;
    sub_1001F0FFC(v5);
    if (a3 == 1)
    {
      unsigned int v7 = *a2;
    }
    else
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Invalid Pairing Failed size %d", v16, v17, v18, v19, v20, v21, v22, a3);
        uint64_t v23 = sub_100050B4C(0x43u);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      unsigned int v7 = 8;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Peer sent Pairing Failed with reason=%d", v24, v25, v26, v27, v28, v29, v30, v7);
      char v31 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    uint64_t v32 = sub_1001F10BC(v7);
    sub_1001F0828(v6, v32, 1);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Could not find associated pairing data.", v8, v9, v10, v11, v12, v13, v14, v33);
    uint64_t v15 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

__n128 sub_10018D430(uint64_t a1, __n128 *a2, uint64_t a3)
{
  if (!off_100A19768)
  {
    if (!sub_100058654()) {
      goto LABEL_20;
    }
    sub_100056E24((uint64_t)"Local device does not support BR/EDR SMP", v9, v10, v11, v12, v13, v14, v15, v74);
    uint64_t v16 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      goto LABEL_20;
    }
LABEL_19:
    sub_100744F6C();
LABEL_20:
    uint64_t v7 = 0;
LABEL_21:
    sub_10018E0DC(a1, 8, (char *)v7);
    return result;
  }
  if (a3 != 16)
  {
    if (!sub_100058654()) {
      goto LABEL_20;
    }
    sub_100056E24((uint64_t)"Invalid Identity Information size %d", v17, v18, v19, v20, v21, v22, v23, a3);
    uint64_t v24 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      goto LABEL_20;
    }
    goto LABEL_19;
  }
  uint64_t v6 = sub_1001F0BBC(a1);
  if (!v6)
  {
    if (!sub_100058654()) {
      goto LABEL_20;
    }
    sub_100056E24((uint64_t)"Could not find associated pairing data.", v25, v26, v27, v28, v29, v30, v31, v74);
    uint64_t v32 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
      goto LABEL_20;
    }
    goto LABEL_19;
  }
  uint64_t v7 = v6;
  if (!byte_100A049B0)
  {
    if (!sub_100058654()) {
      goto LABEL_21;
    }
    sub_100056E24((uint64_t)"Controller does not support Secured Connections", v34, v35, v36, v37, v38, v39, v40, v74);
    uint64_t v41 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
      goto LABEL_21;
    }
LABEL_25:
    sub_100744F6C();
    goto LABEL_21;
  }
  if (!sub_100197698(a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Connection is invalid", v42, v43, v44, v45, v46, v47, v48, v74);
      uint64_t v49 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR)) {
        goto LABEL_28;
      }
    }
    return result;
  }
  if (!*(unsigned char *)(a1 + 304))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Remote does not support BR/EDR SMP", v50, v51, v52, v53, v54, v55, v56, v74);
      unsigned int v57 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v76 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v57, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    goto LABEL_21;
  }
  sub_1001F0FFC((uint64_t *)v7);
  if (*(unsigned char *)(v7 + 75)) {
    goto LABEL_34;
  }
  if (!*(unsigned char *)(a1 + 144))
  {
    char v8 = 66;
    goto LABEL_33;
  }
  if (!sub_1001F11E4(v7, 67))
  {
    if (!sub_100058654()) {
      goto LABEL_21;
    }
    sub_100056E24((uint64_t)"Central is sending keys before we are ...", v66, v67, v68, v69, v70, v71, v72, v74);
    uint64_t v73 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v73, OS_LOG_TYPE_ERROR)) {
      goto LABEL_21;
    }
    goto LABEL_25;
  }
  char v8 = 64;
LABEL_33:
  sub_1001F10F4(v7, v8);
LABEL_34:
  if ((*(unsigned char *)(v7 + 74) & 2) != 0)
  {
    __n128 result = *a2;
    *(__n128 *)(v7 + 562) = *a2;
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"We were not expecting IRK...", v58, v59, v60, v61, v62, v63, v64, v74);
    uint64_t v65 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v65, OS_LOG_TYPE_ERROR)) {
LABEL_28:
    }
      sub_100744F6C();
  }
  return result;
}

void sub_10018D778(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (a3 != 7)
  {
    if (!sub_100058654()) {
      goto LABEL_24;
    }
    sub_100056E24((uint64_t)"Invalid Identity Address Information size %d", v17, v18, v19, v20, v21, v22, v23, a3);
    uint64_t v24 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      goto LABEL_24;
    }
LABEL_23:
    sub_100744F6C();
LABEL_24:
    uint64_t v6 = 0;
    goto LABEL_25;
  }
  uint64_t v5 = sub_1001F0BBC(a1);
  if (!v5)
  {
    if (!sub_100058654()) {
      goto LABEL_24;
    }
    sub_100056E24((uint64_t)"Could not find associated pairing data.", v25, v26, v27, v28, v29, v30, v31, v99);
    uint64_t v32 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
      goto LABEL_24;
    }
    goto LABEL_23;
  }
  uint64_t v6 = v5;
  if (!off_100A19768)
  {
    if (!sub_100058654()) {
      goto LABEL_25;
    }
    sub_100056E24((uint64_t)"Local device does not support BR/EDR SMP", v33, v34, v35, v36, v37, v38, v39, v99);
    uint64_t v40 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
      goto LABEL_25;
    }
LABEL_49:
    sub_100744F6C();
    goto LABEL_25;
  }
  if (!byte_100A049B0)
  {
    if (!sub_100058654()) {
      goto LABEL_25;
    }
    sub_100056E24((uint64_t)"Controller does not support Secured Connections", v41, v42, v43, v44, v45, v46, v47, v99);
    uint64_t v48 = sub_100050B4C(0x43u);
    if (!os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
      goto LABEL_25;
    }
    goto LABEL_49;
  }
  if (!sub_100197698(a1))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Connection is invalid", v49, v50, v51, v52, v53, v54, v55, v99);
      uint64_t v56 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (!*(unsigned char *)(a1 + 304))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Remote does not support BR/EDR SMP", v57, v58, v59, v60, v61, v62, v63, v99);
      uint64_t v64 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v64, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        *(void *)&uint8_t buf[4] = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v64, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
    goto LABEL_25;
  }
  sub_1001F0FFC((uint64_t *)v6);
  if (!*(unsigned char *)(v6 + 75))
  {
    if (*(unsigned char *)(a1 + 144))
    {
      if (!sub_1001F11E4(v6, 64))
      {
LABEL_47:
        if (!sub_100058654()) {
          goto LABEL_25;
        }
        sub_100056E24((uint64_t)"We got an address without IRK.", v73, v74, v75, v76, v77, v78, v79, v99);
        uint64_t v80 = sub_100050B4C(0x43u);
        if (!os_log_type_enabled(v80, OS_LOG_TYPE_ERROR)) {
          goto LABEL_25;
        }
        goto LABEL_49;
      }
      if (*(unsigned char *)(a1 + 144)) {
        goto LABEL_8;
      }
    }
    if (sub_1001F11E4(v6, 66)) {
      goto LABEL_8;
    }
    goto LABEL_47;
  }
LABEL_8:
  if ((*(unsigned char *)(v6 + 74) & 2) != 0)
  {
    *(unsigned char *)(v6 + 75) |= 2u;
    buf[0] = *(unsigned char *)a2;
    *(_DWORD *)&buf[1] = *(_DWORD *)(a2 + 1);
    *(_WORD *)&buf[5] = *(_WORD *)(a2 + 5);
    sub_1001F03A0(&buf[1], 6);
    if (buf[0])
    {
      if (!sub_100058654()) {
        goto LABEL_25;
      }
      sub_100056E24((uint64_t)"We got a remote address (%:) that is not public", v65, v66, v67, v68, v69, v70, v71, (uint64_t)&buf[1]);
      uint64_t v72 = sub_100050B4C(0x43u);
      if (!os_log_type_enabled(v72, OS_LOG_TYPE_ERROR)) {
        goto LABEL_25;
      }
      goto LABEL_66;
    }
    if (*(_DWORD *)&buf[1]) {
      BOOL v81 = 0;
    }
    else {
      BOOL v81 = *(unsigned __int16 *)&buf[5] == 0;
    }
    if (v81)
    {
      if (!sub_100058654()) {
        goto LABEL_25;
      }
      sub_100056E24((uint64_t)"Identity address cannot be all 0.", v91, v92, v93, v94, v95, v96, v97, v99);
      uint64_t v98 = sub_100050B4C(0x43u);
      if (!os_log_type_enabled(v98, OS_LOG_TYPE_ERROR)) {
        goto LABEL_25;
      }
      goto LABEL_66;
    }
    if (*(_DWORD *)&buf[1] == *(_DWORD *)(*(void *)v6 + 48)
      && *(unsigned __int16 *)&buf[5] == *(unsigned __int16 *)(*(void *)v6 + 52))
    {
      goto LABEL_12;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Identity address cannot be different than the classic address.", v83, v84, v85, v86, v87, v88, v89, v99);
      uint64_t v90 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v90, OS_LOG_TYPE_ERROR)) {
LABEL_66:
      }
        sub_100744F6C();
    }
LABEL_25:
    sub_10018E0DC(a1, 8, (char *)v6);
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"We were not expecting address info...", v7, v8, v9, v10, v11, v12, v13, v99);
    uint64_t v14 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
LABEL_12:
  BOOL v15 = (*(unsigned char *)(v6 + 74) & 0xFE) == (*(unsigned char *)(v6 + 75) & 0xFE) || (*(unsigned char *)(v6 + 74) & 0xFE) == 0;
  if (*(unsigned char *)(a1 + 144))
  {
    if (v15)
    {
      sub_1001F10F4(v6, 65);
LABEL_52:
      sub_1001F0828((char *)v6, 0, 1);
    }
  }
  else if (v15)
  {
    sub_1001F10F4(v6, 67);
    sub_10018DE68(v6);
    sub_10018DFE4(v6);
    goto LABEL_52;
  }
}

uint64_t sub_10018DC68(uint64_t a1, char a2, char a3, char a4)
{
  __int16 v42 = 2;
  char v43 = 0;
  char v44 = a2;
  char v45 = 16;
  char v46 = a3;
  char v47 = a4;
  if (sub_100197698(a1))
  {
    if (*(unsigned char *)(a1 + 144))
    {
      uint64_t v5 = sub_1001F0BBC(a1);
      if (v5)
      {
        uint64_t v6 = (uint64_t *)v5;
        if (sub_1001F11E4(v5, 17))
        {
          uint64_t v7 = sub_1001F0C08(*v6, (char *)&v42, 7uLL, 1);
          if (v7)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"SMP_SendPacket failed with error %!", v8, v9, v10, v11, v12, v13, v14, v7);
              BOOL v15 = sub_100050B4C(0x43u);
              if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
                sub_100744F6C();
              }
            }
            sub_1001F0828((char *)v6, v7, 1);
          }
          else
          {
            sub_1001F10F4((uint64_t)v6, 18);
          }
          return v7;
        }
        if (sub_100058654())
        {
          sub_1001F10E8();
          goto LABEL_22;
        }
      }
      else if (sub_100058654())
      {
LABEL_22:
        sub_100056E24((uint64_t)"Invalid pairing state for handle 0x%x : %s", v32, v33, v34, v35, v36, v37, v38, a1);
        uint64_t v39 = sub_100050B4C(0x43u);
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      return 4823;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"You cannot send smpSendPairingResponse command when peripheral.", v24, v25, v26, v27, v28, v29, v30, v41);
      uint64_t v31 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4822;
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"This command is only available to Classic devices.", v16, v17, v18, v19, v20, v21, v22, v41);
      uint64_t v23 = sub_100050B4C(0x43u);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 4820;
  }
}

void sub_10018DE68(uint64_t a1)
{
  HIBYTE(v10) = 8;
  char v11 = *(unsigned char *)sub_1001F07E8();
  char v12 = *((unsigned char *)sub_1001F07E8() + 1);
  char v13 = *((unsigned char *)sub_1001F07E8() + 2);
  char v14 = *((unsigned char *)sub_1001F07E8() + 3);
  char v15 = *((unsigned char *)sub_1001F07E8() + 4);
  char v16 = *((unsigned char *)sub_1001F07E8() + 5);
  char v17 = *((unsigned char *)sub_1001F07E8() + 6);
  char v18 = *((unsigned char *)sub_1001F07E8() + 7);
  char v19 = *((unsigned char *)sub_1001F07E8() + 8);
  char v20 = *((unsigned char *)sub_1001F07E8() + 9);
  char v21 = *((unsigned char *)sub_1001F07E8() + 10);
  char v22 = *((unsigned char *)sub_1001F07E8() + 11);
  char v23 = *((unsigned char *)sub_1001F07E8() + 12);
  char v24 = *((unsigned char *)sub_1001F07E8() + 13);
  char v25 = *((unsigned char *)sub_1001F07E8() + 14);
  char v26 = *((unsigned char *)sub_1001F07E8() + 15);
  if (*(unsigned char *)(a1 + 9))
  {
    sub_1001F0C08(*(void *)a1, (char *)&v10 + 7, 0x11uLL, 1);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"This link is not encrypted, cannot send IRK.", v2, v3, v4, v5, v6, v7, v8, v10);
    uint64_t v9 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10018DFE4(uint64_t a1)
{
  *(_DWORD *)((char *)v13 + 3) = 0;
  v13[0] = 0;
  sub_100229758((uint64_t)v13);
  v14[0] = 9;
  v14[1] = v13[0];
  v2.i32[0] = *(_DWORD *)((char *)v13 + 3);
  int16x8_t v3 = (int16x8_t)vmovl_u8(v2);
  *(int16x4_t *)v3.i8 = vrev64_s16(*(int16x4_t *)v3.i8);
  unsigned __int32 v15 = vmovn_s16(v3).u32[0];
  char v16 = BYTE2(v13[0]);
  char v17 = BYTE1(v13[0]);
  if (*(unsigned char *)(a1 + 9))
  {
    sub_1001F0C08(*(void *)a1, v14, 8uLL, 1);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"This link is not encrypted, cannot send address.", v4, v5, v6, v7, v8, v9, v10, v12);
    char v11 = sub_100050B4C(0x43u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_10018E0DC(uint64_t a1, char a2, char *a3)
{
  v6[0] = 5;
  v6[1] = a2;
  sub_1001F0C08(a1, v6, 2uLL, 0);
  if (a3)
  {
    uint64_t v5 = sub_1001F10BC(a2);
    sub_1001F0828(a3, v5, 1);
  }
}

void sub_10018E140(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read max data length failed %!", v9, v10, v11, v12, v13, v14, v15, a1);
      char v16 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  else
  {
    int v17 = a5;
    unsigned int v18 = a4;
    int v19 = a3;
    sub_10001BDE0(199, (uint64_t)sub_10018E264, a3, a4, a5, a6, a7, a8, 0);
    sub_10021C9A0(a2, v19, v18, v17);
  }
  sub_10018E370(0, (uint64_t)"initCmdLeReadMaxDataLengthCB");
}

void sub_10018E264(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"_SetDefaultPhyCB status %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      int v19 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  if (a1 && sub_100058654())
  {
    sub_100056E24((uint64_t)"Set default Phy failed with %!", v10, v11, v12, v13, v14, v15, v16, a1);
    int v17 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
}

void sub_10018E370(uint64_t a1, uint64_t a2)
{
  if (dword_100A19630 > 5 || ((1 << dword_100A19630) & 0x32) == 0)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"%s orphaned", v22, v23, v24, v25, v26, v27, v28, a2);
    uint64_t v29 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_16:
    sub_100744F6C();
    return;
  }
  uint64_t v5 = qword_100A049C8;
  if (!qword_100A049C8)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"%s orphaned", v14, v15, v16, v17, v18, v19, v20, a2);
    char v21 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_16;
  }
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"%s failed: %!", v6, v7, v8, v9, v10, v11, v12, a2);
      uint64_t v13 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, a1);
  }
  else
  {
    sub_10025B0BC(v5);
  }
}

uint64_t sub_10018E4D8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!BYTE9(xmmword_100A19600)) {
    return 0;
  }
  uint64_t v8 = sub_10001BDE0(167, (uint64_t)sub_10018E570, a3, a4, a5, a6, a7, a8, v18);
  if (v8)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_LE_ReadAdvertisingChannelTxPower", v9, v10, v11, v12, v13, v14, v15, v19);
      uint64_t v16 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  return v8;
}

void sub_10018E570(uint64_t a1, uint64_t a2)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read LE Advertising TX power failed %!", v3, v4, v5, v6, v7, v8, v9, a1);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  else if (sub_100208D04())
  {
    int v12 = 0;
    do
      sub_10022A2E0(a2, v12++);
    while (sub_100208D04() > v12);
  }
}

uint64_t sub_10018E60C(uint64_t a1)
{
  if (DWORD2(xmmword_100A19860)) {
    return 140;
  }
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIAPI_Init: configuration parameter is deprecated", v3, v4, v5, v6, v7, v8, v9, v11);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10025B260(a1, 46);
  }
  qword_100A19628 = sub_10025B218(0x2Eu);
  if (!qword_100A19628)
  {
    sub_10025B8C0();
    if (!qword_100A19628) {
      return 127;
    }
  }
  dword_100A19630 = 0;
  byte_100A19634 = 0;
  qword_100A19638 = (uint64_t)off_10099D668;
  off_100A19640 = nullsub_45;
  off_100A19648 = (uint64_t (*)(void, void, void, void, void, void, void, void, _DWORD))nullsub_45;
  *(_OWORD *)algn_100A19661 = 0u;
  *(long long *)((char *)&xmmword_100A19670 + 1) = 0u;
  xmmword_100A19680 = 0u;
  byte_100A19660 = 7;
  xmmword_100A19650 = xmmword_1007BA10A;
  off_100A049C0 = 0;
  qword_100A049C8 = 0;
  off_100A049D0 = sub_10010B394;
  off_100A19690 = 0;
  off_100A19698 = 0;
  uint64_t result = sub_100197598();
  if (!result)
  {
    uint64_t result = sub_1000262C4();
    if (!result)
    {
      uint64_t result = sub_10019BF60();
      if (!result)
      {
        uint64_t result = sub_10019734C();
        if (!result)
        {
          uint64_t result = sub_1001A1170();
          if (!result) {
            DWORD2(xmmword_100A19860) = 1;
          }
        }
      }
    }
  }
  return result;
}

uint64_t sub_10018E794(uint64_t a1)
{
  uint64_t v4 = a1;
  if (!DWORD2(xmmword_100A19860)) {
    return 103;
  }
  dword_100A19630 = 1;
  qword_100A049C8 = (uint64_t)off_10099D688;
  sub_10025AF38(off_10099D688);
  if (a1)
  {
    v3[1] = &v4;
    v3[0] = (const void *)8;
    return sub_1000268E4((uint64_t)sub_10018E8E4, v3, 1, 0);
  }
  else
  {
    return sub_10018E84C();
  }
}

uint64_t sub_10018E84C()
{
  if (!DWORD2(xmmword_100A19860)) {
    return 103;
  }
  uint64_t result = 109;
  switch(dword_100A19630)
  {
    case 0:
      sub_10025B8C0();
      return 103;
    case 1:
      return result;
    case 2:
      uint64_t result = 0;
      break;
    case 3:
      uint64_t result = 108;
      break;
    default:
      sub_10025B8C0();
      uint64_t result = 637;
      break;
  }
  return result;
}

uint64_t sub_10018E8E4(uint64_t a1)
{
  if (sub_10018E84C() == 109)
  {
    return sub_1000268E4((uint64_t)sub_10018E8E4, (const void **)a1, 1, 0);
  }
  else
  {
    uint64_t v3 = **(uint64_t (***)(void))(a1 + 8);
    return v3();
  }
}

uint64_t sub_10018E960(uint64_t a1)
{
  uint64_t v1 = *(void *)(a1 + 8);
  if (dword_100A19630 != 4) {
    sub_10025B8C0();
  }
  if (qword_100A049C8) {
    sub_10025B8C0();
  }
  if (off_100A049C0) {
    sub_10025B8C0();
  }
  sub_10019F4CC();
  sub_1001973B4();
  sub_10019C2F0();
  dword_100A19630 = 5;
  uint64_t v2 = *(void **)(v1 + 8);
  qword_100A049C8 = (uint64_t)v2;
  off_100A049C0 = *(_UNKNOWN **)v1;

  return sub_10025AF38(v2);
}

void sub_10018E9F0()
{
  v52[0] = 0;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIIfc_DeviceHasBeenReset", v0, v1, v2, v3, v4, v5, v6, v51);
    uint64_t v7 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  if (DWORD2(xmmword_100A19860))
  {
    switch(dword_100A19630)
    {
      case 0:
      case 3:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Device is not initialized, cannot restore device context", v8, v9, v10, v11, v12, v13, v14, v51);
          uint64_t v15 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
            goto LABEL_23;
          }
        }
        break;
      case 1:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Device reset during initialization - terminating failed initialization", v34, v35, v36, v37, v38, v39, v40, v51);
          uint64_t v41 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        __int16 v42 = (void (**)(uint64_t))qword_100A049C8;
        goto LABEL_25;
      case 2:
      case 6:
        v53[0] = sub_10018EC84;
        v53[1] = off_10099D7B0;
        v52[1] = v53;
        LOWORD(v52[0]) = 16;
        uint64_t v24 = sub_1000268E4((uint64_t)sub_10018E960, v52, 10, 0);
        if (v24)
        {
          uint64_t v25 = v24;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed %!", v26, v27, v28, v29, v30, v31, v32, v25);
            uint64_t v33 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
        }
        else
        {
          dword_100A19630 = 4;
        }
        break;
      case 4:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Device reset process is already pending", v43, v44, v45, v46, v47, v48, v49, v51);
          uint64_t v50 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
            goto LABEL_23;
          }
        }
        break;
      case 5:
        sub_1001A1AFC(632);
        __int16 v42 = (void (**)(uint64_t))qword_100A049C8;
        if (qword_100A049C8) {
LABEL_25:
        }
          sub_10025B144(v42, 632);
        break;
      default:
        sub_10025B8C0();
        break;
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"HCI is not initialized, cannot restore device context", v16, v17, v18, v19, v20, v21, v22, v51);
    uint64_t v23 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
LABEL_23:
    }
      sub_100744F6C();
  }
}

void sub_10018EC84(int a1)
{
  if (a1)
  {
    v22[0] = 0;
    int v1 = dword_100A04A10++;
    if (v1 >= 3)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Reset retries exhausted", v3, v4, v5, v6, v7, v8, v9, v21);
        uint64_t v10 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else
    {
      v23[0] = sub_10018EC84;
      v23[1] = off_10099D760;
      v22[1] = v23;
      LOWORD(v22[0]) = 16;
      uint64_t v2 = sub_1000268E4((uint64_t)sub_10018E960, v22, 10, 0);
      if (!v2)
      {
        dword_100A19630 = 4;
        return;
      }
      uint64_t v11 = v2;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_Dispatch_RegisterFunc failed %!", v12, v13, v14, v15, v16, v17, v18, v11);
        uint64_t v19 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    uint64_t v20 = sub_10010B394(631);
    sub_10018EDB8(v20);
  }
  else
  {
    dword_100A04A10 = 0;
  }
}

void sub_10018EDB8(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIIfc_DataErrorDetected %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

uint64_t sub_10018EE24(uint64_t a1)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIIfc_FatalErrorDetected %!", v2, v3, v4, v5, v6, v7, v8, a1);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  if (off_100A049D0) {
    return off_100A049D0(a1);
  }
  uint64_t v11 = (void *)sub_10010B394(a1);
  return sub_10018EEAC(v11, v12);
}

uint64_t sub_10018EEAC(void *a1, void *a2)
{
  if (!DWORD2(xmmword_100A19860)) {
    return 103;
  }
  if (!a1)
  {
    sub_10025B8C0();
    return 101;
  }
  if (!a1[1])
  {
    sub_10025B8C0();
    if (!a1[1]) {
      return 101;
    }
  }
  if (!a1[2])
  {
    sub_10025B8C0();
    if (!a1[2]) {
      return 101;
    }
  }
  if (!a1[3])
  {
    sub_10025B8C0();
    if (!a1[3]) {
      return 101;
    }
  }
  if (a2) {
    *a2 = qword_100A19638;
  }
  uint64_t result = 0;
  qword_100A19638 = (uint64_t)a1;
  return result;
}

uint64_t sub_10018EF4C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10019304C(0xEu, a2, a3, a4, a5, a6, a7, a8, a1);
}

uint64_t sub_10018EF78(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(56, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018EFB8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(64, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018EFE8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  return sub_10001BDE0(65, a1, a3, a4, a5, a6, a7, a8, a9);
}

uint64_t sub_10018EFF4(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(69, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F028(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(154, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F058(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(7, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F088(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(105, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F0B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(155, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F0E8(uint64_t a1, uint64_t a2)
{
  if (!a2) {
    return 101;
  }
  uint64_t v10 = 0;
  uint64_t result = sub_10017E2D4(a2, &v10);
  if (!result) {
    return sub_10001BDE0(156, a1, v4, v5, v6, v7, v8, v9, v10);
  }
  return result;
}

uint64_t sub_10018F154(uint64_t a1, uint64_t a2)
{
  if (!a2) {
    return 101;
  }
  uint64_t v10 = 0;
  uint64_t result = sub_10017E2D4(a2, &v10);
  if (!result) {
    return sub_10001BDE0(157, a1, v4, v5, v6, v7, v8, v9, v10);
  }
  return result;
}

uint64_t sub_10018F1B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCI_Reset(), HCI already initialized", v9, a3, a4, a5, a6, a7, a8, v12);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_1007499C4();
      }
    }
  }
  return sub_10001BDE0(55, a1, a3, a4, a5, a6, a7, a8, v12);
}

uint64_t sub_10018F230(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(115, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F264(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(135, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F298(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(136, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F2CC(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(138, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F308(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(90, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F33C(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(189, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F370(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(190, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F3B0(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(201, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F3F0(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  return sub_10001BDE0(202, a1, a3, a4, a5, a6, a7, a8, a2);
}

uint64_t sub_10018F434()
{
  if (sub_100023E48()) {
    return 0;
  }

  return sub_100022F1C();
}

uint64_t sub_10018F494()
{
  if (!qword_100A049D8)
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"OI_HciIfc_GetPacket: OI_HCIIfc_Send_Req not in progress", v7, v8, v9, v10, v11, v12, v13, v24);
    uint64_t v14 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v14, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
LABEL_10:
    sub_100744F6C();
    return 0;
  }
  uint64_t v0 = sub_100022FE8((unsigned __int16)word_100A049F4 + 5);
  if (!v0)
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"OI_HciIfc_GetPacket: could not allocate packet buffer", v15, v16, v17, v18, v19, v20, v21, v24);
    uint64_t v22 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
    goto LABEL_10;
  }
  int v1 = v0;
  qword_100A049E0 = (uint64_t)v0;
  int v2 = byte_100A049E8;
  *uint64_t v0 = byte_100A049E8;
  char v3 = HIBYTE(word_100A049F0);
  v1[1] = word_100A049F0;
  v1[2] = v3;
  unsigned int v4 = (unsigned __int16)word_100A049F4;
  char v5 = word_100A049F4;
  if (v2 == 2)
  {
    v1[4] = HIBYTE(word_100A049F4);
    uint64_t v6 = 5;
  }
  else
  {
    uint64_t v6 = 4;
  }
  v1[3] = v5;
  if (v4) {
    sub_100022D4C(&v1[v6], qword_100A049D8, v4);
  }
  sub_100023604();
  return qword_100A049E0;
}

uint64_t sub_10018F5E8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  return sub_10001BDE0(160, a1, a3, a4, a5, a6, a7, a8, a9);
}

void sub_10018F5F4()
{
  byte_100A049B8 = 1;
}

uint64_t sub_10018F604()
{
  return byte_100A049B8;
}

uint64_t sub_10018F610(uint64_t result)
{
  byte_100A049F6 = result;
  return result;
}

uint64_t sub_10018F624()
{
  return 0xBF3FF3F86FA7FLL;
}

uint64_t sub_10018F638(uint64_t result)
{
  int v1 = *(_DWORD *)result;
  word_100A049FB = *(_WORD *)(result + 4);
  dword_100A049F7 = v1;
  return result;
}

uint64_t sub_10018F654(uint64_t result)
{
  if (result) {
    int v1 = 3;
  }
  else {
    int v1 = 2;
  }
  dword_100A19630 = v1;
  qword_100A049C8 = 0;
  return result;
}

void sub_10018F674()
{
  if (dword_100A049F7 | (unsigned __int16)word_100A049FB)
  {
    if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
    {
      byte_100A19634 = 1;
      uint64_t v0 = sub_100202334((uint64_t)&dword_100A049F7);
      byte_100A19634 = 0;
      if (v0)
      {
        uint64_t v1 = v0;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"BT_VSC_Write_Bd_Addr failed: %!", v2, v3, v4, v5, v6, v7, v8, v1);
          uint64_t v9 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        sub_10025B144((void (**)(uint64_t))qword_100A049C8, v1);
      }
    }
  }
  else
  {
    sub_10018E370(0, (uint64_t)"initCmdWriteBdAddrCB");
  }
}

void sub_10018F78C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  unsigned int v8 = dword_100A19630;
  if (dword_100A19630 > 5 || ((1 << dword_100A19630) & 0x32) == 0)
  {
    sub_10025B8C0();
    unsigned int v8 = dword_100A19630;
  }
  BOOL v10 = v8 > 5;
  int v11 = (1 << v8) & 0x32;
  if (v10 || v11 == 0)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"initCmdReset, orphaned", v24, v25, v26, v27, v28, v29, v30, v32);
      uint64_t v31 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else if (*(unsigned char *)(qword_100A19628 + 10))
  {
    uint64_t v13 = qword_100A049C8;
    sub_10025B0BC(v13);
  }
  else
  {
    byte_100A19634 = 1;
    uint64_t v14 = sub_10001BDE0(55, (uint64_t)sub_100190E6C, a3, a4, a5, a6, a7, a8, v32);
    byte_100A19634 = 0;
    if (v14)
    {
      uint64_t v15 = v14;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_Reset failed: %!", v16, v17, v18, v19, v20, v21, v22, v15);
        uint64_t v23 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v15);
    }
  }
}

void sub_10018F8FC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(143, (uint64_t)sub_100190F04, a3, a4, a5, a6, a7, a8, v18);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_ReadLocalVersionInformation failed: %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
}

void sub_10018F9C4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
  {
    byte_100A19634 = 1;
    int v8 = sub_10001BDE0(144, (uint64_t)sub_100190FD0, a3, a4, a5, a6, a7, a8, v10);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = qword_100A049C8;
      sub_10025B0BC(v9);
    }
  }
}

void sub_10018FA50(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(149, (uint64_t)sub_100190FE0, a3, a4, a5, a6, a7, a8, v26);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (v8 == 628)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCICMD_ReadBDADDR failed: %!, ignoring error", v10, v11, v12, v13, v14, v15, v16, 628);
          uint64_t v17 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        sub_10025B0BC(qword_100A049C8);
      }
      else
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCICMD_ReadBDADDR failed: %!", v18, v19, v20, v21, v22, v23, v24, v9);
          uint64_t v25 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
      }
    }
  }
}

void sub_10018FB70(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(145, (uint64_t)sub_100191088, a3, a4, a5, a6, a7, a8, v18);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_ReadLocalSupportedFeatures failed: %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
}

void sub_10018FC38(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(146, (uint64_t)sub_100191160, a3, a4, a5, a6, a7, a8, 2);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_ReadLocalExtendedFeatures failed: %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
}

void sub_10018FD08(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600))
  {
    uint64_t v8 = sub_10001BDE0(164, (uint64_t)sub_1001912C4, a3, a4, a5, a6, a7, a8, v19);
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_LE_ReadLocalSupportedFeatures", v10, v11, v12, v13, v14, v15, v16, v20);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
  else
  {
    uint64_t v18 = qword_100A049C8;
    sub_10025B0BC(v18);
  }
}

void sub_10018FDCC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if ((BYTE8(xmmword_100A195C0) & 0xFE) == 4)
  {
    uint64_t v8 = sub_10001BDE0(54, (uint64_t)sub_1001913FC, a3, a4, a5, a6, a7, a8, (uint64_t)&unk_1007BA123);
    if (!v8) {
      return;
    }
    uint64_t v9 = v8;
    if (!sub_100058654()) {
      goto LABEL_11;
    }
    sub_100056E24((uint64_t)"OI_HCICMD_SetEventMask returned %!", v10, v11, v12, v13, v14, v15, v16, v28);
    uint64_t v17 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      goto LABEL_11;
    }
    goto LABEL_10;
  }
  if (BYTE8(xmmword_100A195C0) >= 6u)
  {
    uint64_t v18 = sub_10001BDE0(54, (uint64_t)sub_1001913FC, a3, a4, a5, a6, a7, a8, (uint64_t)&unk_1007BA12B);
    if (!v18) {
      return;
    }
    uint64_t v9 = v18;
    if (!sub_100058654()) {
      goto LABEL_11;
    }
    sub_100056E24((uint64_t)"OI_HCICMD_SetEventMask returned %!", v19, v20, v21, v22, v23, v24, v25, v29);
    uint64_t v26 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      goto LABEL_11;
    }
LABEL_10:
    sub_100748324();
LABEL_11:
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    return;
  }
  uint64_t v27 = qword_100A049C8;

  sub_10025B0BC(v27);
}

void sub_10018FF28()
{
  if (BYTE8(xmmword_100A195C0) < 0xCu)
  {
    uint64_t v17 = qword_100A049C8;
    sub_10025B0BC(v17);
  }
  else
  {
    unint64_t v6 = *((unsigned __int16 *)sub_100022214(0x85u) + 2);
    if ((v6 & 0xC000) == 0 && (*((unsigned char *)&xmmword_100A19650 + (v6 >> 8)) & v6) != 0)
    {
      byte_100A04A00 |= 2u;
      byte_1009F95F4 = 89;
      byte_1009F9460[&stru_100001160.dylib.timestamp] = 89;
    }
    uint64_t v7 = sub_10001BDE0(126, (uint64_t)sub_100191474, v0, v1, v2, v3, v4, v5, (uint64_t)&unk_100A049FD);
    if (v7)
    {
      uint64_t v8 = v7;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_SetEventMaskPage2 returned %!", v9, v10, v11, v12, v13, v14, v15, v18);
        uint64_t v16 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v8);
    }
  }
}

void sub_10019005C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE8(xmmword_100A195C0) < 6u)
  {
    uint64_t v18 = qword_100A049C8;
    sub_10025B0BC(v18);
  }
  else
  {
    uint64_t v8 = sub_10001BDE0(162, (uint64_t)sub_1001914EC, a3, a4, a5, a6, a7, a8, (uint64_t)&unk_1007BA11B);
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_LE_SetEventMask returned %!", v10, v11, v12, v13, v14, v15, v16, v19);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
}

void sub_10019013C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE8(xmmword_100A19600)) {
    BOOL v8 = BYTE8(xmmword_100A195C0) >= 4u;
  }
  else {
    BOOL v8 = 0;
  }
  if (v8)
  {
    uint64_t v10 = sub_10001BDE0(118, (uint64_t)sub_100191564, a3, a4, a5, a6, a7, a8, byte_1009F9454);
    if (v10)
    {
      uint64_t v11 = v10;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WriteSimplePairingMode", v12, v13, v14, v15, v16, v17, v18, v20);
        uint64_t v19 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v11);
    }
  }
  else
  {
    uint64_t v9 = qword_100A049C8;
    sub_10025B0BC(v9);
  }
}

void sub_100190224(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600))
  {
    uint64_t v8 = sub_10001BDE0(131, (uint64_t)sub_1001915DC, a3, a4, a5, a6, a7, a8, 1);
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WriteLeHostSupported", v10, v11, v12, v13, v14, v15, v16, v19);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
  else
  {
    uint64_t v18 = qword_100A049C8;
    sub_10025B0BC(v18);
  }
}

void sub_1001902FC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600))
  {
    if (BYTE7(xmmword_100A195E0) >= 0x10u)
    {
      uint64_t v8 = sub_1001915EC;
      int v9 = 244;
    }
    else
    {
      uint64_t v8 = sub_1001916B8;
      int v9 = 163;
    }
    uint64_t v11 = sub_10001BDE0(v9, (uint64_t)v8, a3, a4, a5, a6, a7, a8, v20);
    if (v11)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WriteLeHostSupported", v12, v13, v14, v15, v16, v17, v18, v21);
        uint64_t v19 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v11);
    }
  }
  else
  {
    uint64_t v10 = qword_100A049C8;
    sub_10025B0BC(v10);
  }
}

void sub_1001903E4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!BYTE9(xmmword_100A19600)) {
    goto LABEL_4;
  }
  uint64_t v8 = sub_10001BDE0(197, (uint64_t)sub_10018E140, a3, a4, a5, a6, a7, a8, v19);
  if (!v8) {
    return;
  }
  uint64_t v9 = v8;
  if (v8 != 628)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_LE_ReadMaximumLength %!", v11, v12, v13, v14, v15, v16, v17, v9);
      uint64_t v18 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
  }
  else
  {
LABEL_4:
    uint64_t v10 = qword_100A049C8;
    sub_10025B0BC(v10);
  }
}

void sub_1001904BC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600))
  {
    uint64_t v8 = sub_10001BDE0(188, (uint64_t)sub_10019173C, a3, a4, a5, a6, a7, a8, v19);
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_LE_ReadSupportedStates", v10, v11, v12, v13, v14, v15, v16, v20);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
  else
  {
    uint64_t v18 = qword_100A049C8;
    sub_10025B0BC(v18);
  }
}

void sub_100190580(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600))
  {
    uint64_t v8 = sub_10001BDE0(175, (uint64_t)sub_100191778, a3, a4, a5, a6, a7, a8, v19);
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_LE_ReadFilterAcceptListSize", v10, v11, v12, v13, v14, v15, v16, v20);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
  else
  {
    uint64_t v18 = qword_100A049C8;
    sub_10025B0BC(v18);
  }
}

void sub_100190644(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (dword_100A19630 == 1 || (sub_10025B8C0(), dword_100A19630 == 1))
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(147, (uint64_t)sub_1001917B4, a3, a4, a5, a6, a7, a8, v18);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_ReadBufferSize failed: %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
    }
  }
}

void sub_10019070C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!BYTE9(xmmword_100A19600) || (BYTE5(xmmword_100A195E0) & 0x20) == 0) {
    goto LABEL_5;
  }
  uint64_t v8 = sub_10001BDE0(224, (uint64_t)sub_1001918E8, a3, a4, a5, a6, a7, a8, v19);
  if (!v8) {
    return;
  }
  uint64_t v9 = v8;
  if (v8 != 628)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_ReadPeriodicAdvListSize %!", v11, v12, v13, v14, v15, v16, v17, v9);
      uint64_t v18 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
  }
  else
  {
LABEL_5:
    uint64_t v10 = qword_100A049C8;
    sub_10025B0BC(v10);
  }
}

void sub_1001907EC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600) && (BYTE7(xmmword_100A195E0) & 0x30) != 0)
  {
    uint64_t v8 = sub_10001BDE0(243, (uint64_t)sub_100191924, a3, a4, a5, a6, a7, a8, 32);
    if (v8)
    {
      uint64_t v9 = v8;
      if (v8 == 628)
      {
        sub_10025B0BC(qword_100A049C8);
      }
      else
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCI_CMD_LE_SetHostFeatureCommand %!", v11, v12, v13, v14, v15, v16, v17, v9);
          uint64_t v18 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
        sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
      }
    }
    BYTE8(xmmword_100A195E0) |= 1u;
  }
  else
  {
    uint64_t v10 = qword_100A049C8;
    sub_10025B0BC(v10);
  }
}

void sub_100190904(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (BYTE9(xmmword_100A19600) && (BYTE8(xmmword_100A195E0) & 0x60) != 0)
  {
    uint64_t v8 = sub_10001BDE0(243, (uint64_t)sub_100191934, a3, a4, a5, a6, a7, a8, 38);
    if (v8)
    {
      uint64_t v9 = v8;
      if (v8 == 628)
      {
        sub_10025B0BC(qword_100A049C8);
      }
      else
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCI_CMD_LE_SetHostFeatureCommand %!", v11, v12, v13, v14, v15, v16, v17, v9);
          uint64_t v18 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
            sub_100745764();
          }
        }
        sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
      }
    }
    BYTE8(xmmword_100A195E0) |= 0x40u;
  }
  else
  {
    uint64_t v10 = qword_100A049C8;
    sub_10025B0BC(v10);
  }
}

void sub_100190A1C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!BYTE9(xmmword_100A19600) || (BYTE8(xmmword_100A195E0) & 0x60) == 0) {
    goto LABEL_5;
  }
  uint64_t v8 = sub_10001BDE0(250, (uint64_t)sub_100191944, a3, a4, a5, a6, a7, a8, 1);
  if (!v8) {
    return;
  }
  uint64_t v9 = v8;
  if (v8 != 628)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_LE_SetDefaultSubrate %!", v11, v12, v13, v14, v15, v16, v17, v9);
      uint64_t v18 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
  }
  else
  {
LABEL_5:
    uint64_t v10 = qword_100A049C8;
    sub_10025B0BC(v10);
  }
}

void sub_100190B1C()
{
  unsigned int v0 = dword_100A19630;
  if (dword_100A19630 > 5 || ((1 << dword_100A19630) & 0x32) == 0)
  {
    sub_10025B8C0();
    unsigned int v0 = dword_100A19630;
  }
  BOOL v2 = v0 > 5;
  int v3 = (1 << v0) & 0x32;
  if (!v2 && v3 != 0)
  {
    int v5 = sub_10019E3F8();
    byte_100A19634 = 1;
    uint64_t v12 = sub_10001BDE0(94, (uint64_t)sub_100191954, v6, v7, v8, v9, v10, v11, (v5 + 4));
    byte_100A19634 = 0;
    if (v12)
    {
      uint64_t v13 = v12;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_HostBufferSize failed: %!", v14, v15, v16, v17, v18, v19, v20, v13);
        uint64_t v21 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v13);
    }
  }
}

void sub_100190C38(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  unsigned int v8 = dword_100A19630;
  if (dword_100A19630 > 5 || ((1 << dword_100A19630) & 0x32) == 0)
  {
    sub_10025B8C0();
    unsigned int v8 = dword_100A19630;
  }
  BOOL v10 = v8 > 5;
  int v11 = (1 << v8) & 0x32;
  if (!v10 && v11 != 0)
  {
    unsigned __int8 v13 = *(unsigned char *)(qword_100A19628 + 8) ? *(unsigned char *)(qword_100A19628 + 7) | 2 : *(unsigned char *)(qword_100A19628 + 7);
    byte_100A19634 = 1;
    uint64_t v14 = sub_10001BDE0(93, (uint64_t)sub_1001919D4, a3, a4, a5, a6, a7, a8, v13);
    byte_100A19634 = 0;
    if (v14)
    {
      uint64_t v15 = v14;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_SetHostControllerToHostFlowControl failed: %!", v16, v17, v18, v19, v20, v21, v22, v15);
        uint64_t v23 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_10025B144((void (**)(uint64_t))qword_100A049C8, v15);
    }
  }
}

void sub_100190D4C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  uint64_t v8 = sub_10001BDE0(124, (uint64_t)sub_100191A48, a3, a4, a5, a6, a7, a8, 1);
  if (v8)
  {
    uint64_t v9 = v8;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteDefaultErroneousDataReporting", v10, v11, v12, v13, v14, v15, v16, v18);
      uint64_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, v9);
  }
}

void sub_100190DEC(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write BD Addr cmd failed %!", v2, v3, v4, v5, v6, v7, v8, a1);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdWriteBdAddrCB");
}

void sub_100190E6C(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"reset command failed (%!), ignoring error and continuing initialization", v2, v3, v4, v5, v6, v7, v8, a1);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (a1 == 621) {
      byte_100A196C1 = 1;
    }
  }
  sub_10018E370(0, (uint64_t)"initCmdResetCB");
}

void sub_100190F04(uint64_t a1, unsigned __int8 *a2)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read Local Version failed %!", v3, v4, v5, v6, v7, v8, v9, a1);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    if (!a2) {
      sub_10025B8C0();
    }
    BYTE14(xmmword_100A19650) = BYTE14(xmmword_100A19650) & 0xEF | (16 * (*a2 > 1u));
    WORD3(xmmword_100A195C0) = *((_WORD *)a2 + 1);
    BYTE8(xmmword_100A195C0) = a2[4];
    WORD5(xmmword_100A195C0) = *((_WORD *)a2 + 4);
  }
  sub_10018E370(a1, (uint64_t)"initCmdReadLocalVersionCB");
}

void sub_100190FD0()
{
}

void sub_100190FE0(uint64_t a1, int *a2)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read BD Addr cmd failed %!", v3, v4, v5, v6, v7, v8, v9, a1);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else if (dword_100A19630 == 1)
  {
    int v11 = *a2;
    WORD2(xmmword_100A195C0) = *((_WORD *)a2 + 2);
    LODWORD(xmmword_100A195C0) = v11;
  }
  sub_10018E370(a1, (uint64_t)"initCmdReadBdAddrCB");
}

void sub_100191088(uint64_t a1, uint64_t a2)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read local features cmd failed %!", v3, v4, v5, v6, v7, v8, v9, a1);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else if (a2 && dword_100A19630 == 1)
  {
    *(void *)((char *)&xmmword_100A195C0 + 12) = *(void *)a2;
    if (BYTE8(xmmword_100A195C0) < 6u)
    {
      WORD4(xmmword_100A19600) = 1;
    }
    else
    {
      BYTE8(xmmword_100A19600) = (*(unsigned char *)(a2 + 4) & 0x20) == 0;
      BYTE9(xmmword_100A19600) = (*(unsigned char *)(a2 + 4) & 0x40) != 0;
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdReadLocalFeaturesCB");
}

void sub_100191160(uint64_t a1, unsigned int a2, unsigned int a3, void *a4)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read local features cmd failed %!", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else if (a4)
  {
    if (dword_100A19630 == 1)
    {
      *(void *)((char *)&xmmword_100A195C0 + 8 * a2 + 12) = *a4;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Extended features, max %d, pageNumber %d: %@", v14, v15, v16, v17, v18, v19, v20, a3);
        uint64_t v21 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          *(_DWORD *)int buf = 136446210;
          uint64_t v23 = sub_100050714();
          _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdReadLocalExtendedFeaturesCB");
}

void sub_1001912C4(uint64_t a1, void *a2)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read local supported features failed %!", v3, v4, v5, v6, v7, v8, v9, a1);
      uint64_t v10 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  else if (a2)
  {
    *(void *)((char *)&xmmword_100A195E0 + 4) = *a2;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"LE local supported features %@", v11, v12, v13, v14, v15, v16, v17, (uint64_t)&xmmword_100A195E0 + 4);
      uint64_t v18 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v20 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }
  sub_10018E370(0, (uint64_t)"initCmdReadLeLocalSupportedFeaturesCB");
}

void sub_1001913FC(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write event mask", v2, v3, v4, v5, v6, v7, v8, v10);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdWriteEventMaskCb");
}

void sub_100191474(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write event mask page 2", v2, v3, v4, v5, v6, v7, v8, v10);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdWriteEventMaskPage2Cb");
}

void sub_1001914EC(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write le event mask", v2, v3, v4, v5, v6, v7, v8, v10);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdWriteLeEventMaskCb");
}

void sub_100191564(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write SSP mode", v2, v3, v4, v5, v6, v7, v8, v10);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100748324();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdWriteSspCb");
}

void sub_1001915DC()
{
}

void sub_1001915EC(uint64_t a1, int a2, int a3, int a4, int a5)
{
  if (!a1)
  {
    if ((a2 != 0) != (a3 != 0)) {
      sub_10025B8C0();
    }
    if ((a4 != 0) != (a5 != 0)) {
      sub_10025B8C0();
    }
    word_100A04A06 = a2;
    byte_100A04A08 = a3;
    word_100A04A0A = a4;
    byte_100A04A0C = a5;
    if (a2) {
      BOOL v10 = a3 == 0;
    }
    else {
      BOOL v10 = 1;
    }
    char v11 = v10;
    byte_100A04A0D = v11;
  }

  sub_10018E370(a1, (uint64_t)"initCmdReadLeBufferSizeV2CB");
}

void sub_1001916B8(int a1, int a2, int a3)
{
  if (!a1)
  {
    if ((a2 != 0) != (a3 != 0)) {
      sub_10025B8C0();
    }
    word_100A04A06 = a2;
    byte_100A04A08 = a3;
    if (a2) {
      BOOL v6 = a3 == 0;
    }
    else {
      BOOL v6 = 1;
    }
    char v7 = v6;
    byte_100A04A0D = v7;
    uint64_t v3 = vars8;
  }
  sub_10018E370(0, (uint64_t)"initCmdReadLeBufferSizeCB");
}

void sub_10019173C(int a1, uint64_t *a2)
{
  if (!a1)
  {
    sub_100226590(a2);
    uint64_t v2 = vars8;
  }
  sub_10018E370(0, (uint64_t)"initCmdReadLeSupportedStatesCB");
}

void sub_100191778(int a1, unsigned int a2)
{
  if (!a1)
  {
    sub_100241BE0(a2);
    uint64_t v2 = vars8;
  }
  sub_10018E370(0, (uint64_t)"initCmdReadLeFilterAcceptListSizeCB");
}

void sub_1001917B4(uint64_t a1, unsigned int a2, __int16 a3, int a4, int a5)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Read device buffer sizes failed %!", v6, v7, v8, v9, v10, v11, v12, a1);
      uint64_t v13 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    goto LABEL_11;
  }
  if (dword_100A19630 != 1
    || (uint64_t v14 = sub_10019F310(a2, a3, word_100A04A06, word_100A04A0A, a4, a5, byte_100A04A08, byte_100A04A0C, byte_100A04A0D), !v14))
  {
LABEL_11:
    sub_10018E370(a1, (uint64_t)"initCmdReadDeviceBufferSizesCB");
    return;
  }
  uint64_t v15 = (uint64_t)v14;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIFlow_Init failed: %!", v16, v17, v18, v19, v20, v21, v22, 0);
    uint64_t v23 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  sub_10025B144((void (**)(uint64_t))qword_100A049C8, v15);
}

void sub_1001918E8(int a1, unsigned int a2)
{
  if (!a1)
  {
    sub_10010A418(a2);
    uint64_t v2 = vars8;
  }
  sub_10018E370(0, (uint64_t)"initCmdReadLePAListSizeCB");
}

void sub_100191924()
{
}

void sub_100191934()
{
}

void sub_100191944()
{
}

void sub_100191954(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Host buffer size cmd failed %!", v2, v3, v4, v5, v6, v7, v8, a1);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdHostBufferSizeCB");
}

void sub_1001919D4(uint64_t a1)
{
  if (a1 == 717)
  {
    a1 = sub_100058654();
    if (a1)
    {
      sub_100056E24((uint64_t)"HCI HostFlowControl unsupported (ignoring)", v1, v2, v3, v4, v5, v6, v7, v9);
      uint64_t v8 = sub_100050B4C(0x2Eu);
      a1 = os_log_type_enabled(v8, OS_LOG_TYPE_ERROR);
      if (a1)
      {
        sub_100744F6C();
        a1 = 0;
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdHostFlowControlCB");
}

void sub_100191A48(uint64_t a1)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Write Erroneous Data Reporting failed %!", v2, v3, v4, v5, v6, v7, v8, a1);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  sub_10018E370(a1, (uint64_t)"initCmdWriteErroneousDataReportingCB");
}

void sub_100191AC8(uint64_t a1)
{
  int v2 = dword_100A19630;
  if ((dword_100A19630 & 0xFFFFFFFE) != 4)
  {
    sub_10025B8C0();
    int v2 = dword_100A19630;
  }
  if ((v2 - 6) > 0xFFFFFFFD)
  {
    qword_100A049C8 = 0;
    if (a1 || (a1 = sub_1001A1AB0(sub_100191CE4), a1))
    {
      sub_100191CE4(a1);
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"resetCmdChainTermination, deviceReset is not active", v3, v4, v5, v6, v7, v8, v9, v11);
    uint64_t v10 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100191B98()
{
  unsigned int v0 = dword_100A19630;
  if (dword_100A19630 > 5 || ((1 << dword_100A19630) & 0x32) == 0)
  {
    sub_10025B8C0();
    unsigned int v0 = dword_100A19630;
  }
  BOOL v2 = v0 > 5;
  int v3 = (1 << v0) & 0x32;
  if (v2 || v3 == 0)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"initCmdStackResetHCITransport, orphaned", v16, v17, v18, v19, v20, v21, v22, v24);
      uint64_t v23 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else if (*(unsigned char *)(qword_100A19628 + 10) || (uint64_t v6 = sub_10016ABB0(), !v6))
  {
    uint64_t v5 = qword_100A049C8;
    sub_10025B0BC(v5);
  }
  else
  {
    uint64_t v7 = (uint64_t)v6;
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIIfc_StackResetHCITransport failed: %!", v8, v9, v10, v11, v12, v13, v14, v7);
      uint64_t v15 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10025B144((void (**)(uint64_t))qword_100A049C8, v7);
  }
}

void sub_100191CE4(uint64_t a1)
{
  if ((dword_100A19630 & 0xFFFFFFFE) != 4) {
    sub_10025B8C0();
  }
  if (a1)
  {
    if (dword_100A19630 == 4) {
      goto LABEL_8;
    }
    int v2 = 6;
  }
  else
  {
    int v2 = 2;
  }
  dword_100A19630 = v2;
LABEL_8:
  int v3 = (void (*)(uint64_t))off_100A049C0;
  if (off_100A049C0)
  {
    off_100A049C0 = 0;
    v3(a1);
  }
}

uint64_t sub_100191DE0(uint64_t *a1, uint64_t a2, uint64_t *a3, void *a4, uint64_t a5, unsigned char *a6, unsigned char *a7)
{
  int v13 = *(unsigned __int16 *)(a2 + 6) + 4;
  uint64_t v14 = sub_100022FE8(*(unsigned __int16 *)(a2 + 6) + 4);
  if (!v14) {
    return 104;
  }
  *((unsigned char *)a3 + 15) = 0;
  *a3 = (uint64_t)v14;
  *((_WORD *)a3 + 4) = v13;
  *((_WORD *)a3 + 5) = v13;
  if (!(_WORD)v13) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2561, "((*pBs).__data != NULL) && ((*pBs).__trueSize > 0)");
  }
  *((unsigned char *)a3 + 14) = 2;
  *((_WORD *)a3 + 5) = v13;
  *((_WORD *)a3 + 6) = 1;
  unsigned char *v14 = 1;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    goto LABEL_137;
  }
  uint64_t v15 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) - (int)v15 <= 1)
  {
LABEL_137:
    uint64_t v104 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_139;
  }
  if (*((unsigned char *)a3 + 14) != 2)
  {
    uint64_t v104 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_139:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2563, v104);
  }
  *(unsigned char *)(*a3 + v15) = *(unsigned char *)(a2 + 2);
  *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 1) = *(unsigned char *)(a2 + 3);
  __int16 v16 = *((_WORD *)a3 + 6);
  *((_WORD *)a3 + 6) = v16 + 2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    goto LABEL_141;
  }
  if (*((unsigned __int16 *)a3 + 5) <= (unsigned __int16)(v16 + 2))
  {
LABEL_141:
    uint64_t v105 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_143;
  }
  long long ptr = v14;
  if (*((unsigned char *)a3 + 14) != 2)
  {
    uint64_t v105 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_143:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2564, v105);
  }
  char v17 = *(unsigned char *)(a2 + 6);
  uint64_t v18 = *a3;
  *((_WORD *)a3 + 6) = v16 + 3;
  *(unsigned char *)(v18 + (unsigned __int16)(v16 + 2)) = v17;
  uint64_t v19 = *(unsigned __int8 **)(a2 + 8);
  if (v19)
  {
    int v20 = *v19;
    if (v20)
    {
      uint64_t v21 = 0;
      uint64_t v127 = a6 + 1;
      uint64_t v128 = a4;
      uint64_t v129 = a5;
      int v130 = v13;
      while (1)
      {
        switch(v20)
        {
          case 'a':
            uint64_t v22 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_145:
              uint64_t v106 = "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_147:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2612, v106);
            }
            uint64_t v23 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v23 <= 5) {
              goto LABEL_145;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v106 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_147;
            }
            uint64_t v24 = *v22;
            sub_100008A18(*a3 + v23, *v22, 6uLL);
            *((_WORD *)a3 + 6) += 6;
            if (a5)
            {
              int v25 = *(_DWORD *)v24;
              *(_WORD *)(a5 + 4) = *(_WORD *)(v24 + 4);
              *(_DWORD *)a5 = v25;
            }
            if (a6)
            {
              int v26 = *(_DWORD *)v24;
              *((_WORD *)v127 + 2) = *(_WORD *)(v24 + 4);
              *(_DWORD *)uint64_t v127 = v26;
            }
            goto LABEL_109;
          case 'b':
            uint64_t v31 = (const void **)a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_153:
              uint64_t v108 = "ByteStream_NumReadBytesAvail(*pBs) >= (31)";
LABEL_155:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2725, v108);
            }
            uint64_t v32 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v32 <= 30) {
              goto LABEL_153;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v108 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_155;
            }
            memmove((void *)(*a3 + v32), *v31, 0x1FuLL);
            __int16 v33 = *((_WORD *)a3 + 6) + 31;
LABEL_108:
            *((_WORD *)a3 + 6) = v33;
            goto LABEL_109;
          case 'c':
            uint64_t v34 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_157:
              uint64_t v109 = "ByteStream_NumReadBytesAvail(*pBs) >= (10)";
LABEL_158:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2694, v109);
            }
            uint64_t v35 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v35 <= 9) {
              goto LABEL_157;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v109 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_158;
            }
LABEL_78:
            uint64_t v71 = (uint64_t *)*v34;
            uint64_t v72 = *a3 + v35;
            uint64_t v73 = *v71;
            *(_WORD *)(v72 + 8) = *((_WORD *)v71 + 4);
            *(void *)uint64_t v72 = v73;
            __int16 v33 = *((_WORD *)a3 + 6) + 10;
            goto LABEL_108;
          case 'd':
            uint64_t v36 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_160:
              uint64_t v110 = "ByteStream_NumReadBytesAvail(*pBs) >= (16)";
LABEL_161:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2732, v110);
            }
            uint64_t v37 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v37 <= 15) {
              goto LABEL_160;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v110 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_161;
            }
LABEL_82:
            *(_OWORD *)(*a3 + v37) = *(_OWORD *)*v36;
            __int16 v33 = *((_WORD *)a3 + 6) + 16;
            goto LABEL_108;
          case 'e':
            uint64_t v38 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_163:
              uint64_t v111 = "ByteStream_NumReadBytesAvail((*pBs)) >= (sizeof(*pVal))";
LABEL_164:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2672, v111);
            }
            uint64_t v39 = *((unsigned __int16 *)a3 + 6);
            if ((unint64_t)*((unsigned __int16 *)a3 + 5) - v39 <= 7) {
              goto LABEL_163;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v111 = "((*pBs)).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_164;
            }
LABEL_107:
            *(void *)(*a3 + v39) = *(void *)*v38;
            __int16 v33 = *((_WORD *)a3 + 6) + 8;
            goto LABEL_108;
          case 'f':
          case 'j':
          case 'q':
          case 'r':
          case 's':
          case 't':
          case 'u':
          case 'v':
          case 'x':
          case 'y':
LABEL_127:
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"unknown cmd parm type %d", v95, v96, v97, v98, v99, v100, v101, *(unsigned __int8 *)(*(void *)(a2 + 8) + v21));
              uint64_t v102 = sub_100050B4C(0x2Eu);
              if (os_log_type_enabled(v102, OS_LOG_TYPE_ERROR))
              {
                *(_DWORD *)int buf = 136446466;
                uint64_t v134 = sub_100050714();
                __int16 v135 = 1024;
                int v136 = 615;
                _os_log_error_impl((void *)&_mh_execute_header, v102, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
              }
            }
            sub_100023010(ptr);
            return 615;
          case 'g':
            uint64_t v40 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_166:
              uint64_t v112 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_168:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2648, v112);
            }
            uint64_t v41 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) <= v41) {
              goto LABEL_166;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v112 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_168;
            }
            int v42 = *(_DWORD *)v40;
            uint64_t v43 = *a3;
            *((_WORD *)a3 + 6) = v41 + 1;
            *(unsigned char *)(v43 + v41) = v42;
            if (a7) {
              *a7 = v42;
            }
            goto LABEL_109;
          case 'h':
            uint64_t v44 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_170:
              uint64_t v113 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_172:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2637, v113);
            }
            uint64_t v45 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v45 <= 1) {
              goto LABEL_170;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v113 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_172;
            }
            uint64_t v46 = (unsigned char *)*v44;
            *(unsigned char *)(*a3 + v45) = *v46;
            *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 1) = v46[1];
            *((_WORD *)a3 + 6) += 2;
            if (a4) {
              *a4 = v46;
            }
            goto LABEL_109;
          case 'i':
            uint64_t v47 = (const void **)a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_174:
              uint64_t v114 = "ByteStream_NumReadBytesAvail(*pBs) >= ((240))";
LABEL_176:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2718, v114);
            }
            uint64_t v48 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v48 <= 239) {
              goto LABEL_174;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v114 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_176;
            }
            memmove((void *)(*a3 + v48), *v47, 0xF0uLL);
            __int16 v33 = *((_WORD *)a3 + 6) + 240;
            goto LABEL_108;
          case 'k':
            uint64_t v36 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_178:
              uint64_t v115 = "ByteStream_NumReadBytesAvail((*pBs)) >= (sizeof(*pVal))";
LABEL_179:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2658, v115);
            }
            uint64_t v37 = *((unsigned __int16 *)a3 + 6);
            if ((unint64_t)*((unsigned __int16 *)a3 + 5) - v37 <= 0xF) {
              goto LABEL_178;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v115 = "((*pBs)).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_179;
            }
            goto LABEL_82;
          case 'l':
            uint64_t v49 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_181:
              uint64_t v116 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_183:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2701, v116);
            }
            uint64_t v50 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) <= v50) {
              goto LABEL_181;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v116 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_183;
            }
            int v51 = *(_DWORD *)v49;
            uint64_t v52 = *a3;
            *((_WORD *)a3 + 6) = v50 + 1;
            *(unsigned char *)(v52 + v50) = v51;
            unsigned int v53 = v51;
            int v54 = v51 + ((v51 + 3) >> 2);
            if (v53 <= (v54 + 1)) {
              char v55 = v54 + 1;
            }
            else {
              char v55 = -1;
            }
            byte_100A196C0 = v55;
            goto LABEL_109;
          case 'm':
            uint64_t v56 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_185:
              uint64_t v117 = "ByteStream_NumReadBytesAvail(*pBs) >= (5)";
LABEL_187:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2739, v117);
            }
            uint64_t v57 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v57 <= 4) {
              goto LABEL_185;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v117 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_187;
            }
            uint64_t v58 = (int *)*v56;
            uint64_t v59 = *a3 + v57;
            int v60 = *v58;
            *(unsigned char *)(v59 + 4) = *((unsigned char *)v58 + 4);
            *(_DWORD *)uint64_t v59 = v60;
            __int16 v33 = *((_WORD *)a3 + 6) + 5;
            goto LABEL_108;
          case 'n':
            uint64_t v61 = a6;
            uint64_t v62 = a7;
            uint64_t v63 = (const char **)a1++;
            uint64_t v64 = *v63;
            int v65 = strlen(*v63);
            int v66 = v65;
            if ((unsigned __int16)v65 <= 0xF8uLL) {
              unsigned __int16 v67 = v65;
            }
            else {
              unsigned __int16 v67 = 248;
            }
            uint64_t v68 = *a3;
            uint64_t v69 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
              int v70 = 0;
            }
            else
            {
              int v70 = *((unsigned __int16 *)a3 + 5) - v69;
            }
            if (v70 < v67)
            {
              int v126 = "ByteStream_NumReadBytesAvail(*pBs) >= (len)";
              goto LABEL_222;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              int v126 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_222:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2683, v126);
            }
            memmove((void *)(v68 + v69), v64, v67);
            *((_WORD *)a3 + 6) += v67;
            BOOL v89 = v67 > 0xF7u;
            a7 = v62;
            a6 = v61;
            a5 = v129;
            int v13 = v130;
            a4 = v128;
            if (!v89)
            {
              while (!*((unsigned char *)a3 + 15))
              {
                uint64_t v90 = *((unsigned __int16 *)a3 + 6);
                if (*((unsigned __int16 *)a3 + 5) <= v90) {
                  goto LABEL_132;
                }
                if (*((unsigned char *)a3 + 14) != 2)
                {
                  uint64_t v103 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_134;
                }
                uint64_t v91 = *a3;
                *((_WORD *)a3 + 6) = v90 + 1;
                *(unsigned char *)(v91 + v90) = 0;
                unsigned int v92 = (unsigned __int16)v66++;
                if (v92 >= 0xF7) {
                  goto LABEL_109;
                }
              }
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_132:
              uint64_t v103 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_134:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2685, v103);
            }
LABEL_109:
            ++v21;
            int v20 = *(unsigned __int8 *)(*(void *)(a2 + 8) + v21);
            if (!*(unsigned char *)(*(void *)(a2 + 8) + v21)) {
              goto LABEL_120;
            }
            break;
          case 'o':
            uint64_t v34 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_189:
              uint64_t v118 = "ByteStream_NumReadBytesAvail(*pBs) >= (10)";
LABEL_191:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2745, v118);
            }
            uint64_t v35 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v35 <= 9) {
              goto LABEL_189;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v118 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_191;
            }
            goto LABEL_78;
          case 'p':
            uint64_t v36 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_193:
              uint64_t v119 = "ByteStream_NumReadBytesAvail((*pBs)) >= (sizeof(*pVal))";
LABEL_195:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2665, v119);
            }
            uint64_t v37 = *((unsigned __int16 *)a3 + 6);
            if ((unint64_t)*((unsigned __int16 *)a3 + 5) - v37 <= 0xF) {
              goto LABEL_193;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v119 = "((*pBs)).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_195;
            }
            goto LABEL_82;
          case 'w':
            uint64_t v74 = (const void **)a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_197:
              uint64_t v120 = "ByteStream_NumReadBytesAvail(*pBs) >= (72)";
LABEL_199:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2751, v120);
            }
            uint64_t v75 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v75 <= 71) {
              goto LABEL_197;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v120 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_199;
            }
            memmove((void *)(*a3 + v75), *v74, 0x48uLL);
            __int16 v33 = *((_WORD *)a3 + 6) + 72;
            goto LABEL_108;
          case 'z':
            uint64_t v76 = a1++;
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_201:
              uint64_t v121 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_203:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2626, v121);
            }
            uint64_t v77 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) <= v77) {
              goto LABEL_201;
            }
            if (*((unsigned char *)a3 + 14) != 2)
            {
              uint64_t v121 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_203;
            }
            int v78 = *(_DWORD *)v76;
            uint64_t v79 = *a3;
            *((_WORD *)a3 + 6) = v77 + 1;
            *(unsigned char *)(v79 + v77) = v78;
            if (a6) {
              *a6 = v78;
            }
            goto LABEL_109;
          default:
            switch(v20)
            {
              case '1':
                uint64_t v27 = a1++;
                if (*((unsigned char *)a3 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_149:
                  uint64_t v107 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_151:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2577, v107);
                }
                uint64_t v28 = *((unsigned __int16 *)a3 + 6);
                if (*((unsigned __int16 *)a3 + 5) <= v28) {
                  goto LABEL_149;
                }
                if (*((unsigned char *)a3 + 14) != 2)
                {
                  uint64_t v107 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_151;
                }
                int v29 = *(_DWORD *)v27;
                uint64_t v30 = *a3;
                *((_WORD *)a3 + 6) = v28 + 1;
                *(unsigned char *)(v30 + v28) = v29;
                break;
              case '2':
                uint64_t v80 = a1++;
                if (*((unsigned char *)a3 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_205:
                  uint64_t v122 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_207:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2584, v122);
                }
                uint64_t v81 = *((unsigned __int16 *)a3 + 6);
                if (*((unsigned __int16 *)a3 + 5) - (int)v81 <= 1) {
                  goto LABEL_205;
                }
                if (*((unsigned char *)a3 + 14) != 2)
                {
                  uint64_t v122 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_207;
                }
                int v82 = *(_DWORD *)v80;
                *(unsigned char *)(*a3 + v81) = v82;
                *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 1) = BYTE1(v82);
                __int16 v33 = *((_WORD *)a3 + 6) + 2;
                goto LABEL_108;
              case '3':
                uint64_t v83 = a1++;
                if (*((unsigned char *)a3 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_209:
                  uint64_t v123 = "ByteStream_NumReadBytesAvail(*pBs) >= 3";
LABEL_211:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2591, v123);
                }
                uint64_t v84 = *((unsigned __int16 *)a3 + 6);
                if (*((unsigned __int16 *)a3 + 5) - (int)v84 <= 2) {
                  goto LABEL_209;
                }
                if (*((unsigned char *)a3 + 14) != 2)
                {
                  uint64_t v123 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_211;
                }
                int v85 = *(_DWORD *)v83;
                *(unsigned char *)(*a3 + v84) = v85;
                *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 1) = BYTE1(v85);
                *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 2) = BYTE2(v85);
                __int16 v33 = *((_WORD *)a3 + 6) + 3;
                goto LABEL_108;
              case '4':
                uint64_t v86 = a1++;
                if (*((unsigned char *)a3 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_213:
                  uint64_t v124 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
LABEL_215:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2598, v124);
                }
                uint64_t v87 = *((unsigned __int16 *)a3 + 6);
                if (*((unsigned __int16 *)a3 + 5) - (int)v87 <= 3) {
                  goto LABEL_213;
                }
                if (*((unsigned char *)a3 + 14) != 2)
                {
                  uint64_t v124 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_215;
                }
                int v88 = *(_DWORD *)v86;
                *(unsigned char *)(*a3 + v87) = v88;
                *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 1) = BYTE1(v88);
                *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 2) = BYTE2(v88);
                *(unsigned char *)(*a3 + *((unsigned __int16 *)a3 + 6) + 3) = HIBYTE(v88);
                __int16 v33 = *((_WORD *)a3 + 6) + 4;
                goto LABEL_108;
              case '8':
                uint64_t v38 = a1++;
                if (*((unsigned char *)a3 + 15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_217:
                  __int16 v125 = "ByteStream_NumReadBytesAvail(*pBs) >= (8)";
LABEL_219:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 2605, v125);
                }
                uint64_t v39 = *((unsigned __int16 *)a3 + 6);
                if (*((unsigned __int16 *)a3 + 5) - (int)v39 <= 7) {
                  goto LABEL_217;
                }
                if (*((unsigned char *)a3 + 14) != 2)
                {
                  __int16 v125 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_219;
                }
                goto LABEL_107;
              default:
                goto LABEL_127;
            }
            goto LABEL_109;
        }
      }
    }
  }
LABEL_120:
  if (*((unsigned char *)a3 + 14) == 2)
  {
    int v93 = *((unsigned __int16 *)a3 + 6);
    *((_WORD *)a3 + 5) = v93;
  }
  else
  {
    int v93 = *((unsigned __int16 *)a3 + 5);
  }
  *((unsigned char *)a3 + 14) = 15;
  if (v13 != v93) {
    sub_10025B8C0();
  }
  return 0;
}

uint64_t sub_10019304C(unsigned __int16 a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  uint64_t v23 = 0;
  uint64_t v27 = -1;
  if (!DWORD2(xmmword_100A19860)) {
    return 103;
  }
  if (sub_100023E48()) {
    return 0;
  }
  if (dword_100A19630 != 2) {
    return 627;
  }
  if (sub_100023020()) {
    return 3704;
  }
  uint64_t v24 = 0;
  uint64_t v25 = 0;
  int v21 = 0;
  __int16 v22 = 0;
  v20[0] = 0;
  *(_DWORD *)((char *)v20 + 3) = 0;
  char v19 = 0;
  int v26 = &a9;
  uint64_t v11 = sub_100022214(a1);
  if (!v11) {
    return 616;
  }
  uint64_t v12 = (uint64_t)v11;
  unint64_t v13 = *((unsigned __int16 *)v11 + 2);
  if ((v13 & 0xC000) != 0 || (*((unsigned char *)&xmmword_100A19650 + (v13 >> 8)) & v13) == 0) {
    return 628;
  }
  if (!v11[17]) {
    sub_10025B8C0();
  }
  if (*(unsigned char *)(v12 + 16)) {
    uint64_t result = sub_10001C0AC((int *)v26, v12, (uint64_t *)&v24, (uint64_t)v20, &v27, 0, &v19);
  }
  else {
    uint64_t result = sub_100191DE0(v26, v12, (uint64_t *)&v24, &v23, (uint64_t)&v21, v20, &v19);
  }
  if (!result)
  {
    long long v17 = 0u;
    long long v18 = 0u;
    BYTE8(v17) = 15;
    WORD2(v17) = *(_WORD *)(v12 + 2);
    WORD3(v17) = a1;
    if (WORD2(v17) == 1064 || WORD2(v17) == 1031)
    {
      uint64_t v14 = v23;
      if (!v23)
      {
        sub_10025B8C0();
        uint64_t v14 = v23;
      }
      int v21 = *((_DWORD *)v14 + 12);
      __int16 v22 = v14[26];
    }
    switch(*(unsigned char *)(v12 + 19))
    {
      case 6:
        uint64_t v15 = v23;
        if (!v23)
        {
          sub_10025B8C0();
          uint64_t v15 = v23;
        }
        LOWORD(v18) = *v15;
        break;
      case 7:
        LODWORD(v18) = v21;
        WORD2(v18) = v22;
        break;
      case 8:
        int v16 = *(unsigned __int16 *)(v12 + 2);
        if (v16 != 8205 && v16 != 8259 && v16 != 8325) {
          sub_10025B8C0();
        }
        LODWORD(v18) = v20[0];
        *(_DWORD *)((char *)&v18 + 3) = *(_DWORD *)((char *)v20 + 3);
        break;
      case 9:
        if (*(_WORD *)(v12 + 2) != 8292) {
          sub_10025B8C0();
        }
        *(void *)&long long v18 = v27;
        break;
      case 0xA:
        LOBYTE(v18) = v19;
        break;
      default:
        return sub_100022298(v24, SWORD1(v25), &v17);
    }
    return sub_100022298(v24, SWORD1(v25), &v17);
  }
  return result;
}

uint64_t sub_1001932F8(unsigned __int8 *a1, uint64_t a2)
{
  int v4 = *a1;
  if (v4 == 14)
  {
    uint64_t v5 = 2;
    uint64_t v6 = 5;
    uint64_t v7 = 3;
    uint64_t v8 = 4;
  }
  else
  {
    if (v4 != 15) {
      return 1;
    }
    uint64_t v5 = 3;
    uint64_t v6 = 2;
    uint64_t v7 = 4;
    uint64_t v8 = 5;
  }
  uint64_t v9 = a1[v7] | (a1[v8] << 8);
  uint64_t v10 = a1[v6];
  byte_100A196C1 = a1[v5];
  if ((unsigned __int16)word_100A196A0 != v9) {
    return 1;
  }
  sub_10011631C("raw HCI Event");
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"raw HCI Event :opcode=0x%4x payloadlen=%d", v11, v12, v13, v14, v15, v16, v17, v9);
    long long v18 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  if (off_100A196B0) {
    off_100A196B0(v10, a1, a2, qword_100A196A8);
  }
  off_100A196B8 = 0;
  int v20 = 0;
  if (sub_100058694(254, &v20)) {
    sub_10019C2C4(v20);
  }
  return 0;
}

uint64_t sub_10019343C(unsigned int a1, const void *a2, unsigned int a3, uint64_t (*a4)(void, void, void, void), uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9, uint64_t a10)
{
  uint64_t v30 = 0;
  size_t v14 = a3 + 7;
  sub_10011631C("raw HCI command");
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"raw HCI command: opcode=0x%4x payloadlen=%d", v15, v16, v17, v18, v19, v20, v21, a1);
    __int16 v22 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
  uint64_t v23 = (char *)sub_100022FE8(v14);
  if (!v23) {
    return 104;
  }
  if (!(_WORD)v14) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 3165, "((bs).__data != NULL) && ((bs).__trueSize > 0)");
  }
  uint64_t v24 = v23;
  *uint64_t v23 = 1;
  if ((unsigned __int16)v14 <= 2u) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 3167, "ByteStream_NumReadBytesAvail(bs) >= 2");
  }
  *(_WORD *)(v23 + 1) = a1;
  if ((unsigned __int16)v14 == 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 3168, "ByteStream_NumReadBytesAvail(bs) >= 1");
  }
  v23[3] = a3;
  if (a3)
  {
    if ((unsigned __int16)v14 - 4 < a3) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 3170, "ByteStream_NumReadBytesAvail(bs) >= (len)");
    }
    memmove(v23 + 4, a2, a3);
    __int16 v25 = a3 + 4;
  }
  else
  {
    __int16 v25 = 4;
  }
  word_100A196A0 = a1;
  uint64_t v30 = &a10;
  qword_100A196A8 = a9;
  off_100A196B0 = a4;
  LODWORD(v27) = 0;
  *((void *)&v27 + 1) = 0;
  WORD2(v27) = a1;
  *(_DWORD *)((char *)&v27 + 6) = -16908016;
  uint64_t v28 = 0;
  int v29 = a4;
  off_100A196B8 = (uint64_t (*)(void, void, void))sub_1001932F8;
  return sub_100022298(v24, v25, &v27);
}

uint64_t sub_100193608(uint64_t a1, uint64_t (*a2)(uint64_t, void), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    int v5 = *(unsigned __int16 *)(a3 + 12);
    if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) > 1u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if (*(unsigned __int16 *)(a3 + 10) - v5 > 1)
        {
          unsigned __int16 v6 = *(_WORD *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12));
          *(_WORD *)(a3 + 12) = v5 + 2;
          goto LABEL_7;
        }
        uint64_t v8 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
      }
      else
      {
        uint64_t v8 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 160, v8);
    }
  }
  unsigned __int16 v6 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v6);
}

uint64_t sub_1001936F4(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 2u)
  {
LABEL_4:
    uint64_t v7 = 0;
    uint64_t v8 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    size_t v14 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_16;
  }
  if ((int)(v5 - v6) <= 1)
  {
    size_t v14 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 208, v14);
  }
  uint64_t v10 = *a3;
  uint64_t v11 = (unsigned __int8 *)(*a3 + v6);
  int v12 = *v11;
  int v13 = v11[1];
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 209, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v7 = v12 | (v13 << 8);
  *((_WORD *)a3 + 6) = v6 + 3;
  uint64_t v8 = *(unsigned __int8 *)(v10 + (unsigned __int16)(v6 + 2));
LABEL_7:

  return v3(a1, v7, v8);
}

uint64_t sub_10019381C(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, void), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 3u)
  {
LABEL_4:
    uint64_t v7 = 0;
    unsigned __int16 v8 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    size_t v14 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_16;
  }
  if (v5 - (int)v6 <= 1)
  {
    size_t v14 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 324, v14);
  }
  uint64_t v10 = *a3;
  uint64_t v11 = (unsigned __int8 *)(*a3 + v6);
  int v12 = *v11;
  int v13 = v11[1];
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 - (unsigned __int16)(v6 + 2) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 325, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v7 = v12 | (v13 << 8);
  unsigned __int16 v8 = *(_WORD *)(v10 + (unsigned __int16)(v6 + 2));
  *((_WORD *)a3 + 6) = v6 + 4;
LABEL_7:

  return v3(a1, v7, v8);
}

uint64_t sub_10019394C(uint64_t a1, uint64_t (*a2)(uint64_t, void, void, uint64_t, void), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 7u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    unsigned __int16 v8 = 0;
    uint64_t v9 = 0;
    unsigned __int16 v10 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_18;
  }
  if (v5 - (int)v6 <= 1)
  {
    uint64_t v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_18:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 372, v16);
  }
  uint64_t v12 = *a3;
  unsigned __int16 v7 = *(_WORD *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 - (unsigned __int16)(v6 + 2) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 373, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  unsigned __int16 v8 = *(_WORD *)(v12 + (unsigned __int16)(v6 + 2));
  *((_WORD *)a3 + 6) = v6 + 4;
  if (v5 - (unsigned __int16)(v6 + 4) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 374, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v13 = (unsigned __int8 *)(v12 + (unsigned __int16)(v6 + 4));
  int v14 = *v13;
  int v15 = v13[1];
  *((_WORD *)a3 + 6) = v6 + 6;
  if (v5 - (unsigned __int16)(v6 + 6) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 375, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v9 = v14 | (v15 << 8);
  unsigned __int16 v10 = *(_WORD *)(v12 + (unsigned __int16)(v6 + 6));
  *((_WORD *)a3 + 6) = v6 + 8;
LABEL_7:

  return v3(a1, v7, v8, v9, v10);
}

uint64_t sub_100193AF0(uint64_t a1, uint64_t (*a2)(uint64_t, long long *), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    int v5 = *(unsigned __int16 *)(a3 + 12);
    if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) > 1u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if (*(unsigned __int16 *)(a3 + 10) - v5 > 1)
        {
          int v8 = *(unsigned __int16 *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12));
          *(_WORD *)(a3 + 12) = v5 + 2;
          uint64_t v6 = sub_100197864(v8);
          int v3 = a2;
          goto LABEL_7;
        }
        uint64_t v9 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
      }
      else
      {
        uint64_t v9 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 181, v9);
    }
  }
  uint64_t v6 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v6);
}

uint64_t sub_100193BE8(unsigned int a1, uint64_t (*a2)(uint64_t, long long *, uint64_t), uint64_t *a3)
{
  unsigned __int16 v10 = 0;
  char v9 = 0;
  LODWORD(v4) = sub_100196B38(&v10, &v9, a3);
  if (a1) {
    uint64_t v4 = a1;
  }
  else {
    uint64_t v4 = v4;
  }
  int v5 = v10;
  uint64_t v6 = v9;

  return a2(v4, v5, v6);
}

uint64_t sub_100193C4C(unsigned int a1, uint64_t (*a2)(uint64_t, long long *, uint64_t), uint64_t *a3)
{
  unsigned __int16 v10 = 0;
  unsigned __int8 v9 = 0;
  LODWORD(v4) = sub_100196B38(&v10, &v9, a3);
  if (a1) {
    uint64_t v4 = a1;
  }
  else {
    uint64_t v4 = v4;
  }
  int v5 = v10;
  uint64_t v6 = v9;

  return a2(v4, v5, v6);
}

uint64_t sub_100193CB0(unsigned int a1, uint64_t (*a2)(uint64_t, long long *, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    unsigned int v10 = 605;
    goto LABEL_5;
  }
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(*((_WORD *)a3 + 5) - v6) < 3u) {
    goto LABEL_4;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v17 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_23;
  }
  if (*((unsigned __int16 *)a3 + 5) - (int)v6 <= 1)
  {
    uint64_t v17 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_23:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 245, v17);
  }
  int v13 = *(unsigned __int16 *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  unsigned __int16 v7 = sub_100197864(v13);
  if (v7)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    }
    else
    {
      unsigned int v14 = *((unsigned __int16 *)a3 + 5);
      uint64_t v15 = *((unsigned __int16 *)a3 + 6);
      if (v14 > v15)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v16 = *a3;
          *((_WORD *)a3 + 6) = v15 + 1;
          if (v14 <= (int)v15 + 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 251, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          unsigned int v10 = 0;
          uint64_t v8 = *(unsigned __int8 *)(v16 + v15);
          *((_WORD *)a3 + 6) = v15 + 2;
          uint64_t v9 = *(unsigned __int8 *)(v16 + v15 + 1);
          goto LABEL_20;
        }
        uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_27:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 250, v18);
      }
    }
    uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_27;
  }
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  unsigned int v10 = 601;
LABEL_20:
  int v3 = a2;
LABEL_5:
  if (a1) {
    uint64_t v11 = a1;
  }
  else {
    uint64_t v11 = v10;
  }

  return v3(v11, v7, v8, v9);
}

uint64_t sub_100193E6C(uint64_t a1, uint64_t (*a2)(uint64_t, long long *, void), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    int v6 = *(unsigned __int16 *)(a3 + 12);
    if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v6) > 3u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if (*(unsigned __int16 *)(a3 + 10) - v6 > 1)
        {
          int v10 = *(unsigned __int16 *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12));
          *(_WORD *)(a3 + 12) = v6 + 2;
          uint64_t v11 = sub_100197864(v10);
          if (*(unsigned char *)(a3 + 14) == 1)
          {
            int v3 = a2;
            if (*(unsigned char *)(a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
            }
            else
            {
              uint64_t v12 = *(unsigned __int16 *)(a3 + 12);
              if (*(unsigned __int16 *)(a3 + 10) - (int)v12 > 1)
              {
                uint64_t v8 = v11;
                unsigned __int16 v7 = *(_WORD *)(*(void *)a3 + v12);
                *(_WORD *)(a3 + 12) = v12 + 2;
                goto LABEL_7;
              }
            }
            unsigned int v14 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
          }
          else
          {
            unsigned int v14 = "(*pBs).__RWFlag == BYTESTREAM_READ";
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 348, v14);
        }
        int v13 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
      }
      else
      {
        int v13 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 346, v13);
    }
  }
  unsigned __int16 v7 = 0;
  uint64_t v8 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v8, v7);
}

uint64_t sub_100193FEC(uint64_t a1, uint64_t (*a2)(uint64_t, int *), uint64_t a3)
{
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    __int16 v12 = 0;
    int v11 = 0;
  }
  else
  {
    unsigned int v6 = *(unsigned __int16 *)(a3 + 12);
    int v7 = *(unsigned __int16 *)(a3 + 10) - v6;
    unsigned int v8 = (unsigned __int16)(*(_WORD *)(a3 + 10) - v6);
    __int16 v12 = 0;
    int v11 = 0;
    if (v8 > 5)
    {
      if (v7 <= 5)
      {
        int v10 = "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE";
      }
      else
      {
        if (*(unsigned char *)(a3 + 14) == 1)
        {
          sub_100008A18((uint64_t)&v11, *(void *)a3 + v6, 6uLL);
          *(_WORD *)(a3 + 12) += 6;
          return a2(a1, &v11);
        }
        int v10 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 402, v10);
    }
  }
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
  return a2(a1, &v11);
}

void sub_1001940EC(uint64_t a1, void (*a2)(uint64_t, void), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
LABEL_4:
    if (a1) {
      uint64_t v6 = a1;
    }
    else {
      uint64_t v6 = 605;
    }
    v3(v6, 0);
    return;
  }
  if ((unsigned __int16)(*(_WORD *)(a3 + 10) - *(_WORD *)(a3 + 12)) <= 0xF7u) {
    goto LABEL_4;
  }
  unsigned int v7 = *(unsigned __int8 *)(sub_10025B218(0x28u) + 6);
  if (v7 >= 0xF9) {
    sub_10025B8C0();
  }
  if (v7 >= 0xF8) {
    uint64_t v8 = 248;
  }
  else {
    uint64_t v8 = v7;
  }
  uint64_t v9 = (unsigned char *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12));
  if (v8)
  {
    uint64_t v10 = 0;
    while (v9[v10])
    {
      if (v8 == ++v10) {
        goto LABEL_24;
      }
    }
    LODWORD(v8) = v10;
LABEL_24:
    if (v8 < 0xF8)
    {
      __int16 v12 = 0;
    }
    else
    {
      int v11 = sub_10010CE48(0xF9uLL);
      if (v11)
      {
        __int16 v12 = v11;
        memmove(v11, v9, 0xF8uLL);
        uint64_t v9 = v12;
        LODWORD(v8) = 248;
      }
      else
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Malloc for local name failed, name truncated to 247 characters.", v13, v14, v15, v16, v17, v18, v19, v23);
          uint64_t v20 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
        __int16 v12 = 0;
        LODWORD(v8) = 247;
      }
    }
    uint64_t v21 = v8;
    if (v8 && (char)v9[v8] < 0)
    {
      while (v9[v8] <= 0xBFu)
      {
        BOOL v22 = __OFSUB__(v8, 1);
        LODWORD(v8) = v8 - 1;
        if (((int)v8 < 0) ^ v22 | (v8 == 0))
        {
          LODWORD(v8) = 0;
          break;
        }
      }
      uint64_t v21 = v8;
    }
    v9[v21] = 0;
    a2(a1, v9);
    if (v12) {
      sub_100023010(v12);
    }
  }
  else
  {
    *uint64_t v9 = 0;
    a2(a1, v9);
  }
}

uint64_t sub_1001942F8(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    int v5 = *(unsigned __int16 *)(a3 + 12);
    if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) > 2u)
    {
      if (*(unsigned __int16 *)(a3 + 10) - v5 <= 2)
      {
        uint64_t v8 = "ByteStream_NumReadBytesAvail(*pBs) >= 3";
      }
      else
      {
        if (*(unsigned char *)(a3 + 14) == 1)
        {
          uint64_t v6 = *(unsigned __int16 *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12)) | (*(unsigned __int8 *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12) + 2) << 16);
          *(_WORD *)(a3 + 12) = v5 + 3;
          goto LABEL_7;
        }
        uint64_t v8 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 462, v8);
    }
  }
  uint64_t v6 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v6);
}

void sub_1001943EC(uint64_t a1, void (*a2)(uint64_t, uint64_t, void *), uint64_t *a3)
{
  uint64_t v4 = a1;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    unsigned int v5 = 0;
    if (v4)
    {
LABEL_3:
      uint64_t v6 = 0;
LABEL_4:
      a2(v4, v6, 0);
      return;
    }
  }
  else
  {
    unsigned int v5 = (unsigned __int16)(*((_WORD *)a3 + 5) - *((_WORD *)a3 + 6));
    if (a1) {
      goto LABEL_3;
    }
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    goto LABEL_27;
  }
  uint64_t v7 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v7)
  {
LABEL_27:
    uint64_t v17 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_29;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v17 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_29:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 482, v17);
  }
  uint64_t v8 = *a3;
  *((_WORD *)a3 + 6) = v7 + 1;
  uint64_t v6 = *(unsigned __int8 *)(v8 + v7);
  uint64_t v9 = sub_100022FE8(4 * v6);
  if (!v9)
  {
    uint64_t v4 = 106;
    goto LABEL_4;
  }
  uint64_t v10 = v9;
  if (v5 >= 3 * (int)v6)
  {
    if (v6)
    {
      if (*((unsigned char *)a3 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_31:
        uint64_t v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 3";
      }
      else
      {
        int v12 = *((unsigned __int16 *)a3 + 5) - 2;
        unsigned __int16 v13 = *((_WORD *)a3 + 6);
        uint64_t v14 = v6;
        uint64_t v15 = (int *)v9;
        while (1)
        {
          if (v12 <= v13) {
            goto LABEL_31;
          }
          if (*((unsigned char *)a3 + 14) != 1) {
            break;
          }
          *v15++ = *(unsigned __int16 *)(*a3 + v13) | (*(unsigned __int8 *)(*a3 + v13 + 2) << 16);
          v13 += 3;
          *((_WORD *)a3 + 6) = v13;
          if (!--v14) {
            goto LABEL_21;
          }
        }
        uint64_t v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 498, v16);
    }
LABEL_21:
    uint64_t v11 = 0;
  }
  else
  {
    uint64_t v11 = 605;
  }
  a2(v11, v6, v10);

  sub_100023010(v10);
}

uint64_t sub_100194604(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t *), uint64_t *a3)
{
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    __int16 v11 = 0;
    uint64_t v10 = 0;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  __int16 v11 = 0;
  uint64_t v10 = 0;
  if ((unsigned __int16)(v5 - v6) <= 7u)
  {
LABEL_4:
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    return a2(a1, &v10);
  }
  if (v5 <= v6)
  {
    uint64_t v9 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_17;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v9 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_17:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 831, v9);
  }
  uint64_t v8 = *a3;
  *((_WORD *)a3 + 6) = v6 + 1;
  LOBYTE(v10) = *(unsigned char *)(v8 + v6);
  if ((int)(v5 - (unsigned __int16)(v6 + 1)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 832, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  WORD1(v10) = *(_WORD *)(v8 + v6 + 1);
  *((_WORD *)a3 + 6) = v6 + 3;
  if (v5 <= (unsigned __int16)(v6 + 3)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 833, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 4;
  BYTE4(v10) = *(unsigned char *)(v8 + (unsigned __int16)(v6 + 3));
  if ((int)(v5 - (unsigned __int16)(v6 + 4)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 834, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  HIWORD(v10) = *(_WORD *)(v8 + (unsigned __int16)(v6 + 4));
  *((_WORD *)a3 + 6) = v6 + 6;
  if ((int)(v5 - (unsigned __int16)(v6 + 6)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 835, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  __int16 v11 = *(_WORD *)(v8 + (unsigned __int16)(v6 + 6));
  *((_WORD *)a3 + 6) = v6 + 8;
  return a2(a1, &v10);
}

uint64_t sub_1001947C4(uint64_t a1, uint64_t (*a2)(uint64_t, long long *), uint64_t a3)
{
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    goto LABEL_4;
  }
  uint64_t v5 = *(unsigned __int16 *)(a3 + 12);
  if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) <= 0x3Fu)
  {
LABEL_4:
    uint64_t v6 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    return a2(a1, v6);
  }
  uint64_t v6 = (long long *)(*(void *)a3 + v5);
  long long v8 = *v6;
  long long v9 = v6[1];
  long long v10 = v6[3];
  xmmword_100A19670 = v6[2];
  xmmword_100A19680 = v10;
  xmmword_100A19650 = v8;
  *(_OWORD *)&byte_100A19660 = v9;
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"command supported mask is: %@", v11, v12, v13, v14, v15, v16, v17, (uint64_t)&xmmword_100A19650);
    uint64_t v18 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v20 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  BYTE14(xmmword_100A19650) |= 0x10u;
  return a2(a1, v6);
}

uint64_t sub_100194928(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t *), uint64_t a3)
{
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    uint64_t v9 = 0;
  }
  else
  {
    uint64_t v5 = *(unsigned __int16 *)(a3 + 10);
    uint64_t v6 = *(unsigned __int16 *)(a3 + 12);
    uint64_t v9 = 0;
    if ((unsigned __int16)(v5 - v6) > 7u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if ((unint64_t)(v5 - v6) > 7)
        {
          uint64_t v9 = *(void *)(*(void *)a3 + v6);
          *(_WORD *)(a3 + 12) = v6 + 8;
          return a2(a1, &v9);
        }
        long long v8 = "ByteStream_NumReadBytesAvail((*pBs)) >= (sizeof(lmpFeatures))";
      }
      else
      {
        long long v8 = "((*pBs)).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 626, v8);
    }
  }
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
  return a2(a1, &v9);
}

uint64_t sub_100194A38(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t, uint64_t *), uint64_t *a3)
{
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    uint64_t v12 = 0;
    goto LABEL_4;
  }
  uint64_t v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  uint64_t v12 = 0;
  if ((unsigned __int16)(v5 - v6) <= 9u)
  {
LABEL_4:
    uint64_t v7 = 0;
    uint64_t v8 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    return a2(a1, v7, v8, &v12);
  }
  if (v5 <= v6)
  {
    uint64_t v11 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_15;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v11 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_15:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 653, v11);
  }
  uint64_t v10 = *a3;
  *((_WORD *)a3 + 6) = v6 + 1;
  if (v5 <= (unsigned __int16)(v6 + 1)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 654, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v7 = *(unsigned __int8 *)(v10 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if ((unint64_t)(v5 - (v6 + 2)) <= 7) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 655, "ByteStream_NumReadBytesAvail((*pBs)) >= (sizeof(lmpFeatures))");
  }
  uint64_t v8 = *(unsigned __int8 *)(v10 + v6 + 1);
  uint64_t v12 = *(void *)(v10 + v6 + 2);
  *((_WORD *)a3 + 6) = v6 + 10;
  return a2(a1, v7, v8, &v12);
}

uint64_t sub_100194BAC(uint64_t a1, uint64_t (*a2)(uint64_t, void, uint64_t, uint64_t, void), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 6u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    unsigned __int16 v10 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_18;
  }
  if ((int)(v5 - v6) <= 1)
  {
    uint64_t v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_18:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 430, v16);
  }
  uint64_t v12 = *a3;
  unsigned __int16 v7 = *(_WORD *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 431, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 3;
  if ((int)(v5 - (unsigned __int16)(v6 + 3)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 432, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v8 = *(unsigned __int8 *)(v12 + (unsigned __int16)(v6 + 2));
  uint64_t v13 = (unsigned __int8 *)(v12 + (unsigned __int16)(v6 + 3));
  int v14 = *v13;
  int v15 = v13[1];
  *((_WORD *)a3 + 6) = v6 + 5;
  if ((int)(v5 - (unsigned __int16)(v6 + 5)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 433, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v9 = v14 | (v15 << 8);
  unsigned __int16 v10 = *(_WORD *)(v12 + (unsigned __int16)(v6 + 5));
  *((_WORD *)a3 + 6) = v6 + 7;
LABEL_7:

  return v3(a1, v7, v8, v9, v10);
}

uint64_t sub_100194D4C(uint64_t a1, uint64_t (*a2)(uint64_t, long long *, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 0xCu)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v17 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_16;
  }
  if ((int)(v5 - v6) <= 1)
  {
    uint64_t v17 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 710, v17);
  }
  uint64_t v11 = *a3;
  uint64_t v12 = (unsigned __int8 *)(*a3 + v6);
  int v13 = *v12;
  int v14 = v12[1];
  unsigned __int16 v15 = v6 + 2;
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 711, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  unsigned __int16 v16 = v6 + 3;
  *((_WORD *)a3 + 6) = v16;
  uint64_t v8 = *(unsigned __int8 *)(v11 + v15);
  uint64_t v9 = v11 + v16;
  unsigned __int16 v7 = sub_100197864(v13 | (v14 << 8));
  int v3 = a2;
LABEL_7:

  return v3(a1, v7, v8, v9);
}

uint64_t sub_100194E9C(uint64_t a1, uint64_t (*a2)(uint64_t, long long *, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 6u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v13 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_17;
  }
  if ((int)(v5 - v6) <= 1)
  {
    int v13 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_17:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 803, v13);
  }
  uint64_t v11 = *a3;
  unsigned __int16 v12 = *(_WORD *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 804, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 3;
  if ((int)(v5 - (unsigned __int16)(v6 + 3)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 805, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  uint64_t v8 = *(unsigned __int8 *)(v11 + (unsigned __int16)(v6 + 2));
  uint64_t v9 = *(unsigned int *)(v11 + (unsigned __int16)(v6 + 3));
  *((_WORD *)a3 + 6) = v6 + 7;
  unsigned __int16 v7 = sub_100197864(v12);
  int v3 = a2;
LABEL_7:

  return v3(a1, v7, v8, v9);
}

uint64_t sub_100195014(uint64_t a1, uint64_t (*a2)(uint64_t, long long *, uint64_t, void), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 7u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    unsigned __int16 v9 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v13 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_17;
  }
  if (v5 - (int)v6 <= 1)
  {
    int v13 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_17:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 741, v13);
  }
  uint64_t v11 = *a3;
  unsigned __int16 v12 = *(_WORD *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 - (unsigned __int16)(v6 + 2) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 742, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  uint64_t v8 = *(unsigned int *)(v11 + (unsigned __int16)(v6 + 2));
  *((_WORD *)a3 + 6) = v6 + 6;
  if (v5 - (unsigned __int16)(v6 + 6) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 743, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  unsigned __int16 v9 = *(_WORD *)(v11 + (unsigned __int16)(v6 + 6));
  *((_WORD *)a3 + 6) = v6 + 8;
  unsigned __int16 v7 = sub_100197864(v12);
  int v3 = a2;
LABEL_7:

  return v3(a1, v7, v8, v9);
}

uint64_t sub_100195190(uint64_t a1, uint64_t (*a2)(uint64_t, long long *, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 2u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v14 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_16;
  }
  if ((int)(v5 - v6) <= 1)
  {
    int v14 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 772, v14);
  }
  uint64_t v10 = *a3;
  uint64_t v11 = (unsigned __int8 *)(*a3 + v6);
  int v12 = *v11;
  int v13 = v11[1];
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 773, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 3;
  uint64_t v8 = *(unsigned __int8 *)(v10 + (unsigned __int16)(v6 + 2));
  unsigned __int16 v7 = sub_100197864(v12 | (v13 << 8));
  int v3 = a2;
LABEL_7:

  return v3(a1, v7, v8);
}

uint64_t sub_1001952CC(uint64_t a1, uint64_t (*a2)(uint64_t, void), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    unsigned int v5 = *((unsigned __int16 *)a3 + 5);
    uint64_t v6 = *((unsigned __int16 *)a3 + 6);
    if (v5 != v6)
    {
      if (v5 > v6)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v9 = *a3;
          *((_WORD *)a3 + 6) = v6 + 1;
          char v7 = *(unsigned char *)(v9 + v6);
          goto LABEL_7;
        }
        uint64_t v10 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      else
      {
        uint64_t v10 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 860, v10);
    }
  }
  char v7 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v7);
}

uint64_t sub_1001953AC(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    unsigned int v5 = *((unsigned __int16 *)a3 + 5);
    uint64_t v6 = *((unsigned __int16 *)a3 + 6);
    if ((unsigned __int16)(v5 - v6) > 0x1Fu)
    {
      if (v5 <= v6)
      {
        uint64_t v11 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
      }
      else
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v10 = *a3;
          *((_WORD *)a3 + 6) = v6 + 1;
          uint64_t v7 = *(unsigned __int8 *)(v10 + v6);
          uint64_t v8 = v10 + (unsigned __int16)(v6 + 1);
          goto LABEL_7;
        }
        uint64_t v11 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 886, v11);
    }
  }
  uint64_t v7 = 0;
  uint64_t v8 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v7, v8);
}

uint64_t sub_10019549C(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  uint64_t v5 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(*((_WORD *)a3 + 5) - v5) <= 0x1Fu)
  {
LABEL_4:
    uint64_t v6 = 0;
    uint64_t v7 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned __int16 *)a3 + 5) - (int)v5 <= 15) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 914, "ByteStream_NumReadBytesAvail(*pBs) >= (16)");
  }
  uint64_t v9 = *a3;
  uint64_t v6 = *a3 + v5;
  unsigned __int16 v10 = v5 + 16;
  *((_WORD *)a3 + 6) = v10;
  uint64_t v7 = v9 + v10;
LABEL_7:

  return v3(a1, v6, v7);
}

uint64_t sub_10019556C(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 0x3Fu)
  {
LABEL_4:
    uint64_t v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    uint64_t v10 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (v5 - (int)v6 <= 15) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 945, "ByteStream_NumReadBytesAvail(*pBs) >= (16)");
  }
  uint64_t v12 = *a3;
  *((_WORD *)a3 + 6) = v6 + 16;
  if (v5 - (unsigned __int16)(v6 + 16) <= 15) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 947, "ByteStream_NumReadBytesAvail(*pBs) >= (16)");
  }
  *((_WORD *)a3 + 6) = v6 + 32;
  if (v5 - (unsigned __int16)(v6 + 32) <= 15) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 949, "ByteStream_NumReadBytesAvail(*pBs) >= (16)");
  }
  uint64_t v7 = v12 + v6;
  uint64_t v8 = v12 + (unsigned __int16)(v6 + 16);
  uint64_t v9 = v12 + (unsigned __int16)(v6 + 32);
  unsigned __int16 v13 = v6 + 48;
  *((_WORD *)a3 + 6) = v13;
  uint64_t v10 = v12 + v13;
LABEL_7:

  return v3(a1, v7, v8, v9, v10);
}

uint64_t sub_1001956A8(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 2u)
  {
LABEL_4:
    uint64_t v7 = 0;
    uint64_t v8 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v14 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_16;
  }
  if ((int)(v5 - v6) <= 1)
  {
    int v14 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1015, v14);
  }
  uint64_t v10 = *a3;
  uint64_t v11 = (unsigned __int8 *)(*a3 + v6);
  int v12 = *v11;
  int v13 = v11[1];
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1016, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v7 = v12 | (v13 << 8);
  *((_WORD *)a3 + 6) = v6 + 3;
  uint64_t v8 = *(unsigned __int8 *)(v10 + (unsigned __int16)(v6 + 2));
LABEL_7:

  return v3(a1, v7, v8);
}

uint64_t sub_1001957D0(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t *), uint64_t a3)
{
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    uint64_t v9 = 0;
  }
  else
  {
    uint64_t v5 = *(unsigned __int16 *)(a3 + 10);
    uint64_t v6 = *(unsigned __int16 *)(a3 + 12);
    uint64_t v9 = 0;
    if ((unsigned __int16)(v5 - v6) > 7u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if ((unint64_t)(v5 - v6) > 7)
        {
          uint64_t v9 = *(void *)(*(void *)a3 + v6);
          *(_WORD *)(a3 + 12) = v6 + 8;
          return a2(a1, &v9);
        }
        uint64_t v8 = "ByteStream_NumReadBytesAvail((*pBs)) >= (sizeof(lmpFeatures))";
      }
      else
      {
        uint64_t v8 = "((*pBs)).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 681, v8);
    }
  }
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
  return a2(a1, &v9);
}

uint64_t sub_1001958E0(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 6u)
  {
LABEL_4:
    uint64_t v7 = 0;
    uint64_t v8 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v14 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_16;
  }
  if (v5 - (int)v6 <= 1)
  {
    int v14 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1037, v14);
  }
  uint64_t v10 = *a3;
  uint64_t v11 = (unsigned __int8 *)(*a3 + v6);
  int v12 = *v11;
  int v13 = v11[1];
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 - (unsigned __int16)(v6 + 2) <= 4) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1039, "ByteStream_NumReadBytesAvail(*pBs) >= (5)");
  }
  uint64_t v8 = v10 + (unsigned __int16)(v6 + 2);
  uint64_t v7 = v12 | (v13 << 8);
  *((_WORD *)a3 + 6) = v6 + 7;
LABEL_7:

  return v3(a1, v7, v8);
}

uint64_t sub_100195A0C(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  uint64_t v5 = *(unsigned __int16 *)(a3 + 12);
  if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) <= 0xFu)
  {
LABEL_4:
    uint64_t v6 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*(unsigned __int16 *)(a3 + 10) - (int)v5 <= 15) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 993, "ByteStream_NumReadBytesAvail(*pBs) >= ((16))");
  }
  uint64_t v6 = *(void *)a3 + v5;
  *(_WORD *)(a3 + 12) = v5 + 16;
LABEL_7:

  return v3(a1, v6);
}

uint64_t sub_100195AD4(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  uint64_t v5 = *(unsigned __int16 *)(a3 + 12);
  if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) <= 7u)
  {
LABEL_4:
    uint64_t v6 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*(unsigned __int16 *)(a3 + 10) - (int)v5 <= 7) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 971, "ByteStream_NumReadBytesAvail(*pBs) >= ((8))");
  }
  uint64_t v6 = *(void *)a3 + v5;
  *(_WORD *)(a3 + 12) = v5 + 8;
LABEL_7:

  return v3(a1, v6);
}

uint64_t sub_100195B9C(uint64_t a1, uint64_t (*a2)(uint64_t, void, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 3u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v12 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_17;
  }
  if ((int)(v5 - v6) <= 1)
  {
    int v12 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_17:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1061, v12);
  }
  uint64_t v11 = *a3;
  unsigned __int16 v7 = *(_WORD *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1062, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 3;
  if (v5 <= (unsigned __int16)(v6 + 3)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1063, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v8 = *(unsigned __int8 *)(v11 + (unsigned __int16)(v6 + 2));
  *((_WORD *)a3 + 6) = v6 + 4;
  uint64_t v9 = *(unsigned __int8 *)(v11 + (unsigned __int16)(v6 + 3));
LABEL_7:

  return v3(a1, v7, v8, v9);
}

void sub_100195CF4(unsigned int a1, void (*a2)(uint64_t, uint64_t, uint64_t, void *), uint64_t *a3)
{
  LODWORD(v5) = a1;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    if (v5) {
      uint64_t v5 = v5;
    }
    else {
      uint64_t v5 = 605;
    }
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
      goto LABEL_35;
    }
    unint64_t v6 = 0;
  }
  else
  {
    if (a1) {
      BOOL v7 = 1;
    }
    else {
      BOOL v7 = (unsigned __int16)(*((_WORD *)a3 + 5) - *((_WORD *)a3 + 6)) >= 2u;
    }
    if (v7) {
      uint64_t v5 = a1;
    }
    else {
      uint64_t v5 = 605;
    }
    unint64_t v6 = (unsigned __int16)(*((_WORD *)a3 + 5) - *((_WORD *)a3 + 6));
  }
  unsigned int v8 = *((unsigned __int16 *)a3 + 5);
  uint64_t v9 = *((unsigned __int16 *)a3 + 6);
  if (v8 <= v9)
  {
LABEL_35:
    uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_36:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1084, v18);
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_36;
  }
  uint64_t v10 = *a3;
  *((_WORD *)a3 + 6) = v9 + 1;
  if (v8 <= (int)v9 + 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1085, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v11 = *(unsigned __int8 *)(v10 + v9);
  *((_WORD *)a3 + 6) = v9 + 2;
  uint64_t v12 = *(unsigned __int8 *)(v10 + v9 + 1);
  unint64_t v13 = 2 * v12;
  int v14 = sub_10010CE48(2 * v12);
  if (2 * v12 + 2 <= v6)
  {
    if (*((unsigned char *)a3 + 14) == 1)
    {
      uint64_t v15 = *a3;
      uint64_t v16 = *((unsigned __int16 *)a3 + 6);
      if (*((unsigned char *)a3 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
        unint64_t v17 = 0;
      }
      else
      {
        unint64_t v17 = *((unsigned __int16 *)a3 + 5) - v16;
      }
      if (v17 >= v13)
      {
        memmove(v14, (const void *)(v15 + v16), 2 * v12);
        *((_WORD *)a3 + 6) += v13;
        goto LABEL_27;
      }
      uint64_t v19 = "ByteStream_NumReadBytesAvail(*pBs) >= (sizeof(uint16_t) * param2)";
    }
    else
    {
      uint64_t v19 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1094, v19);
  }
  if (v5) {
    uint64_t v5 = v5;
  }
  else {
    uint64_t v5 = 605;
  }
LABEL_27:
  a2(v5, v11, v12, v14);
  if (v14)
  {
    sub_100023010(v14);
  }
}

uint64_t sub_100195F40(uint64_t a1, uint64_t (*a2)(uint64_t, void, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
    goto LABEL_4;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(v5 - v6) <= 5u)
  {
LABEL_4:
    unsigned __int16 v7 = 0;
    uint64_t v8 = 0;
    uint64_t v9 = 0;
    uint64_t v10 = 0;
    if (a1) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
    goto LABEL_7;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_18;
  }
  if ((int)(v5 - v6) <= 1)
  {
    uint64_t v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_18:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1122, v16);
  }
  uint64_t v12 = *a3;
  unsigned __int16 v7 = *(_WORD *)(*a3 + v6);
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1123, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 3;
  if ((int)(v5 - (unsigned __int16)(v6 + 3)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1124, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v8 = *(unsigned __int8 *)(v12 + (unsigned __int16)(v6 + 2));
  unint64_t v13 = (unsigned __int8 *)(v12 + (unsigned __int16)(v6 + 3));
  int v14 = *v13;
  int v15 = v13[1];
  *((_WORD *)a3 + 6) = v6 + 5;
  if (v5 <= (unsigned __int16)(v6 + 5)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1125, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v9 = v14 | (v15 << 8);
  *((_WORD *)a3 + 6) = v6 + 6;
  uint64_t v10 = *(unsigned __int8 *)(v12 + (unsigned __int16)(v6 + 5));
LABEL_7:

  return v3(a1, v7, v8, v9, v10);
}

uint64_t sub_1001960D8(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  int v3 = a2;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    unsigned int v5 = *((unsigned __int16 *)a3 + 5);
    uint64_t v6 = *((unsigned __int16 *)a3 + 6);
    if (v5 != v6)
    {
      if (v5 > v6)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v9 = *a3;
          *((_WORD *)a3 + 6) = v6 + 1;
          uint64_t v7 = *(unsigned __int8 *)(v9 + v6);
          goto LABEL_7;
        }
        uint64_t v10 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      else
      {
        uint64_t v10 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1145, v10);
    }
  }
  uint64_t v7 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v7);
}

uint64_t sub_1001961B4(uint64_t a1, uint64_t (*a2)(uint64_t, void), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    int v5 = *(unsigned __int16 *)(a3 + 12);
    if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) > 1u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if (*(unsigned __int16 *)(a3 + 10) - v5 > 1)
        {
          unsigned __int16 v6 = *(_WORD *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12));
          *(_WORD *)(a3 + 12) = v5 + 2;
          goto LABEL_7;
        }
        uint64_t v8 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
      }
      else
      {
        uint64_t v8 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1165, v8);
    }
  }
  unsigned __int16 v6 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v6);
}

uint64_t sub_1001962A0(uint64_t a1, uint64_t (*a2)(uint64_t, void), uint64_t a3)
{
  int v3 = a2;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    int v3 = a2;
  }
  else
  {
    int v5 = *(unsigned __int16 *)(a3 + 12);
    if ((unsigned __int16)(*(_WORD *)(a3 + 10) - v5) > 1u)
    {
      if (*(unsigned char *)(a3 + 14) == 1)
      {
        if (*(unsigned __int16 *)(a3 + 10) - v5 > 1)
        {
          unsigned __int16 v6 = *(_WORD *)(*(void *)a3 + *(unsigned __int16 *)(a3 + 12));
          *(_WORD *)(a3 + 12) = v5 + 2;
          goto LABEL_7;
        }
        uint64_t v8 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
      }
      else
      {
        uint64_t v8 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1185, v8);
    }
  }
  unsigned __int16 v6 = 0;
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:

  return v3(a1, v6);
}

uint64_t sub_10019638C(uint64_t a1, uint64_t (*a2)(uint64_t, void, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
  }
  else if ((unsigned __int16)(*((_WORD *)a3 + 5) - *((_WORD *)a3 + 6)) > 4u)
  {
    goto LABEL_7;
  }
  if (a1) {
    a1 = a1;
  }
  else {
    a1 = 605;
  }
LABEL_7:
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v15 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_19;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    goto LABEL_18;
  }
  unsigned int v5 = *((unsigned __int16 *)a3 + 5);
  uint64_t v6 = *((unsigned __int16 *)a3 + 6);
  if ((int)(v5 - v6) <= 1)
  {
LABEL_18:
    int v15 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_19:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1206, v15);
  }
  uint64_t v7 = *a3;
  uint64_t v8 = (unsigned __int8 *)(*a3 + v6);
  int v9 = *v8;
  int v10 = v8[1];
  *((_WORD *)a3 + 6) = v6 + 2;
  if (v5 <= (unsigned __int16)(v6 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1207, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v6 + 3;
  if (v5 <= (unsigned __int16)(v6 + 3)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1208, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v11 = *(unsigned __int8 *)(v7 + (unsigned __int16)(v6 + 2));
  *((_WORD *)a3 + 6) = v6 + 4;
  if (v5 <= (unsigned __int16)(v6 + 4)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1209, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v12 = *(unsigned __int8 *)(v7 + (unsigned __int16)(v6 + 3));
  *((_WORD *)a3 + 6) = v6 + 5;
  uint64_t v13 = *(unsigned __int8 *)(v7 + (unsigned __int16)(v6 + 4));

  return a2(a1, v9 | (v10 << 8), v11, v12, v13);
}

uint64_t sub_100196534(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, void, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, int, uint64_t), uint64_t *a3)
{
  unsigned int v5 = a1;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    if (v5) {
      a1 = v5;
    }
    else {
      a1 = 605;
    }
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_32:
      uint64_t v34 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
      goto LABEL_34;
    }
  }
  else
  {
    if (a1) {
      BOOL v6 = 1;
    }
    else {
      BOOL v6 = (unsigned __int16)(*((_WORD *)a3 + 5) - *((_WORD *)a3 + 6)) >= 0x16u;
    }
    if (v6) {
      a1 = a1;
    }
    else {
      a1 = 605;
    }
  }
  unsigned int v7 = *((unsigned __int16 *)a3 + 5);
  uint64_t v8 = *((unsigned __int16 *)a3 + 6);
  if (v7 <= v8) {
    goto LABEL_32;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v34 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_34:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1245, v34);
  }
  uint64_t v9 = *a3;
  uint64_t v10 = v8 + 1;
  *((_WORD *)a3 + 6) = v8 + 1;
  if ((int)(v7 - (v8 + 1)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1246, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v11 = *(unsigned __int8 *)(v9 + v8);
  uint64_t v12 = v9 + v10;
  int v13 = *(unsigned __int8 *)(v9 + v10);
  int v14 = *(unsigned __int8 *)(v12 + 1);
  *((_WORD *)a3 + 6) = v8 + 3;
  if (v7 <= (unsigned __int16)(v8 + 3)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1247, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v8 + 4;
  if (v7 <= (unsigned __int16)(v8 + 4)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1248, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v15 = *(unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 3));
  *((_WORD *)a3 + 6) = v8 + 5;
  if (v7 <= (unsigned __int16)(v8 + 5)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1249, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v16 = *(unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 4));
  *((_WORD *)a3 + 6) = v8 + 6;
  if (v7 <= (unsigned __int16)(v8 + 6)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1250, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v17 = *(unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 5));
  *((_WORD *)a3 + 6) = v8 + 7;
  if (v7 <= (unsigned __int16)(v8 + 7)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1251, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v18 = *(unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 6));
  *((_WORD *)a3 + 6) = v8 + 8;
  if (v7 <= (unsigned __int16)(v8 + 8)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1252, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v19 = *(unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 7));
  *((_WORD *)a3 + 6) = v8 + 9;
  if (v7 <= (unsigned __int16)(v8 + 9)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1253, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  char v20 = *(unsigned char *)(v9 + (unsigned __int16)(v8 + 8));
  *((_WORD *)a3 + 6) = v8 + 10;
  if (v7 <= (unsigned __int16)(v8 + 10)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1254, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  char v21 = *(unsigned char *)(v9 + (unsigned __int16)(v8 + 9));
  *((_WORD *)a3 + 6) = v8 + 11;
  if ((int)(v7 - (unsigned __int16)(v8 + 11)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1255, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  char v22 = *(unsigned char *)(v9 + (unsigned __int16)(v8 + 10));
  *((_WORD *)a3 + 6) = v8 + 13;
  if ((int)(v7 - (unsigned __int16)(v8 + 13)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1256, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  *((_WORD *)a3 + 6) = v8 + 15;
  if ((int)(v7 - (unsigned __int16)(v8 + 15)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1257, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v23 = (unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 15));
  __int16 v24 = *v23;
  __int16 v25 = v23[1];
  *((_WORD *)a3 + 6) = v8 + 17;
  if ((int)(v7 - (unsigned __int16)(v8 + 17)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1258, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v26 = (unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 17));
  __int16 v27 = *v26;
  __int16 v28 = v26[1];
  *((_WORD *)a3 + 6) = v8 + 19;
  if ((int)(v7 - (unsigned __int16)(v8 + 19)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1259, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v29 = (unsigned __int8 *)(v9 + (unsigned __int16)(v8 + 19));
  __int16 v30 = *v29;
  __int16 v31 = v29[1];
  *((_WORD *)a3 + 6) = v8 + 21;
  if (v7 <= (unsigned __int16)(v8 + 21)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1260, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v8 + 22;
  if (v7 <= (unsigned __int16)(v8 + 22)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1261, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  char v32 = *(unsigned char *)(v9 + (unsigned __int16)(v8 + 21));
  *((_WORD *)a3 + 6) = v8 + 23;
  HIBYTE(v36) = *(unsigned char *)(v9 + (unsigned __int16)(v8 + 22));
  BYTE6(v36) = v32;
  WORD2(v36) = v30 | (v31 << 8);
  WORD1(v36) = v27 | (v28 << 8);
  LOWORD(v36) = v24 | (v25 << 8);
  BYTE2(v35) = v22;
  BYTE1(v35) = v21;
  LOBYTE(v35) = v20;
  return a2(a1, v11, v13 | (v14 << 8), v15, v16, v17, v18, v19, v35, v36);
}

uint64_t sub_1001969C0(uint64_t a1, uint64_t (*a2)(uint64_t, long long *), uint64_t *a3)
{
  unsigned int v5 = a1;
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    uint64_t v20 = 0;
    long long v18 = 0u;
    long long v19 = 0u;
    long long v16 = 0u;
    long long v17 = 0u;
    if (v5) {
      a1 = v5;
    }
    else {
      a1 = 605;
    }
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
LABEL_7:
      BOOL v6 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_22:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 1282, v6);
    }
  }
  else
  {
    unsigned int v7 = (unsigned __int16)(*((_WORD *)a3 + 5) - *((_WORD *)a3 + 6));
    uint64_t v20 = 0;
    long long v18 = 0u;
    long long v19 = 0u;
    long long v16 = 0u;
    long long v17 = 0u;
    if (a1) {
      unsigned int v8 = a1;
    }
    else {
      unsigned int v8 = 605;
    }
    if (v7 <= 0x48) {
      a1 = v8;
    }
    else {
      a1 = a1;
    }
  }
  uint64_t v9 = 0;
  unsigned int v10 = *((unsigned __int16 *)a3 + 5);
  uint64_t v11 = *((unsigned __int16 *)a3 + 6);
  BOOL v12 = v10 >= v11;
  LODWORD(v13) = v10 - v11;
  if (v12) {
    uint64_t v13 = v13;
  }
  else {
    uint64_t v13 = 0;
  }
  do
  {
    if (v13 == v9) {
      goto LABEL_7;
    }
    if (*((unsigned char *)a3 + 14) != 1)
    {
      BOOL v6 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      goto LABEL_22;
    }
    uint64_t v14 = *a3;
    *((_WORD *)a3 + 6) = v11 + v9 + 1;
    *((unsigned char *)&v16 + v9) = *(unsigned char *)(v11 + v9 + v14);
    ++v9;
  }
  while (v9 != 72);
  return a2(a1, &v16);
}

uint64_t sub_100196B38(long long **a1, unsigned char *a2, uint64_t *a3)
{
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    return 605;
  }
  int v4 = *((unsigned __int16 *)a3 + 6);
  if ((unsigned __int16)(*((_WORD *)a3 + 5) - v4) < 3u) {
    return 605;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    BOOL v12 = "(*pBs).__RWFlag == BYTESTREAM_READ";
    goto LABEL_15;
  }
  if (*((unsigned __int16 *)a3 + 5) - v4 <= 1)
  {
    BOOL v12 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_15:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 224, v12);
  }
  int v8 = *(unsigned __int16 *)(*a3 + *((unsigned __int16 *)a3 + 6));
  *((_WORD *)a3 + 6) = v4 + 2;
  uint64_t v9 = sub_100197864(v8);
  *a1 = v9;
  if (v9)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c");
    }
    else
    {
      uint64_t v10 = *((unsigned __int16 *)a3 + 6);
      if (*((unsigned __int16 *)a3 + 5) > v10)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t result = 0;
          uint64_t v11 = *a3;
          *((_WORD *)a3 + 6) = v10 + 1;
          *a2 = *(unsigned char *)(v11 + v10);
          return result;
        }
        uint64_t v13 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcicmdapi.c", 229, v13);
      }
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_19;
  }
  return 601;
}

uint64_t sub_100196C90(uint64_t a1)
{
  if (!a1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 47, "pool");
  }
  pthread_mutex_lock((pthread_mutex_t *)a1);
  sub_10025B778("_block_size: %u", *(void *)(a1 + 120));
  sub_10025B778("_num_blocks_total: %u", *(_DWORD *)(a1 + 128));
  sub_10025B778("_num_blocks_free: %u", *(_DWORD *)(a1 + 132));
  sub_10025B778("_num_blocks_allocated: %u", *(_DWORD *)(a1 + 136));
  sub_10025B778("_node_pool: %p", *(const void **)(a1 + 176));
  sub_10025B778("_start_addr: %p", *(const void **)(a1 + 184));
  sub_10025B778("_end_addr: %p", *(const void **)(a1 + 192));
  if (*(void *)(a1 + 160))
  {
    sub_10025B778("[START] FREE LIST");
    for (uint64_t i = *(void *)(a1 + 160); i; uint64_t i = *(void *)(i + 8))
      sub_10025B778("%p", *(const void **)i);
    sub_10025B778("[END] FREE LIST");
  }
  else
  {
    sub_10025B778("Free List Empty");
  }
  if (*(void *)(a1 + 144))
  {
    sub_10025B778("[START] ALLOCATED LIST");
    for (uint64_t j = *(void *)(a1 + 144); j; uint64_t j = *(void *)(j + 8))
      sub_10025B778("%p", *(const void **)j);
    sub_10025B778("[END] ALLOCATED LIST");
  }
  else
  {
    sub_10025B778("Allocated List Empty");
  }

  return pthread_mutex_unlock((pthread_mutex_t *)a1);
}

void sub_100196E48(pthread_mutex_t *a1)
{
  if (!a1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 64, "pool");
  }
  if (*(void *)&a1[2].__opaque[8]) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 67, "STAILQ_EMPTY(&pool->_allocated_list)");
  }
  pthread_mutex_destroy(a1);
  pthread_cond_destroy((pthread_cond_t *)&a1[1]);
  int v2 = *(void **)&a1[2].__opaque[40];
  if (v2)
  {
    free(v2);
    *(void *)&a1[2].__opaque[40] = 0;
  }
  int v3 = *(void **)&a1[2].__opaque[48];
  if (v3) {
    free(v3);
  }

  free(a1);
}

pthread_mutex_t *sub_100196EE4(unsigned int a1, size_t a2)
{
  if (!a1 || !a2)
  {
    sub_10025B778("invalid input parameters, num_blocks_total: %u, block_size: %u", a1, a2);
    return 0;
  }
  int v4 = (pthread_mutex_t *)malloc_type_calloc(1uLL, 0xC8uLL, 0x10A004052A8F8F9uLL);
  unsigned int v5 = v4;
  if (!v4)
  {
    sub_10025B778("failed to allocate memory for pool struct");
    return v5;
  }
  pthread_mutex_init(v4, 0);
  pthread_cond_init((pthread_cond_t *)&v5[1], 0);
  *(void *)&v5[2].__opaque[8] = 0;
  *(_DWORD *)&v5[1].__opaque[40] = 0;
  *(void *)&v5[1].__opaque[48] = a2;
  LODWORD(v5[2].__sig) = a1;
  HIDWORD(v5[2].__sig) = a1;
  *(_DWORD *)v5[2].__opaque = 0;
  *(void *)&v5[2].__opaque[16] = (char *)v5 + 144;
  *(void *)&v5[2].__opaque[24] = 0;
  *(void *)&v5[2].__opaque[32] = (char *)v5 + 160;
  BOOL v6 = (char *)malloc_type_calloc(a1, a2, 0x4B9514E2uLL);
  *(void *)&v5[2].__opaque[48] = v6;
  if (!v6)
  {
    sub_10025B778("failed to allocate memory for pool");
LABEL_13:
    sub_100196E48(v5);
    return 0;
  }
  size_t sig_low = LODWORD(v5[2].__sig);
  v5[3].__sig = (uint64_t)&v6[*(void *)&v5[1].__opaque[48] * sig_low];
  int v8 = malloc_type_calloc(sig_low, 0x10uLL, 0xA0040BD48D6D6uLL);
  *(void *)&v5[2].__opaque[40] = v8;
  if (!v8)
  {
    sub_10025B778("failed to allocate memory for mem_addr_node_pool");
    goto LABEL_13;
  }
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t v12 = *(void *)&v5[1].__opaque[48];
  uint64_t v13 = *(void **)&v5[2].__opaque[32];
  do
  {
    uint64_t v14 = *(void *)&v5[2].__opaque[40];
    uint64_t v15 = (void *)(v14 + v10);
    *uint64_t v15 = *(void *)&v5[2].__opaque[48] + v9;
    v15[1] = 0;
    *uint64_t v13 = v14 + v10;
    uint64_t v13 = (void *)(v14 + 16 * v11 + 8);
    *(void *)&v5[2].__opaque[32] = v14 + v10 + 8;
    ++v11;
    v10 += 16;
    v9 += v12;
  }
  while (16 * a1 != v10);
  return v5;
}

uint64_t sub_10019707C(uint64_t a1)
{
  if (!a1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 140, "pool");
  }
  pthread_mutex_lock((pthread_mutex_t *)a1);
  *(_DWORD *)(a1 + 112) = 1;
  if (*(void *)(a1 + 144))
  {
    int v2 = pthread_cond_wait((pthread_cond_t *)(a1 + 64), (pthread_mutex_t *)a1);
    if (v2 || *(void *)(a1 + 144))
    {
      int v4 = v2;
      pthread_mutex_unlock((pthread_mutex_t *)a1);
      sub_10025B778("retval: %d", v4);
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 150, "false");
    }
  }

  return pthread_mutex_unlock((pthread_mutex_t *)a1);
}

uint64_t sub_100197134(uint64_t a1)
{
  if (!a1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 158, "pool");
  }
  pthread_mutex_lock((pthread_mutex_t *)a1);
  int v2 = (void *)(a1 + 160);
  int v3 = *(void **)(a1 + 160);
  if (v3)
  {
    uint64_t v4 = v3[1];
    *int v2 = v4;
    if (!v4) {
      *(void *)(a1 + 168) = v2;
    }
    v3[1] = 0;
    **(void **)(a1 + 152) = v3;
    *(void *)(a1 + 152) = v3 + 1;
    *(int32x2_t *)(a1 + 132) = vadd_s32(*(int32x2_t *)(a1 + 132), (int32x2_t)0x1FFFFFFFFLL);
    pthread_mutex_unlock((pthread_mutex_t *)a1);
    return *v3;
  }
  else
  {
    pthread_mutex_unlock((pthread_mutex_t *)a1);
    sub_10025B778("free list empty. Cannot allocate memory from pool");
    return 0;
  }
}

uint64_t sub_1001971E0(uint64_t a1, unint64_t a2)
{
  if (!a1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 201, "pool");
  }
  pthread_mutex_lock((pthread_mutex_t *)a1);
  unint64_t v4 = *(void *)(a1 + 184);
  if (v4 > a2 || *(void *)(a1 + 192) <= a2)
  {
    sub_10025B778("%p not from pool");
    goto LABEL_20;
  }
  unint64_t v5 = (a2 - v4) / *(void *)(a1 + 120);
  uint64_t v6 = *(void *)(a1 + 176);
  unsigned int v7 = (void *)(v6 + 16 * (int)v5);
  if (*v7 != a2)
  {
    sub_10025B778("node->addr: %p, addr: %p");
LABEL_20:
    pthread_mutex_unlock((pthread_mutex_t *)a1);
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/Platforms/Darwin/pcie_mempool.c", 209, "false");
  }
  int v8 = (void *)(a1 + 144);
  uint64_t v9 = *(void **)(a1 + 144);
  if (v9 == v7)
  {
    uint64_t v15 = *(void *)(v6 + 16 * (int)v5 + 8);
    *int v8 = v15;
    uint64_t v12 = (void *)(a1 + 144);
    if (v15) {
      goto LABEL_9;
    }
    goto LABEL_8;
  }
  do
  {
    uint64_t v10 = v9;
    uint64_t v9 = (void *)v9[1];
  }
  while (v9 != v7);
  uint64_t v11 = *(void *)(v6 + 16 * (int)v5 + 8);
  v10[1] = v11;
  uint64_t v12 = v10 + 1;
  if (!v11) {
LABEL_8:
  }
    *(void *)(a1 + 152) = v12;
LABEL_9:
  uint64_t v13 = v6 + 16 * (int)v5;
  *(void *)(v13 + 8) = 0;
  **(void **)(a1 + 168) = v7;
  *(void *)(a1 + 168) = v13 + 8;
  *(int32x2_t *)(a1 + 132) = vadd_s32(*(int32x2_t *)(a1 + 132), (int32x2_t)0xFFFFFFFF00000001);
  if (*(_DWORD *)(a1 + 112) && !*v8) {
    pthread_cond_signal((pthread_cond_t *)(a1 + 64));
  }

  return pthread_mutex_unlock((pthread_mutex_t *)a1);
}

uint64_t sub_10019734C()
{
  byte_100A196C1 = 1;
  byte_100A04A18 = 1;
  dword_100A04A1C = 0;
  dword_100A04A20 = 0;
  qword_100A04A28 = (uint64_t)sub_10010CE48(48 * *(unsigned __int8 *)(qword_100A19628 + 2));
  if (qword_100A04A28) {
    return 0;
  }
  else {
    return 106;
  }
}

void sub_1001973B4()
{
  int v0 = dword_100A04A1C;
  if (dword_100A04A1C)
  {
    uint64_t v1 = 0;
    unint64_t v2 = 0;
    do
    {
      int v3 = (void **)(qword_100A04A28 + v1);
      if (*(_WORD *)(qword_100A04A28 + v1 + 20) != 3125) {
        sub_100199970(129, (uint64_t)(v3 + 2));
      }
      sub_100023010(*v3);
      ++v2;
      int v0 = dword_100A04A1C;
      v1 += 48;
    }
    while (v2 < dword_100A04A1C);
  }
  if (!byte_100A196C1) {
    byte_100A196C1 = 1;
  }
  if (byte_100A04A18)
  {
    if (!v0) {
      return;
    }
  }
  else
  {
    byte_100A04A18 = 1;
    if (!v0) {
      return;
    }
  }
  dword_100A04A1C = 0;
}

void sub_10019746C()
{
  byte_100A04A18 = 1;
  if (dword_100A04A1C) {
    BOOL v0 = byte_100A196C1 == 0;
  }
  else {
    BOOL v0 = 1;
  }
  if (!v0) {
    sub_1000223C0();
  }
}

uint64_t sub_10019749C()
{
  sub_10025B778("HciCmdQueue:\n");
  sub_10025B778("   %d cmds queued: \n", dword_100A04A1C);
  if (dword_100A04A1C)
  {
    unint64_t v0 = 0;
    uint64_t v1 = 20;
    do
    {
      sub_10025B778("   cmd opcode: 0x%4x\n", *(unsigned __int16 *)(qword_100A04A28 + v1));
      ++v0;
      v1 += 48;
    }
    while (v0 < dword_100A04A1C);
  }
  sub_10025B778("   queueHighWaterMaruint64_t k = %d\n", dword_100A04A20);
  if (byte_100A04A18) {
    unint64_t v2 = "TRUE";
  }
  else {
    unint64_t v2 = "FALSE";
  }
  sub_10025B778("   Command Transport Ready = %s\n", v2);
  return sub_10025B778("   OI_HCIFlow_NumCmdPktsAllowed = %d\n", byte_100A196C1);
}

uint64_t sub_100197598()
{
  dword_100A04CD0 = 0;
  qword_100A04CD8 = 0;
  dword_100A04CE0 = 0;
  qword_100A04CE8 = 0;
  dword_100A04CF0 = 0;
  qword_100A04CF8 = 0;
  dword_100A04D00 = 0;
  qword_100A04D08 = 0;
  dword_100A04D10 = 0;
  qword_100A04D18 = 0;
  dword_100A04D20 = 0;
  qword_100A04D28 = 0;
  xmmword_100A04A30 = 0u;
  *(_OWORD *)&word_100A04A40 = 0u;
  xmmword_100A04A50 = 0u;
  unk_100A04A60 = 0u;
  xmmword_100A04A70 = 0u;
  unk_100A04A80 = 0u;
  xmmword_100A04A90 = 0u;
  unk_100A04AA0 = 0u;
  xmmword_100A04AB0 = 0u;
  unk_100A04AC0 = 0u;
  xmmword_100A04AD0 = 0u;
  unk_100A04AE0 = 0u;
  xmmword_100A04AF0 = 0u;
  unk_100A04B00 = 0u;
  xmmword_100A04B10 = 0u;
  unk_100A04B20 = 0u;
  xmmword_100A04B30 = 0u;
  unk_100A04B40 = 0u;
  xmmword_100A04B50 = 0u;
  unk_100A04B60 = 0u;
  xmmword_100A04B70 = 0u;
  BYTE2(xmmword_100A04A30) = 2;
  int v0 = dword_1009F9458 + 1;
  DWORD1(xmmword_100A04A30) = dword_1009F9458;
  xmmword_100A04B80 = 0u;
  *(_OWORD *)&word_100A04B90 = 0u;
  xmmword_100A04BA0 = 0u;
  unk_100A04BB0 = 0u;
  xmmword_100A04BC0 = 0u;
  unk_100A04BD0 = 0u;
  xmmword_100A04BE0 = 0u;
  unk_100A04BF0 = 0u;
  xmmword_100A04C00 = 0u;
  unk_100A04C10 = 0u;
  xmmword_100A04C20 = 0u;
  unk_100A04C30 = 0u;
  xmmword_100A04C40 = 0u;
  unk_100A04C50 = 0u;
  xmmword_100A04C60 = 0u;
  unk_100A04C70 = 0u;
  xmmword_100A04C80 = 0u;
  unk_100A04C90 = 0u;
  xmmword_100A04CA0 = 0u;
  unk_100A04CB0 = 0u;
  xmmword_100A04CC0 = 0u;
  BYTE2(xmmword_100A04B80) = 3;
  dword_1009F9458 += 2;
  DWORD1(xmmword_100A04B80) = v0;
  return 0;
}

BOOL sub_100197698(uint64_t a1)
{
  BOOL v1 = 0;
  if (a1)
  {
    for (uint64_t i = qword_100A04CD8; i; uint64_t i = *(void *)(i + 40))
    {
      BOOL v1 = i == a1;
      if (i == a1) {
        break;
      }
    }
  }
  return v1;
}

BOOL sub_1001976C8(uint64_t a1)
{
  uint64_t v1 = 0;
  if (a1)
  {
    uint64_t v2 = qword_100A04CD8;
    if (qword_100A04CD8)
    {
      while (v2 != a1)
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          return 0;
        }
      }
      return *(unsigned char *)(a1 + 304) != 0;
    }
  }
  return v1;
}

uint64_t sub_100197708(uint64_t a1)
{
  uint64_t v1 = 0;
  if (a1)
  {
    uint64_t v2 = qword_100A04CD8;
    if (qword_100A04CD8)
    {
      while (v2 != a1)
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          return 0;
        }
      }
      return *(unsigned __int8 *)(a1 + 153);
    }
  }
  return v1;
}

BOOL sub_100197740(uint64_t a1)
{
  BOOL v1 = 0;
  if (a1)
  {
    for (uint64_t i = qword_100A04CE8; i; uint64_t i = *(void *)(i + 40))
    {
      BOOL v1 = i == a1;
      if (i == a1) {
        break;
      }
    }
  }
  return v1;
}

BOOL sub_100197770(uint64_t a1)
{
  BOOL v1 = 0;
  if (a1)
  {
    for (uint64_t i = qword_100A04CF8; i; uint64_t i = *(void *)(i + 40))
    {
      BOOL v1 = i == a1;
      if (i == a1) {
        break;
      }
    }
  }
  return v1;
}

uint64_t sub_1001977A0(uint64_t a1)
{
  uint64_t v1 = 0;
  if (a1)
  {
    uint64_t v2 = qword_100A04D28;
    if (qword_100A04D28)
    {
      while (v2 != a1)
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          return 0;
        }
      }
      return 1;
    }
  }
  return v1;
}

uint64_t sub_1001977D8(uint64_t a1)
{
  if (*(unsigned char *)(a1 + 2)) {
    sub_10025B8C0();
  }
  return (*(unsigned __int8 *)(a1 + 152) >> 7) ^ 1u;
}

BOOL sub_100197810(uint64_t a1)
{
  BOOL result = *(unsigned char *)(a1 + 2) != 4 && (sub_10025B8C0(), *(unsigned char *)(a1 + 2) != 4) || *(unsigned char *)(a1 + 166) != 2;
  return result;
}

long long *sub_100197864(int a1)
{
  BOOL result = (long long *)qword_100A04CD8;
  if (qword_100A04CD8)
  {
    while (*((unsigned char *)result + 54) == 7 || *(unsigned __int16 *)result != a1)
    {
      BOOL result = (long long *)*((void *)result + 5);
      if (!result) {
        goto LABEL_5;
      }
    }
  }
  else
  {
LABEL_5:
    BOOL result = (long long *)qword_100A04CE8;
    if (qword_100A04CE8)
    {
      while (*(unsigned __int16 *)result != a1)
      {
        BOOL result = (long long *)*((void *)result + 5);
        if (!result) {
          goto LABEL_8;
        }
      }
    }
    else
    {
LABEL_8:
      BOOL result = (long long *)qword_100A04CF8;
      if (qword_100A04CF8)
      {
        while (*(unsigned __int16 *)result != a1)
        {
          BOOL result = (long long *)*((void *)result + 5);
          if (!result) {
            goto LABEL_11;
          }
        }
      }
      else
      {
LABEL_11:
        BOOL result = (long long *)qword_100A04D08;
        if (qword_100A04D08)
        {
          while (*(unsigned __int16 *)result != a1)
          {
            BOOL result = (long long *)*((void *)result + 5);
            if (!result) {
              goto LABEL_14;
            }
          }
        }
        else
        {
LABEL_14:
          BOOL result = (long long *)qword_100A04D18;
          if (qword_100A04D18)
          {
            while (*(unsigned __int16 *)result != a1)
            {
              BOOL result = (long long *)*((void *)result + 5);
              if (!result) {
                goto LABEL_17;
              }
            }
          }
          else
          {
LABEL_17:
            BOOL result = (long long *)qword_100A04D28;
            if (qword_100A04D28)
            {
              while (*(unsigned __int16 *)result != a1)
              {
                BOOL result = (long long *)*((void *)result + 5);
                if (!result) {
                  goto LABEL_20;
                }
              }
            }
            else
            {
LABEL_20:
              BOOL result = &xmmword_100A04A30;
              if ((unsigned __int16)xmmword_100A04A30 != a1)
              {
                if ((unsigned __int16)xmmword_100A04B80 == a1) {
                  return &xmmword_100A04B80;
                }
                else {
                  return 0;
                }
              }
            }
          }
        }
      }
    }
  }
  return result;
}

uint64_t sub_100197960(unsigned __int16 *a1)
{
  uint64_t v1 = qword_100A04CD8;
  if (qword_100A04CD8)
  {
    while ((unsigned __int16 *)v1 != a1 || *(unsigned char *)(v1 + 54) == 7)
    {
      uint64_t v1 = *(void *)(v1 + 40);
      if (!v1) {
        goto LABEL_5;
      }
    }
  }
  else
  {
LABEL_5:
    uint64_t v2 = qword_100A04CE8;
    if (qword_100A04CE8)
    {
      while ((unsigned __int16 *)v2 != a1)
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          goto LABEL_8;
        }
      }
    }
    else
    {
LABEL_8:
      uint64_t v3 = qword_100A04CF8;
      if (qword_100A04CF8)
      {
        while ((unsigned __int16 *)v3 != a1)
        {
          uint64_t v3 = *(void *)(v3 + 40);
          if (!v3) {
            goto LABEL_11;
          }
        }
      }
      else
      {
LABEL_11:
        uint64_t v4 = qword_100A04D28;
        if (qword_100A04D28)
        {
          while ((unsigned __int16 *)v4 != a1)
          {
            uint64_t v4 = *(void *)(v4 + 40);
            if (!v4) {
              goto LABEL_14;
            }
          }
        }
        else
        {
LABEL_14:
          uint64_t v5 = qword_100A04D08;
          if (!qword_100A04D08) {
            return 0;
          }
          while ((unsigned __int16 *)v5 != a1)
          {
            uint64_t v5 = *(void *)(v5 + 40);
            if (!v5) {
              return 0;
            }
          }
        }
      }
    }
  }
  return *a1;
}

uint64_t sub_100197A08(uint64_t a1)
{
  uint64_t v1 = (unsigned __int16 *)sub_100197A30(a1);

  return sub_100197960(v1);
}

uint64_t sub_100197A30(uint64_t a1)
{
  uint64_t v1 = 0;
  if (a1)
  {
    uint64_t v2 = qword_100A04CD8;
    if (qword_100A04CD8)
    {
      while (*(unsigned char *)(v2 + 54) == 7
           || *(_DWORD *)(v2 + 48) != *(_DWORD *)a1
           || *(unsigned __int16 *)(v2 + 52) != *(unsigned __int16 *)(a1 + 4))
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          return 0;
        }
      }
      return v2;
    }
  }
  return v1;
}

uint64_t sub_100197A88(uint64_t a1)
{
  for (uint64_t i = qword_100A04CE8; i; uint64_t i = *(void *)(i + 40))
  {
    uint64_t v3 = *(void *)(i + 48);
    if (v3)
    {
      if (*(unsigned char *)(v3 + 54) != 7)
      {
        int v4 = *(_DWORD *)(v3 + 48);
        int v5 = *(unsigned __int16 *)(v3 + 52);
        if (v4 == *(_DWORD *)a1 && v5 == *(unsigned __int16 *)(a1 + 4)) {
          return i;
        }
      }
    }
    else
    {
      sub_10025B8C0();
    }
  }
  return i;
}

uint64_t sub_100197AF8(unint64_t a1)
{
  uint64_t v1 = sub_1002284B8(a1);
  int v3 = v1;
  char v5 = BYTE6(v1);
  __int16 v4 = WORD2(v1);
  return sub_100197B34(&v3);
}

uint64_t sub_100197B34(_DWORD *a1)
{
  for (uint64_t result = qword_100A04CF8; result; uint64_t result = *(void *)(result + 40))
  {
    if (*(unsigned char *)(result + 124) != 7)
    {
      if (*(unsigned char *)(result + 55))
      {
        if (*(_DWORD *)(result + 56) == *a1 && *(_DWORD *)(result + 59) == *(_DWORD *)((char *)a1 + 3)) {
          break;
        }
      }
      if (*(_DWORD *)(result + 48) == *a1 && *(_DWORD *)(result + 51) == *(_DWORD *)((char *)a1 + 3)) {
        break;
      }
    }
  }
  return result;
}

uint64_t sub_100197B9C(uint64_t a1)
{
  uint64_t result = qword_100A04CD8;
  if (qword_100A04CD8)
  {
    while (*(unsigned char *)(result + 54) == 7
         || *(_DWORD *)(result + 48) != *(_DWORD *)a1
         || *(unsigned __int16 *)(result + 52) != *(unsigned __int16 *)(a1 + 4))
    {
      uint64_t result = *(void *)(result + 40);
      if (!result) {
        goto LABEL_8;
      }
    }
  }
  else
  {
LABEL_8:
    uint64_t result = qword_100A04CF8;
    if (qword_100A04CF8)
    {
      while (1)
      {
        if (*(unsigned char *)(result + 124) != 7)
        {
          if (*(unsigned char *)(result + 55))
          {
            if (*(_DWORD *)(result + 57) == *(_DWORD *)a1
              && *(unsigned __int16 *)(result + 61) == *(unsigned __int16 *)(a1 + 4))
            {
              break;
            }
          }
          if (*(_DWORD *)(result + 49) == *(_DWORD *)a1
            && *(unsigned __int16 *)(result + 53) == *(unsigned __int16 *)(a1 + 4))
          {
            break;
          }
        }
        uint64_t result = *(void *)(result + 40);
        if (!result) {
          goto LABEL_20;
        }
      }
    }
    else
    {
LABEL_20:
      for (uint64_t result = qword_100A04CE8; result; uint64_t result = *(void *)(result + 40))
      {
        uint64_t v6 = *(void *)(result + 48);
        if (v6 && *(unsigned char *)(v6 + 54) != 7)
        {
          int v7 = *(_DWORD *)(v6 + 48);
          int v8 = *(unsigned __int16 *)(v6 + 52);
          if (v7 == *(_DWORD *)a1 && v8 == *(unsigned __int16 *)(a1 + 4)) {
            break;
          }
        }
      }
    }
  }
  return result;
}

uint64_t sub_100197C84(uint64_t a1)
{
  uint64_t v1 = 0;
  if (a1)
  {
    uint64_t v2 = qword_100A04CF8;
    if (qword_100A04CF8)
    {
      while (v2 != a1 || *(unsigned char *)(v2 + 124) == 7)
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          return 0;
        }
      }
      uint64_t v1 = a1 + 48;
      if (*(unsigned char *)(a1 + 55)) {
        return a1 + 56;
      }
    }
  }
  return v1;
}

uint64_t sub_100197CD8(uint64_t a1)
{
  uint64_t v1 = 0;
  if (a1)
  {
    uint64_t v2 = qword_100A04CD8;
    if (qword_100A04CD8)
    {
      while (v2 != a1 || *(unsigned char *)(v2 + 54) == 7)
      {
        uint64_t v2 = *(void *)(v2 + 40);
        if (!v2) {
          return 0;
        }
      }
      return a1 + 48;
    }
  }
  return v1;
}

__int16 *sub_100197D1C(uint64_t a1)
{
  uint64_t v1 = (__int16 *)qword_100A04CE8;
  if (qword_100A04CE8)
  {
    do
    {
      if (*v1 == -1)
      {
        uint64_t v3 = *((void *)v1 + 6);
        if (v3)
        {
          int v4 = *(_DWORD *)(v3 + 48);
          int v5 = *(unsigned __int16 *)(v3 + 52);
          if (v4 == *(_DWORD *)a1 && v5 == *(unsigned __int16 *)(a1 + 4)) {
            return v1;
          }
        }
        else
        {
          sub_10025B8C0();
        }
      }
      uint64_t v1 = (__int16 *)*((void *)v1 + 5);
    }
    while (v1);
  }
  return v1;
}

uint64_t sub_100197D8C(uint64_t a1, char a2)
{
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Allocating ACL connection for %: at state:%d while numAclConnections is %d", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136446210;
      uint64_t v47 = sub_100050714();
      _os_log_impl((void *)&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
  int v12 = dword_100A04CD0;
  if (v12 == *(unsigned __int8 *)sub_10025B218(0x28u))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Max ACL connections reached - refusing to allocate acl connection record", v13, v14, v15, v16, v17, v18, v19, v45);
      uint64_t v20 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    if (sub_100017A14()) {
      sub_10017B6E4();
    }
    sub_10025B8C0();
    return 0;
  }
  char v21 = sub_10010CE48(0x150uLL);
  if (!v21)
  {
LABEL_20:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Out of memory - unable to allocate acl connection record", v36, v37, v38, v39, v40, v41, v42, v45);
      uint64_t v43 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 0;
  }
  uint64_t v22 = (uint64_t)v21;
  int v23 = *(_DWORD *)a1;
  v21[26] = *(_WORD *)(a1 + 4);
  *((_DWORD *)v21 + 12) = v23;
  *((unsigned char *)v21 + 54) = a2;
  v21[69] = *(_WORD *)(qword_100A195B0 + 10) & 6 | 1;
  *((unsigned char *)v21 + 144) = -1;
  *((unsigned char *)v21 + 152) = 0;
  v21[70] = 32000;
  *((unsigned char *)v21 + 2) = 0;
  *char v21 = -1;
  int v24 = dword_1009F9458++;
  *((_DWORD *)v21 + 1) = v24;
  v21[10] = -1;
  *((unsigned char *)v21 + 256) = *(unsigned char *)(sub_10025B218(0x28u) + 10) != 0;
  *(unsigned char *)(v22 + 153) = 0;
  *(_DWORD *)(v22 + 324) = 0;
  __int16 v25 = &qword_100A04CD8;
  uint64_t v26 = qword_100A04CD8;
  if (qword_100A04CD8)
  {
    do
    {
      uint64_t v27 = v26;
      uint64_t v26 = *(void *)(v26 + 40);
    }
    while (v26);
    __int16 v25 = (uint64_t *)(v27 + 40);
  }
  *__int16 v25 = v22;
  ++dword_100A04CD0;
  if (sub_1001F6490(v22))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Fail to allocate L2CAP resources for new ACL connection", v28, v29, v30, v31, v32, v33, v34, v45);
      int v35 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_100198044(v22);
    sub_100023010((void *)v22);
    goto LABEL_20;
  }
  return v22;
}

void sub_100198044(uint64_t a1)
{
  uint64_t v2 = qword_100A04CD8;
  if (qword_100A04CD8 == a1)
  {
    qword_100A04CD8 = *(void *)(a1 + 40);
LABEL_6:
    --dword_100A04CD0;
  }
  else
  {
    while (v2)
    {
      uint64_t v3 = v2;
      uint64_t v2 = *(void *)(v2 + 40);
      if (v2 == a1)
      {
        *(void *)(v3 + 40) = *(void *)(a1 + 40);
        goto LABEL_6;
      }
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"RemoveAclHandleFromList: invalid handle %x", v4, v5, v6, v7, v8, v9, v10, a1);
      uint64_t v11 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100749AD0();
      }
    }
  }
}

char *sub_1001980F8(uint64_t a1)
{
  int v2 = dword_100A04CE0;
  if (v2 == *(unsigned __int8 *)(sub_10025B218(0x28u) + 1))
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"Max SCO connections reached - refusing to allocate sco connection record", v3, v4, v5, v6, v7, v8, v9, v26);
    uint64_t v10 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
    goto LABEL_12;
  }
  uint64_t v11 = (char *)sub_10010CE48(0x40uLL);
  if (!v11)
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"Out of memory - unable to allocate sco connection record", v17, v18, v19, v20, v21, v22, v23, v26);
    int v24 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
LABEL_12:
    sub_100744F6C();
    return 0;
  }
  int v12 = v11;
  *((void *)v11 + 6) = sub_100197A30(a1);
  *(_WORD *)(v12 + 57) = 255;
  v12[59] = 0;
  v12[2] = 1;
  *(_WORD *)int v12 = -1;
  int v13 = dword_1009F9458++;
  *((_DWORD *)v12 + 1) = v13;
  uint64_t v14 = &qword_100A04CE8;
  uint64_t v15 = qword_100A04CE8;
  if (qword_100A04CE8)
  {
    do
    {
      uint64_t v16 = v15;
      uint64_t v15 = *(void *)(v15 + 40);
    }
    while (v15);
    uint64_t v14 = (uint64_t *)(v16 + 40);
  }
  uint64_t *v14 = (uint64_t)v12;
  ++dword_100A04CE0;
  return v12;
}

void *sub_100198244(int *a1)
{
  int v2 = dword_100A04CF0;
  if (v2 == *(unsigned __int8 *)(sub_10025B218(0x28u) + 2))
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"Max LE connections reached - refusing to allocate LE connection record", v3, v4, v5, v6, v7, v8, v9, v28);
    uint64_t v10 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
    goto LABEL_10;
  }
  uint64_t v11 = sub_10010CE48(0x150uLL);
  if (!v11)
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"Out of memory - unable to allocate LE connection record", v16, v17, v18, v19, v20, v21, v22, v28);
    uint64_t v23 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
LABEL_10:
    sub_100744F6C();
    return 0;
  }
  int v12 = v11;
  int v13 = *a1;
  __int16 v14 = *((_WORD *)a1 + 2);
  *((unsigned char *)v11 + 54) = *((unsigned char *)a1 + 6);
  *((_WORD *)v11 + 26) = v14;
  *((_DWORD *)v11 + 12) = v13;
  *((unsigned char *)v11 + 2) = 4;
  int v15 = dword_1009F9458++;
  *((_DWORD *)v11 + 1) = v15;
  if (sub_1001F6490((uint64_t)v11))
  {
    sub_100023010(v12);
    return 0;
  }
  __int16 v25 = &qword_100A04CF8;
  uint64_t v26 = qword_100A04CF8;
  if (qword_100A04CF8)
  {
    do
    {
      uint64_t v27 = v26;
      uint64_t v26 = *(void *)(v26 + 40);
    }
    while (v26);
    __int16 v25 = (uint64_t *)(v27 + 40);
  }
  *__int16 v25 = (uint64_t)v12;
  ++dword_100A04CF0;
  return v12;
}

void *sub_10019839C(uint64_t a1)
{
  int v2 = dword_100A04D20;
  if (v2 == *(unsigned __int8 *)(sub_10025B218(0x28u) + 5))
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"Max OTHER connections reached - refusing to allocate new OTHER connection record", v3, v4, v5, v6, v7, v8, v9, v26);
    uint64_t v10 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
    goto LABEL_10;
  }
  uint64_t v11 = sub_10010CE48(0x48uLL);
  if (!v11)
  {
    if (!sub_100058654()) {
      return 0;
    }
    sub_100056E24((uint64_t)"Out of memory - unable to allocate OTHER connection record", v14, v15, v16, v17, v18, v19, v20, v26);
    uint64_t v21 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      return 0;
    }
LABEL_10:
    sub_100744F6C();
    return 0;
  }
  int v12 = v11;
  *((unsigned char *)v11 + 2) = 8;
  *((void *)v11 + 6) = a1;
  int v13 = dword_1009F9458++;
  *((_DWORD *)v11 + 1) = v13;
  if (sub_1001F6490((uint64_t)v11))
  {
    sub_100023010(v12);
    return 0;
  }
  uint64_t v23 = &qword_100A04D28;
  uint64_t v24 = qword_100A04D28;
  if (qword_100A04D28)
  {
    do
    {
      uint64_t v25 = v24;
      uint64_t v24 = *(void *)(v24 + 40);
    }
    while (v24);
    uint64_t v23 = (uint64_t *)(v25 + 40);
  }
  *uint64_t v23 = (uint64_t)v12;
  ++dword_100A04D20;
  return v12;
}

void sub_1001984E0(unsigned __int16 *a1)
{
  if (a1)
  {
    switch(*((unsigned char *)a1 + 2))
    {
      case 0:
        uint64_t v2 = qword_100A04CD8;
        if (qword_100A04CD8)
        {
          while ((unsigned __int16 *)v2 != a1)
          {
            uint64_t v2 = *(void *)(v2 + 40);
            if (!v2) {
              goto LABEL_6;
            }
          }
        }
        else
        {
LABEL_6:
          sub_10025B8C0();
        }
        sub_1001F653C((uint64_t)a1);
        if (*((void *)a1 + 20)) {
          sub_10025B8C0();
        }
        if (*((void *)a1 + 15)) {
          sub_10025B8C0();
        }
        if (*((void *)a1 + 16)) {
          sub_10025B8C0();
        }
        uint64_t v3 = (void *)*((void *)a1 + 15);
        if (v3)
        {
          sub_100023010(v3);
          *((void *)a1 + 15) = 0;
        }
        uint64_t v4 = (void *)*((void *)a1 + 16);
        if (v4)
        {
          sub_100023010(v4);
          *((void *)a1 + 16) = 0;
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Releasing ACL connection 0x%x with addr %: numAclConnections:%d", v5, v6, v7, v8, v9, v10, v11, *a1);
          int v12 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v129 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        sub_100026DB4(*((unsigned int *)a1 + 18));
        *((_DWORD *)a1 + 18) = 0;
        uint64_t v13 = *((unsigned int *)a1 + 44);
        if (v13) {
          sub_100026DB4(v13);
        }
        sub_10019BFB8(a1);
        sub_100198044((uint64_t)a1);
        break;
      case 1:
        uint64_t v22 = qword_100A04CE8;
        if (qword_100A04CE8)
        {
          while ((unsigned __int16 *)v22 != a1)
          {
            uint64_t v22 = *(void *)(v22 + 40);
            if (!v22) {
              goto LABEL_29;
            }
          }
        }
        else
        {
LABEL_29:
          sub_10025B8C0();
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Releasing SCO connection 0x%4x", v23, v24, v25, v26, v27, v28, v29, *a1);
          uint64_t v30 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v129 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v30, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        sub_10019BFB8(a1);
        uint64_t v31 = qword_100A04CE8;
        if ((unsigned __int16 *)qword_100A04CE8 == a1)
        {
          qword_100A04CE8 = *((void *)a1 + 5);
LABEL_91:
          --dword_100A04CE0;
        }
        else
        {
          while (v31)
          {
            uint64_t v32 = v31;
            uint64_t v31 = *(void *)(v31 + 40);
            if ((unsigned __int16 *)v31 == a1)
            {
              *(void *)(v32 + 40) = *((void *)a1 + 5);
              goto LABEL_91;
            }
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCI_ReleaseConnection: %x", v80, v81, v82, v83, v84, v85, v86, (uint64_t)a1);
            uint64_t v87 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v87, OS_LOG_TYPE_ERROR)) {
              goto LABEL_118;
            }
          }
        }
        break;
      case 4:
        uint64_t v44 = qword_100A04CF8;
        if (qword_100A04CF8)
        {
          while ((unsigned __int16 *)v44 != a1)
          {
            uint64_t v44 = *(void *)(v44 + 40);
            if (!v44) {
              goto LABEL_52;
            }
          }
        }
        else
        {
LABEL_52:
          sub_10025B8C0();
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Releasing LE connection 0x%4x", v45, v46, v47, v48, v49, v50, v51, *a1);
          uint64_t v52 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v129 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v52, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        sub_1001F653C((uint64_t)a1);
        sub_100026DB4(*((unsigned int *)a1 + 50));
        *((_DWORD *)a1 + 50) = 0;
        sub_10019BFB8(a1);
        sub_10023F044((uint64_t)a1);
        uint64_t v53 = qword_100A04CF8;
        if ((unsigned __int16 *)qword_100A04CF8 == a1)
        {
          qword_100A04CF8 = *((void *)a1 + 5);
LABEL_95:
          --dword_100A04CF0;
        }
        else
        {
          while (v53)
          {
            uint64_t v54 = v53;
            uint64_t v53 = *(void *)(v53 + 40);
            if ((unsigned __int16 *)v53 == a1)
            {
              *(void *)(v54 + 40) = *((void *)a1 + 5);
              goto LABEL_95;
            }
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCI_ReleaseConnection: %x", v96, v97, v98, v99, v100, v101, v102, (uint64_t)a1);
            uint64_t v103 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v103, OS_LOG_TYPE_ERROR)) {
              goto LABEL_118;
            }
          }
        }
        break;
      case 5:
        uint64_t v55 = qword_100A04D08;
        if (qword_100A04D08)
        {
          while ((unsigned __int16 *)v55 != a1)
          {
            uint64_t v55 = *(void *)(v55 + 40);
            if (!v55) {
              goto LABEL_63;
            }
          }
        }
        else
        {
LABEL_63:
          sub_10025B8C0();
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Releasing LE CIS connection 0x%4x", v56, v57, v58, v59, v60, v61, v62, *a1);
          uint64_t v63 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v63, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v129 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v63, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        uint64_t v64 = qword_100A04D08;
        if ((unsigned __int16 *)qword_100A04D08 == a1)
        {
          qword_100A04D08 = *((void *)a1 + 5);
LABEL_97:
          --dword_100A04D00;
        }
        else
        {
          while (v64)
          {
            uint64_t v65 = v64;
            uint64_t v64 = *(void *)(v64 + 40);
            if ((unsigned __int16 *)v64 == a1)
            {
              *(void *)(v65 + 40) = *((void *)a1 + 5);
              goto LABEL_97;
            }
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCI_ReleaseConnection: %x", v104, v105, v106, v107, v108, v109, v110, (uint64_t)a1);
            uint64_t v111 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v111, OS_LOG_TYPE_ERROR)) {
              goto LABEL_118;
            }
          }
        }
        break;
      case 6:
        uint64_t v66 = qword_100A04D18;
        if (qword_100A04D18)
        {
          while ((unsigned __int16 *)v66 != a1)
          {
            uint64_t v66 = *(void *)(v66 + 40);
            if (!v66) {
              goto LABEL_74;
            }
          }
        }
        else
        {
LABEL_74:
          sub_10025B8C0();
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Releasing LE BIS connection 0x%4x", v67, v68, v69, v70, v71, v72, v73, *a1);
          uint64_t v74 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v129 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v74, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        uint64_t v75 = qword_100A04D18;
        if ((unsigned __int16 *)qword_100A04D18 == a1)
        {
          qword_100A04D18 = *((void *)a1 + 5);
LABEL_99:
          --dword_100A04D10;
        }
        else
        {
          while (v75)
          {
            uint64_t v76 = v75;
            uint64_t v75 = *(void *)(v75 + 40);
            if ((unsigned __int16 *)v75 == a1)
            {
              *(void *)(v76 + 40) = *((void *)a1 + 5);
              goto LABEL_99;
            }
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCI_ReleaseConnection: %x", v112, v113, v114, v115, v116, v117, v118, (uint64_t)a1);
            uint64_t v119 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v119, OS_LOG_TYPE_ERROR)) {
              goto LABEL_118;
            }
          }
        }
        break;
      case 7:
        uint64_t v33 = qword_100A04D30;
        if (qword_100A04D30)
        {
          while ((unsigned __int16 *)v33 != a1)
          {
            uint64_t v33 = *(void *)(v33 + 40);
            if (!v33) {
              goto LABEL_41;
            }
          }
        }
        else
        {
LABEL_41:
          sub_10025B8C0();
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Releasing LE BIS sync connection 0x%4x", v34, v35, v36, v37, v38, v39, v40, *a1);
          uint64_t v41 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            uint64_t v129 = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v41, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        uint64_t v42 = qword_100A04D30;
        if ((unsigned __int16 *)qword_100A04D30 == a1)
        {
          qword_100A04D30 = *((void *)a1 + 5);
LABEL_93:
          --dword_100A04D38;
        }
        else
        {
          while (v42)
          {
            uint64_t v43 = v42;
            uint64_t v42 = *(void *)(v42 + 40);
            if ((unsigned __int16 *)v42 == a1)
            {
              *(void *)(v43 + 40) = *((void *)a1 + 5);
              goto LABEL_93;
            }
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCI_ReleaseConnection: %x", v88, v89, v90, v91, v92, v93, v94, (uint64_t)a1);
            uint64_t v95 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v95, OS_LOG_TYPE_ERROR)) {
LABEL_118:
            }
              sub_100749AD0();
          }
        }
        break;
      case 8:
        uint64_t v77 = qword_100A04D28;
        if (qword_100A04D28)
        {
          while ((unsigned __int16 *)v77 != a1)
          {
            uint64_t v77 = *(void *)(v77 + 40);
            if (!v77) {
              goto LABEL_85;
            }
          }
        }
        else
        {
LABEL_85:
          sub_10025B8C0();
        }
        sub_1001F653C((uint64_t)a1);
        uint64_t v78 = qword_100A04D28;
        if ((unsigned __int16 *)qword_100A04D28 == a1)
        {
          qword_100A04D28 = *((void *)a1 + 5);
LABEL_101:
          --dword_100A04D20;
        }
        else
        {
          while (v78)
          {
            uint64_t v79 = v78;
            uint64_t v78 = *(void *)(v78 + 40);
            if ((unsigned __int16 *)v78 == a1)
            {
              *(void *)(v79 + 40) = *((void *)a1 + 5);
              goto LABEL_101;
            }
          }
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCI_ReleaseConnection: %x", v120, v121, v122, v123, v124, v125, v126, (uint64_t)a1);
            uint64_t v127 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v127, OS_LOG_TYPE_ERROR)) {
              sub_100749AD0();
            }
          }
        }
        break;
      default:
        sub_10025B8C0();
        break;
    }
    sub_100023010(a1);
  }
  else
  {
    sub_10025B8C0();
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"connection handle is null, numAclConnections:%d", v14, v15, v16, v17, v18, v19, v20, dword_100A04CD0);
      uint64_t v21 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
}

uint64_t sub_100198D88()
{
  uint64_t v2 = 0;
  uint64_t v0 = 0;
  while (sub_100198DE0(&v2))
  {
    if (*(unsigned char *)(v2 + 54) == 7) {
      uint64_t v0 = v0;
    }
    else {
      uint64_t v0 = (v0 + 1);
    }
  }
  return v0;
}

BOOL sub_100198DE0(uint64_t *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  uint64_t v2 = *a1;
  if (*a1)
  {
    uint64_t v3 = qword_100A04CD8;
    if (qword_100A04CD8)
    {
      while (v3 != v2)
      {
        uint64_t v3 = *(void *)(v3 + 40);
        if (!v3) {
          goto LABEL_7;
        }
      }
    }
    else
    {
LABEL_7:
      sub_10025B8C0();
      uint64_t v2 = *a1;
    }
    uint64_t v4 = (uint64_t *)(v2 + 40);
  }
  else
  {
    uint64_t v4 = &qword_100A04CD8;
  }
  uint64_t v5 = *v4;
  *a1 = v5;
  return v5 != 0;
}

uint64_t sub_100198E54()
{
  return dword_100A04CE0;
}

uint64_t sub_100198E60()
{
  uint64_t v2 = 0;
  uint64_t v0 = 0;
  while (sub_100198EB8(&v2))
  {
    if (*(unsigned char *)(v2 + 124) == 7) {
      uint64_t v0 = v0;
    }
    else {
      uint64_t v0 = (v0 + 1);
    }
  }
  return v0;
}

BOOL sub_100198EB8(uint64_t *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  uint64_t v2 = *a1;
  if (*a1)
  {
    uint64_t v3 = qword_100A04CF8;
    if (qword_100A04CF8)
    {
      while (v3 != v2)
      {
        uint64_t v3 = *(void *)(v3 + 40);
        if (!v3) {
          goto LABEL_7;
        }
      }
    }
    else
    {
LABEL_7:
      sub_10025B8C0();
      uint64_t v2 = *a1;
    }
    uint64_t v4 = (uint64_t *)(v2 + 40);
  }
  else
  {
    uint64_t v4 = &qword_100A04CF8;
  }
  uint64_t v5 = *v4;
  *a1 = v5;
  return v5 != 0;
}

uint64_t sub_100198F2C()
{
  uint64_t v2 = 0;
  uint64_t v0 = 0;
  while (sub_100198EB8(&v2))
  {
    if (*(unsigned char *)(v2 + 124) != 7) {
      uint64_t v0 = v0 + *(unsigned __int8 *)(v2 + 127);
    }
  }
  return v0;
}

uint64_t sub_100198F8C()
{
  uint64_t v2 = 0;
  uint64_t v0 = 0;
  while (sub_100198FE4(&v2))
  {
    if (*(unsigned char *)(v2 + 60) == 7) {
      uint64_t v0 = v0;
    }
    else {
      uint64_t v0 = (v0 + 1);
    }
  }
  return v0;
}

BOOL sub_100198FE4(uint64_t *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  uint64_t v2 = *a1;
  if (*a1)
  {
    uint64_t v3 = qword_100A04D28;
    if (qword_100A04D28)
    {
      while (v3 != v2)
      {
        uint64_t v3 = *(void *)(v3 + 40);
        if (!v3) {
          goto LABEL_7;
        }
      }
    }
    else
    {
LABEL_7:
      sub_10025B8C0();
      uint64_t v2 = *a1;
    }
    uint64_t v4 = (uint64_t *)(v2 + 40);
  }
  else
  {
    uint64_t v4 = &qword_100A04D28;
  }
  uint64_t v5 = *v4;
  *a1 = v5;
  return v5 != 0;
}

uint64_t sub_100199058()
{
  uint64_t v2 = 0;
  uint64_t v0 = 0;
  while (sub_100198DE0(&v2))
  {
    if (*(_DWORD *)(v2 + 248)) {
      uint64_t v0 = (v0 + 1);
    }
    else {
      uint64_t v0 = v0;
    }
  }
  return v0;
}

BOOL sub_1001990B0(uint64_t *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  uint64_t v2 = *a1;
  if (*a1)
  {
    uint64_t v3 = qword_100A04CE8;
    if (qword_100A04CE8)
    {
      while (v3 != v2)
      {
        uint64_t v3 = *(void *)(v3 + 40);
        if (!v3) {
          goto LABEL_7;
        }
      }
    }
    else
    {
LABEL_7:
      sub_10025B8C0();
      uint64_t v2 = *a1;
    }
    uint64_t v4 = (uint64_t *)(v2 + 40);
  }
  else
  {
    uint64_t v4 = &qword_100A04CE8;
  }
  uint64_t v5 = *v4;
  *a1 = v5;
  return v5 != 0;
}

BOOL sub_100199124(uint64_t *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  uint64_t v2 = *a1;
  if (*a1)
  {
    uint64_t v3 = qword_100A04D08;
    if (qword_100A04D08)
    {
      while (v3 != v2)
      {
        uint64_t v3 = *(void *)(v3 + 40);
        if (!v3) {
          goto LABEL_7;
        }
      }
    }
    else
    {
LABEL_7:
      sub_10025B8C0();
      uint64_t v2 = *a1;
    }
    uint64_t v4 = (uint64_t *)(v2 + 40);
  }
  else
  {
    uint64_t v4 = &qword_100A04D08;
  }
  uint64_t v5 = *v4;
  *a1 = v5;
  return v5 != 0;
}

uint64_t sub_100199198(uint64_t a1)
{
  if (a1 && (uint64_t v1 = qword_100A04CD8) != 0)
  {
    while (v1 != a1)
    {
      uint64_t v1 = *(void *)(v1 + 40);
      if (!v1) {
        goto LABEL_5;
      }
    }
    return 1;
  }
  else
  {
LABEL_5:
    uint64_t v2 = 0;
    if (a1)
    {
      uint64_t v3 = qword_100A04CF8;
      if (qword_100A04CF8)
      {
        while (v3 != a1)
        {
          uint64_t v3 = *(void *)(v3 + 40);
          if (!v3) {
            return 0;
          }
        }
        return 3;
      }
    }
  }
  return v2;
}

const char *sub_1001991F8(unsigned int a1)
{
  if (a1 > 7) {
    return "unknown";
  }
  else {
    return (&off_10099D858)[(char)a1];
  }
}

void sub_100199220(uint64_t a1, float a2)
{
  *(void *)uint64_t v10 = 0;
  uint64_t v11 = 0;
  memset(v12, 0, sizeof(v12));
  LOWORD(a2) = *(_WORD *)(a1 + 80);
  gcvt((float)((float)LODWORD(a2) * 1.25), 7, v10);
  sub_10025B894(*(unsigned __int8 *)(a1 + 70));
  sub_10025B7A4((uint64_t)"Le topology - {adv-addr: %:-%s, resolved-addr: %:-%s, lmhandle: 0x%2x, interval: %s ms, latency: %d, lsto: %d, minCE: %d, maxCE: %d, role: %s, state: %s, ready-state: %s, enc-state: %s, phyStatsEnabled: %d}", v3, v4, v5, v6, v7, v8, v9, a1 + 49);
}

void sub_1001993A4(uint64_t a1, float a2)
{
  *(void *)uint64_t v10 = 0;
  uint64_t v11 = 0;
  memset(v12, 0, sizeof(v12));
  LOWORD(a2) = *(_WORD *)(a1 + 136);
  gcvt((float)((float)LODWORD(a2) * 0.625), 7, v10);
  sub_10025B894(*(unsigned __int8 *)(a1 + 144));
  sub_10025B86C(*(unsigned __int8 *)(a1 + 152));
  sub_10025B7D0(*(unsigned __int8 *)(a1 + 153));
  sub_10025B7A4((uint64_t)"ACL topology - {bd-addr: %:, lmhandle: 0x%2x, reference: %d, role: %s, state: %s, lk-mode: %s, enc-state: %s, lsto: %d, interval: %s ms, phyStatsEnabled: %d}", v3, v4, v5, v6, v7, v8, v9, a1 + 48);
}

void sub_1001994C0(unsigned __int16 *a1)
{
  uint64_t v1 = *a1;
  sub_10025B7F8(*((unsigned __int8 *)a1 + 58));
  sub_10025B7A4((uint64_t)"Voice topology - {lmhandle: 0x%2x, voicehandle: 0x%2x, lk-type: %d, phyStatsEnabled: %d}}", v2, v3, v4, v5, v6, v7, v8, v1);
}

void sub_100199524()
{
  if (dword_100A04CF0)
  {
    for (uint64_t i = 0; sub_100198EB8(&i); sub_100199220(i, v0))
      ;
  }
}

void sub_100199570()
{
  int v0 = dword_100A04CE0;
  if (dword_100A04CD0 | dword_100A04CE0)
  {
    if (dword_100A04CD0)
    {
      for (uint64_t i = 0; sub_100198DE0((uint64_t *)&i); sub_1001993A4((uint64_t)i, v1))
        ;
      int v0 = dword_100A04CE0;
    }
    if (v0)
    {
      for (uint64_t i = 0; sub_1001990B0((uint64_t *)&i); sub_1001994C0(i))
        ;
    }
  }
}

void sub_100199600()
{
  if (dword_100A04CD0) {
    BOOL v0 = 0;
  }
  else {
    BOOL v0 = dword_100A04CE0 == 0;
  }
  if (!v0 || dword_100A04CF0 != 0 || dword_100A04D00 != 0)
  {
    if (dword_100A04CD0)
    {
      for (uint64_t i = 0; sub_100198DE0((uint64_t *)&i); sub_1001993A4((uint64_t)i, v3))
        ;
    }
    if (dword_100A04CE0)
    {
      for (uint64_t i = 0; sub_1001990B0((uint64_t *)&i); sub_1001994C0(i))
        ;
    }
    if (dword_100A04CF0)
    {
      for (uint64_t i = 0; sub_100198EB8((uint64_t *)&i); sub_100199220((uint64_t)i, v4))
        ;
    }
    if (dword_100A04D00)
    {
      for (uint64_t i = 0;
            sub_100199124((uint64_t *)&i);
            sub_10025B7A4((uint64_t)"Le CIS topology - {cisHandle: 0x%2x, isoInterval: %d}", v5, v6, v7, v8, v9, v10, v11, *i))
      {
        ;
      }
    }
  }
}

void sub_100199740(uint64_t a1, uint64_t a2)
{
  if (DWORD2(xmmword_100A19860))
  {
    switch((int)a1)
    {
      case 1:
        ++dword_100A04D40;
        sub_10019746C();
        break;
      case 2:
        ++dword_100A04D48;
        sub_10019C524(a2);
        break;
      case 3:
        ++dword_100A04D50;
        sub_10019C6AC(a2);
        break;
      case 4:
        if (!sub_100058654()) {
          goto LABEL_15;
        }
        sub_100056E24((uint64_t)"OI_HCIIfc_SendCompleted, invalid sendType %d", v19, v20, v21, v22, v23, v24, v25, 4);
        uint64_t v26 = sub_100050B4C(0x2Eu);
        if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
          goto LABEL_15;
        }
        goto LABEL_14;
      default:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"OI_HCIIfc_SendCompleted, unknown sendType %d", v11, v12, v13, v14, v15, v16, v17, a1);
          uint64_t v18 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
LABEL_14:
          }
            sub_100744F6C();
        }
LABEL_15:
        sub_10025B8C0();
        break;
    }
    sub_100025E20();
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCIIfc_SendCompleted, HCI not initialized - ignoring event", v3, v4, v5, v6, v7, v8, v9, v27);
    uint64_t v10 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

char *sub_1001998DC(unsigned char *a1)
{
  if (a1) {
    *a1 = 5;
  }
  return &byte_100A04D58;
}

void sub_100199970(uint64_t a1, uint64_t a2)
{
  memset(v58, 0, sizeof(v58));
  unsigned int v4 = *(unsigned __int16 *)(a2 + 4);
  unsigned int v5 = v4 >> 10;
  uint64_t v6 = *(unsigned __int8 *)(a2 + 8);
  sub_1001DA4C8(v4);
  if (v5 < 0x3F) {
    sub_10025B74C((uint64_t)v58, 256, (uint64_t)"HCI expected event %d with opcode %s (0x%x) %s, reason is %!", v7, v8, v9, v10, v11, v6);
  }
  else {
    sub_10025B74C((uint64_t)v58, 256, (uint64_t)"HCI expected event %d with opcode %s (0x%x) %s, reason is %!. subopcode: 0x%02x -- subopcode2: 0x%02x", v7, v8, v9, v10, v11, v6);
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)v58, v12, v13, v14, v15, v16, v17, v18, v51);
    uint64_t v19 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  sub_10011631C((const char *)v58);
  if (sub_100023020())
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Controller core dump is in progress, don't trigger expected event timeouts", v20, v21, v22, v23, v24, v25, v26, v51);
      uint64_t v27 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    return;
  }
  if (a1 == 621)
  {
    if (off_100A04D60) {
      off_100A04D60(621);
    }
    else {
      sub_10025B8C0();
    }
  }
  uint64_t v28 = *(unsigned __int8 *)(a2 + 8);
  switch(v28)
  {
    case 0xE:
      __int16 v52 = 0;
      *(void *)&long long v53 = &v52;
      WORD4(v53) = 1;
      HIWORD(v53) = 1;
      *(_DWORD *)((char *)&v53 + 10) = 65537;
      (*(void (**)(uint64_t, void, long long *))(a2 + 16))(a1, *(void *)(a2 + 24), &v53);
      return;
    case 0x3E:
      uint64_t v57 = 0;
      long long v55 = 0u;
      long long v56 = 0u;
      long long v53 = 0u;
      long long v54 = 0u;
      if (sub_100025D0C(62))
      {
        sub_100199E9C(a1, a2, (uint64_t)&v53);
        sub_100223818((unsigned __int16)v53, DWORD2(v53), v54);
        return;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to find event descriptor for %x", v35, v36, v37, v38, v39, v40, v41, 62);
        uint64_t v42 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
LABEL_29:
        }
          sub_100744F6C();
      }
      break;
    case 0xF:
      sub_100199CC8(a2, a1);
      return;
    default:
      uint64_t v57 = 0;
      long long v55 = 0u;
      long long v56 = 0u;
      long long v53 = 0u;
      long long v54 = 0u;
      uint64_t v29 = sub_100025D0C(v28);
      if (v29)
      {
        sub_100199FB8(a1, a2, v29, (uint64_t *)&v53);
        sub_10019A2C4(v28, (unsigned int *)&v53, 0, 0, v30, v31, v32, v33, v34);
        return;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Failed to find event descriptor for %x", v43, v44, v45, v46, v47, v48, v49, v28);
        uint64_t v50 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
          goto LABEL_29;
        }
      }
      break;
  }
}

void sub_100199CC8(uint64_t a1, int a2)
{
  uint64_t v40 = 0;
  long long v38 = 0u;
  long long v39 = 0u;
  long long v36 = 0u;
  long long v37 = 0u;
  unsigned int v4 = sub_100022214(*(unsigned __int16 *)(a1 + 6));
  if (!v4)
  {
    if (!sub_100058654()) {
      goto LABEL_16;
    }
    sub_100056E24((uint64_t)"%! (%d)", v6, v7, v8, v9, v10, v11, v12, 620);
    uint64_t v13 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      goto LABEL_16;
    }
    goto LABEL_15;
  }
  uint64_t v5 = v4[20];
  if (v5 == 62)
  {
    if (sub_100025D0C(62))
    {
      sub_100199E9C(a2, a1, (uint64_t)&v36);
      sub_100223818((unsigned __int16)v36, DWORD2(v36), v37);
      return;
    }
    if (!sub_100058654()) {
      goto LABEL_16;
    }
    sub_100056E24((uint64_t)"%! (%d)", v20, v21, v22, v23, v24, v25, v26, 620);
    uint64_t v27 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
      goto LABEL_16;
    }
    goto LABEL_15;
  }
  uint64_t v14 = sub_100025D0C(v4[20]);
  if (v14)
  {
    sub_100199FB8(a2, a1, v14, (uint64_t *)&v36);
    sub_10019A2C4(v5, (unsigned int *)&v36, 0, 0, v15, v16, v17, v18, v19);
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"%! (%d)", v28, v29, v30, v31, v32, v33, v34, 620);
    uint64_t v35 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR)) {
LABEL_15:
    }
      sub_100744F6C();
  }
LABEL_16:
  sub_10025B8C0();
}

void sub_100199E9C(int a1, uint64_t a2, uint64_t a3)
{
  *(void *)(a3 + 64) = 0;
  *(_OWORD *)(a3 + 32) = 0u;
  *(_OWORD *)(a3 + 48) = 0u;
  *(_OWORD *)a3 = 0u;
  *(_OWORD *)(a3 + 16) = 0u;
  *(_DWORD *)a3 = *(unsigned __int16 *)(a2 + 4);
  *(_DWORD *)(a3 + 8) = a1;
  unsigned int v3 = *(unsigned __int16 *)(a2 + 4);
  if (v3 > 0x2067)
  {
    if (v3 - 8296 >= 5)
    {
      if (v3 == 8318) {
        goto LABEL_15;
      }
      if (v3 != 8325) {
        goto LABEL_12;
      }
    }
    goto LABEL_9;
  }
  char v4 = v3 - 13;
  if (v3 - 8205 <= 0x37)
  {
    if (((1 << v4) & 0x1240) != 0)
    {
LABEL_15:
      *(_DWORD *)(a3 + 16) = *(unsigned __int16 *)(a2 + 16);
      return;
    }
    if (((1 << v4) & 0xC0000000000001) != 0) {
      goto LABEL_9;
    }
  }
  if (v3 == 8292)
  {
LABEL_9:
    *(void *)(a3 + 16) = a2 + 16;
    return;
  }
  if (v3 == 8294) {
    goto LABEL_15;
  }
LABEL_12:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Unknown expected param type.", v5, v6, v7, v8, v9, v10, v11, v13);
    uint64_t v12 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_100199FB8(int a1, uint64_t a2, unsigned __int8 *a3, uint64_t *a4)
{
  bzero(a4, 8 * a3[4]);
  if (a3[4])
  {
    unint64_t v8 = 0;
    uint64_t v9 = (unsigned __int16 *)(a2 + 16);
    uint64_t v10 = a4;
    while (1)
    {
      switch(*(unsigned char *)(*((void *)a3 + 1) + v8))
      {
        case 'a':
          if (a3[17] != 7) {
            goto LABEL_4;
          }
          *uint64_t v10 = (uint64_t)v9;
          goto LABEL_5;
        case 'c':
        case 'e':
        case 'f':
        case 'k':
        case 'n':
        case 'p':
LABEL_4:
          *uint64_t v10 = (uint64_t)&unk_1007BA148;
          goto LABEL_5;
        case 'h':
          int v11 = a3[17];
          if (v11 == 7)
          {
            uint64_t v12 = (uint64_t)sub_100197D1C((uint64_t)v9);
            if (v12)
            {
              if (*(unsigned char *)(*(void *)(v12 + 48) + 54) == 7) {
                uint64_t v12 = *(void *)(v12 + 48);
              }
              if (v12) {
                goto LABEL_25;
              }
LABEL_22:
              if (!sub_100058654()
                || (sub_100056E24((uint64_t)"No connection record found for %:", v21, v22, v23, v24, v25, v26, v27, (uint64_t)v9), uint64_t v20 = sub_100050B4C(0x2Eu), !os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)))
              {
LABEL_24:
                uint64_t v12 = 0;
                goto LABEL_25;
              }
LABEL_26:
              uint64_t v28 = sub_100050714();
              *(_DWORD *)int buf = 136446466;
              uint64_t v34 = v28;
              __int16 v35 = 1024;
              int v36 = 0xFFFF;
              _os_log_error_impl((void *)&_mh_execute_header, v20, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
              goto LABEL_24;
            }
            uint64_t v12 = sub_100197A30((uint64_t)v9);
            if (!v12) {
              goto LABEL_22;
            }
          }
          else
          {
            if (v11 != 6)
            {
              if (!sub_100058654()) {
                goto LABEL_24;
              }
              sub_100056E24((uint64_t)"Unable to recover handle from failed status event - no event context", v13, v14, v15, v16, v17, v18, v19, v32);
              uint64_t v20 = sub_100050B4C(0x2Eu);
              if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
                goto LABEL_24;
              }
              goto LABEL_26;
            }
            uint64_t v12 = (uint64_t)sub_100197864(*v9);
          }
LABEL_25:
          *uint64_t v10 = v12;
LABEL_5:
          ++v8;
          ++v10;
          if (v8 >= a3[4]) {
            goto LABEL_27;
          }
          break;
        case 's':
          *(_DWORD *)uint64_t v10 = a1;
          goto LABEL_5;
        default:
          goto LABEL_5;
      }
    }
  }
LABEL_27:
  int v29 = *a3;
  if (v29 == 44)
  {
    int v30 = 2;
    uint64_t v31 = 3;
    goto LABEL_32;
  }
  if (v29 == 20 && sub_100197698(a4[1]))
  {
    int v30 = *(unsigned char *)(a4[1] + 152) & 0x7F;
    uint64_t v31 = 2;
LABEL_32:
    LODWORD(a4[v31]) = v30;
  }
}

void sub_10019A2C4(uint64_t a1, unsigned int *a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, __n128 a9)
{
  switch((int)a1)
  {
    case 1:
      uint64_t v21 = *a2;
      sub_100183058(v21);
      return;
    case 2:
    case 34:
      uint64_t v10 = *(void *)a2;
      sub_10018311C(v10);
      return;
    case 3:
      uint64_t v22 = *a2;
      uint64_t v23 = *((void *)a2 + 2);
      uint64_t v24 = *((unsigned __int8 *)a2 + 24);
      uint64_t v25 = *((unsigned __int8 *)a2 + 32);
      uint64_t v26 = (unsigned __int16 *)*((void *)a2 + 1);
      sub_10017C6DC(v22, v26, v23, v24, v25);
      return;
    case 4:
      uint64_t v27 = *(void *)a2;
      uint64_t v28 = *((unsigned __int8 *)a2 + 16);
      uint64_t v29 = a2[2];
      sub_10017D434(v27, v29, v28);
      return;
    case 5:
      uint64_t v30 = *((void *)a2 + 1);
      if (!v30) {
        goto LABEL_173;
      }
      int v31 = *(unsigned __int8 *)(v30 + 2);
      if (v31 != 5)
      {
        if (v31 == 4)
        {
          uint64_t v34 = *a2;
          uint64_t v35 = a2[4];
          uint64_t v36 = *((void *)a2 + 1);
          sub_10021B970(v34, v36, v35, a3, a4);
        }
        else
        {
LABEL_173:
          uint64_t v145 = *a2;
          uint64_t v146 = a2[4];
          uint64_t v147 = (unsigned __int16 *)*((void *)a2 + 1);
          sub_10017D8BC(v145, v147, v146);
        }
      }
      break;
    case 6:
      uint64_t v37 = *a2;
      uint64_t v38 = *((void *)a2 + 1);
      sub_1002571D8(v37, v38);
      return;
    case 7:
      uint64_t v39 = *a2;
      uint64_t v40 = *((void *)a2 + 2);
      uint64_t v41 = *((void *)a2 + 1);
      sub_10017DDCC(v39, v41, v40);
      return;
    case 8:
      uint64_t v42 = *((void *)a2 + 1);
      if (v42 && *(unsigned char *)(v42 + 2) == 4) {
        goto LABEL_160;
      }
      uint64_t v43 = *a2;
      uint64_t v44 = *((unsigned __int8 *)a2 + 16);
      uint64_t v45 = *((void *)a2 + 1);
      uint64_t v46 = 255;
      goto LABEL_170;
    case 9:
      uint64_t v47 = *a2;
      uint64_t v48 = *((void *)a2 + 1);
      sub_100254B60(v47, v48);
      return;
    case 10:
      sub_100254C3C();
      return;
    case 11:
      uint64_t v49 = *a2;
      uint64_t v50 = *((void *)a2 + 2);
      uint64_t v51 = *((void *)a2 + 1);
      sub_100184308(v49, v51, v50);
      return;
    case 12:
      uint64_t v52 = *((void *)a2 + 1);
      if (v52 && *(unsigned char *)(v52 + 2) == 4)
      {
        uint64_t v53 = *a2;
        unsigned int v54 = *((unsigned __int8 *)a2 + 16);
        __int16 v55 = *((_WORD *)a2 + 12);
        __int16 v56 = *((_WORD *)a2 + 16);
        uint64_t v57 = *((void *)a2 + 1);
        sub_10021C760(v53, v57, v54, v55, v56);
      }
      else
      {
        uint64_t v138 = *a2;
        uint64_t v139 = *((unsigned __int8 *)a2 + 16);
        uint64_t v140 = *((unsigned __int16 *)a2 + 12);
        uint64_t v141 = *((unsigned __int16 *)a2 + 16);
        uint64_t v142 = *((void *)a2 + 1);
        sub_100184648(v138, v142, v139, v140, v141);
      }
      return;
    case 13:
      uint64_t v58 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))off_100A19640;
      uint64_t v59 = *a2;
      uint64_t v60 = *((unsigned __int8 *)a2 + 16);
      uint64_t v61 = *((unsigned __int8 *)a2 + 24);
      uint64_t v62 = a2[8];
      uint64_t v63 = a2[10];
      uint64_t v64 = a2[12];
      uint64_t v65 = a2[14];
      uint64_t v66 = *((void *)a2 + 1);
      v58(v59, v66, v60, v61, v62, v63, v64, v65);
      return;
    case 14:
    case 15:
    case 19:
      goto LABEL_4;
    case 16:
      uint64_t v67 = *(unsigned __int8 *)a2;
      sub_100182660(v67);
      return;
    case 17:
      uint64_t v68 = *(void (**)(uint64_t))(qword_100A19638 + 24);
      uint64_t v69 = *(void *)a2;
      v68(v69);
      return;
    case 18:
      uint64_t v70 = *a2;
      int v71 = *((unsigned __int8 *)a2 + 16);
      uint64_t v72 = *((void *)a2 + 1);
      sub_10018823C(v70, v72, v71);
      return;
    case 20:
      uint64_t v73 = *a2;
      uint64_t v74 = *((unsigned __int8 *)a2 + 16);
      uint64_t v75 = *((unsigned __int16 *)a2 + 12);
      uint64_t v76 = *((void *)a2 + 1);
      sub_1001827D4(v73, v76, v74, v75);
      return;
    case 21:
      uint64_t v77 = *(void *)a2;
      goto LABEL_71;
    case 22:
      uint64_t v78 = *(void *)a2;
      sub_100256728(v78);
      return;
    case 23:
      uint64_t v79 = *(void *)a2;
      sub_100256A8C(v79, (uint64_t)a2, a3, a4, a5, a6, a7, a8);
      return;
    case 24:
      uint64_t v80 = *(void *)a2;
      uint64_t v81 = a2[4];
      uint64_t v82 = *((void *)a2 + 1);
      sub_1002570A0(v80, v82, v81);
      return;
    case 25:
      uint64_t v83 = *(void *)a2;
      uint64_t v84 = *((unsigned __int8 *)a2 + 8);
      sub_100182528(v83, v84);
      return;
    case 26:
      int v85 = *(unsigned __int8 *)a2;
      sub_10017DF20(v85);
      return;
    case 27:
      uint64_t v86 = *(void *)a2;
      uint64_t v87 = *((unsigned __int8 *)a2 + 8);
      sub_100182938(v86, v87);
      return;
    case 28:
      uint64_t v88 = *a2;
      uint64_t v89 = *((void *)a2 + 1);
      sub_100184770(v88, v89);
      return;
    case 29:
      uint64_t v90 = *a2;
      uint64_t v91 = *((unsigned __int16 *)a2 + 8);
      uint64_t v92 = *((void *)a2 + 1);
      sub_100182A28(v90, v92, v91);
      return;
    case 30:
      uint64_t v77 = *(void *)a2;
      goto LABEL_71;
    case 31:
      uint64_t v93 = *(void *)a2;
      uint64_t v94 = *((unsigned __int8 *)a2 + 8);
      sub_100182B7C(v93, v94);
      return;
    case 32:
      uint64_t v95 = *(void *)a2;
      uint64_t v96 = *((unsigned __int8 *)a2 + 8);
      sub_100182C10(v95, v96);
      return;
    case 33:
      off_100A19648(*a2, *((void *)a2 + 1), *((unsigned __int8 *)a2 + 16), *((unsigned __int8 *)a2 + 24), *((unsigned __int8 *)a2 + 32), a2[10], a2[12], a2[14], a2[16]);
      return;
    case 35:
      uint64_t v97 = *a2;
      uint64_t v98 = *((unsigned __int8 *)a2 + 16);
      uint64_t v99 = *((unsigned __int8 *)a2 + 24);
      uint64_t v100 = *((void *)a2 + 4);
      uint64_t v101 = *((void *)a2 + 1);
      sub_10018449C(v97, v101, v98, v99, v100);
      return;
    case 36:
    case 37:
    case 38:
    case 39:
    case 40:
    case 41:
    case 42:
    case 43:
    case 47:
    case 55:
    case 58:
    case 62:
    case 63:
    case 64:
    case 65:
    case 66:
    case 67:
    case 68:
    case 69:
    case 70:
    case 72:
    case 73:
    case 74:
    case 75:
    case 76:
    case 77:
    case 78:
    case 79:
    case 80:
    case 81:
    case 82:
    case 83:
    case 84:
    case 85:
    case 86:
    case 88:
      goto LABEL_12;
    case 44:
      sub_10018B6B4(*a2, *((void *)a2 + 1), *((void *)a2 + 2), *((unsigned __int8 *)a2 + 24), *((unsigned __int8 *)a2 + 32), *((unsigned __int8 *)a2 + 40), *((unsigned __int16 *)a2 + 24), *((unsigned __int16 *)a2 + 28), a2[16]);
      return;
    case 45:
      uint64_t v102 = *a2;
      uint64_t v103 = *((unsigned __int8 *)a2 + 16);
      uint64_t v104 = *((unsigned __int8 *)a2 + 24);
      uint64_t v105 = *((unsigned __int16 *)a2 + 16);
      uint64_t v106 = *((unsigned __int16 *)a2 + 20);
      uint64_t v107 = *((void *)a2 + 1);
      sub_10018B3C4(v102, v107, v103, v104, v105, v106);
      return;
    case 46:
      uint64_t v108 = *a2;
      uint64_t v109 = *((unsigned __int16 *)a2 + 8);
      uint64_t v110 = *((unsigned __int16 *)a2 + 12);
      uint64_t v111 = *((unsigned __int16 *)a2 + 16);
      uint64_t v112 = *((unsigned __int16 *)a2 + 20);
      uint64_t v113 = *((void *)a2 + 1);
      sub_100182CA4(v108, v113, v109, v110, v111, v112);
      return;
    case 48:
      uint64_t v114 = *((void *)a2 + 1);
      if (v114 && *(unsigned char *)(v114 + 2) == 4)
      {
        uint64_t v115 = *a2;
        uint64_t v116 = (unsigned char *)*((void *)a2 + 1);
        sub_100232E54(v115, v116);
      }
      else
      {
        uint64_t v143 = *a2;
        uint64_t v144 = *((void *)a2 + 1);
        sub_100254620(v143, v144);
      }
      return;
    case 49:
      uint64_t v117 = *(void *)a2;
      sub_100255A04(v117);
      return;
    case 50:
      uint64_t v118 = *(void *)a2;
      uint64_t v119 = *((unsigned __int8 *)a2 + 16);
      uint64_t v120 = *((unsigned __int8 *)a2 + 24);
      uint64_t v121 = *((unsigned __int8 *)a2 + 8);
      sub_100256108(v118, v121, v119, v120);
      return;
    case 51:
      uint64_t v122 = *(void *)a2;
      uint64_t v123 = a2[2];
      sub_100254E5C(v122, v123);
      return;
    case 52:
      uint64_t v124 = *(void *)a2;
      sub_100255270(v124);
      return;
    case 53:
      uint64_t v125 = *(void *)a2;
      sub_1002555D4(v125);
      return;
    case 54:
      uint64_t v126 = *a2;
      uint64_t v127 = *((void *)a2 + 1);
      sub_10025757C(v126, v127, a9);
      return;
    case 56:
      uint64_t v77 = *(void *)a2;
LABEL_71:
      nullsub_95(v77);
      break;
    case 57:
      uint64_t v128 = *(void *)a2;
      sub_10017E74C(v128);
      break;
    case 59:
      uint64_t v129 = *(void *)a2;
      uint64_t v130 = a2[2];
      sub_100255480(v129, v130);
      break;
    case 60:
      uint64_t v131 = *(void *)a2;
      uint64_t v132 = *((unsigned __int8 *)a2 + 8);
      sub_1002553AC(v131, v132);
      break;
    case 61:
      uint64_t v133 = *(void *)a2;
      uint64_t v134 = *((void *)a2 + 1);
      sub_100182D70(v133, v134);
      break;
    case 71:
      return;
    case 87:
      uint64_t v135 = *(void *)a2;
      sub_100254550(v135);
      break;
    case 89:
      uint64_t v42 = *((void *)a2 + 1);
      if (v42 && *(unsigned char *)(v42 + 2) == 4)
      {
LABEL_160:
        uint64_t v136 = *a2;
        uint64_t v137 = *((unsigned __int8 *)a2 + 16);
        sub_100232CBC(v136, v42, v137);
      }
      else
      {
        uint64_t v43 = *a2;
        uint64_t v44 = *((unsigned __int8 *)a2 + 16);
        uint64_t v46 = *((unsigned __int8 *)a2 + 24);
        uint64_t v45 = *((void *)a2 + 1);
LABEL_170:
        sub_10025468C(v43, v45, v44, v46);
      }
      break;
    default:
      if (a1 == 254)
      {
        uint64_t v11 = *(void *)a2;
        uint64_t v12 = *((unsigned __int8 *)a2 + 8);
        sub_100182494(v11, v12);
      }
      else
      {
LABEL_12:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Unknown event type, event id %x", v13, v14, v15, v16, v17, v18, v19, a1);
          uint64_t v20 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
LABEL_4:
        sub_10025B8C0();
      }
      break;
  }
}

void *sub_10019AE6C(void *result)
{
  off_100A04D68 = result;
  return result;
}

void *sub_10019AE78(void *result)
{
  off_100A04D60 = result;
  return result;
}

void sub_10019AE84(uint64_t *a1, int a2, int a3)
{
  uint64_t v64 = 0;
  uint64_t v65 = 0;
  uint64_t v66 = 0;
  if (!a2)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"handle_InquiryResult bad parm length: expected %d, got %d", v9, v10, v11, v12, v13, v14, v15, 1);
    uint64_t v16 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
      return;
    }
LABEL_10:
    sub_100744F6C();
    return;
  }
  if (*((unsigned char *)a1 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
    goto LABEL_67;
  }
  uint64_t v4 = *((unsigned __int16 *)a1 + 6);
  if (*((unsigned __int16 *)a1 + 5) <= v4)
  {
LABEL_67:
    uint64_t v63 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_69;
  }
  if (*((unsigned char *)a1 + 14) != 1)
  {
    uint64_t v63 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_69:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1164, v63);
  }
  uint64_t v6 = *a1;
  *((_WORD *)a1 + 6) = v4 + 1;
  uint64_t v7 = *(unsigned __int8 *)(v6 + v4);
  if (a3 == 2)
  {
    if (v7 != 1)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"handle_InquiryResult misinterpreted spec: expected 1 resp, got %d", v53, v54, v55, v56, v57, v58, v59, v7);
        uint64_t v60 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR)) {
          sub_100745764();
        }
      }
      return;
    }
    uint64_t v8 = 255;
  }
  else
  {
    uint64_t v8 = (14 * v7) | 1u;
    if (a3 == 1 && 15 * v7 + 1 == a2)
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"handle_InquiryResult misinterpreted spec: expected %d, got %d", v17, v18, v19, v20, v21, v22, v23, (14 * v7) | 1u);
        uint64_t v24 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      int v25 = 1;
      if (v7) {
        goto LABEL_20;
      }
      return;
    }
  }
  if (v8 != a2)
  {
    if (!sub_100058654()) {
      return;
    }
    sub_100056E24((uint64_t)"handle_InquiryResult bad parm length: expected %d, got %d", v45, v46, v47, v48, v49, v50, v51, v8);
    uint64_t v52 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v52, OS_LOG_TYPE_ERROR)) {
      return;
    }
    goto LABEL_10;
  }
  int v25 = 0;
  if (v7)
  {
LABEL_20:
    if (a3) {
      int v26 = v25;
    }
    else {
      int v26 = 1;
    }
    while (!*((unsigned char *)a1 + 15))
    {
      uint64_t v27 = *((unsigned __int16 *)a1 + 6);
      if (*((unsigned __int16 *)a1 + 5) - (int)v27 <= 5) {
        goto LABEL_54;
      }
      if (*((unsigned char *)a1 + 14) != 1)
      {
        uint64_t v61 = "(*pBs).__RWFlag == BYTESTREAM_READ";
        goto LABEL_56;
      }
      sub_100008A18((uint64_t)&v64, *a1 + v27, 6uLL);
      __int16 v28 = *((_WORD *)a1 + 6);
      *((_WORD *)a1 + 6) = v28 + 6;
      if (*((unsigned char *)a1 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_58:
        uint64_t v62 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_60:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1200, v62);
      }
      unsigned int v29 = *((unsigned __int16 *)a1 + 5);
      if (v29 <= (unsigned __int16)(v28 + 6)) {
        goto LABEL_58;
      }
      if (*((unsigned char *)a1 + 14) != 1)
      {
        uint64_t v62 = "(*pBs).__RWFlag == BYTESTREAM_READ";
        goto LABEL_60;
      }
      uint64_t v30 = *a1;
      *((_WORD *)a1 + 6) = v28 + 7;
      BYTE6(v64) = *(unsigned char *)(v30 + (unsigned __int16)(v28 + 6));
      if (v29 <= (unsigned __int16)(v28 + 7)) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1201, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      }
      unsigned __int16 v31 = v28 + 8;
      *((_WORD *)a1 + 6) = v28 + 8;
      HIBYTE(v64) = *(unsigned char *)(v30 + (unsigned __int16)(v28 + 7));
      if (v26)
      {
        if (v29 <= v31) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1206, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned __int16 v32 = v28 + 9;
        *((_WORD *)a1 + 6) = v32;
        char v33 = *(unsigned char *)(v30 + v31);
      }
      else
      {
        char v33 = 0;
        unsigned __int16 v32 = v28 + 8;
      }
      BYTE4(v65) = v33;
      if ((int)(v29 - v32) <= 2) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1208, "ByteStream_NumReadBytesAvail(*pBs) >= 3");
      }
      LODWORD(v65) = *(unsigned __int16 *)(v30 + v32) | (*(unsigned __int8 *)(v30 + v32 + 2) << 16);
      *((_WORD *)a1 + 6) = v32 + 3;
      if ((int)(v29 - (unsigned __int16)(v32 + 3)) < 2) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1209, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      HIWORD(v65) = *(_WORD *)(v30 + (unsigned __int16)(v32 + 3));
      unsigned __int16 v34 = v32 + 5;
      *((_WORD *)a1 + 6) = v32 + 5;
      uint64_t v66 = 0;
      BYTE5(v65) = 0;
      if (a3)
      {
        if (v29 <= v34) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1213, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        unsigned __int16 v35 = v32 + 6;
        *((_WORD *)a1 + 6) = v35;
        BYTE5(v65) = *(unsigned char *)(v30 + v34);
        if (a3 == 2)
        {
          if (v29 - 240 > 0x11)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"Extended Inquiry Result bad parm length: maximum expected %d, got %d", v36, v37, v38, v39, v40, v41, v42, 257);
              uint64_t v43 = sub_100050B4C(0x2Eu);
              if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
              {
                uint64_t v44 = sub_100050714();
                *(_DWORD *)int buf = 136446466;
                uint64_t v68 = v44;
                __int16 v69 = 1024;
                int v70 = 0xFFFF;
                _os_log_error_impl((void *)&_mh_execute_header, v43, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
              }
            }
          }
          else
          {
            uint64_t v66 = v30 + v35;
          }
        }
      }
      sub_10018311C((uint64_t)&v64);
      LODWORD(v7) = v7 - 1;
      if (!v7) {
        return;
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_54:
    uint64_t v61 = "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_56:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 1199, v61);
  }
}

uint64_t sub_10019B400(uint64_t a1, uint64_t a2, uint64_t *a3, int a4, _WORD *a5, uint64_t a6)
{
  if (!*(unsigned char *)(a2 + 4)) {
    return 0;
  }
  unint64_t v10 = 0;
  char v11 = 0;
  while (2)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
      unsigned int v12 = 0;
    }
    else
    {
      unsigned int v12 = *((unsigned __int16 *)a3 + 5) - *((unsigned __int16 *)a3 + 6);
    }
    switch(*(unsigned char *)(*(void *)(a2 + 8) + v10))
    {
      case 'a':
        if (v12 < 6)
        {
          if (v11) {
            uint64_t v14 = 0;
          }
          else {
            uint64_t v14 = 608;
          }
        }
        else
        {
          if (*((unsigned char *)a3 + 15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_105:
            uint64_t v43 = "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_107:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 403, v43);
          }
          uint64_t v13 = *((unsigned __int16 *)a3 + 6);
          if (*((unsigned __int16 *)a3 + 5) - (int)v13 <= 5) {
            goto LABEL_105;
          }
          if (*((unsigned char *)a3 + 14) != 1)
          {
            uint64_t v43 = "(*pBs).__RWFlag == BYTESTREAM_READ";
            goto LABEL_107;
          }
          sub_100008A18(a6, *a3 + v13, 6uLL);
          uint64_t v14 = 0;
          *((_WORD *)a3 + 6) += 6;
        }
        *(void *)a1 = a6;
        goto LABEL_79;
      case 'b':
      case 'd':
      case 'e':
      case 'g':
      case 'i':
      case 'j':
      case 'l':
      case 'm':
      case 'o':
      case 'p':
      case 'q':
      case 'r':
LABEL_92:
        sub_10025B8C0();
        uint64_t v14 = 620;
        goto LABEL_87;
      case 'c':
        if (v12 < 0xA) {
          goto LABEL_72;
        }
        *(void *)a1 = *a3 + *((unsigned __int16 *)a3 + 6);
        if (*((unsigned char *)a3 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_109:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 480, "ByteStream_NumReadBytesAvail(*pBs) >= (10)");
        }
        int v16 = *((unsigned __int16 *)a3 + 6);
        if (*((unsigned __int16 *)a3 + 5) - v16 <= 9) {
          goto LABEL_109;
        }
        uint64_t v14 = 0;
        __int16 v17 = v16 + 10;
        goto LABEL_71;
      case 'f':
        if (v12 < 8) {
          goto LABEL_72;
        }
        *(void *)a1 = *a3 + *((unsigned __int16 *)a3 + 6);
        if (*((unsigned char *)a3 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_111:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 465, "ByteStream_NumReadBytesAvail(*pBs) >= (8)");
        }
        int v18 = *((unsigned __int16 *)a3 + 6);
        if (*((unsigned __int16 *)a3 + 5) - v18 <= 7) {
          goto LABEL_111;
        }
        goto LABEL_70;
      case 'h':
        if (v12 < 2) {
          goto LABEL_64;
        }
        if (*((unsigned char *)a3 + 14) != 1)
        {
          uint64_t v44 = "(*pBs).__RWFlag == BYTESTREAM_READ";
          goto LABEL_115;
        }
        if (*((unsigned char *)a3 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_114:
          uint64_t v44 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_115:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 414, v44);
        }
        uint64_t v19 = *((unsigned __int16 *)a3 + 6);
        if (*((unsigned __int16 *)a3 + 5) - (int)v19 <= 1) {
          goto LABEL_114;
        }
        *a5 = *(_WORD *)(*a3 + v19);
        *((_WORD *)a3 + 6) += 2;
        uint64_t v14 = 0;
        *(void *)a1 = sub_100197864((unsigned __int16)*a5);
        goto LABEL_79;
      case 'k':
        if (v12 < 0x10) {
          goto LABEL_72;
        }
        *(void *)a1 = *a3 + *((unsigned __int16 *)a3 + 6);
        if (*((unsigned char *)a3 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_117:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 510, "ByteStream_NumReadBytesAvail(*pBs) >= (16)");
        }
        int v20 = *((unsigned __int16 *)a3 + 6);
        if (*((unsigned __int16 *)a3 + 5) - v20 <= 15) {
          goto LABEL_117;
        }
        uint64_t v14 = 0;
        __int16 v17 = v20 + 16;
        goto LABEL_71;
      case 'n':
        if (v12 >= 0xF8)
        {
          *(void *)a1 = *a3 + *((unsigned __int16 *)a3 + 6);
          if (*((unsigned char *)a3 + 15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_119:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 447, "ByteStream_NumReadBytesAvail(*pBs) >= (248)");
          }
          int v21 = *((unsigned __int16 *)a3 + 6);
          if (*((unsigned __int16 *)a3 + 5) - v21 <= 247) {
            goto LABEL_119;
          }
          uint64_t v14 = 0;
          *((_WORD *)a3 + 6) = v21 + 248;
          *(unsigned char *)(*(void *)a1 + 247) = 0;
          goto LABEL_79;
        }
LABEL_72:
        if ((v11 & 1) == 0) {
          goto LABEL_85;
        }
        uint64_t v14 = 0;
        *(void *)a1 = &unk_1007BA148;
        goto LABEL_74;
      case 's':
        if (v12)
        {
          if (*((unsigned char *)a3 + 15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_94:
            uint64_t v40 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_96:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 426, v40);
          }
          uint64_t v22 = *((unsigned __int16 *)a3 + 6);
          if (*((unsigned __int16 *)a3 + 5) <= v22) {
            goto LABEL_94;
          }
          if (*((unsigned char *)a3 + 14) != 1)
          {
            uint64_t v40 = "(*pBs).__RWFlag == BYTESTREAM_READ";
            goto LABEL_96;
          }
          uint64_t v23 = *a3;
          *((_WORD *)a3 + 6) = v22 + 1;
          int v24 = sub_1000262CC(*(unsigned __int8 *)(v23 + v22));
          uint64_t v14 = 0;
          *(_DWORD *)a1 = v24;
          v11 |= v24 != 0;
LABEL_79:
          BOOL v30 = v14 == 0;
          if (v14) {
            goto LABEL_86;
          }
          ++v10;
          a1 += 8;
          if (v10 >= *(unsigned __int8 *)(a2 + 4)) {
            goto LABEL_86;
          }
          continue;
        }
        if (v11)
        {
          uint64_t v14 = 0;
          *(_DWORD *)a1 = 638;
LABEL_74:
          char v11 = 1;
          goto LABEL_79;
        }
LABEL_85:
        BOOL v30 = 0;
        uint64_t v14 = 608;
LABEL_86:
        if (!v30)
        {
LABEL_87:
          if (*(unsigned __int16 *)(a2 + 2) != a4)
          {
            if (sub_100058654())
            {
              sub_100056E24((uint64_t)"missing parameters, expected %d, got %d", v31, v32, v33, v34, v35, v36, v37, *(unsigned __int16 *)(a2 + 2));
              uint64_t v38 = sub_100050B4C(0x2Eu);
              if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR)) {
                sub_100744F6C();
              }
            }
          }
        }
        return v14;
      case 't':
        if (!v12)
        {
LABEL_64:
          if (v11) {
            uint64_t v14 = 0;
          }
          else {
            uint64_t v14 = 608;
          }
          goto LABEL_79;
        }
        if (*((unsigned char *)a3 + 15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_98:
          uint64_t v41 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_100:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 523, v41);
        }
        uint64_t v15 = *((unsigned __int16 *)a3 + 6);
        if (*((unsigned __int16 *)a3 + 5) <= v15) {
          goto LABEL_98;
        }
        if (*((unsigned char *)a3 + 14) != 1)
        {
          uint64_t v41 = "(*pBs).__RWFlag == BYTESTREAM_READ";
          goto LABEL_100;
        }
        goto LABEL_48;
      default:
        switch(*(unsigned char *)(*(void *)(a2 + 8) + v10))
        {
          case '1':
            if (!v12) {
              goto LABEL_64;
            }
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_102:
              uint64_t v42 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_103:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 364, v42);
            }
            uint64_t v15 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) <= v15) {
              goto LABEL_102;
            }
            if (*((unsigned char *)a3 + 14) != 1)
            {
              uint64_t v42 = "(*pBs).__RWFlag == BYTESTREAM_READ";
              goto LABEL_103;
            }
LABEL_48:
            uint64_t v14 = 0;
            uint64_t v25 = *a3;
            *((_WORD *)a3 + 6) = v15 + 1;
            *(_DWORD *)a1 = *(unsigned __int8 *)(v25 + v15);
            goto LABEL_79;
          case '2':
            if (v12 < 2) {
              goto LABEL_64;
            }
            if (*((unsigned char *)a3 + 14) != 1)
            {
              uint64_t v45 = "(*pBs).__RWFlag == BYTESTREAM_READ";
              goto LABEL_123;
            }
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_122:
              uint64_t v45 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_123:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 374, v45);
            }
            uint64_t v26 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v26 <= 1) {
              goto LABEL_122;
            }
            uint64_t v14 = 0;
            int v27 = *(unsigned __int16 *)(*a3 + v26);
            *((_WORD *)a3 + 6) = v26 + 2;
            *(_DWORD *)a1 = v27;
            break;
          case '3':
            if (v12 < 3) {
              goto LABEL_64;
            }
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_125:
              uint64_t v46 = "ByteStream_NumReadBytesAvail(*pBs) >= 3";
LABEL_127:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 384, v46);
            }
            uint64_t v28 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v28 <= 2) {
              goto LABEL_125;
            }
            if (*((unsigned char *)a3 + 14) != 1)
            {
              uint64_t v46 = "(*pBs).__RWFlag == BYTESTREAM_READ";
              goto LABEL_127;
            }
            uint64_t v14 = 0;
            *(_DWORD *)a1 = *(unsigned __int16 *)(*a3 + v28) | (*(unsigned __int8 *)(*a3 + v28 + 2) << 16);
            __int16 v17 = *((_WORD *)a3 + 6) + 3;
LABEL_71:
            *((_WORD *)a3 + 6) = v17;
            goto LABEL_79;
          case '4':
            if (v12 < 4) {
              goto LABEL_64;
            }
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_129:
              uint64_t v47 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
LABEL_131:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 393, v47);
            }
            uint64_t v29 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - (int)v29 <= 3) {
              goto LABEL_129;
            }
            if (*((unsigned char *)a3 + 14) != 1)
            {
              uint64_t v47 = "(*pBs).__RWFlag == BYTESTREAM_READ";
              goto LABEL_131;
            }
            uint64_t v14 = 0;
            *(_DWORD *)a1 = *(_DWORD *)(*a3 + v29);
            __int16 v17 = *((_WORD *)a3 + 6) + 4;
            goto LABEL_71;
          case '8':
            if (v12 < 8) {
              goto LABEL_72;
            }
            *(void *)a1 = *a3 + *((unsigned __int16 *)a3 + 6);
            if (*((unsigned char *)a3 + 15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c");
LABEL_133:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hcievents.c", 495, "ByteStream_NumReadBytesAvail(*pBs) >= (8)");
            }
            int v18 = *((unsigned __int16 *)a3 + 6);
            if (*((unsigned __int16 *)a3 + 5) - v18 <= 7) {
              goto LABEL_133;
            }
LABEL_70:
            uint64_t v14 = 0;
            __int16 v17 = v18 + 8;
            goto LABEL_71;
          default:
            goto LABEL_92;
        }
        goto LABEL_79;
    }
  }
}

void sub_10019BD30(unsigned __int8 *a1)
{
  if (a1[16] != 3)
  {
    int v11 = 0;
    if (sub_100058694(*a1, &v11))
    {
      uint64_t v1 = sub_10019C2C4(v11);
      if (v1)
      {
        uint64_t v2 = v1;
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"%! (%d)", v3, v4, v5, v6, v7, v8, v9, v2);
          unint64_t v10 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR)) {
            sub_100744F6C();
          }
        }
      }
    }
  }
}

uint64_t sub_10019BDC8(unsigned __int8 *a1, int a2, uint64_t a3, int a4)
{
  if (a1[16] == 3) {
    return 0;
  }
  int v29 = 0;
  for (uint64_t i = sub_100058694(*a1, &v29); i; uint64_t i = sub_10019C25C(*a1, &v29))
  {
    int v10 = a1[17];
    switch(v10)
    {
      case 6:
        if (*(unsigned __int16 *)(i + 16) == a2) {
          goto LABEL_21;
        }
        break;
      case 7:
        if (*(_DWORD *)a3 == *(_DWORD *)(i + 16) && *(unsigned __int16 *)(a3 + 4) == *(unsigned __int16 *)(i + 20))
        {
LABEL_21:
          if (a4)
          {
            uint64_t v4 = sub_10019C2C4(v29);
            if (v4)
            {
              if (sub_100058654())
              {
                sub_100056E24((uint64_t)"%! (%d)", v21, v22, v23, v24, v25, v26, v27, v4);
                uint64_t v28 = sub_100050B4C(0x2Eu);
                if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
                  sub_100744F6C();
                }
              }
            }
            return v4;
          }
          return 0;
        }
        break;
      case 5:
        goto LABEL_21;
    }
  }
  if (a1[16] == 2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"%! (%d)", v12, v13, v14, v15, v16, v17, v18, 619);
      uint64_t v19 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  return 120;
}

void sub_10019BF40(void *a1, uint64_t a2, uint64_t a3, const char *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8, uint8_t a9)
{
  _os_log_fault_impl(a1, v9, OS_LOG_TYPE_FAULT, a4, &a9, 0xCu);
}

uint64_t sub_10019BF60()
{
  word_100A04D78 = 0;
  dword_100A04D7C = 0;
  byte_100A04D80 = 0;
  qword_100A04D88 = (uint64_t)sub_10010CE48(32 * *(unsigned __int8 *)(qword_100A19628 + 2));
  if (qword_100A04D88) {
    return 0;
  }
  else {
    return 106;
  }
}

void sub_10019BFB8(unsigned __int16 *a1)
{
  if (sub_100197698((uint64_t)a1) || sub_100197770((uint64_t)a1))
  {
    int v2 = 1;
  }
  else
  {
    if (!sub_100197740((uint64_t)a1))
    {
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCIExpEvQ_Flush: %x", v21, v22, v23, v24, v25, v26, v27, (uint64_t)a1);
        uint64_t v28 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
          sub_100749BC0();
        }
      }
      return;
    }
    int v2 = 0;
  }
  unint64_t v3 = (unsigned __int16)word_100A04D78;
  if (word_100A04D78)
  {
    uint64_t v4 = 32 * (unsigned __int16)word_100A04D78;
    do
    {
      int v5 = sub_100022214(*(unsigned __int16 *)(qword_100A04D88 + v4 - 26))[19];
      if (v5 == 6)
      {
        uint64_t v7 = qword_100A04D88;
        if (*(unsigned __int16 *)(qword_100A04D88 + v4 - 16) == *a1) {
          goto LABEL_18;
        }
      }
      else if (v5 == 7 && v2 != 0)
      {
        uint64_t v7 = qword_100A04D88;
        if (*((_DWORD *)a1 + 12) == *(_DWORD *)(qword_100A04D88 + v4 - 16)
          && a1[26] == *(unsigned __int16 *)(qword_100A04D88 + v4 - 12))
        {
LABEL_18:
          long long v29 = 0u;
          long long v30 = 0u;
          uint64_t v9 = v7 + v4;
          long long v10 = *(_OWORD *)(v9 - 16);
          long long v29 = *(_OWORD *)(v9 - 32);
          long long v30 = v10;
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Handle disconnected: %d, expected %2x", v11, v12, v13, v14, v15, v16, v17, *a1);
            uint64_t v18 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              int v20 = sub_100050714();
              *(_DWORD *)int buf = 136446466;
              uint64_t v32 = v20;
              __int16 v33 = 1024;
              int v34 = 634;
              _os_log_error_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }
          sub_100025F78(v3 - 1);
          if (BYTE8(v29) > 0x2Cu
            || ((1 << SBYTE8(v29)) & 0x100000100028) == 0
            && (BYTE8(v29) != 15 || WORD3(v29) > 0x2Au || ((1 << SBYTE6(v29)) & 0x60030000370) == 0))
          {
            sub_100199970(634, &v29);
          }
        }
      }
      v4 -= 32;
    }
    while (v3-- > 1);
  }
}

uint64_t sub_10019C244(uint64_t a1, uint64_t a2, _OWORD *a3)
{
  return sub_100025E68(15, a1, a2, a3);
}

uint64_t sub_10019C25C(int a1, int *a2)
{
  uint64_t v2 = *a2;
  if ((int)v2 + 1 >= (unsigned __int16)word_100A04D78) {
    return 0;
  }
  uint64_t v3 = v2 + 1;
  for (uint64_t i = qword_100A04D88 + 32 * v2 + 32;
        *(unsigned __int8 *)(i + 8) != a1 && *(unsigned __int8 *)(i + 9) != a1;
        i += 32)
  {
    if (++v3 >= (unsigned __int16)word_100A04D78) {
      return 0;
    }
  }
  *a2 = v3;
  return i;
}

uint64_t sub_10019C2C4(int a1)
{
  uint64_t v1 = sub_100025F78(a1);
  sub_10002670C();
  return v1;
}

void sub_10019C2F0()
{
  for (__int16 i = word_100A04D78; word_100A04D78; __int16 i = word_100A04D78)
  {
    word_100A04D78 = i - 1;
    sub_100199970(129, qword_100A04D88 + 32 * (unsigned __int16)(i - 1));
  }
  byte_100A04D80 = 0;
}

void *sub_10019C348(void *result)
{
  off_100A04D90 = result;
  return result;
}

void sub_10019C354(uint64_t a1)
{
  uint64_t v1 = *(void *)(a1 + 8);
  sub_100199970(621, v1);
  int v2 = *(unsigned __int8 *)(v1 + 8);
  if (v2 == 15)
  {
    if (byte_100A196C1) {
      return;
    }
    goto LABEL_9;
  }
  if (v2 == 14 && byte_100A196C1 == 0)
  {
LABEL_9:
    byte_100A196C1 = 1;
    sub_100026DA8((uint64_t)sub_100026D78, 0, 0);
  }
}

uint64_t sub_10019C3F8()
{
  dword_100A04D7C = 0;
  return sub_10002670C();
}

void sub_10019C404(char a1, __int16 a2, __int16 a3, uint64_t a4)
{
  if (byte_100A19730)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Failed to add external transport - too many alreay registered.", v4, v5, v6, v7, v8, v9, v10, v12);
      uint64_t v11 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
  }
  else
  {
    word_100A19720 = a2;
    word_100A19722 = a2;
    word_100A19724 = a3;
    byte_100A19726 = 1;
    byte_100A19727 = a1;
    qword_100A19728 = a4;
    byte_100A19738 = 1;
    byte_100A19730 = 1;
  }
}

void sub_10019C49C()
{
  WORD3(xmmword_100A196D8) = 1;
  if (BYTE14(xmmword_100A196D8)) {
    BOOL v0 = WORD5(xmmword_100A196D8) > 2u;
  }
  else {
    BOOL v0 = 0;
  }
  char v1 = v0;
  byte_100A19739 = v1;
}

void sub_10019C4CC()
{
  WORD3(xmmword_100A196D8) = 0;
  if (BYTE14(xmmword_100A196D8)) {
    BOOL v0 = WORD5(xmmword_100A196D8) == 0;
  }
  else {
    BOOL v0 = 1;
  }
  char v1 = !v0;
  byte_100A19739 = v1;
}

BOOL sub_10019C4F8()
{
  return !WORD3(xmmword_100A196D8) || WORD5(xmmword_100A196D8) > 1u;
}

uint64_t sub_10019C518(uint64_t result)
{
  BYTE1(xmmword_100A196D8) = result;
  return result;
}

void sub_10019C524(uint64_t a1)
{
  if (dword_100A19630 == 2)
  {
    if (BYTE14(xmmword_100A196D8[0])
      && (sub_10025B8C0(), BYTE14(xmmword_100A196D8[0]))
      && sub_100058654()
      && (sub_100056E24((uint64_t)"%! (%d)", v2, v3, v4, v5, v6, v7, v8, 614),
          uint64_t v9 = sub_100050B4C(0x2Eu),
          os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)))
    {
      sub_100749C4C();
      if (a1) {
        goto LABEL_7;
      }
    }
    else if (a1)
    {
LABEL_7:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"ACL transmit error (%!)", v10, v11, v12, v13, v14, v15, v16, a1);
        uint64_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100748324();
        }
      }
    }
    BYTE14(xmmword_100A196D8[0]) = 1;
    BOOL v18 = WORD5(xmmword_100A196D8[0]) != 0;
    if (WORD3(xmmword_100A196D8[0])) {
      BOOL v18 = WORD5(xmmword_100A196D8[0]) > 2u;
    }
    byte_100A19739 = v18;
    if (v18) {
      (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 1);
    }
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"HCI not initialized, ignoring AclPacketSent event", v19, v20, v21, v22, v23, v24, v25, v27);
    uint64_t v26 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      sub_100749CC4();
    }
  }
}

void sub_10019C6AC(uint64_t a1)
{
  if (dword_100A19630 == 2)
  {
    if (byte_100A196F6
      && (sub_10025B8C0(), byte_100A196F6)
      && sub_100058654()
      && (sub_100056E24((uint64_t)"%! (%d)", v2, v3, v4, v5, v6, v7, v8, 614),
          uint64_t v9 = sub_100050B4C(0x2Eu),
          os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)))
    {
      sub_100749C4C();
      if (a1)
      {
LABEL_7:
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"SCO transmit error (%!)", v10, v11, v12, v13, v14, v15, v16, a1);
          uint64_t v17 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
            sub_100748324();
          }
        }
      }
    }
    else if (a1)
    {
      goto LABEL_7;
    }
    byte_100A196F6 = 1;
    sub_10018B238();
    return;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"HCI not initialized, ignoring ScoPacketSent event", v18, v19, v20, v21, v22, v23, v24, v26);
    uint64_t v25 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
      sub_100749CC4();
    }
  }
}

void sub_10019C7F0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, void *a5)
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v5 = dword_100A19630 == 2;
  }
  else {
    BOOL v5 = 0;
  }
  if (!v5)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIIfc_AclPacketReceived, HCI not initialized - discarding data", v6, v7, v8, v9, v10, v11, v12, v60);
      uint64_t v13 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
LABEL_7:
        sub_100749D3C();
        return;
      }
    }
    return;
  }
  if (!a2) {
    return;
  }
  int v16 = a4;
  unsigned int v18 = a1;
  uint64_t v19 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t))off_100A19690;
  if (off_100A19690)
  {
    v19(a4, a1, a2, a3);
    return;
  }
  uint64_t v20 = a1 & 0xFFF;
  if ((a1 & 0x3000) == 0x2000)
  {
    uint64_t v21 = 2;
  }
  else if ((a1 & 0x3000) == 0x1000)
  {
    uint64_t v21 = 1;
  }
  else if ((a1 & 0x3000) != 0)
  {
    uint64_t v21 = 3;
  }
  else if ((byte_100A195D2 & 0x40) != 0)
  {
    uint64_t v21 = 0;
  }
  else
  {
    uint64_t v21 = 3;
  }
  uint64_t v22 = sub_100197864(a1 & 0xFFF);
  if (sub_1001F7D74() <= 0x12 && !v22)
  {
    sub_10025B8C0();
LABEL_35:
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"connection handle %p is invalid, ignoring ACL packet.", v33, v34, v35, v36, v37, v38, v39, 0);
      uint64_t v40 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (!v22) {
    goto LABEL_35;
  }
  uint64_t v23 = (v18 >> 12) & 4;
  int v24 = *((unsigned __int8 *)v22 + 2);
  if (v24 == 1)
  {
    sub_10025B8C0();
    int v24 = *((unsigned __int8 *)v22 + 2);
  }
  if (v24 != 8)
  {
    if (v24 == 4)
    {
      ++HIWORD(dword_100A04D9E);
      LOWORD(dword_100A04D9E) = v20;
      if (*((unsigned char *)v22 + 124) == 6 && (v16 != 6 || *a5 >= *((void *)v22 + 34)))
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received ACL data for disconnecting handle %d, discarding packet", v25, v26, v27, v28, v29, v30, v31, v20);
          uint64_t v59 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v59, OS_LOG_TYPE_ERROR)) {
            sub_100749D3C();
          }
        }
      }
      else
      {
        (*(void (**)(long long *, uint64_t, uint64_t, uint64_t, uint64_t, BOOL, void *))(qword_100A19638 + 8))(v22, v21, v23, a3, a2, v16 == 6, a5);
      }
      if (!*(unsigned char *)(qword_100A19628 + 9)) {
        return;
      }
      uint64_t v57 = &dword_100A04D9E;
    }
    else
    {
      if (v24)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received ACL data for unknown handle %d, discarding packet", v49, v50, v51, v52, v53, v54, v55, v20);
          uint64_t v56 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR)) {
            sub_100749DB4();
          }
        }
        return;
      }
      ++HIWORD(dword_100A04D98);
      LOWORD(dword_100A04D98) = v20;
      if (*((unsigned char *)v22 + 54) == 6)
      {
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"Received ACL data for disconnecting handle %d, discarding packet", v25, v26, v27, v28, v29, v30, v31, v20);
          uint64_t v32 = sub_100050B4C(0x2Eu);
          if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR)) {
            sub_100749D3C();
          }
        }
      }
      else
      {
        (*(void (**)(long long *, uint64_t, uint64_t, uint64_t, uint64_t, void, void *))(qword_100A19638 + 8))(v22, v21, v23, a3, a2, 0, a5);
      }
      if (!*(unsigned char *)(qword_100A19628 + 7)) {
        return;
      }
      uint64_t v57 = &dword_100A04D98;
    }
    sub_10019CC5C((unsigned __int16 *)v57, v25, v26, v27, v28, v29, v30, v31);
    return;
  }
  if (*((unsigned char *)v22 + 60) == 6)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received Other data for disconnecting handle %d, discarding packet", v41, v42, v43, v44, v45, v46, v47, v20);
      uint64_t v48 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR)) {
        goto LABEL_7;
      }
    }
  }
  else
  {
    uint64_t v58 = *(void (**)(long long *, uint64_t, uint64_t, uint64_t, uint64_t, void, void *))(qword_100A19638 + 8);
    v58(v22, v21, v23, a3, a2, 0, a5);
  }
}

void sub_10019CC5C(unsigned __int16 *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!*((unsigned char *)a1 + 4) && a1[1])
  {
    uint64_t v9 = sub_10001BDE0(95, 0, a3, a4, a5, a6, a7, a8, *a1);
    if (v9)
    {
      uint64_t v10 = v9;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_HostNumberOfCompletedPackets failed: %!", v11, v12, v13, v14, v15, v16, v17, v10);
        unsigned int v18 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR)) {
          sub_100749E34();
        }
      }
    }
    else
    {
      a1[1] = 0;
    }
  }
}

uint64_t sub_10019CCFC(uint64_t a1)
{
  uint64_t v2 = a1 & 0xFFF;
  uint64_t v3 = sub_100197864(a1 & 0xFFF);
  if (v3)
  {
    uint64_t result = *((unsigned __int8 *)v3 + 2);
    if (!result) {
      return result;
    }
    if (result == 4)
    {
      if ((~a1 & 0x3000) != 0) {
        return 1;
      }
      else {
        return 2;
      }
    }
    if (!sub_100058654()) {
      return 4;
    }
    sub_100056E24((uint64_t)"lmHandle 0x%04X found as connectionHandle 0x%08X of non ACL/LE kind????\n", v6, v7, v8, v9, v10, v11, v12, v2);
    uint64_t v13 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v13, OS_LOG_TYPE_ERROR)) {
      return 4;
    }
LABEL_18:
    sub_100749D3C();
    return 4;
  }
  if (!off_100A19698)
  {
    if (!sub_100058654()) {
      return 4;
    }
    sub_100056E24((uint64_t)"No stack handle found for lmHandle 0x%04X, falling back to KIND_UNKNOWN\n", v14, v15, v16, v17, v18, v19, v20, v2);
    uint64_t v21 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
      return 4;
    }
    goto LABEL_18;
  }
  uint64_t result = off_100A19698(a1);
  if ((~a1 & 0x3000) != 0) {
    uint64_t v5 = 1;
  }
  else {
    uint64_t v5 = 2;
  }
  if (result == 1) {
    return v5;
  }
  return result;
}

void sub_10019CE28(unsigned __int16 *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (a2)
  {
    if (a2 > 3)
    {
      if (!a1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 728, "buf");
      }
      uint64_t v16 = *a1;
      uint64_t v17 = a1[1];
      if (*(unsigned char *)(a4 + 8))
      {
        int v34 = 0;
        long long v32 = 0u;
        long long v33 = 0u;
        long long v30 = 0u;
        long long v31 = 0u;
        uint64_t v18 = "HCI_ACL";
        if (a3 == 6) {
          uint64_t v18 = "HCI_ACL_TS";
        }
        *(_OWORD *)__str = 0uLL;
        long long v29 = 0uLL;
        snprintf(__str, 0x64uLL, "BT Controller %s wakeupCause (handle=0x%04X dataLen=%d)", v18, v16, v17);
        sub_10025B778("OI_HCIFlow_AclPacketReceived: %s", __str);
        sub_100116128(__str);
      }
      uint64_t v19 = (a2 - 4);
      if (v19 == v17)
      {
        sub_10019C7F0(v16, v17, (uint64_t)(a1 + 2), a3, (void *)a4);
        qword_100A04DB0 = sub_10010BA04();
        if (!dword_100A04DB8)
        {
          sub_10010C770();
          sub_1000268E4((uint64_t)sub_10019FB60, 0, 2, &dword_100A04DB8);
        }
        sub_100025E20();
      }
      else if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Potentially malicious packet received (actually %d bytes, but claims it is %d bytes), ignoring packet", v20, v21, v22, v23, v24, v25, v26, v19);
        uint64_t v27 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Short ACL packet received (%d bytes), ignoring packet", v5, v6, v7, v8, v9, v10, v11, a2);
      uint64_t v12 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100749EB4();
      }
    }
  }
}

void sub_10019D030(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v4 = dword_100A19630 == 2;
  }
  else {
    BOOL v4 = 0;
  }
  if (!v4)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIIfc_ScoPacketReceived, HCI not initialized - discarding data, status %!", v5, v6, v7, v8, v9, v10, v11, 408);
      uint64_t v12 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    return;
  }
  unsigned int v16 = a1;
  uint64_t v17 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))off_100A19690;
  if (off_100A19690)
  {
    v17(3, a1, a2, a3, a4);
    return;
  }
  if (*(unsigned char *)(qword_100A19628 + 8))
  {
    ++HIWORD(dword_100A04DA4);
    LOWORD(dword_100A04DA4) = a1 & 0xFFF;
  }
  uint64_t v18 = sub_100197864(a1 & 0xFFF);
  if (v18 && ((uint64_t v19 = (uint64_t)v18, *((unsigned char *)v18 + 2) == 1) || (sub_10025B8C0(), *(unsigned char *)(v19 + 2) == 1)))
  {
    if (!*(unsigned char *)(v19 + 56))
    {
      uint64_t v29 = *(void *)(v19 + 48);
      if (v29)
      {
        if (*(unsigned char *)(v29 + 54) != 6)
        {
          sub_10018B500(v19, a3, a2, (v16 >> 12) & 3, a4);
          goto LABEL_24;
        }
      }
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Received SCO data for disconnecting handle %d, discarding packet. Status %!", v20, v21, v22, v23, v24, v25, v26, v16 & 0xFFF);
      uint64_t v27 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
LABEL_23:
      }
        sub_100745764();
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Received SCO data for unknown handle %d, discarding packet. Status %!", v20, v21, v22, v23, v24, v25, v26, v16 & 0xFFF);
    uint64_t v28 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
      goto LABEL_23;
    }
  }
LABEL_24:
  if (*(unsigned char *)(qword_100A19628 + 8)) {
    sub_10019CC5C((unsigned __int16 *)&dword_100A04DA4, v20, v21, v22, v23, v24, v25, v26);
  }
}

void sub_10019D274(unsigned __int16 *a1, uint64_t a2, uint64_t a3)
{
  if (a2 > 2)
  {
    if (!a1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 847, "buf");
    }
    uint64_t v14 = *a1;
    int v15 = byte_100A04DAA;
    if (byte_100A04DAA)
    {
      if (a2 <= 3) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 857, "ByteStream_NumReadBytesAvail(bs) >= 2");
      }
      unsigned __int16 v16 = a1[1];
      uint64_t v17 = 4;
    }
    else
    {
      unsigned __int16 v16 = *((unsigned __int8 *)a1 + 2);
      uint64_t v17 = 3;
    }
    if (*(unsigned char *)(a3 + 8))
    {
      int v35 = 0;
      long long v33 = 0u;
      long long v34 = 0u;
      long long v31 = 0u;
      long long v32 = 0u;
      int v18 = v16;
      *(_OWORD *)__str = 0u;
      long long v30 = 0u;
      snprintf(__str, 0x64uLL, "BT Controller HCI_SCO wakeupCause (handle=0x%04X dataLen=%d)", v14, v16);
      sub_10025B778("OI_HCIFlow_ScoPacketReceived: %s", __str);
      sub_100116128(__str);
      int v15 = byte_100A04DAA;
    }
    else
    {
      int v18 = v16;
    }
    if (v15) {
      int v19 = -4;
    }
    else {
      int v19 = -3;
    }
    uint64_t v20 = (v19 + a2);
    if (v20 == v18)
    {
      sub_10019D030(v14, v16, (uint64_t)a1 + v17, a3);
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Potentially malicious packet received (actually %d bytes, but claims it is %d bytes), ignoring packet", v21, v22, v23, v24, v25, v26, v27, v20);
      uint64_t v28 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Short SCO packet received (%d bytes), ignoring packet. Status %!", v4, v5, v6, v7, v8, v9, v10, a2);
    uint64_t v11 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
}

uint64_t sub_10019D478(uint64_t a1)
{
  if (sub_100197698(a1))
  {
    if (*(unsigned char *)(a1 + 26)) {
      return 1288;
    }
    else {
      return 679;
    }
  }
  else
  {
    BOOL v3 = sub_100197770(a1);
    unsigned __int16 v2 = word_100A19704;
    if (!v3) {
      return 0;
    }
  }
  return v2;
}

uint64_t sub_10019D4D4(unsigned __int16 *a1, unsigned int a2, int a3, uint64_t a4)
{
  if (sub_100197698((uint64_t)a1))
  {
    if (DWORD2(xmmword_100A19860)) {
      BOOL v8 = dword_100A19630 == 2;
    }
    else {
      BOOL v8 = 0;
    }
    if (!v8) {
      return 103;
    }
    if (!BYTE14(xmmword_100A196D8[0]))
    {
LABEL_10:
      if (!sub_100058654()) {
        return 613;
      }
      sub_100056E24((uint64_t)"writeAclData, transmit is not ready", v9, v10, v11, v12, v13, v14, v15, v138);
      unsigned __int16 v16 = sub_100050B4C(0x2Eu);
      if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR)) {
        return 613;
      }
      goto LABEL_12;
    }
    if (WORD3(xmmword_100A196D8[0]))
    {
      if (WORD5(xmmword_100A196D8[0]) <= 2u) {
        goto LABEL_10;
      }
    }
    else if (!WORD5(xmmword_100A196D8[0]))
    {
      goto LABEL_10;
    }
    if (*(unsigned __int16 *)(a4 + 4) >= WORD6(xmmword_100A196D8[0])) {
      unsigned int v32 = WORD6(xmmword_100A196D8[0]);
    }
    else {
      unsigned int v32 = *(unsigned __int16 *)(a4 + 4);
    }
    if (a3 != 2)
    {
      if (a3 != 1)
      {
        if (a3) {
          return 101;
        }
        if (*((unsigned char *)a1 + 2) || (int v96 = *a1, v96 == 0xFFFF))
        {
          if (!sub_100058654()) {
            return 601;
          }
          sub_100056E24((uint64_t)"writeAclData, %d is not an ACL connection handle", v33, v34, v35, v36, v37, v38, v39, *a1);
          uint64_t v40 = sub_100050B4C(0x2Eu);
          if (!os_log_type_enabled(v40, OS_LOG_TYPE_ERROR)) {
            return 601;
          }
          goto LABEL_143;
        }
        if (*((unsigned char *)a1 + 152) == 2) {
          ++WORD2(xmmword_100A196D8[0]);
        }
        __int16 v97 = v96 & 0xFFF;
LABEL_118:
        if (a2)
        {
          if (a2 != 1)
          {
            if (a2 == 2)
            {
              v97 |= 0x2000u;
              goto LABEL_126;
            }
            return 101;
          }
          v97 |= 0x1000u;
        }
        else if ((byte_100A195D2 & 0x40) == 0)
        {
          sub_10025B8C0();
        }
LABEL_126:
        int v100 = *((unsigned __int8 *)a1 + 54);
        if (v100 == 6)
        {
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"writeAclData, handle %d is disconnecting.  Sending anyway", v109, v110, v111, v112, v113, v114, v115, *a1);
            uint64_t v116 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v116, OS_LOG_TYPE_ERROR)) {
              sub_10074A01C();
            }
          }
        }
        else if (v100 == 7)
        {
          if (!sub_100058654()) {
            return 601;
          }
          sub_100056E24((uint64_t)"writeAclData, handle %d is disconnected.  discarding", v101, v102, v103, v104, v105, v106, v107, *a1);
          uint64_t v108 = sub_100050B4C(0x2Eu);
          if (!os_log_type_enabled(v108, OS_LOG_TYPE_ERROR)) {
            return 601;
          }
          goto LABEL_143;
        }
        if (off_100A19690)
        {
          uint64_t result = 629;
          goto LABEL_171;
        }
        uint64_t result = sub_1000228AC(2, v97, a4, v32);
        if (result != 625)
        {
          if (result) {
            goto LABEL_171;
          }
          BYTE14(xmmword_100A196D8[0]) = 0;
        }
        --WORD5(xmmword_100A196D8[0]);
        ++a1[8];
        ++WORD1(xmmword_100A196D8[0]);
        (*(void (**)(unsigned __int16 *))qword_100A19638)(a1);
        uint64_t result = 0;
LABEL_171:
        char v136 = BYTE14(xmmword_100A196D8[0]);
        if (BYTE14(xmmword_100A196D8[0]))
        {
          if (WORD3(xmmword_100A196D8[0])) {
            char v136 = WORD5(xmmword_100A196D8[0]) > 2u;
          }
          else {
            char v136 = WORD5(xmmword_100A196D8[0]) != 0;
          }
        }
LABEL_175:
        byte_100A19739 = v136;
        return result;
      }
      if (&xmmword_100A04A30 != (long long *)a1)
      {
        if (!sub_100058654()) {
          return 601;
        }
        sub_100056E24((uint64_t)"writeAclData not the active broadcast connection handle", v51, v52, v53, v54, v55, v56, v57, v138);
        uint64_t v58 = sub_100050B4C(0x2Eu);
        if (!os_log_type_enabled(v58, OS_LOG_TYPE_ERROR)) {
          return 601;
        }
        goto LABEL_143;
      }
      unsigned __int16 v98 = *a1;
      __int16 v99 = 0x4000;
LABEL_117:
      __int16 v97 = v99 & 0xF000 | v98 & 0xFFF;
      goto LABEL_118;
    }
    if (&xmmword_100A04B80 == (long long *)a1)
    {
      unsigned __int16 v98 = *a1;
      __int16 v99 = 0x8000;
      goto LABEL_117;
    }
    if (!sub_100058654()) {
      return 601;
    }
    sub_100056E24((uint64_t)"writeAclData not the piconet broadcast connection handle", v43, v44, v45, v46, v47, v48, v49, v138);
    uint64_t v50 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v50, OS_LOG_TYPE_ERROR)) {
      return 601;
    }
LABEL_143:
    sub_100749FA4();
    return 601;
  }
  if (!sub_100197770((uint64_t)a1))
  {
    if (sub_1001977A0((uint64_t)a1))
    {
      uint64_t v19 = byte_100A19730;
      if (byte_100A19730)
      {
        for (__int16 i = &qword_100A19728; *((_DWORD *)a1 + 14) != *((unsigned __int8 *)i - 1); i += 2)
        {
          if (!--v19) {
            return 105;
          }
        }
        if (*(unsigned __int16 *)(a4 + 4) >= *((unsigned __int16 *)i - 2)) {
          uint64_t v41 = *((unsigned __int16 *)i - 2);
        }
        else {
          uint64_t v41 = *(unsigned __int16 *)(a4 + 4);
        }
        if (a2 >= 2) {
          sub_10025B8C0();
        }
        uint64_t result = ((uint64_t (*)(void, BOOL, uint64_t, uint64_t))*i)(*a1, a2 == 0, a4, v41);
        if (result != 625)
        {
          if (result)
          {
LABEL_64:
            byte_100A19738 = *((unsigned char *)i - 2);
            return result;
          }
          *((unsigned char *)i - 2) = 0;
        }
        --*((_WORD *)i - 3);
        ++WORD1(xmmword_100A196D8[0]);
        ++a1[8];
        (*(void (**)(unsigned __int16 *))qword_100A19638)(a1);
        uint64_t result = 0;
        goto LABEL_64;
      }
    }
    else if (sub_100058654())
    {
      sub_100056E24((uint64_t)"Can't write to unknown handle type.", v24, v25, v26, v27, v28, v29, v30, v138);
      long long v31 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return 105;
  }
  if (DWORD2(xmmword_100A19860)) {
    BOOL v18 = dword_100A19630 == 2;
  }
  else {
    BOOL v18 = 0;
  }
  if (!v18) {
    return 103;
  }
  int v21 = LOBYTE(xmmword_100A196D8[0]);
  if (WORD4(xmmword_100A196D8[0])) {
    BOOL v22 = LOBYTE(xmmword_100A196D8[0]) == 0;
  }
  else {
    BOOL v22 = 1;
  }
  if (v22 && word_100A19700 == 0)
  {
    sub_10025B8C0();
    int v21 = LOBYTE(xmmword_100A196D8[0]);
  }
  if (v21)
  {
    if (BYTE14(xmmword_100A196D8[0]))
    {
      if (WORD3(xmmword_100A196D8[0]))
      {
        if (WORD5(xmmword_100A196D8[0]) > 2u) {
          goto LABEL_79;
        }
      }
      else if (WORD5(xmmword_100A196D8[0]))
      {
        goto LABEL_79;
      }
    }
  }
  else if (byte_100A19706 && word_100A19702)
  {
    unsigned int v42 = *(unsigned __int16 *)(a4 + 4);
    if (a2 == 3) {
      goto LABEL_88;
    }
    goto LABEL_85;
  }
  if (!*((unsigned char *)a1 + 129))
  {
    if (!sub_100058654()) {
      return 613;
    }
    sub_100056E24((uint64_t)"writeLeData, transmit is not ready", v60, v61, v62, v63, v64, v65, v66, v138);
    uint64_t v67 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v67, OS_LOG_TYPE_ERROR)) {
      return 613;
    }
LABEL_12:
    sub_100749F2C();
    return 613;
  }
LABEL_79:
  unsigned int v42 = *(unsigned __int16 *)(a4 + 4);
  if (a2 == 3) {
    goto LABEL_88;
  }
  if (v21)
  {
    unsigned int v59 = WORD6(xmmword_100A196D8[0]);
    goto LABEL_86;
  }
LABEL_85:
  unsigned int v59 = (unsigned __int16)word_100A19704;
LABEL_86:
  if (v42 >= v59) {
    unsigned int v42 = v59;
  }
LABEL_88:
  if (a3 == 2)
  {
    if (&xmmword_100A04B80 != (long long *)a1)
    {
      if (!sub_100058654()) {
        return 601;
      }
      sub_100056E24((uint64_t)"writeLeData not the piconet broadcast connection handle", v70, v71, v72, v73, v74, v75, v76, v138);
      uint64_t v77 = sub_100050B4C(0x2Eu);
      if (!os_log_type_enabled(v77, OS_LOG_TYPE_ERROR)) {
        return 601;
      }
      goto LABEL_143;
    }
    unsigned __int16 v94 = *a1;
    __int16 v95 = 0x8000;
    goto LABEL_107;
  }
  if (a3 == 1)
  {
    if (&xmmword_100A04A30 != (long long *)a1)
    {
      if (!sub_100058654()) {
        return 601;
      }
      sub_100056E24((uint64_t)"writeLeData not the active broadcast connection handle", v78, v79, v80, v81, v82, v83, v84, v138);
      int v85 = sub_100050B4C(0x2Eu);
      if (!os_log_type_enabled(v85, OS_LOG_TYPE_ERROR)) {
        return 601;
      }
      goto LABEL_143;
    }
    unsigned __int16 v94 = *a1;
    __int16 v95 = 0x4000;
LABEL_107:
    __int16 v69 = v95 & 0xF000 | v94 & 0xFFF;
    goto LABEL_108;
  }
  if (a3) {
    return 101;
  }
  if (*((unsigned char *)a1 + 2) != 4 || (int v68 = *a1, v68 == 0xFFFF))
  {
    if (!sub_100058654()) {
      return 601;
    }
    sub_100056E24((uint64_t)"writeLeData, %d is not an LE connection handle", v86, v87, v88, v89, v90, v91, v92, *a1);
    uint64_t v93 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v93, OS_LOG_TYPE_ERROR)) {
      return 601;
    }
    goto LABEL_143;
  }
  __int16 v69 = v68 & 0xFFF;
LABEL_108:
  switch(a2)
  {
    case 0u:
      if ((byte_100A195D2 & 0x40) == 0) {
        sub_10025B8C0();
      }
      break;
    case 1u:
      v69 |= 0x1000u;
      break;
    case 2u:
      v69 |= 0x2000u;
      break;
    case 3u:
      v69 |= 0x3000u;
      break;
    default:
      return 101;
  }
  int v117 = *((unsigned __int8 *)a1 + 124);
  if (v117 == 6)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"writeLeData, handle %d is disconnecting.  Sending anyway", v126, v127, v128, v129, v130, v131, v132, *a1);
      uint64_t v133 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v133, OS_LOG_TYPE_ERROR)) {
        sub_10074A01C();
      }
    }
  }
  else if (v117 == 7)
  {
    if (!sub_100058654()) {
      return 601;
    }
    sub_100056E24((uint64_t)"writeLeData, handle %d is disconnected.  discarding", v118, v119, v120, v121, v122, v123, v124, *a1);
    uint64_t v125 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v125, OS_LOG_TYPE_ERROR)) {
      return 601;
    }
    goto LABEL_143;
  }
  if (off_100A19690)
  {
    uint64_t result = 629;
    goto LABEL_160;
  }
  uint64_t result = sub_1000228AC(2, v69, a4, v42);
  if (result != 625)
  {
    if (result) {
      goto LABEL_160;
    }
    uint64_t v134 = 14;
    if (!LOBYTE(xmmword_100A196D8[0])) {
      uint64_t v134 = 46;
    }
    *((unsigned char *)xmmword_100A196D8 + v134) = 0;
  }
  if (!*((unsigned char *)a1 + 129))
  {
    uint64_t v135 = 10;
    if (!LOBYTE(xmmword_100A196D8[0])) {
      uint64_t v135 = 42;
    }
    --*(_WORD *)((char *)xmmword_100A196D8 + v135);
    ++WORD1(xmmword_100A196D8[0]);
    ++a1[8];
  }
  (*(void (**)(unsigned __int16 *))qword_100A19638)(a1);
  uint64_t result = 0;
LABEL_160:
  if (LOBYTE(xmmword_100A196D8[0]))
  {
    char v136 = BYTE14(xmmword_100A196D8[0]);
    if (BYTE14(xmmword_100A196D8[0]))
    {
      char v136 = WORD5(xmmword_100A196D8[0]) != 0;
      if (WORD3(xmmword_100A196D8[0])) {
        char v136 = WORD5(xmmword_100A196D8[0]) > 2u;
      }
    }
    goto LABEL_175;
  }
  BOOL v137 = byte_100A19706 && word_100A19702 || *((unsigned char *)a1 + 129) != 0;
  byte_100A1973A = v137;
  return result;
}

uint64_t sub_10019DE9C(_WORD *a1, uint64_t a2, unsigned int a3)
{
  if (sub_100197770((uint64_t)a1))
  {
    __int16 v6 = *a1 | 0x3000;
    return sub_1000228AC(2, v6, a2, a3);
  }
  else
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"LE connection handle is no longer valid. Dropping LEA data.", v8, v9, v10, v11, v12, v13, v14, v16);
      uint64_t v15 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    return 601;
  }
}

uint64_t sub_10019DF4C(unsigned __int16 *a1, char *a2, size_t a3, char a4)
{
  if (!sub_100197740((uint64_t)a1))
  {
    if (!sub_100058654()) {
      return 601;
    }
    sub_100056E24((uint64_t)"SCO connection handle is no longer valid. Dropping SCO data.", v10, v11, v12, v13, v14, v15, v16, v63);
    uint64_t v17 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      return 601;
    }
    goto LABEL_9;
  }
  if (DWORD2(xmmword_100A19860)) {
    BOOL v8 = dword_100A19630 == 2;
  }
  else {
    BOOL v8 = 0;
  }
  if (!v8) {
    return 103;
  }
  if (!byte_100A196F6) {
    return 613;
  }
  if (!a1 || *((unsigned char *)a1 + 2) != 1)
  {
    if (!sub_100058654()) {
      return 601;
    }
    uint64_t v9 = 601;
    sub_100056E24((uint64_t)"0x%x is not SCO connection handle, retval %!", v27, v28, v29, v30, v31, v32, v33, (uint64_t)a1);
    uint64_t v34 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR)) {
      return v9;
    }
    goto LABEL_9;
  }
  if (*((unsigned char *)a1 + 56))
  {
    if (!sub_100058654()) {
      return 601;
    }
    uint64_t v9 = 601;
    sub_100056E24((uint64_t)"SCO connection %d is disconnected, retval %!", v19, v20, v21, v22, v23, v24, v25, *a1);
    uint64_t v26 = sub_100050B4C(0x2Eu);
    if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR)) {
      return v9;
    }
LABEL_9:
    sub_100745764();
    return 601;
  }
  if (!off_100A19690)
  {
    memset(v64, 0, sizeof(v64));
    sub_1000226D0((uint64_t)v64, 1u);
    sub_100022798((unsigned __int8 *)v64, a2, a3, 2u);
    if (byte_100A04DAA == 1)
    {
      __int16 v43 = *a1;
      char v44 = -13;
LABEL_39:
      uint64_t v9 = sub_1000228AC(v44, v43, (uint64_t)v64, a3);
      goto LABEL_40;
    }
    if (a3 < 0x100)
    {
      __int16 v43 = *a1;
      char v44 = 3;
      goto LABEL_39;
    }
    if (a3 >> 1 != 180) {
      sub_10025B8C0();
    }
    uint64_t v45 = sub_1000228AC(3, *a1 | 0x4000u, (uint64_t)v64, a3 >> 1);
    if (v45 == 625)
    {
      uint64_t v46 = sub_1000228AC(3, *a1, (uint64_t)v64, a3 >> 1);
      if (v46 == 625) {
        goto LABEL_43;
      }
      uint64_t v9 = v46;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCI_Send failed to write second SCO data chunk", v47, v48, v49, v50, v51, v52, v53, v63);
        uint64_t v54 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
          goto LABEL_37;
        }
      }
    }
    else
    {
      uint64_t v9 = v45;
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCI_Send failed to write first SCO data chunk", v55, v56, v57, v58, v59, v60, v61, v63);
        uint64_t v62 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR)) {
LABEL_37:
        }
          sub_100748324();
      }
    }
LABEL_40:
    if (v9 != 625)
    {
      if (v9) {
        goto LABEL_25;
      }
LABEL_42:
      byte_100A196F6 = 0;
      return v9;
    }
LABEL_43:
    if (a4) {
      return 625;
    }
    uint64_t v9 = sub_100026DA8((uint64_t)sub_10019C6AC, 0, 0);
    if (v9) {
      return v9;
    }
    goto LABEL_42;
  }
  uint64_t v9 = 629;
LABEL_25:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"OI_HCI_Send failed to write SCO data", v35, v36, v37, v38, v39, v40, v41, v63);
    unsigned int v42 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR)) {
      sub_100748324();
    }
  }
  return v9;
}

uint64_t sub_10019E2C4(int a1, uint64_t a2, void *a3)
{
  if (!a1) {
    a2 = 0;
  }
  if (!a1) {
    a3 = 0;
  }
  qword_100A196C8 = a2;
  off_100A196D0 = a3;
  return 0;
}

uint64_t sub_10019E2E8(_WORD *a1)
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v1 = dword_100A19630 == 2;
  }
  else {
    BOOL v1 = 0;
  }
  if (!v1) {
    return 103;
  }
  uint64_t result = 0;
  *a1 = word_100A196F4;
  return result;
}

uint64_t sub_10019E32C(__int16 a1, __int16 a2)
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v2 = dword_100A19630 == 2;
  }
  else {
    BOOL v2 = 0;
  }
  if (!v2) {
    return 103;
  }
  uint64_t result = 0;
  word_100A196F4 = a1;
  word_100A196F0 = a2;
  return result;
}

uint64_t sub_10019E374()
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v0 = dword_100A19630 == 2;
  }
  else {
    BOOL v0 = 0;
  }
  if (!v0) {
    return 103;
  }
  uint64_t result = 0;
  byte_100A04DAA = 1;
  return result;
}

uint64_t sub_10019E3B4(_WORD *a1)
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v1 = dword_100A19630 == 2;
  }
  else {
    BOOL v1 = 0;
  }
  if (!v1) {
    return 103;
  }
  uint64_t result = 0;
  *a1 = WORD6(xmmword_100A196D8);
  return result;
}

uint64_t sub_10019E3F8()
{
  return WORD6(xmmword_100A196D8);
}

uint64_t sub_10019E404()
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v0 = dword_100A19630 == 2;
  }
  else {
    BOOL v0 = 0;
  }
  if (v0) {
    return WORD4(xmmword_100A196D8[0]);
  }
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"OI_HCIAPI_GetTotalNumAclBuffers - not initialized", v2, v3, v4, v5, v6, v7, v8, v10);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    uint64_t result = os_log_type_enabled(v9, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100749CC4();
      return 0;
    }
  }
  return result;
}

uint64_t sub_10019E490()
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v0 = dword_100A19630 == 2;
  }
  else {
    BOOL v0 = 0;
  }
  if (v0) {
    return (unsigned __int16)word_100A19700;
  }
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"OI_HCIAPI_GetTotalNumAclBuffers - not initialized", v2, v3, v4, v5, v6, v7, v8, v10);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    uint64_t result = os_log_type_enabled(v9, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100749CC4();
      return 0;
    }
  }
  return result;
}

uint64_t sub_10019E51C()
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v0 = dword_100A19630 == 2;
  }
  else {
    BOOL v0 = 0;
  }
  if (v0) {
    return (unsigned __int16)word_100A196F0;
  }
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"OI_HCIAPI_GetTotalNumScoBuffers - not initialized", v2, v3, v4, v5, v6, v7, v8, v10);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    uint64_t result = os_log_type_enabled(v9, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100749CC4();
      return 0;
    }
  }
  return result;
}

uint64_t sub_10019E5A8(uint64_t a1)
{
  return *(unsigned __int16 *)(a1 + 16);
}

uint64_t sub_10019E5B0()
{
  if (DWORD2(xmmword_100A19860)) {
    BOOL v0 = dword_100A19630 == 2;
  }
  else {
    BOOL v0 = 0;
  }
  if (v0) {
    return byte_100A196F6 != 0;
  }
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"OI_HCIAPI_ReadyToTransmitSco - not initialized", v2, v3, v4, v5, v6, v7, v8, v10);
    uint64_t v9 = sub_100050B4C(0x2Eu);
    uint64_t result = os_log_type_enabled(v9, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100749CC4();
      return 0;
    }
  }
  return result;
}

void sub_10019E644(uint64_t a1, unsigned int a2, uint64_t a3)
{
  if (*(unsigned char *)(a3 + 8))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCIFlow_HandleNumCompletedPackets: wakeupCause HCI_EVENT Packet from BT Controller (len=%d)\n", v5, v6, v7, v8, v9, v10, v11, a2);
      uint64_t v12 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136446210;
        uint64_t v58 = sub_100050714();
        _os_log_impl((void *)&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }
  if (dword_100A19630 != 2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"HCI not initialized, ignoring AclPacketSent event", v22, v23, v24, v25, v26, v27, v28, v56);
      uint64_t v29 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
        sub_100749CC4();
      }
    }
    return;
  }
  if (!a1)
  {
    uint64_t v55 = "eventBuf";
    goto LABEL_66;
  }
  if (a2 == 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 1994, "ByteStream_NumReadBytesAvail(bs) >= 1");
  }
  if (!a2)
  {
    uint64_t v55 = "(numBytes) > 0";
LABEL_66:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 1991, v55);
  }
  if (a2 <= 2) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 1995, "ByteStream_NumReadBytesAvail(bs) >= 1");
  }
  signed int v13 = *(unsigned __int8 *)(a1 + 1);
  if ((int)(a2 - 2) > v13)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"NumCompletedPackets short packet expected %d, got %d", v14, v15, v16, v17, v18, v19, v20, (v13 + 2));
      uint64_t v21 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100749EB4();
      }
    }
    return;
  }
  int v30 = *(unsigned __int8 *)(a1 + 2);
  if (v13 == ((4 * v30) | 1))
  {
    if (!*(unsigned char *)(a1 + 2)) {
      return;
    }
    uint64_t v31 = 0;
    uint64_t v32 = (int)(a2 - 1);
    while (1)
    {
      if (v31 + 3 >= v32) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 2014, "ByteStream_NumReadBytesAvail(bs) >= 2");
      }
      if (v31 + 5 >= v32) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciflow.c", 2015, "ByteStream_NumReadBytesAvail(bs) >= 2");
      }
      unsigned __int16 v33 = *(_WORD *)(a1 + v31 + 5);
      uint64_t v34 = sub_100197864(*(unsigned __int16 *)(a1 + v31 + 3));
      if (!v34) {
        goto LABEL_51;
      }
      uint64_t v35 = v34;
      switch(*((unsigned char *)v34 + 2))
      {
        case 0:
          sub_10019EB60((uint64_t)v34, v33);
          if (qword_100A196C8 && (long long *)qword_100A196C8 == v35 && !*((_WORD *)v35 + 8) && off_100A196D0 != 0) {
            off_100A196D0(v35);
          }
          if (!BYTE14(xmmword_100A196D8[0])) {
            goto LABEL_51;
          }
          if (WORD3(xmmword_100A196D8[0]))
          {
            if (WORD5(xmmword_100A196D8[0]) <= 2u) {
              goto LABEL_51;
            }
LABEL_50:
            (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 1);
            goto LABEL_51;
          }
          if (WORD5(xmmword_100A196D8[0])) {
            goto LABEL_50;
          }
          goto LABEL_51;
        case 1:
          sub_10018B2DC((uint64_t)v34, v33);
          goto LABEL_51;
        case 4:
          if (*((unsigned char *)v34 + 129)) {
            goto LABEL_41;
          }
          sub_10019EB60((uint64_t)v34, v33);
          if (LOBYTE(xmmword_100A196D8[0]))
          {
            if (!BYTE14(xmmword_100A196D8[0])) {
              goto LABEL_51;
            }
            int v46 = WORD5(xmmword_100A196D8[0]);
            if (WORD3(xmmword_100A196D8[0]))
            {
              if (WORD5(xmmword_100A196D8[0]) <= 2u) {
                goto LABEL_51;
              }
              goto LABEL_41;
            }
          }
          else
          {
            if (!byte_100A19706) {
              goto LABEL_51;
            }
            int v46 = (unsigned __int16)word_100A19702;
          }
          if (!v46) {
            goto LABEL_51;
          }
LABEL_41:
          (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 3);
LABEL_51:
          --v30;
          v31 += 4;
          if (!(_BYTE)v30) {
            return;
          }
          break;
        case 5:
        case 6:
          sub_10019EB60((uint64_t)v34, v33);
          goto LABEL_51;
        case 8:
          sub_10019EB60((uint64_t)v34, v33);
          if (byte_100A19726) {
            (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 5);
          }
          goto LABEL_51;
        default:
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"Unknown connection type.", v37, v38, v39, v40, v41, v42, v43, v56);
            char v44 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
            {
              uint64_t v45 = sub_100050714();
              *(_DWORD *)int buf = 136446466;
              uint64_t v58 = v45;
              __int16 v59 = 1024;
              int v60 = 0xFFFF;
              _os_log_error_impl((void *)&_mh_execute_header, v44, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }
          goto LABEL_51;
      }
    }
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"NumCompletedPackets bad parm length: expected %d, got %d", v47, v48, v49, v50, v51, v52, v53, (4 * v30) | 1u);
    uint64_t v54 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR)) {
      sub_100749EB4();
    }
  }
}

void sub_10019EB60(uint64_t a1, uint64_t a2)
{
  uint64_t v2 = a2;
  unsigned int v4 = *(unsigned __int16 *)(a1 + 16);
  if (v4 < a2)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"hciflow inconsistency - %d packets completed for handle %d, but only %d were outstanding", v5, v6, v7, v8, v9, v10, v11, v2);
      uint64_t v12 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100749D3C();
      }
    }
    uint64_t v2 = *(unsigned __int16 *)(a1 + 16);
    LOWORD(v4) = *(_WORD *)(a1 + 16);
  }
  *(_WORD *)(a1 + 16) = v4 - v2;
  __int16 v13 = WORD1(xmmword_100A196D8[0]);
  if (v2 > WORD1(xmmword_100A196D8[0]))
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"hciflow inconsistency - %d packets completed, only %d were outstannding", v14, v15, v16, v17, v18, v19, v20, v2);
      uint64_t v21 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100749D3C();
      }
    }
    __int16 v13 = WORD1(xmmword_100A196D8[0]);
    LODWORD(v2) = WORD1(xmmword_100A196D8[0]);
  }
  __int16 v22 = v13 - v2;
  WORD1(xmmword_100A196D8[0]) = v22;
  if (!*(unsigned char *)(a1 + 2) && *(unsigned char *)(a1 + 152) == 2)
  {
    if (WORD2(xmmword_100A196D8[0]) >= v2)
    {
      WORD2(xmmword_100A196D8[0]) -= v2;
    }
    else
    {
      sub_10025B8C0();
      WORD2(xmmword_100A196D8[0]) = 0;
      __int16 v22 = WORD1(xmmword_100A196D8[0]);
    }
  }
  if (!v22) {
    WORD2(xmmword_100A196D8[0]) = 0;
  }
  switch(*(unsigned char *)(a1 + 2))
  {
    case 0:
      goto LABEL_24;
    case 4:
      if (LOBYTE(xmmword_100A196D8[0]))
      {
LABEL_24:
        unsigned __int16 v31 = WORD5(xmmword_100A196D8[0]) + v2;
        WORD5(xmmword_100A196D8[0]) += v2;
        if (BYTE14(xmmword_100A196D8[0]))
        {
          BOOL v32 = v31 != 0;
          BOOL v33 = v31 > 2u;
          if (!WORD3(xmmword_100A196D8[0])) {
            BOOL v33 = v32;
          }
        }
        else
        {
          BOOL v33 = 0;
        }
        byte_100A19739 = v33;
      }
      else
      {
        word_100A19702 += v2;
        if (word_100A19702) {
          BOOL v38 = byte_100A19706 == 0;
        }
        else {
          BOOL v38 = 1;
        }
        char v39 = !v38;
        byte_100A1973A = v39;
      }
      break;
    case 5:
    case 6:
      word_100A19712 += v2;
      break;
    case 8:
      word_100A19722 += v2;
      byte_100A19738 = byte_100A19726;
      break;
    default:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Unexpected connection type", v23, v24, v25, v26, v27, v28, v29, v40);
        int v30 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v30, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      break;
  }
  int v34 = *(__int16 *)(a1 + 18);
  BOOL v35 = __OFSUB__(v34, 1);
  int v36 = v34 - 1;
  if (v36 < 0 == v35)
  {
    *(_WORD *)(a1 + 18) = v36;
    if (!(_WORD)v36)
    {
      uint64_t v37 = *(void (**)(uint64_t))(a1 + 8);
      if (v37)
      {
        *(void *)(a1 + 8) = 0;
        *(_WORD *)(a1 + 18) = 0;
      }
      else
      {
        sub_10025B8C0();
        uint64_t v37 = *(void (**)(uint64_t))(a1 + 8);
        *(void *)(a1 + 8) = 0;
        *(_WORD *)(a1 + 18) = 0;
        if (!v37) {
          return;
        }
      }
      v37(a1);
    }
  }
}

long long *sub_10019EE54(long long *result)
{
  *((_WORD *)result + 8) = 0;
  int v1 = *(unsigned __int16 *)result;
  uint64_t v2 = &xmmword_100A04A30;
  if (v1 == (unsigned __int16)xmmword_100A04A30)
  {
    int v3 = 1794;
    do
    {
      int v4 = v3;
      uint64_t result = sub_100197864((unsigned __int16)v3);
      int v3 = v4 + 2;
    }
    while (result);
  }
  else
  {
    uint64_t v2 = &xmmword_100A04B80;
    if (v1 != (unsigned __int16)xmmword_100A04B80) {
      return result;
    }
    int v5 = 1795;
    do
    {
      int v4 = v5;
      uint64_t result = sub_100197864((unsigned __int16)v5);
      int v5 = v4 + 2;
    }
    while (result);
  }
  *(_WORD *)uint64_t v2 = v4;
  return result;
}

void sub_10019EEE0(uint64_t a1)
{
  char v2 = BYTE14(xmmword_100A196D8[0]);
  if (!BYTE14(xmmword_100A196D8[0]))
  {
    char v3 = 0;
    char v4 = 0;
    if (LOBYTE(xmmword_100A196D8[0])) {
      goto LABEL_13;
    }
    goto LABEL_6;
  }
  if (WORD3(xmmword_100A196D8[0])) {
    char v2 = WORD5(xmmword_100A196D8[0]) > 2u;
  }
  else {
    char v2 = WORD5(xmmword_100A196D8[0]) != 0;
  }
  char v3 = v2;
  char v4 = v2;
  if (!LOBYTE(xmmword_100A196D8[0]))
  {
LABEL_6:
    if (byte_100A19706) {
      BOOL v5 = word_100A19702 == 0;
    }
    else {
      BOOL v5 = 1;
    }
    char v4 = !v5;
    char v3 = v2;
  }
LABEL_13:
  int v6 = byte_100A19726;
  if (*(_WORD *)(a1 + 16)) {
    sub_10019EB60(a1, *(unsigned __int16 *)(a1 + 16));
  }
  switch(*(unsigned char *)(a1 + 2))
  {
    case 0:
      if (BYTE14(xmmword_100A196D8[0])) {
        char v7 = v3;
      }
      else {
        char v7 = 1;
      }
      if (v7) {
        goto LABEL_46;
      }
      if (!WORD3(xmmword_100A196D8[0]))
      {
        if (!WORD5(xmmword_100A196D8[0])) {
          goto LABEL_46;
        }
        goto LABEL_40;
      }
      if (WORD5(xmmword_100A196D8[0]) > 2u) {
LABEL_40:
      }
        (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 1);
LABEL_46:
      if (!sub_100198D88())
      {
        if (word_100A04A40) {
          sub_10019EB60((uint64_t)&xmmword_100A04A30, (unsigned __int16)word_100A04A40);
        }
        if (word_100A04B90) {
          sub_10019EB60((uint64_t)&xmmword_100A04B80, (unsigned __int16)word_100A04B90);
        }
        if (!LOBYTE(xmmword_100A196D8[0]) || !sub_100198E60())
        {
          unsigned int v17 = WORD5(xmmword_100A196D8[0]);
          if (WORD5(xmmword_100A196D8[0]) != WORD4(xmmword_100A196D8[0]))
          {
            sub_10025B8C0();
            unsigned int v17 = WORD4(xmmword_100A196D8[0]);
          }
          WORD5(xmmword_100A196D8[0]) = v17;
          BYTE14(xmmword_100A196D8[0]) = 1;
          BOOL v18 = v17 > 2;
          BOOL v19 = v17 != 0;
          if (WORD3(xmmword_100A196D8[0])) {
            BOOL v19 = v18;
          }
          byte_100A19739 = v19;
        }
        sub_10019FBF0();
      }
      if (!sub_100198E60())
      {
        uint64_t v23 = 0;
        word_100A19702 = word_100A19700;
        byte_100A19706 = 1;
        if (LOBYTE(xmmword_100A196D8[0]))
        {
          char v20 = BYTE14(xmmword_100A196D8[0]);
          if (BYTE14(xmmword_100A196D8[0]))
          {
            char v20 = WORD5(xmmword_100A196D8[0]) != 0;
            if (WORD3(xmmword_100A196D8[0])) {
              char v20 = WORD5(xmmword_100A196D8[0]) > 2u;
            }
          }
        }
        else
        {
          char v20 = word_100A19700 != 0;
        }
        byte_100A1973A = v20;
        while (sub_100198EB8(&v23))
        {
          if (*(unsigned char *)(v23 + 124) == 7) {
            *(_WORD *)(v23 + 16) = 0;
          }
        }
      }
      if (!sub_100198F8C())
      {
        __int16 v21 = word_100A19722;
        if (word_100A19722 != word_100A19720)
        {
          sub_10025B8C0();
          __int16 v21 = word_100A19720;
        }
        word_100A19722 = v21;
        byte_100A19726 = 1;
        byte_100A19738 = 1;
      }
      if (!sub_100198D88() && !sub_100198E60() && !sub_100198F8C())
      {
        if (byte_100A04DAB == 1)
        {
          if (WORD1(xmmword_100A196D8[0])) {
            sub_10025B8C0();
          }
        }
        WORD1(xmmword_100A196D8[0]) = 0;
      }
      return;
    case 1:
      if (*(_WORD *)(a1 + 16)) {
        sub_10018B2DC(a1, *(unsigned __int16 *)(a1 + 16));
      }
      goto LABEL_46;
    case 4:
      if (v4) {
        goto LABEL_46;
      }
      if (LOBYTE(xmmword_100A196D8[0]))
      {
        if (!BYTE14(xmmword_100A196D8[0])) {
          goto LABEL_44;
        }
        int v16 = WORD5(xmmword_100A196D8[0]);
        if (WORD3(xmmword_100A196D8[0]))
        {
          if (WORD5(xmmword_100A196D8[0]) > 2u) {
            goto LABEL_45;
          }
          goto LABEL_44;
        }
      }
      else
      {
        if (!byte_100A19706) {
          goto LABEL_44;
        }
        int v16 = (unsigned __int16)word_100A19702;
      }
      if (v16) {
        goto LABEL_45;
      }
LABEL_44:
      if (!*(unsigned char *)(a1 + 129)) {
        goto LABEL_46;
      }
LABEL_45:
      (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 3);
      goto LABEL_46;
    case 8:
      if (!v6 && byte_100A19726) {
        (*(void (**)(void, uint64_t))(qword_100A19638 + 16))(0, 5);
      }
      goto LABEL_46;
    default:
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"Unknown connection type.", v8, v9, v10, v11, v12, v13, v14, v22);
        uint64_t v15 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      goto LABEL_46;
  }
}

uint64_t sub_10019F308(uint64_t a1, uint64_t a2)
{
  return a2;
}

long long *sub_10019F310(unsigned int a1, __int16 a2, __int16 a3, __int16 a4, int a5, int a6, int a7, int a8, char a9)
{
  word_100A04D9C = 0;
  dword_100A04D98 = 0;
  dword_100A04DA4 = 0;
  word_100A04DA8 = 0;
  dword_100A04D9E = 0;
  word_100A04DA2 = 0;
  xmmword_100A196D8[0] = 0u;
  *(_OWORD *)algn_100A196E8 = 0u;
  unk_100A196F8 = 0u;
  unk_100A19708 = 0u;
  unk_100A19718 = 0u;
  *(_OWORD *)&qword_100A19728 = 0u;
  unsigned int v17 = (unsigned __int16)(sub_10016ABE4() - 4);
  if (a1 >= v17) {
    __int16 v18 = v17;
  }
  else {
    __int16 v18 = a1;
  }
  WORD6(xmmword_100A196D8[0]) = v18;
  word_100A196F4 = a2;
  word_100A19704 = a3;
  word_100A19714 = a4;
  WORD4(xmmword_100A196D8[0]) = a5;
  word_100A196F0 = a6;
  word_100A19700 = a7;
  word_100A19710 = a8;
  WORD5(xmmword_100A196D8[0]) = a5;
  word_100A19702 = a7;
  word_100A19712 = a8;
  WORD3(xmmword_100A196D8[0]) = 0;
  LOBYTE(xmmword_100A196D8[0]) = a9;
  if (a9)
  {
    BOOL v19 = 1;
    BOOL v20 = a5 != 0;
    BOOL v21 = 1;
    BOOL v22 = 1;
  }
  else
  {
    BOOL v21 = a6 != 0;
    BOOL v20 = a7 != 0;
    BOOL v19 = a5 != 0;
    BOOL v22 = a7 != 0;
  }
  BYTE14(xmmword_100A196D8[0]) = v19;
  byte_100A196F6 = v21;
  byte_100A19706 = v22;
  byte_100A19716 = a8 != 0;
  byte_100A19739 = a5 != 0;
  byte_100A1973A = v20;
  byte_100A19738 = 0;
  byte_100A19730 = 0;
  sub_10019FBF0();
  int v23 = 1794;
  do
  {
    int v24 = v23;
    uint64_t v25 = sub_100197864((unsigned __int16)v23);
    int v23 = v24 + 2;
  }
  while (v25);
  LOWORD(xmmword_100A04A30) = v24;
  int v26 = 1795;
  do
  {
    int v27 = v26;
    uint64_t result = sub_100197864((unsigned __int16)v26);
    int v26 = v27 + 2;
  }
  while (result);
  LOWORD(xmmword_100A04B80) = v27;
  return result;
}

void sub_10019F4CC()
{
  uint64_t v14 = 0;
  while (sub_1001990B0((uint64_t *)&v14))
  {
    BOOL v0 = v14;
    if ((__int16)*v14 == -1)
    {
      sub_10017C6DC(129, v14, *((void *)v14 + 6) + 48, 0, 0);
    }
    else
    {
      *((unsigned char *)v14 + 56) = 1;
      sub_10017D8BC(0, v0, 129);
    }
    if (!sub_100197740((uint64_t)v14)) {
      uint64_t v14 = 0;
    }
  }
  uint64_t v14 = 0;
  if (sub_100198DE0((uint64_t *)&v14))
  {
    while (1)
    {
      int v1 = v14;
      int v2 = *((unsigned __int8 *)v14 + 54);
      if ((v2 - 1) < 2) {
        break;
      }
      if (v2 != 7)
      {
        *((unsigned char *)v14 + 54) = 7;
        int v3 = *((_DWORD *)v1 + 37);
        sub_10019EEE0((uint64_t)v1);
        sub_10017D8BC(0, v14, 129);
        if (!v3)
        {
          sub_100253FB8((uint64_t)v14, 129);
          sub_10024EAD4((uint64_t)v14);
          sub_1001984E0(v14);
        }
        goto LABEL_14;
      }
LABEL_15:
      if (!sub_100198DE0((uint64_t *)&v14)) {
        goto LABEL_16;
      }
    }
    sub_10017C6DC(129, v14, (uint64_t)(v14 + 24), 1, 0);
LABEL_14:
    uint64_t v14 = 0;
    goto LABEL_15;
  }
LABEL_16:
  uint64_t v14 = 0;
  if (sub_100198EB8((uint64_t *)&v14))
  {
    while (1)
    {
      char v4 = v14;
      int v5 = *((unsigned __int8 *)v14 + 124);
      if ((v5 - 1) < 2) {
        break;
      }
      if (v5 != 7)
      {
        *((unsigned char *)v14 + 124) = 7;
        int v7 = *((_DWORD *)v4 + 51);
        sub_10019EEE0((uint64_t)v4);
        sub_10021B970(0, (uint64_t)v14, 129, 0, 0);
        if (!v7)
        {
          sub_100253FB8((uint64_t)v14, 129);
          sub_10024EAD4((uint64_t)v14);
          sub_1001984E0(v14);
        }
        goto LABEL_25;
      }
LABEL_26:
      if (!sub_100198EB8((uint64_t *)&v14)) {
        goto LABEL_27;
      }
    }
    if (*((unsigned char *)v14 + 55)) {
      int v6 = v14 + 28;
    }
    else {
      int v6 = 0;
    }
    BYTE4(v13) = 0;
    LODWORD(v13) = -256;
    ((void (*)(uint64_t, void, void, unsigned __int16 *, unsigned __int16 *, void, void, void, uint64_t))loc_10021AE70)(129, 0, 0, v14 + 24, v6, 0, 0, 0, v13);
LABEL_25:
    uint64_t v14 = 0;
    goto LABEL_26;
  }
LABEL_27:
  WORD5(xmmword_100A196D8[0]) = WORD4(xmmword_100A196D8[0]);
  word_100A19702 = word_100A19700;
  WORD1(xmmword_100A196D8[0]) = 0;
  if (LOBYTE(xmmword_100A196D8[0]))
  {
    char v8 = 0;
    BOOL v9 = 1;
    BYTE14(xmmword_100A196D8[0]) = 1;
    BOOL v10 = 1;
  }
  else
  {
    char v8 = WORD4(xmmword_100A196D8[0]) == 0;
    BYTE14(xmmword_100A196D8[0]) = WORD4(xmmword_100A196D8[0]) != 0;
    BOOL v9 = word_100A196F0 != 0;
    BOOL v10 = word_100A19700 != 0;
  }
  byte_100A196F6 = v9;
  byte_100A19706 = v10;
  WORD3(xmmword_100A196D8[0]) = 0;
  byte_100A19739 = (WORD4(xmmword_100A196D8[0]) != 0) & ~v8;
  if (LOBYTE(xmmword_100A196D8[0]))
  {
    if (WORD4(xmmword_100A196D8[0])) {
      char v11 = v8;
    }
    else {
      char v11 = 1;
    }
    if (v11) {
      goto LABEL_39;
    }
  }
  else if (!v10 || !word_100A19700)
  {
LABEL_39:
    BOOL v12 = sub_100198F2C() != 0;
    goto LABEL_40;
  }
  BOOL v12 = 1;
LABEL_40:
  byte_100A1973A = v12;
  byte_100A19738 = byte_100A19730 != 0;
  sub_10019FBF0();
}

uint64_t sub_10019F7AC(int a1)
{
  return WORD5(xmmword_100A196D8[a1]);
}

BOOL sub_10019F7C0()
{
  return WORD3(xmmword_100A196D8[0]) != 0;
}

uint64_t sub_10019F7D4()
{
  return BYTE1(xmmword_100A196D8[0]);
}

void sub_10019F7E0()
{
  byte_100A04DAB = 1;
}

uint64_t sub_10019F7F0()
{
  sub_10025B778("HciFlow - txFlowControl\n");
  sub_10025B778("   gAssertOnControllerFlowPRoblems  = %d\n", byte_100A04DAB);
  sub_10025B778("   MaxAclDataPacketSize\t\t\t= %d\n", WORD6(xmmword_100A196D8[0]));
  sub_10025B778("   MaxScoDataPacketSize\t\t\t= %d\n", (unsigned __int16)word_100A196F4);
  sub_10025B778("   MaxLeDataPacketSize\t\t\t= %d\n", (unsigned __int16)word_100A19704);
  if (LOBYTE(xmmword_100A196D8[0])) {
    BOOL v0 = "TRUE";
  }
  else {
    BOOL v0 = "FALSE";
  }
  sub_10025B778("   sharedACLandLEbuffers     \t= %s\n", v0);
  sub_10025B778("   totalNumOutstandingTransmits\t= %d\n", WORD1(xmmword_100A196D8[0]));
  sub_10025B778("   totalNumAclSlots\t\t\t\t= %d\n", WORD4(xmmword_100A196D8[0]));
  sub_10025B778("   totalNumScoSlots\t\t\t\t= %d\n", (unsigned __int16)word_100A196F0);
  sub_10025B778("   totalNumLeSlots\t\t\t\t= %d\n", (unsigned __int16)word_100A19700);
  sub_10025B778("   curNumAclSlotsAvail\t\t\t= %d\n", WORD5(xmmword_100A196D8[0]));
  sub_10025B778("   curNumLeSlotsAvail\t\t\t= %d\n", (unsigned __int16)word_100A19702);
  if (BYTE14(xmmword_100A196D8[0])) {
    int v1 = "TRUE";
  }
  else {
    int v1 = "FALSE";
  }
  sub_10025B778("   aclTransportReady\t\t\t\t= %s\n", v1);
  if (byte_100A196F6) {
    int v2 = "TRUE";
  }
  else {
    int v2 = "FALSE";
  }
  sub_10025B778("   scoTransportReady\t\t\t\t= %s\n", v2);
  if (byte_100A19706) {
    int v3 = "TRUE";
  }
  else {
    int v3 = "FALSE";
  }
  sub_10025B778("   leTransportReady\t\t\t\t= %s\n", v3);
  sub_10025B778("   needScoBuffers\t\t\t\t= %d\n", WORD3(xmmword_100A196D8[0]));
  sub_10025B778("   _OI_HCIAPI_ReadyToTransmitLe  = %d\n", byte_100A1973A);
  sub_10025B778("   _OI_HCIAPI_ReadyToTransmitAcl  = %d\n", byte_100A19739);
  sub_10025B778("   _OI_HCIAPI_ReadyToTransmitOther  = %d\n", byte_100A19738);
  sub_100199600();
  if (qword_100A19628 && *(unsigned char *)(qword_100A19628 + 7))
  {
    sub_10025B778("HciFlow - aclRxFlowControl:\n");
    sub_10025B778("   lmHandle\t = %d\n", (unsigned __int16)dword_100A04D98);
    if ((_BYTE)word_100A04D9C) {
      char v4 = "TRUE";
    }
    else {
      char v4 = "FALSE";
    }
    sub_10025B778("   flowIsPaused = %s\n", v4);
    sub_10025B778("   numOutstandingReceives = %d\n");
  }
  else
  {
    sub_10025B778("HciFlow - aclRxFlowControl not enabled\n");
  }
  if (qword_100A19628 && *(unsigned char *)(qword_100A19628 + 8))
  {
    sub_10025B778("HciFlow - scoRxFlowControl:\n");
    sub_10025B778("   lmHandle\t = %d\n", (unsigned __int16)dword_100A04DA4);
    if ((_BYTE)word_100A04DA8) {
      int v5 = "TRUE";
    }
    else {
      int v5 = "FALSE";
    }
    sub_10025B778("   flowIsPaused = %s\n", v5);
    sub_10025B778("   numOutstandingReceives = %d\n");
  }
  else
  {
    sub_10025B778("HciFlow - scoRxFlowControl not enabled\n");
  }
  if (qword_100A19628 && *(unsigned char *)(qword_100A19628 + 9))
  {
    sub_10025B778("HciFlow - leRxFlowControl:\n");
    sub_10025B778("   lmHandle\t = %d\n", (unsigned __int16)dword_100A04D9E);
    if ((_BYTE)word_100A04DA2) {
      int v6 = "TRUE";
    }
    else {
      int v6 = "FALSE";
    }
    sub_10025B778("   flowIsPaused = %s\n", v6);
    return sub_10025B778("   numOutstandingReceives = %d\n", HIWORD(dword_100A04D9E));
  }
  else
  {
    return sub_10025B778("HciFlow - leRxFlowControl not enabled\n");
  }
}

void sub_10019FB60()
{
  dword_100A04DB8 = 0;
  uint64_t v0 = sub_10010BA04();
  __int16 v1 = v0 - qword_100A04DB0;
  if (v0 - qword_100A04DB0 < 0x7D0)
  {
    sub_1000268E4((uint64_t)sub_10019FB60, 0, (unsigned __int16)(2099 - v1) / 0x64u, &dword_100A04DB8);
  }
  else
  {
    sub_10010C838();
  }
}

void sub_10019FBF0()
{
  if (dword_100A04DB8)
  {
    sub_100026DB4(dword_100A04DB8);
    dword_100A04DB8 = 0;
    sub_10010C838();
  }
  qword_100A04DB0 = 0;
}

uint64_t sub_10019FCEC()
{
  if (byte_100A04DC0) {
    return 0;
  }
  mach_port_t v1 = dword_100A04DD8;
  if (dword_100A04DD8) {
    goto LABEL_4;
  }
  io_iterator_t notification = 0;
  int v3 = IONotificationPortCreate(kIOMainPortDefault);
  RunLoopSource = IONotificationPortGetRunLoopSource(v3);
  Current = CFRunLoopGetCurrent();
  CFRunLoopAddSource(Current, RunLoopSource, kCFRunLoopDefaultMode);
  CFDictionaryRef v6 = IOServiceNameMatching("AppleBTHci");
  uint64_t v7 = IOServiceAddMatchingNotification(v3, "IOServiceFirstMatch", v6, (IOServiceMatchingCallback)sub_1001A0FD0, Current, &notification);
  if (v7)
  {
    uint64_t v0 = v7;
    if (qword_100A04DC8 != -1) {
      dispatch_once(&qword_100A04DC8, &stru_10099DD38);
    }
    char v8 = qword_100A04DD0;
    if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
      sub_10074A1E4(v0, v8, v9, v10, v11, v12, v13, v14);
    }
  }
  else
  {
    io_service_t v16 = IOIteratorNext(notification);
    for (dword_100A04DDC = v16; !v16; dword_100A04DDC = v16)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DD78);
      }
      unsigned int v17 = qword_100A04DD0;
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136315138;
        int v36 = "AppleBTHci";
        _os_log_impl((void *)&_mh_execute_header, v17, OS_LOG_TYPE_DEFAULT, "applebt_hci_connect: Couldn't find %s service, waiting for first match\n", buf, 0xCu);
      }
      CFRunLoopRun();
      io_service_t v16 = IOIteratorNext(notification);
    }
    uint64_t v0 = IOServiceOpen(v16, mach_task_self_, 0, (io_connect_t *)&dword_100A04DD8);
    if (v0)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DDB8);
      }
      __int16 v18 = qword_100A04DD0;
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        sub_10074A178(v0, v18, v19, v20, v21, v22, v23, v24);
      }
    }
  }
  CFRunLoopRemoveSource(Current, RunLoopSource, kCFRunLoopDefaultMode);
  IONotificationPortDestroy(v3);
  IOObjectRelease(notification);
  if (qword_100A04DC8 != -1) {
    dispatch_once(&qword_100A04DC8, &stru_10099DDF8);
  }
  uint64_t v25 = qword_100A04DD0;
  if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
  {
    *(_DWORD *)int buf = 136315138;
    int v36 = "AppleBTHci";
    _os_log_impl((void *)&_mh_execute_header, v25, OS_LOG_TYPE_DEFAULT, "applebt_hci_connect: Service %s connected!\n", buf, 0xCu);
  }
  if (!v0)
  {
    mach_port_t v1 = dword_100A04DD8;
LABEL_4:
    uint64_t v2 = IOConnectCallMethod(v1, 0, 0, 0, 0, 0, 0, 0, 0, 0);
    if (v2)
    {
      uint64_t v0 = v2;
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099D8F8);
      }
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        sub_10074A094();
      }
    }
    else
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099D938);
      }
      uint64_t v15 = qword_100A04DD0;
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
      {
        *(_DWORD *)int buf = 136315138;
        int v36 = "AppleBTHci";
        _os_log_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_DEFAULT, "applebt_hci_open: Service %s opened!\n", buf, 0xCu);
      }
      uint64_t v0 = 0;
      byte_100A04DC0 = 1;
    }
    return v0;
  }
  if (qword_100A04DC8 != -1) {
    dispatch_once(&qword_100A04DC8, &stru_10099D8B8);
  }
  int v26 = qword_100A04DD0;
  if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
    sub_10074A10C(v0, v26, v27, v28, v29, v30, v31, v32);
  }
  return v0;
}

void sub_1001A016C(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A019C(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

const char *sub_1001A01CC(int a1)
{
  if (a1 > -536870182)
  {
    if (a1 > -536870161)
    {
      switch(a1)
      {
        case -536870160:
          return "kIOReturnNotFound";
        case 0:
          return "kIOReturnSuccess";
        case 5:
          return "KERN_FAILURE";
      }
    }
    else
    {
      switch(a1)
      {
        case -536870181:
          return "kIOReturnNoSpace";
        case -536870167:
          return "kIOReturnDeviceError";
        case -536870165:
          return "kIOReturnAborted";
      }
    }
    return "UNKNOWN";
  }
  if (a1 <= -536870199)
  {
    if (a1 == -536870211) {
      return "kIOReturnNoMemory";
    }
    if (a1 == -536870206) {
      return "kIOReturnBadArgument";
    }
    return "UNKNOWN";
  }
  switch(a1)
  {
    case -536870198:
      uint64_t result = "kIOReturnIOError";
      break;
    case -536870197:
    case -536870196:
      return "UNKNOWN";
    case -536870195:
      uint64_t result = "kIOReturnNotOpen";
      break;
    case -536870194:
      uint64_t result = "kIOReturnNotReadable";
      break;
    case -536870193:
      uint64_t result = "kIOReturnNotWritable";
      break;
    default:
      if (a1 != -536870185) {
        return "UNKNOWN";
      }
      uint64_t result = "kIOReturnOffline";
      break;
  }
  return result;
}

void sub_1001A036C(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

uint64_t sub_1001A039C()
{
  if (byte_100A04DC0)
  {
    byte_100A04DC0 = 0;
    uint64_t v0 = IOConnectCallMethod(dword_100A04DD8, 1u, 0, 0, 0, 0, 0, 0, 0, 0);
    if (v0)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099D9B8);
      }
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        sub_10074A250();
      }
    }
    IOServiceClose(dword_100A04DD8);
    dword_100A04DD8 = 0;
    IOObjectRelease(dword_100A04DDC);
    dword_100A04DDC = 0;
    if (qword_100A04DC8 != -1) {
      dispatch_once(&qword_100A04DC8, &stru_10099D9F8);
    }
    mach_port_t v1 = qword_100A04DD0;
    if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
    {
      *(_DWORD *)int buf = 136315138;
      char v4 = "AppleBTHci";
      _os_log_impl((void *)&_mh_execute_header, v1, OS_LOG_TYPE_DEFAULT, "applebt_hci_close: Service %s closed and disconnected!\n", buf, 0xCu);
    }
  }
  else
  {
    if (qword_100A04DC8 != -1) {
      dispatch_once(&qword_100A04DC8, &stru_10099D978);
    }
    if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
      sub_10074A2C8();
    }
    return 5;
  }
  return v0;
}

void sub_1001A0578(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A05A8(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A05D8(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

uint64_t sub_1001A0608()
{
  if (byte_100A04DC0)
  {
    uint64_t v0 = IOConnectCallMethod(dword_100A04DD8, 4u, 0, 0, 0, 0, 0, 0, 0, 0);
    if (v0)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DA78);
      }
      if (!os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        goto LABEL_9;
      }
      sub_10074A2FC();
    }
    if (qword_100A04DC8 != -1) {
      dispatch_once(&qword_100A04DC8, &stru_10099DAB8);
    }
LABEL_9:
    mach_port_t v1 = qword_100A04DD0;
    if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
    {
      *(_WORD *)int buf = 0;
      _os_log_impl((void *)&_mh_execute_header, v1, OS_LOG_TYPE_DEFAULT, "applebt_hci_transport_reset: HCI Transport was reset!\n", buf, 2u);
    }
    return v0;
  }
  if (qword_100A04DC8 != -1) {
    dispatch_once(&qword_100A04DC8, &stru_10099DA38);
  }
  if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
    sub_10074A374();
  }
  return 5;
}

void sub_1001A0778(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A07A8(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A07D8(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

uint64_t sub_1001A0808(int a1, unsigned __int8 *inputStruct)
{
  if (byte_100A04DC0)
  {
    uint64_t v34 = 0;
    memset(outputStruct, 0, sizeof(outputStruct));
    uint64_t v26 = 8 * a1;
    uint64_t v4 = IOConnectCallMethod(dword_100A04DD8, 2u, 0, 0, inputStruct, 16 * a1, 0, 0, outputStruct, (size_t *)&v26);
    if (v4)
    {
      uint64_t v5 = v4;
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DB38);
      }
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        sub_10074A3A8();
      }
      return v5;
    }
    if (a1 < 1) {
      return 0;
    }
    uint64_t v5 = 0;
    uint64_t v7 = a1;
    char v8 = inputStruct + 1;
    for (__int16 i = (unsigned __int8 *)outputStruct + 4; ; i += 8)
    {
      int v10 = *((_DWORD *)i - 1);
      if (v10) {
        break;
      }
LABEL_30:
      v8 += 16;
      if (!--v7) {
        return v5;
      }
    }
    if (v10 == -536870181)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DBB8);
      }
      __int16 v18 = qword_100A04DD0;
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
      {
        int v19 = *(v8 - 1);
        int v20 = *i;
        int v21 = *v8;
        *(_DWORD *)int buf = 67109632;
        int v28 = v19;
        __int16 v29 = 1024;
        int v30 = v20;
        __int16 v31 = 1024;
        LODWORD(v32) = v21;
        _os_log_impl((void *)&_mh_execute_header, v18, OS_LOG_TYPE_DEFAULT, "applebt_hci_write: write to discardable pipe %d failed with no space, written %d out of %d packets\n", buf, 0x14u);
      }
      goto LABEL_30;
    }
    if (v10 == -536870198)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DB78);
      }
      uint64_t v11 = qword_100A04DD0;
      if (!os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        goto LABEL_29;
      }
      int v12 = *(v8 - 1);
      int v13 = *i;
      int v14 = *v8;
      *(_DWORD *)int buf = 67109632;
      int v28 = v12;
      __int16 v29 = 1024;
      int v30 = v13;
      __int16 v31 = 1024;
      LODWORD(v32) = v14;
      uint64_t v15 = v11;
      io_service_t v16 = "applebt_hci_write: write to non-discardable pipe %d failed with no space, written %d out of %d packets\n";
      uint32_t v17 = 20;
    }
    else
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DBF8);
      }
      uint64_t v22 = qword_100A04DD0;
      if (!os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        goto LABEL_29;
      }
      int v23 = *(v8 - 1);
      int v24 = *((_DWORD *)i - 1);
      uint64_t v25 = sub_1001A01CC(v24);
      *(_DWORD *)int buf = 67109634;
      int v28 = v23;
      __int16 v29 = 1024;
      int v30 = v24;
      __int16 v31 = 2080;
      uint64_t v32 = v25;
      uint64_t v15 = v22;
      io_service_t v16 = "applebt_hci_write: write to pipe %d failed with (0x%08X, %s)\n";
      uint32_t v17 = 24;
    }
    _os_log_error_impl((void *)&_mh_execute_header, v15, OS_LOG_TYPE_ERROR, v16, buf, v17);
LABEL_29:
    uint64_t v5 = 5;
    goto LABEL_30;
  }
  if (qword_100A04DC8 != -1) {
    dispatch_once(&qword_100A04DC8, &stru_10099DAF8);
  }
  if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
    sub_10074A420();
  }
  return 5;
}

void sub_1001A0BB0(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0BE0(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0C10(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0C40(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0C70(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

uint64_t sub_1001A0CA0(int a1, void *inputStruct, void *outputStruct)
{
  if (byte_100A04DC0)
  {
    uint64_t v11 = 8 * a1;
    size_t v5 = 16 * a1;
    while (1)
    {
      uint64_t v6 = IOConnectCallMethod(dword_100A04DD8, 3u, 0, 0, inputStruct, v5, 0, 0, outputStruct, (size_t *)&v11);
      if (v6 != -536870165) {
        break;
      }
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DCB8);
      }
      uint64_t v7 = qword_100A04DD0;
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
      {
        *(_WORD *)int buf = 0;
        _os_log_impl((void *)&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, "applebt_hci_read: method kAppleBTHciRead was aborted by signal! Read again\n", buf, 2u);
      }
    }
    uint64_t v8 = v6;
    if (v6)
    {
      if (qword_100A04DC8 != -1) {
        dispatch_once(&qword_100A04DC8, &stru_10099DC78);
      }
      if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
        sub_10074A454();
      }
    }
  }
  else
  {
    if (qword_100A04DC8 != -1) {
      dispatch_once(&qword_100A04DC8, &stru_10099DC38);
    }
    if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
      sub_10074A4CC();
    }
    return 5;
  }
  return v8;
}

void sub_1001A0E5C(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0E8C(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0EBC(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

CFTypeRef sub_1001A0EEC()
{
  io_registry_entry_t v0 = dword_100A04DDC;
  if (dword_100A04DDC)
  {
    return IORegistryEntrySearchCFProperty(v0, "IODeviceTree", @"pipes", kCFAllocatorDefault, 1u);
  }
  else
  {
    if (qword_100A04DC8 != -1) {
      dispatch_once(&qword_100A04DC8, &stru_10099DCF8);
    }
    if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_ERROR)) {
      sub_10074A500();
    }
    return 0;
  }
}

void sub_1001A0FA0(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A0FD0(__CFRunLoop *a1)
{
  if (qword_100A04DC8 != -1) {
    dispatch_once(&qword_100A04DC8, &stru_10099DE38);
  }
  uint64_t v2 = qword_100A04DD0;
  if (os_log_type_enabled((os_log_t)qword_100A04DD0, OS_LOG_TYPE_DEFAULT))
  {
    *(_WORD *)int v3 = 0;
    _os_log_impl((void *)&_mh_execute_header, v2, OS_LOG_TYPE_DEFAULT, "DeviceFoundCB: releasing waiting thread\n", v3, 2u);
  }
  CFRunLoopStop(a1);
}

void sub_1001A1068(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A1098(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A10C8(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A10F8(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

void sub_1001A1128(id a1)
{
  qword_100A04DD0 = (uint64_t)os_log_create("com.apple.bluetooth", "applebt_hci");
}

uint64_t sub_1001A1170()
{
  off_100A04F08 = 0;
  byte_100A04F10 = 0;
  return 0;
}

uint64_t sub_1001A11B0(uint64_t a1, unsigned int a2)
{
  if (!a1)
  {
    __int16 v18 = "cmdPacket";
    goto LABEL_123;
  }
  if (!a2)
  {
    __int16 v18 = "(cmdPacketLen) > 0";
LABEL_123:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 203, v18);
  }
  if (a2 <= 2)
  {
    sub_10025B8C0();
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 210, "ByteStream_NumReadBytesAvail(bs) >= 2");
  }
  if (a2 == 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 211, "ByteStream_NumReadBytesAvail(bs) >= 1");
  }
  unsigned int v4 = *(unsigned __int8 *)(a1 + 3);
  if (a2 - 4 == v4)
  {
    uint64_t v5 = *(unsigned __int16 *)(a1 + 1);
    if (*(unsigned __int16 *)(a1 + 1) > 0xC3Bu)
    {
      switch(*(_WORD *)(a1 + 1))
      {
        case 0xC3C:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 290, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF6 = *(unsigned char *)(a1 + 4);
          break;
        case 0xC3D:
        case 0xC40:
        case 0xC41:
        case 0xC42:
        case 0xC44:
        case 0xC46:
        case 0xC48:
LABEL_113:
          if (sub_100058654())
          {
            sub_100056E24((uint64_t)"OI_HCIParmCache, unknown opcode 0x%x", v10, v11, v12, v13, v14, v15, v16, v5);
            uint32_t v17 = sub_100050B4C(0x2Eu);
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
              sub_100744F6C();
            }
          }
          uint64_t result = 105;
          break;
        case 0xC3E:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 295, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF7 = *(unsigned char *)(a1 + 4);
          break;
        case 0xC3F:
          if (v4 <= 9) {
            sub_10025B8C0();
          }
          if (a2 - 14 >= 0xFFFFFFF6) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 223, "ByteStream_NumReadBytesAvail(bs) >= (sizeof(parmCache.channelClassification))");
          }
          uint64_t result = 0;
          uint64_t v9 = *(void *)(a1 + 4);
          word_100A04E04 = *(_WORD *)(a1 + 12);
          qword_100A04DFC = v9;
          break;
        case 0xC43:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 300, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF8 = *(unsigned char *)(a1 + 4);
          break;
        case 0xC45:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 305, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF9 = *(unsigned char *)(a1 + 4);
          break;
        case 0xC47:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 310, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DFA = *(unsigned char *)(a1 + 4);
          break;
        case 0xC49:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 315, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DFB = *(unsigned char *)(a1 + 4);
          break;
        default:
          switch(*(_WORD *)(a1 + 1))
          {
            case 0xC52:
              if (v4 <= 0xF0) {
                sub_10025B8C0();
              }
              if (a2 - 245 >= 0xFFFFFF0F) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 348, "ByteStream_NumReadBytesAvail(bs) >= (sizeof(parmCache.extendedInqResponse))");
              }
              memmove(&byte_100A04E08, (const void *)(a1 + 4), 0xF1uLL);
              uint64_t result = 0;
              break;
            case 0xC56:
              if (!*(unsigned char *)(a1 + 3)) {
                sub_10025B8C0();
              }
              if (a2 <= 4) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 332, "ByteStream_NumReadBytesAvail(bs) >= 1");
              }
              uint64_t result = 0;
              byte_100A04E06 = *(unsigned char *)(a1 + 4);
              break;
            case 0xC59:
              if (!*(unsigned char *)(a1 + 3)) {
                sub_10025B8C0();
              }
              if (a2 <= 4) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 337, "ByteStream_NumReadBytesAvail(bs) >= 1");
              }
              uint64_t result = 0;
              char v7 = *(unsigned char *)(a1 + 4);
              uint64_t v8 = &byte_100A04F02;
              goto LABEL_107;
            case 0xC5B:
              if (!*(unsigned char *)(a1 + 3)) {
                sub_10025B8C0();
              }
              if (a2 <= 4) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 343, "ByteStream_NumReadBytesAvail(bs) >= 1");
              }
              uint64_t result = 0;
              byte_100A04E07 = *(unsigned char *)(a1 + 4);
              break;
            default:
              goto LABEL_113;
          }
          break;
      }
    }
    else
    {
      switch(*(_WORD *)(a1 + 1))
      {
        case 0xC16:
          if (v4 <= 1) {
            sub_10025B8C0();
          }
          if (a2 <= 5) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 233, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          uint64_t result = 0;
          word_100A04DE0 = *(_WORD *)(a1 + 4);
          return result;
        case 0xC17:
        case 0xC19:
        case 0xC1B:
        case 0xC1D:
        case 0xC1F:
        case 0xC21:
        case 0xC23:
        case 0xC25:
        case 0xC27:
        case 0xC28:
        case 0xC29:
        case 0xC2B:
        case 0xC2D:
        case 0xC2E:
          goto LABEL_113;
        case 0xC18:
          if (v4 <= 1) {
            sub_10025B8C0();
          }
          if (a2 <= 5) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 238, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          uint64_t result = 0;
          word_100A04DE4 = *(_WORD *)(a1 + 4);
          return result;
        case 0xC1A:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 243, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF0 = *(unsigned char *)(a1 + 4);
          return result;
        case 0xC1C:
          if (v4 <= 3) {
            sub_10025B8C0();
          }
          if (a2 <= 5) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 248, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          word_100A04DE6 = *(_WORD *)(a1 + 4);
          if (a2 <= 7) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 249, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          uint64_t result = 0;
          word_100A04DE8 = *(_WORD *)(a1 + 6);
          return result;
        case 0xC1E:
          if (v4 <= 3) {
            sub_10025B8C0();
          }
          if (a2 <= 5) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 254, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          word_100A04DEA = *(_WORD *)(a1 + 4);
          if (a2 <= 7) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 255, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          uint64_t result = 0;
          word_100A04DEC = *(_WORD *)(a1 + 6);
          return result;
        case 0xC20:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 260, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF1 = *(unsigned char *)(a1 + 4);
          return result;
        case 0xC22:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 265, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF2 = *(unsigned char *)(a1 + 4);
          return result;
        case 0xC24:
          if (v4 <= 2) {
            sub_10025B8C0();
          }
          if (a2 <= 6) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 326, "ByteStream_NumReadBytesAvail(bs) >= 3");
          }
          uint64_t result = 0;
          uint64_t v8 = &byte_100A04EF9;
          dword_100A04EFC = *(unsigned __int16 *)(a1 + 4) | (*(unsigned __int8 *)(a1 + 6) << 16);
          goto LABEL_108;
        case 0xC26:
          if (v4 <= 1) {
            sub_10025B8C0();
          }
          if (a2 <= 5) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 270, "ByteStream_NumReadBytesAvail(bs) >= 2");
          }
          uint64_t result = 0;
          word_100A04DE2 = *(_WORD *)(a1 + 4);
          return result;
        case 0xC2A:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 275, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF3 = *(unsigned char *)(a1 + 4);
          return result;
        case 0xC2C:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 280, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF4 = *(unsigned char *)(a1 + 4);
          return result;
        case 0xC2F:
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 285, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          byte_100A04DF5 = *(unsigned char *)(a1 + 4);
          return result;
        default:
          if (v5 == 2063)
          {
            if (!*(unsigned char *)(a1 + 3)) {
              sub_10025B8C0();
            }
            if (a2 <= 4) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 228, "ByteStream_NumReadBytesAvail(bs) >= 1");
            }
            uint64_t result = 0;
            word_100A04DEE = *(unsigned __int8 *)(a1 + 4);
            return result;
          }
          if (v5 != 3082) {
            goto LABEL_113;
          }
          if (!*(unsigned char *)(a1 + 3)) {
            sub_10025B8C0();
          }
          if (a2 <= 4) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/hci/hciparmcache.c", 320, "ByteStream_NumReadBytesAvail(bs) >= 1");
          }
          uint64_t result = 0;
          char v7 = *(unsigned char *)(a1 + 4);
          uint64_t v8 = &byte_100A04F00;
          break;
      }
LABEL_107:
      v8[1] = v7;
LABEL_108:
      *uint64_t v8 = 1;
    }
  }
  else
  {
    sub_10025B8C0();
    return 101;
  }
  return result;
}

uint64_t sub_1001A1AB0(void *a1)
{
  if (!a1) {
    sub_10025B8C0();
  }
  off_100A04F08 = a1;
  byte_100A04F10 = 1;
  sub_10025AF38(off_10099DE58);
  return 0;
}

void sub_1001A1AFC(uint64_t a1)
{
  if (byte_100A04F10 == 1) {
    sub_10025B144((void (**)(uint64_t))off_10099DE58, a1);
  }
}

uint64_t sub_1001A1B20()
{
  byte_100A04F10 = 0;
  io_registry_entry_t v0 = (uint64_t (*)(void))off_100A04F08;
  off_100A04F08 = 0;
  if (v0) {
    return v0();
  }
  return result;
}

void sub_1001A1B40(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A04EF9)
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(81, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, dword_100A04EFC);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (v8 != 628 && sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WriteClassofDevice failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint32_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_1001A2DDC(v9);
    }
  }
  else
  {
    sub_1001A2DDC(0);
  }
}

void sub_1001A1C28(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A04F00)
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(59, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04F01);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (v8 != 628 && sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WritePINType failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint32_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_1001A2DDC(v9);
    }
  }
  else
  {
    sub_1001A2DDC(0);
  }
}

void sub_1001A1D10(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(67, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_100A04DE0);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteConnectionAcceptTimeout failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A1DC8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(69, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_100A04DE4);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageTimeout failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A1E80(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(71, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF0);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteScanEnable failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A1F38(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(73, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_100A04DE6);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanActivity failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A1FF8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(75, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_100A04DEA);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryScanActivity failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A20B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(77, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF1);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteAuthenticationEnable failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2170(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(79, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF2);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteEncryptionMode failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2228(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(83, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_100A04DE2);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteVoiceSetting failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A22E0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(87, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF3);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteNumBroadcastRetransmissions failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2398(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(89, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF4);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteHoldModeActivity failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2450(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(92, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF5);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteSCOFlowControlEnable failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2508(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(102, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF6);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanPeriodMode failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A25C0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(104, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF7);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanMode failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2678(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(107, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF8);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryScanType failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2730(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(109, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DF9);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryMode failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A27E8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(111, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DFA);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WritePageScanType failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A28A0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(113, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04DFB);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteAfhChannelAssessmentMode failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2958(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(51, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (unsigned __int16)word_100A04DEE);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteDefaultLinkPolicySettings failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2A10(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(105, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, (uint64_t)&qword_100A04DFC);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_SetAfhHostChannelClassification failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2AC8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(118, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04E06);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteSimplePairingMode failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2B80(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(124, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04E07);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteDefaultErroneousDataReporting failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2C38(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  byte_100A19634 = 1;
  uint64_t v8 = sub_10001BDE0(115, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04E08);
  byte_100A19634 = 0;
  if (v8)
  {
    uint64_t v9 = v8;
    if (v8 != 628 && sub_100058654())
    {
      sub_100056E24((uint64_t)"OI_HCICMD_WriteExtendedInquiryResponse failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
      uint32_t v17 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_1001A2DDC(v9);
  }
}

void sub_1001A2CF4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (byte_100A04F02)
  {
    byte_100A19634 = 1;
    uint64_t v8 = sub_10001BDE0(121, (uint64_t)sub_1001A2DDC, a3, a4, a5, a6, a7, a8, byte_100A04F03);
    byte_100A19634 = 0;
    if (v8)
    {
      uint64_t v9 = v8;
      if (v8 != 628 && sub_100058654())
      {
        sub_100056E24((uint64_t)"OI_HCICMD_WriteInquiryResponseTxPowerLevel failed %!", v10, v11, v12, v13, v14, v15, v16, v9);
        uint32_t v17 = sub_100050B4C(0x2Eu);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
          sub_100744F6C();
        }
      }
      sub_1001A2DDC(v9);
    }
  }
  else
  {
    sub_1001A2DDC(0);
  }
}

void sub_1001A2DDC(uint64_t a1)
{
  if (byte_100A04F10)
  {
    if (a1 == 628)
    {
LABEL_19:
      sub_10025B0BC((uint64_t)off_10099DE58);
      return;
    }
    if (a1 == 717)
    {
      if (!sub_100058654()) {
        goto LABEL_19;
      }
      sub_100056E24((uint64_t)"Unsupported command %!, ignoring error", v2, v3, v4, v5, v6, v7, v8, 717);
      uint64_t v9 = sub_100050B4C(0x2Eu);
      if (!os_log_type_enabled(v9, OS_LOG_TYPE_ERROR)) {
        goto LABEL_19;
      }
      goto LABEL_6;
    }
    if ((a1 - 701) <= 0x44)
    {
      if (!sub_100058654()) {
        goto LABEL_19;
      }
      sub_100056E24((uint64_t)"Assuming unsupported command %!, ignoring error", v18, v19, v20, v21, v22, v23, v24, a1);
      uint64_t v25 = sub_100050B4C(0x2Eu);
      if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
        goto LABEL_19;
      }
LABEL_6:
      sub_100744F6C();
      goto LABEL_19;
    }
    if (!a1) {
      goto LABEL_19;
    }
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"commonRestoreCb %!", v26, v27, v28, v29, v30, v31, v32, a1);
      BOOL v33 = sub_100050B4C(0x2Eu);
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    sub_10025B144((void (**)(uint64_t))off_10099DE58, a1);
  }
  else if (sub_100058654())
  {
    sub_100056E24((uint64_t)"Orphaned parm chache callback", v10, v11, v12, v13, v14, v15, v16, v34);
    uint32_t v17 = sub_100050B4C(0x2Eu);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR)) {
      sub_100744F6C();
    }
  }
}

void sub_1001A2F64(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %d, Byte 0x%x, hlCb 0x%x", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    if (a2) {
      goto LABEL_6;
    }
    return;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_14;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_14:
    uint64_t v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_16;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 66, v16);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (a2) {
LABEL_6:
  }
    a2(a1, v13);
}

void sub_1001A3074(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v15 = *((unsigned __int16 *)a3 + 5);
      uint64_t v16 = *((unsigned __int16 *)a3 + 6);
      if (v15 > v16)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v17 = *a3;
          *((_WORD *)a3 + 6) = v16 + 1;
          if (v15 <= (int)v16 + 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 84, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = *(unsigned __int8 *)(v17 + v16);
          *((_WORD *)a3 + 6) = v16 + 2;
          uint64_t v14 = *(unsigned __int8 *)(v17 + v16 + 1);
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_17:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 83, v18);
      }
    }
    uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %d,  Byte 0x%x, Byte1 0x%x, hlCb 0x%x", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14);
}

void sub_1001A31B4(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v16 = *((unsigned __int16 *)a3 + 5);
      uint64_t v17 = *((unsigned __int16 *)a3 + 6);
      if (v16 > v17)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v18 = *a3;
          *((_WORD *)a3 + 6) = v17 + 1;
          if (v16 <= (int)v17 + 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 103, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = *(unsigned __int8 *)(v18 + v17);
          *((_WORD *)a3 + 6) = v17 + 2;
          if (v16 <= (int)v17 + 2) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 104, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v14 = *(unsigned __int8 *)(v18 + v17 + 1);
          *((_WORD *)a3 + 6) = v17 + 3;
          uint64_t v15 = *(unsigned __int8 *)(v18 + v17 + 2);
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        uint64_t v19 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_18:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 102, v19);
      }
    }
    uint64_t v19 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_18;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %d,  Byte 0x%x, Byte1 0x%x, Byte2 0x%x, hlCb 0x%x", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14, v15);
}

void sub_1001A332C(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v15 = *((unsigned __int16 *)a3 + 5);
      uint64_t v16 = *((unsigned __int16 *)a3 + 6);
      if ((int)(v15 - v16) > 1)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v17 = *a3;
          uint64_t v18 = (unsigned __int8 *)(*a3 + v16);
          int v19 = *v18;
          int v20 = v18[1];
          *((_WORD *)a3 + 6) = v16 + 2;
          if (v15 <= (unsigned __int16)(v16 + 2)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 123, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = v19 | (v20 << 8);
          *((_WORD *)a3 + 6) = v16 + 3;
          uint64_t v14 = *(unsigned __int8 *)(v17 + (unsigned __int16)(v16 + 2));
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        uint64_t v21 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_17:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 122, v21);
      }
    }
    uint64_t v21 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %d, ConnectionHandle 0x%x, Byte 0x%x, hlCb 0x%x", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14);
}

void sub_1001A3480(uint64_t a1, void (*a2)(uint64_t, void, void, uint64_t, void), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      int v17 = *((unsigned __int16 *)a3 + 5);
      uint64_t v18 = *((unsigned __int16 *)a3 + 6);
      if (v17 - (int)v18 > 1)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v19 = *a3;
          unsigned __int16 v13 = *(_WORD *)(*a3 + v18);
          *((_WORD *)a3 + 6) = v18 + 2;
          if (v17 - (unsigned __int16)(v18 + 2) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 141, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          unsigned __int16 v14 = *(_WORD *)(v19 + (unsigned __int16)(v18 + 2));
          *((_WORD *)a3 + 6) = v18 + 4;
          if (v17 - (unsigned __int16)(v18 + 4) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 142, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          int v20 = (unsigned __int8 *)(v19 + (unsigned __int16)(v18 + 4));
          int v21 = *v20;
          int v22 = v20[1];
          *((_WORD *)a3 + 6) = v18 + 6;
          if (v17 - (unsigned __int16)(v18 + 6) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 143, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          uint64_t v15 = v21 | (v22 << 8);
          unsigned __int16 v16 = *(_WORD *)(v19 + (unsigned __int16)(v18 + 6));
          *((_WORD *)a3 + 6) = v18 + 8;
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        uint64_t v23 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 140, v23);
      }
    }
    uint64_t v23 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_19;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!, transmitting %d, receiving %d, sleep %d, others %d", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  unsigned __int16 v13 = 0;
  unsigned __int16 v14 = 0;
  uint64_t v15 = 0;
  unsigned __int16 v16 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14, v15, v16);
}

uint64_t sub_1001A3658(uint64_t a1, uint64_t (*a2)(uint64_t, _DWORD *), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"EnhancedProfilingStats VSC failed with status %!", v4, v5, v6, v7, v8, v9, v10, a1);
      uint64_t v11 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    unsigned int v12 = 0;
    int v13 = 0;
    int v14 = 0;
    int v15 = 0;
    int v16 = 0;
    int v17 = 0;
    int v18 = 0;
    int v19 = 0;
    int v20 = 0;
    int v21 = 0;
    int v69 = 0;
    int v70 = 0;
    uint64_t v82 = 0;
    uint64_t v83 = 0;
    int v22 = 0;
    int v23 = 0;
    int v24 = 0;
    int v25 = 0;
    int v26 = 0;
    int v27 = 0;
    int v28 = 0;
    int v72 = 0;
    int v73 = 0;
    uint64_t v75 = 0;
    uint64_t v76 = 0;
    unint64_t v77 = 0;
    uint64_t v78 = 0;
    uint64_t v80 = 0;
    uint64_t v81 = 0;
    uint64_t v79 = 0;
    int v29 = 0;
    uint64_t v85 = 0;
    uint64_t v86 = 0;
    int v30 = 0;
    uint64_t v74 = 0;
    int v71 = 0;
    int v68 = 0;
    int v31 = 0;
    int v32 = 0;
    int v33 = 0;
    int v34 = 0;
    int v35 = 0;
    int v36 = 0;
    int v37 = 0;
    uint64_t result = 0;
    uint64_t v39 = 0;
    goto LABEL_80;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_85;
  }
  unsigned int v40 = *((unsigned __int16 *)a3 + 5);
  uint64_t v41 = *((unsigned __int16 *)a3 + 6);
  if (v40 <= v41)
  {
LABEL_85:
    uint64_t v65 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_87;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v65 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_87:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 173, v65);
  }
  uint64_t v42 = *a3;
  *((_WORD *)a3 + 6) = v41 + 1;
  if ((int)(v40 - (v41 + 1)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 176, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  unsigned int v12 = *(unsigned __int8 *)(v42 + v41);
  int v67 = *(unsigned __int16 *)(v42 + v41 + 1);
  *((_WORD *)a3 + 6) = v41 + 3;
  if ((int)(v40 - (unsigned __int16)(v41 + 3)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 179, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v66 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 3));
  *((_WORD *)a3 + 6) = v41 + 5;
  if ((int)(v40 - (unsigned __int16)(v41 + 5)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 182, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v15 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 5));
  *((_WORD *)a3 + 6) = v41 + 7;
  if ((int)(v40 - (unsigned __int16)(v41 + 7)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 185, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  int v16 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 7));
  *((_WORD *)a3 + 6) = v41 + 9;
  if ((int)(v40 - (unsigned __int16)(v41 + 9)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 188, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v43 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 9));
  *((_WORD *)a3 + 6) = v41 + 13;
  if ((int)(v40 - (unsigned __int16)(v41 + 13)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 189, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v18 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 13));
  *((_WORD *)a3 + 6) = v41 + 17;
  if ((int)(v40 - (unsigned __int16)(v41 + 17)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 190, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v19 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 17));
  *((_WORD *)a3 + 6) = v41 + 21;
  if ((int)(v40 - (unsigned __int16)(v41 + 21)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 191, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v20 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 21));
  *((_WORD *)a3 + 6) = v41 + 25;
  if ((int)(v40 - (unsigned __int16)(v41 + 25)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 192, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v44 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 25));
  *((_WORD *)a3 + 6) = v41 + 29;
  if ((int)(v40 - (unsigned __int16)(v41 + 29)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 193, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v45 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 29));
  *((_WORD *)a3 + 6) = v41 + 33;
  if ((int)(v40 - (unsigned __int16)(v41 + 33)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 194, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v46 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 33));
  *((_WORD *)a3 + 6) = v41 + 37;
  if ((int)(v40 - (unsigned __int16)(v41 + 37)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 195, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v47 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 37));
  *((_WORD *)a3 + 6) = v41 + 41;
  if ((int)(v40 - (unsigned __int16)(v41 + 41)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 196, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v22 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 41));
  *((_WORD *)a3 + 6) = v41 + 45;
  if ((int)(v40 - (unsigned __int16)(v41 + 45)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 197, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v23 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 45));
  *((_WORD *)a3 + 6) = v41 + 49;
  if ((int)(v40 - (unsigned __int16)(v41 + 49)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 198, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v24 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 49));
  *((_WORD *)a3 + 6) = v41 + 53;
  if ((int)(v40 - (unsigned __int16)(v41 + 53)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 199, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v25 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 53));
  *((_WORD *)a3 + 6) = v41 + 57;
  if ((int)(v40 - (unsigned __int16)(v41 + 57)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 200, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v26 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 57));
  *((_WORD *)a3 + 6) = v41 + 61;
  if ((int)(v40 - (unsigned __int16)(v41 + 61)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 201, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v27 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 61));
  *((_WORD *)a3 + 6) = v41 + 65;
  if ((int)(v40 - (unsigned __int16)(v41 + 65)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 202, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v28 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 65));
  *((_WORD *)a3 + 6) = v41 + 69;
  if ((int)(v40 - (unsigned __int16)(v41 + 69)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 203, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v48 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 69));
  *((_WORD *)a3 + 6) = v41 + 73;
  if ((int)(v40 - (unsigned __int16)(v41 + 73)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 204, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v49 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 73));
  *((_WORD *)a3 + 6) = v41 + 77;
  if ((int)(v40 - (unsigned __int16)(v41 + 77)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 205, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  unsigned int v50 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 77));
  *((_WORD *)a3 + 6) = v41 + 81;
  if ((int)(v40 - (unsigned __int16)(v41 + 81)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 206, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v83) = v47;
  unsigned int v51 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 81));
  *((_WORD *)a3 + 6) = v41 + 85;
  if ((int)(v40 - (unsigned __int16)(v41 + 85)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 207, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v52 = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 85));
  *((_WORD *)a3 + 6) = v41 + 89;
  if ((int)(v40 - (unsigned __int16)(v41 + 89)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 208, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  LODWORD(v83) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 89));
  *((_WORD *)a3 + 6) = v41 + 93;
  if ((int)(v40 - (unsigned __int16)(v41 + 93)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 209, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v82) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 93));
  *((_WORD *)a3 + 6) = v41 + 97;
  if ((int)(v40 - (unsigned __int16)(v41 + 97)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 210, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  LODWORD(v82) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 97));
  *((_WORD *)a3 + 6) = v41 + 101;
  if ((int)(v40 - (unsigned __int16)(v41 + 101)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 211, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v81) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 101));
  *((_WORD *)a3 + 6) = v41 + 105;
  if ((int)(v40 - (unsigned __int16)(v41 + 105)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 212, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  LODWORD(v81) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 105));
  *((_WORD *)a3 + 6) = v41 + 109;
  if ((int)(v40 - (unsigned __int16)(v41 + 109)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 213, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v80) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 109));
  *((_WORD *)a3 + 6) = v41 + 113;
  if ((int)(v40 - (unsigned __int16)(v41 + 113)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 214, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  LODWORD(v80) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 113));
  *((_WORD *)a3 + 6) = v41 + 117;
  if ((int)(v40 - (unsigned __int16)(v41 + 117)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 215, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v79) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 117));
  *((_WORD *)a3 + 6) = v41 + 121;
  if ((int)(v40 - (unsigned __int16)(v41 + 121)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 216, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  LODWORD(v79) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 121));
  *((_WORD *)a3 + 6) = v41 + 125;
  if ((int)(v40 - (unsigned __int16)(v41 + 125)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 217, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v78) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 125));
  *((_WORD *)a3 + 6) = v41 + 129;
  if ((int)(v40 - (unsigned __int16)(v41 + 129)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 218, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  LODWORD(v78) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 129));
  *((_WORD *)a3 + 6) = v41 + 133;
  if ((int)(v40 - (unsigned __int16)(v41 + 133)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 219, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  HIDWORD(v76) = v52;
  unint64_t v77 = __PAIR64__(v50, v51);
  LODWORD(v76) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 133));
  *((_WORD *)a3 + 6) = v41 + 137;
  if ((int)(v40 - (unsigned __int16)(v41 + 137)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 220, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  int v29 = 0;
  LODWORD(v75) = *(_DWORD *)(v42 + (unsigned __int16)(v41 + 137));
  HIDWORD(v75) = v49;
  unsigned __int16 v53 = v41 + 141;
  *((_WORD *)a3 + 6) = v41 + 141;
  if (v12 > 0x16)
  {
    uint64_t v86 = 0;
    uint64_t v85 = 0;
  }
  else
  {
    uint64_t v86 = 0;
    uint64_t v85 = 0;
    if (((1 << v12) & 0x5A0000) != 0)
    {
      if ((int)(v40 - v53) <= 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 226, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      int v29 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 141));
      *((_WORD *)a3 + 6) = v41 + 143;
      if ((int)(v40 - (unsigned __int16)(v41 + 143)) <= 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 228, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      int v54 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 143));
      *((_WORD *)a3 + 6) = v41 + 145;
      if ((int)(v40 - (unsigned __int16)(v41 + 145)) <= 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 230, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      LODWORD(v86) = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 145));
      HIDWORD(v86) = v54;
      *((_WORD *)a3 + 6) = v41 + 147;
      if ((int)(v40 - (unsigned __int16)(v41 + 147)) <= 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 232, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      uint64_t v55 = (unsigned __int8 *)(v42 + (unsigned __int16)(v41 + 147));
      int v56 = *v55;
      int v57 = v55[1];
      *((_WORD *)a3 + 6) = v41 + 149;
      if ((int)(v40 - (unsigned __int16)(v41 + 149)) <= 1) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 234, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      LODWORD(v85) = *(unsigned __int16 *)(v42 + (unsigned __int16)(v41 + 149));
      HIDWORD(v85) = v56 | (v57 << 8);
      unsigned __int16 v53 = v41 + 151;
      *((_WORD *)a3 + 6) = v41 + 151;
    }
  }
  int v30 = 0;
  if (v12 <= 0x16 && ((1 << v12) & 0x580000) != 0)
  {
    if ((int)(v40 - v53) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 240, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v30 = *(unsigned __int16 *)(v42 + v53);
    *((_WORD *)a3 + 6) = v53 + 2;
    if ((int)(v40 - (unsigned __int16)(v53 + 2)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 242, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    HIDWORD(v74) = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 2));
    *((_WORD *)a3 + 6) = v53 + 4;
    if ((int)(v40 - (unsigned __int16)(v53 + 4)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 244, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    LODWORD(v74) = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 4));
    *((_WORD *)a3 + 6) = v53 + 6;
    if ((int)(v40 - (unsigned __int16)(v53 + 6)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 246, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    uint64_t v58 = (unsigned __int8 *)(v42 + (unsigned __int16)(v53 + 6));
    int v59 = *v58;
    int v60 = v58[1];
    *((_WORD *)a3 + 6) = v53 + 8;
    if ((int)(v40 - (unsigned __int16)(v53 + 8)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 248, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v61 = v59 | (v60 << 8);
    int v71 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 8));
    v53 += 10;
    *((_WORD *)a3 + 6) = v53;
  }
  else
  {
    uint64_t v74 = 0;
    int v61 = 0;
    int v71 = 0;
  }
  int v72 = v61;
  int v73 = v48;
  if ((v12 | 2) == 0x16)
  {
    if ((int)(v40 - v53) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 256, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    uint64_t v62 = (unsigned __int8 *)(v42 + v53);
    int v63 = *v62;
    int v64 = v62[1];
    *((_WORD *)a3 + 6) = v53 + 2;
    if ((int)(v40 - (unsigned __int16)(v53 + 2)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 258, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v68 = v63 | (v64 << 8);
    int v31 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 2));
    v53 += 4;
    *((_WORD *)a3 + 6) = v53;
  }
  else
  {
    int v68 = 0;
    int v31 = 0;
  }
  int v69 = v46;
  int v70 = v45;
  if (v12 == 22)
  {
    if ((int)(v40 - v53) <= 3) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 268, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
    }
    int v32 = *(_DWORD *)(v42 + v53);
    *((_WORD *)a3 + 6) = v53 + 4;
    if ((int)(v40 - (unsigned __int16)(v53 + 4)) <= 3) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 270, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
    }
    int v33 = *(_DWORD *)(v42 + (unsigned __int16)(v53 + 4));
    *((_WORD *)a3 + 6) = v53 + 8;
    if ((int)(v40 - (unsigned __int16)(v53 + 8)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 272, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v34 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 8));
    *((_WORD *)a3 + 6) = v53 + 10;
    if ((int)(v40 - (unsigned __int16)(v53 + 10)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 274, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v21 = v44;
    int v35 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 10));
    *((_WORD *)a3 + 6) = v53 + 12;
    if ((int)(v40 - (unsigned __int16)(v53 + 12)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 276, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v36 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 12));
    *((_WORD *)a3 + 6) = v53 + 14;
    if ((int)(v40 - (unsigned __int16)(v53 + 14)) <= 1) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 278, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    int v17 = v43;
    int v37 = *(unsigned __int16 *)(v42 + (unsigned __int16)(v53 + 14));
    *((_WORD *)a3 + 6) = v53 + 16;
    if ((int)(v40 - (unsigned __int16)(v53 + 16)) <= 7) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 280, "ByteStream_NumReadBytesAvail(*pBs) >= 8");
    }
    uint64_t result = *(void *)(v42 + (unsigned __int16)(v53 + 16));
    *((_WORD *)a3 + 6) = v53 + 24;
    if ((int)(v40 - (unsigned __int16)(v53 + 24)) <= 7) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 282, "ByteStream_NumReadBytesAvail(*pBs) >= 8");
    }
    uint64_t v39 = *(void *)(v42 + (unsigned __int16)(v53 + 24));
    *((_WORD *)a3 + 6) = v53 + 32;
    unsigned int v12 = 22;
  }
  else
  {
    int v21 = v44;
    int v17 = v43;
    int v32 = 0;
    int v33 = 0;
    int v34 = 0;
    int v35 = 0;
    int v36 = 0;
    int v37 = 0;
    uint64_t result = 0;
    uint64_t v39 = 0;
  }
  int v14 = v66;
  int v13 = v67;
LABEL_80:
  if (a2)
  {
    v88[0] = v12;
    v88[1] = v13;
    v88[2] = v14;
    v88[3] = v15;
    v88[4] = v16;
    v88[5] = v17;
    v88[6] = v18;
    v88[7] = v19;
    v88[8] = v20;
    v88[9] = v21;
    v88[10] = v70;
    v88[11] = v69;
    v88[12] = HIDWORD(v83);
    v88[13] = v22;
    v88[14] = v23;
    v88[15] = v24;
    v88[16] = v25;
    v88[17] = v26;
    v88[18] = v27;
    v88[19] = v28;
    v88[20] = v73;
    v88[21] = HIDWORD(v75);
    v88[22] = HIDWORD(v77);
    v88[23] = v77;
    v88[24] = HIDWORD(v76);
    v88[25] = v83;
    v88[26] = HIDWORD(v82);
    v88[27] = v82;
    v88[28] = HIDWORD(v81);
    v88[29] = v81;
    v88[30] = HIDWORD(v80);
    v88[31] = v80;
    v88[32] = HIDWORD(v79);
    v88[33] = v79;
    v88[34] = HIDWORD(v78);
    v88[35] = v78;
    v88[36] = v76;
    v88[37] = v75;
    v88[38] = v29;
    v88[39] = HIDWORD(v86);
    v88[40] = v86;
    v88[41] = HIDWORD(v85);
    v88[42] = v85;
    v88[43] = v30;
    v88[44] = HIDWORD(v74);
    v88[45] = v74;
    v88[46] = v72;
    v88[47] = v71;
    v88[48] = v68;
    v88[49] = v31;
    v88[50] = v32;
    v88[51] = v33;
    v88[52] = v34;
    v88[53] = v35;
    v88[54] = v36;
    v88[55] = v37;
    uint64_t v89 = result;
    uint64_t v90 = v39;
    return a2(a1, v88);
  }
  return result;
}

void sub_1001A4628(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!, iPACounter %d, ePACounter %d, iPAThreadCounter %d, ePAThreadCounter %d", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    uint64_t v14 = 0;
    goto LABEL_15;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_19;
  }
  uint64_t v15 = *((unsigned __int16 *)a3 + 5);
  uint64_t v16 = *((unsigned __int16 *)a3 + 6);
  if ((int)v15 - (int)v16 <= 3)
  {
LABEL_19:
    int v21 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
    goto LABEL_21;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v21 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_21:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 311, v21);
  }
  uint64_t v17 = *a3;
  uint64_t v13 = *(unsigned int *)(*a3 + v16);
  *((_WORD *)a3 + 6) = v16 + 4;
  if ((int)(v15 - (unsigned __int16)(v16 + 4)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 312, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  uint64_t v14 = *(unsigned int *)(v17 + (unsigned __int16)(v16 + 4));
  *((_WORD *)a3 + 6) = v16 + 8;
  if (v15 - (unsigned __int16)(v16 + 8) != 8)
  {
LABEL_15:
    uint64_t v19 = 0;
    uint64_t v20 = 0;
    if (!a2) {
      return;
    }
    goto LABEL_16;
  }
  uint64_t v18 = (unsigned __int16)(v16 + 8);
  if ((int)v15 - (int)v18 <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 316, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  uint64_t v19 = *(unsigned int *)(v17 + v18);
  *((_WORD *)a3 + 6) = v16 + 12;
  if ((int)(v15 - (unsigned __int16)(v16 + 12)) <= 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 317, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
  }
  uint64_t v20 = *(unsigned int *)(v17 + (unsigned __int16)(v16 + 12));
  *((_WORD *)a3 + 6) = v16 + 16;
  if (a2) {
LABEL_16:
  }
    a2(a1, v13, v14, v19, v20);
}

void sub_1001A4800(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    if (a2) {
      goto LABEL_6;
    }
    return;
  }
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_14;
  }
  uint64_t v14 = *(unsigned __int16 *)(a3 + 12);
  if (*(unsigned __int16 *)(a3 + 10) - (int)v14 <= 3)
  {
LABEL_14:
    uint64_t v15 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
    goto LABEL_16;
  }
  if (*(unsigned char *)(a3 + 14) != 1)
  {
    uint64_t v15 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 336, v15);
  }
  uint64_t v13 = *(unsigned int *)(*(void *)a3 + v14);
  *(_WORD *)(a3 + 12) = v14 + 4;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13);
}

void sub_1001A4910(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      int v15 = *((unsigned __int16 *)a3 + 5);
      uint64_t v16 = *((unsigned __int16 *)a3 + 6);
      if (v15 - (int)v16 > 1)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v17 = *a3;
          uint64_t v18 = (unsigned __int8 *)(*a3 + v16);
          int v19 = *v18;
          int v20 = v18[1];
          *((_WORD *)a3 + 6) = v16 + 2;
          if (v15 - (unsigned __int16)(v16 + 2) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 355, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v13 = v19 | (v20 << 8);
          uint64_t v14 = *(unsigned int *)(v17 + (unsigned __int16)(v16 + 2));
          *((_WORD *)a3 + 6) = v16 + 6;
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        int v21 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_17:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 354, v21);
      }
    }
    int v21 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
    unsigned int v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14);
}

void sub_1001A4A68(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v16 = *((unsigned __int16 *)a3 + 5);
      uint64_t v17 = *((unsigned __int16 *)a3 + 6);
      if (v16 > v17)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v18 = *a3;
          *((_WORD *)a3 + 6) = v17 + 1;
          if (v16 <= (int)v17 + 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 373, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = *(unsigned __int8 *)(v18 + v17);
          *((_WORD *)a3 + 6) = v17 + 2;
          if (v16 <= (int)v17 + 2) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 374, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v14 = *(unsigned __int8 *)(v18 + v17 + 1);
          *((_WORD *)a3 + 6) = v17 + 3;
          uint64_t v15 = *(unsigned __int8 *)(v18 + v17 + 2);
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        int v19 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_18:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 372, v19);
      }
    }
    int v19 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_18;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
    unsigned int v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14, v15);
}

void sub_1001A4BD8(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    goto LABEL_10;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_18;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_18:
    int v24 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_20;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v24 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_20:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 391, v24);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (v13 == 1) {
    goto LABEL_12;
  }
LABEL_10:
  if (!sub_100058654()
    || (sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v16, v17, v18, v19, v20, v21, v22, a1),
        int v23 = sub_100050B4C(0x54u),
        !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
  {
LABEL_12:
    if (!a2) {
      return;
    }
    goto LABEL_13;
  }
  sub_100745764();
  if (a2) {
LABEL_13:
  }
    a2(a1, v13);
}

void sub_1001A4D38(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    uint64_t v14 = 255;
    uint64_t v15 = 255;
    uint64_t v16 = 255;
    goto LABEL_13;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_21;
  }
  unsigned int v17 = *((unsigned __int16 *)a3 + 5);
  uint64_t v18 = *((unsigned __int16 *)a3 + 6);
  if (v17 <= v18)
  {
LABEL_21:
    int v28 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_23;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v28 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_23:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 414, v28);
  }
  uint64_t v19 = *a3;
  *((_WORD *)a3 + 6) = v18 + 1;
  if (v17 <= (int)v18 + 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 415, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v16 = *(unsigned __int8 *)(v19 + v18);
  *((_WORD *)a3 + 6) = v18 + 2;
  if (v17 <= (int)v18 + 2) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 416, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v15 = *(unsigned __int8 *)(v19 + v18 + 1);
  *((_WORD *)a3 + 6) = v18 + 3;
  if (v17 <= (int)v18 + 3) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 417, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v14 = *(unsigned __int8 *)(v19 + v18 + 2);
  *((_WORD *)a3 + 6) = v18 + 4;
  uint64_t v13 = *(unsigned __int8 *)(v19 + v18 + 3);
  if (v16 == 13)
  {
LABEL_15:
    if (!a2) {
      return;
    }
    goto LABEL_16;
  }
LABEL_13:
  if (!sub_100058654()) {
    goto LABEL_15;
  }
  sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v20, v21, v22, v23, v24, v25, v26, a1);
  int v27 = sub_100050B4C(0x54u);
  if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
    goto LABEL_15;
  }
  sub_100745764();
  if (a2) {
LABEL_16:
  }
    a2(a1, v16, v15, v14, v13);
}

void sub_1001A4F44(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t, void), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    unsigned __int16 v13 = 0;
    uint64_t v14 = 0;
    uint64_t v15 = 0;
    uint64_t v16 = 255;
    goto LABEL_13;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_21;
  }
  unsigned int v17 = *((unsigned __int16 *)a3 + 5);
  uint64_t v18 = *((unsigned __int16 *)a3 + 6);
  if (v17 <= v18)
  {
LABEL_21:
    int v28 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_23;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v28 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_23:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 440, v28);
  }
  uint64_t v19 = *a3;
  *((_WORD *)a3 + 6) = v18 + 1;
  if (v17 <= (unsigned __int16)(v18 + 1)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 441, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v16 = *(unsigned __int8 *)(v19 + v18);
  *((_WORD *)a3 + 6) = v18 + 2;
  if (v17 <= (unsigned __int16)(v18 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 442, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v15 = *(unsigned __int8 *)(v19 + v18 + 1);
  *((_WORD *)a3 + 6) = v18 + 3;
  if ((int)(v17 - (v18 + 3)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 443, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v14 = *(unsigned __int8 *)(v19 + v18 + 2);
  unsigned __int16 v13 = *(_WORD *)(v19 + v18 + 3);
  *((_WORD *)a3 + 6) = v18 + 5;
  if (v16 == 2)
  {
LABEL_15:
    if (!a2) {
      return;
    }
    goto LABEL_16;
  }
LABEL_13:
  if (!sub_100058654()) {
    goto LABEL_15;
  }
  sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v20, v21, v22, v23, v24, v25, v26, a1);
  int v27 = sub_100050B4C(0x54u);
  if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR)) {
    goto LABEL_15;
  }
  sub_100745764();
  if (a2) {
LABEL_16:
  }
    a2(a1, v16, v15, v14, v13);
}

void sub_1001A5154(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    goto LABEL_10;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_18;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_18:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_20;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v24 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_20:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 463, v24);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (v13 == 3) {
    goto LABEL_12;
  }
LABEL_10:
  if (!sub_100058654()
    || (sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v16, v17, v18, v19, v20, v21, v22, a1),
        uint64_t v23 = sub_100050B4C(0x54u),
        !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
  {
LABEL_12:
    if (!a2) {
      return;
    }
    goto LABEL_13;
  }
  sub_100745764();
  if (a2) {
LABEL_13:
  }
    a2(a1, v13);
}

uint64_t sub_1001A52B4(uint64_t a1, uint64_t (*a2)(uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    goto LABEL_12;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_19;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_19:
    uint64_t v25 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_21;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v25 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_21:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 483, v25);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (v13 == 12)
  {
    uint64_t result = 0;
    if (!a2) {
      return result;
    }
    return a2(result);
  }
LABEL_12:
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"SubOpcode Incorrect %x!", v17, v18, v19, v20, v21, v22, v23, v13);
    uint64_t v24 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t result = 101;
  if (a2) {
    return a2(result);
  }
  return result;
}

void sub_1001A540C(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    goto LABEL_10;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_18;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_18:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_20;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v24 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_20:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 505, v24);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (v13 == 7) {
    goto LABEL_12;
  }
LABEL_10:
  if (!sub_100058654()
    || (sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v16, v17, v18, v19, v20, v21, v22, a1),
        uint64_t v23 = sub_100050B4C(0x54u),
        !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
  {
LABEL_12:
    if (!a2) {
      return;
    }
    goto LABEL_13;
  }
  sub_100745764();
  if (a2) {
LABEL_13:
  }
    a2(a1, v13);
}

void sub_1001A556C(uint64_t a1, void (*a2)(uint64_t))
{
  if (a1
    && sub_100058654()
    && (sub_100056E24((uint64_t)"status %!", v4, v5, v6, v7, v8, v9, v10, a1),
        uint64_t v11 = sub_100050B4C(0x54u),
        os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)))
  {
    sub_100745764();
    if (!a2) {
      return;
    }
  }
  else if (!a2)
  {
    return;
  }
  a2(a1);
}

void sub_1001A55F8(uint64_t a1, void (*a2)(uint64_t))
{
  if (a1
    && sub_100058654()
    && (sub_100056E24((uint64_t)"status %!", v4, v5, v6, v7, v8, v9, v10, a1),
        uint64_t v11 = sub_100050B4C(0x54u),
        os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)))
  {
    sub_100745764();
    if (!a2) {
      return;
    }
  }
  else if (!a2)
  {
    return;
  }
  a2(a1);
}

void sub_1001A5684(uint64_t a1, void (*a2)(uint64_t))
{
  if (a1
    && sub_100058654()
    && (sub_100056E24((uint64_t)"status %!", v4, v5, v6, v7, v8, v9, v10, a1),
        uint64_t v11 = sub_100050B4C(0x54u),
        os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)))
  {
    sub_100745764();
    if (!a2) {
      return;
    }
  }
  else if (!a2)
  {
    return;
  }
  a2(a1);
}

void sub_1001A5710(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    goto LABEL_10;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_18;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_18:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_20;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v24 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_20:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 564, v24);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (v13 == 4) {
    goto LABEL_12;
  }
LABEL_10:
  if (!sub_100058654()
    || (sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v16, v17, v18, v19, v20, v21, v22, a1),
        uint64_t v23 = sub_100050B4C(0x54u),
        !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
  {
LABEL_12:
    if (!a2) {
      return;
    }
    goto LABEL_13;
  }
  sub_100745764();
  if (a2) {
LABEL_13:
  }
    a2(a1, v13);
}

void sub_1001A5870(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    goto LABEL_10;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_18;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_18:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_20;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v24 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_20:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 584, v24);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (v13 == 5) {
    goto LABEL_12;
  }
LABEL_10:
  if (!sub_100058654()
    || (sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v16, v17, v18, v19, v20, v21, v22, a1),
        uint64_t v23 = sub_100050B4C(0x54u),
        !os_log_type_enabled(v23, OS_LOG_TYPE_ERROR)))
  {
LABEL_12:
    if (!a2) {
      return;
    }
    goto LABEL_13;
  }
  sub_100745764();
  if (a2) {
LABEL_13:
  }
    a2(a1, v13);
}

void sub_1001A59D0(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    uint64_t v14 = 255;
    goto LABEL_11;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_19;
  }
  unsigned int v15 = *((unsigned __int16 *)a3 + 5);
  uint64_t v16 = *((unsigned __int16 *)a3 + 6);
  if (v15 <= v16)
  {
LABEL_19:
    uint64_t v26 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_21;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v26 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_21:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 605, v26);
  }
  uint64_t v17 = *a3;
  *((_WORD *)a3 + 6) = v16 + 1;
  if (v15 <= (int)v16 + 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 606, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v14 = *(unsigned __int8 *)(v17 + v16);
  *((_WORD *)a3 + 6) = v16 + 2;
  uint64_t v13 = *(unsigned __int8 *)(v17 + v16 + 1);
  if (v14 == 6)
  {
LABEL_13:
    if (!a2) {
      return;
    }
    goto LABEL_14;
  }
LABEL_11:
  if (!sub_100058654()) {
    goto LABEL_13;
  }
  sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v18, v19, v20, v21, v22, v23, v24, a1);
  uint64_t v25 = sub_100050B4C(0x54u);
  if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR)) {
    goto LABEL_13;
  }
  sub_100745764();
  if (a2) {
LABEL_14:
  }
    a2(a1, v14, v13);
}

void sub_1001A5B6C(uint64_t a1, void (*a2)(uint64_t, void), uint64_t a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    unsigned __int16 v13 = 0;
    if (a2) {
      goto LABEL_6;
    }
    return;
  }
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_14;
  }
  uint64_t v14 = *(unsigned __int16 *)(a3 + 12);
  if (*(unsigned __int16 *)(a3 + 10) - (int)v14 <= 1)
  {
LABEL_14:
    unsigned int v15 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_16;
  }
  if (*(unsigned char *)(a3 + 14) != 1)
  {
    unsigned int v15 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 626, v15);
  }
  unsigned __int16 v13 = *(_WORD *)(*(void *)a3 + v14);
  *(_WORD *)(a3 + 12) = v14 + 2;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13);
}

void sub_1001A5C80(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    uint64_t v14 = 0;
    uint64_t v15 = 255;
    goto LABEL_12;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_20;
  }
  unsigned int v16 = *((unsigned __int16 *)a3 + 5);
  uint64_t v17 = *((unsigned __int16 *)a3 + 6);
  if (v16 <= v17)
  {
LABEL_20:
    int v30 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_22;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v30 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_22:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 645, v30);
  }
  uint64_t v18 = *a3;
  *((_WORD *)a3 + 6) = v17 + 1;
  if ((int)(v16 - (v17 + 1)) <= 1) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 646, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
  }
  uint64_t v15 = *(unsigned __int8 *)(v18 + v17);
  uint64_t v19 = (unsigned __int8 *)(v18 + v17 + 1);
  int v20 = *v19;
  int v21 = v19[1];
  *((_WORD *)a3 + 6) = v17 + 3;
  if (v16 <= (unsigned __int16)(v17 + 3)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 647, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v14 = v20 | (v21 << 8);
  *((_WORD *)a3 + 6) = v17 + 4;
  uint64_t v13 = *(unsigned __int8 *)(v18 + (unsigned __int16)(v17 + 3));
  if (!v15)
  {
LABEL_14:
    if (!a2) {
      return;
    }
    goto LABEL_15;
  }
LABEL_12:
  if (!sub_100058654()) {
    goto LABEL_14;
  }
  sub_100056E24((uint64_t)"SubOpcode Incorrect %!", v22, v23, v24, v25, v26, v27, v28, a1);
  int v29 = sub_100050B4C(0x54u);
  if (!os_log_type_enabled(v29, OS_LOG_TYPE_ERROR)) {
    goto LABEL_14;
  }
  sub_100745764();
  if (a2) {
LABEL_15:
  }
    a2(a1, v15, v14, v13);
}

void sub_1001A5E60(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, int *, int *, int *, int), uint64_t *a3)
{
  char v36 = 0;
  int v35 = 0;
  char v34 = 0;
  int v33 = 0;
  char v32 = 0;
  int v31 = 0;
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      unsigned int v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    uint64_t v14 = 0;
    uint64_t v15 = 0;
    uint64_t v16 = 0;
    goto LABEL_20;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_26;
  }
  unsigned int v18 = *((unsigned __int16 *)a3 + 5);
  uint64_t v19 = *((unsigned __int16 *)a3 + 6);
  if (v18 <= v19)
  {
LABEL_26:
    int v29 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_28;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v29 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_28:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 674, v29);
  }
  uint64_t v20 = *a3;
  *((_WORD *)a3 + 6) = v19 + 1;
  if (v18 <= (unsigned __int16)(v19 + 1)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 675, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v13 = *(unsigned __int8 *)(v20 + v19);
  *((_WORD *)a3 + 6) = v19 + 2;
  if (v18 <= (unsigned __int16)(v19 + 2)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 676, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v14 = *(unsigned __int8 *)(v20 + v19 + 1);
  *((_WORD *)a3 + 6) = v19 + 3;
  if (v18 <= (unsigned __int16)(v19 + 3)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 677, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  uint64_t v15 = *(unsigned __int8 *)(v20 + v19 + 2);
  uint64_t v21 = v19 + 4;
  *((_WORD *)a3 + 6) = v19 + 4;
  uint64_t v16 = *(unsigned __int8 *)(v20 + v19 + 3);
  if ((v13 - 1) > 1u)
  {
LABEL_20:
    char v28 = 0;
    if (!a2) {
      return;
    }
    goto LABEL_21;
  }
  if ((int)(v18 - v21) <= 4) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 679, "ByteStream_NumReadBytesAvail(*pBs) >= (5)");
  }
  uint64_t v22 = (int *)(v20 + v21);
  int v23 = *v22;
  char v36 = *((unsigned char *)v22 + 4);
  int v35 = v23;
  *((_WORD *)a3 + 6) = v19 + 9;
  if ((int)(v18 - (unsigned __int16)(v19 + 9)) <= 4) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 680, "ByteStream_NumReadBytesAvail(*pBs) >= (5)");
  }
  uint64_t v24 = (int *)(v20 + (unsigned __int16)(v19 + 9));
  int v25 = *v24;
  char v34 = *((unsigned char *)v24 + 4);
  int v33 = v25;
  *((_WORD *)a3 + 6) = v19 + 14;
  if ((int)(v18 - (unsigned __int16)(v19 + 14)) <= 4) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 681, "ByteStream_NumReadBytesAvail(*pBs) >= (5)");
  }
  uint64_t v26 = (int *)(v20 + (unsigned __int16)(v19 + 14));
  int v27 = *v26;
  char v32 = *((unsigned char *)v26 + 4);
  int v31 = v27;
  *((_WORD *)a3 + 6) = v19 + 19;
  if (v13 != 2)
  {
    char v28 = 0;
    uint64_t v13 = 1;
    if (!a2) {
      return;
    }
LABEL_21:
    LOBYTE(v30) = v28;
    a2(a1, v13, v14, v15, v16, &v35, &v33, &v31, v30);
    return;
  }
  if (v18 <= (unsigned __int16)(v19 + 19)) {
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 683, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
  }
  *((_WORD *)a3 + 6) = v19 + 20;
  char v28 = *(unsigned char *)(v20 + (unsigned __int16)(v19 + 19));
  uint64_t v13 = 2;
  if (a2) {
    goto LABEL_21;
  }
}

uint64_t sub_1001A614C(uint64_t a1, uint64_t (*a2)(uint64_t, void, void, void, void, void, void, void, int), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v24 = *((unsigned __int16 *)a3 + 5);
      uint64_t v25 = *((unsigned __int16 *)a3 + 6);
      if ((int)(v24 - v25) > 1)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v26 = *a3;
          unsigned __int16 v14 = *(_WORD *)(*a3 + v25);
          *((_WORD *)a3 + 6) = v25 + 2;
          if (v24 <= (unsigned __int16)(v25 + 2)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 713, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *((_WORD *)a3 + 6) = v25 + 3;
          if (v24 <= (unsigned __int16)(v25 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 714, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v15 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 2));
          *((_WORD *)a3 + 6) = v25 + 4;
          if (v24 <= (unsigned __int16)(v25 + 4)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 715, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v16 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 3));
          *((_WORD *)a3 + 6) = v25 + 5;
          if (v24 <= (unsigned __int16)(v25 + 5)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 716, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v17 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 4));
          *((_WORD *)a3 + 6) = v25 + 6;
          if (v24 <= (unsigned __int16)(v25 + 6)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 717, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v18 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 5));
          *((_WORD *)a3 + 6) = v25 + 7;
          if (v24 <= (unsigned __int16)(v25 + 7)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 718, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v19 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 6));
          *((_WORD *)a3 + 6) = v25 + 8;
          if (v24 <= (unsigned __int16)(v25 + 8)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 719, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v20 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 7));
          *((_WORD *)a3 + 6) = v25 + 9;
          if (v24 <= (unsigned __int16)(v25 + 9)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 720, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t result = *(unsigned __int8 *)(v26 + (unsigned __int16)(v25 + 8));
          *((_WORD *)a3 + 6) = v25 + 10;
          if (v24 <= (unsigned __int16)(v25 + 10)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 721, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v21 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 9));
          *((_WORD *)a3 + 6) = v25 + 11;
          if (v24 <= (unsigned __int16)(v25 + 11)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 722, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          char v22 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 10));
          *((_WORD *)a3 + 6) = v25 + 12;
          char v23 = *(unsigned char *)(v26 + (unsigned __int16)(v25 + 11));
          if (a2) {
            goto LABEL_6;
          }
          return result;
        }
        int v27 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_27:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 712, v27);
      }
    }
    int v27 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_27;
  }
  uint64_t result = sub_100058654();
  if (result
    && (sub_100056E24((uint64_t)"status %!", v6, v7, v8, v9, v10, v11, v12, a1),
        uint64_t v13 = sub_100050B4C(0x54u),
        uint64_t result = os_log_type_enabled(v13, OS_LOG_TYPE_ERROR),
        result))
  {
    sub_100745764();
    unsigned __int16 v14 = 0;
    char v15 = 0;
    char v16 = 0;
    char v17 = 0;
    char v18 = 0;
    char v19 = 0;
    char v20 = 0;
    uint64_t result = 0;
  }
  else
  {
    unsigned __int16 v14 = 0;
    char v15 = 0;
    char v16 = 0;
    char v17 = 0;
    char v18 = 0;
    char v19 = 0;
    char v20 = 0;
  }
  char v21 = 0;
  char v22 = 0;
  char v23 = 0;
  if (a2)
  {
LABEL_6:
    HIBYTE(v28) = v23;
    BYTE2(v28) = v22;
    BYTE1(v28) = v21;
    LOBYTE(v28) = result;
    return a2(a1, v14, v15, v16, v17, v18, v19, v20, v28);
  }
  return result;
}

void sub_1001A64AC(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v15 = *((unsigned __int16 *)a3 + 6);
      uint64_t v16 = *((unsigned __int16 *)a3 + 5);
      if ((int)v16 - (int)v15 > 9)
      {
        uint64_t v17 = *a3;
        *((_WORD *)a3 + 6) = v15 + 10;
        if (v16 - (unint64_t)(unsigned __int16)(v15 + 10) <= 0x9F) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 744, "ByteStream_NumReadBytesAvail(*pBs) >= (80 * sizeof(uint16_t))");
        }
        uint64_t v13 = v17 + v15;
        uint64_t v14 = v17 + (unsigned __int16)(v15 + 10);
        *((_WORD *)a3 + 6) = v15 + 170;
        if (a2) {
          goto LABEL_6;
        }
        return;
      }
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 742, "ByteStream_NumReadBytesAvail(*pBs) >= (10)");
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14);
}

void sub_1001A65D8(uint64_t a1, void (*a2)(uint64_t, uint64_t, void), uint64_t a3)
{
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_4;
  }
  if (*(unsigned __int16 *)(a3 + 10) - *(unsigned __int16 *)(a3 + 12) <= 1)
  {
LABEL_4:
    if (sub_100058654())
    {
      if (*(unsigned char *)(a3 + 15))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        uint64_t v11 = 0;
      }
      else
      {
        uint64_t v11 = *(unsigned __int16 *)(a3 + 10) - *(unsigned __int16 *)(a3 + 12);
      }
      sub_100056E24((uint64_t)"Invalid data size %d", v4, v5, v6, v7, v8, v9, v10, v11);
      char v21 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR)) {
        sub_100744F6C();
      }
    }
    return;
  }
  if (!a1 || !sub_100058654()) {
    goto LABEL_15;
  }
  if (*(unsigned char *)(a3 + 15)) {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
  }
  sub_100056E24((uint64_t)"hlCb 0x%x, data %@", v14, v15, v16, v17, v18, v19, v20, (uint64_t)a2);
  char v22 = sub_100050B4C(0x54u);
  if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
  {
    sub_100745764();
    if (!a2) {
      return;
    }
  }
  else
  {
LABEL_15:
    if (!a2) {
      return;
    }
  }
  uint64_t v23 = *(unsigned __int16 *)(a3 + 12);
  uint64_t v24 = *(void *)a3 + v23;
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    unsigned __int8 v25 = 0;
  }
  else
  {
    unsigned __int8 v25 = *(unsigned char *)(a3 + 10) - v23;
  }
  a2(a1, v24, v25);
}

uint64_t sub_1001A679C(uint64_t a1, __int16 a2)
{
  if (!a1) {
    return (a2 & 0x3FFu) <= 0x32 && ((1 << a2) & 0x7000000000001) != 0 || (a2 & 0x3FF) == 0x247;
  }
  uint64_t result = sub_100058654();
  if (result)
  {
    sub_100056E24((uint64_t)"status %!, opcode 0x%x, subOpcode %x, myopcode %x", v4, v5, v6, v7, v8, v9, v10, a1);
    uint64_t v11 = sub_100050B4C(0x54u);
    uint64_t result = os_log_type_enabled(v11, OS_LOG_TYPE_ERROR);
    if (result)
    {
      sub_100745764();
      return 0;
    }
  }
  return result;
}

void sub_1001A6868(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 255;
    if (a2) {
      goto LABEL_6;
    }
    return;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_14;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_14:
    uint64_t v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_16;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    uint64_t v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 827, v16);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (a2) {
LABEL_6:
  }
    a2(a1, v13);
}

void sub_1001A6974(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    if (a2) {
      goto LABEL_6;
    }
    return;
  }
  if (*(unsigned char *)(a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_14;
  }
  uint64_t v14 = *(unsigned __int16 *)(a3 + 12);
  if (*(unsigned __int16 *)(a3 + 10) - (int)v14 <= 3)
  {
LABEL_14:
    uint64_t v15 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
    goto LABEL_16;
  }
  if (*(unsigned char *)(a3 + 14) != 1)
  {
    uint64_t v15 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 844, v15);
  }
  uint64_t v13 = *(unsigned int *)(*(void *)a3 + v14);
  *(_WORD *)(a3 + 12) = v14 + 4;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13);
}

void sub_1001A6A84(uint64_t a1, void (*a2)(uint64_t, uint64_t, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v15 = *((unsigned __int16 *)a3 + 5);
      uint64_t v16 = *((unsigned __int16 *)a3 + 6);
      if (v15 > v16)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v17 = *a3;
          *((_WORD *)a3 + 6) = v16 + 1;
          if (v15 <= (int)v16 + 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 863, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = *(unsigned __int8 *)(v17 + v16);
          *((_WORD *)a3 + 6) = v16 + 2;
          uint64_t v14 = *(unsigned __int8 *)(v17 + v16 + 1);
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_17:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 862, v18);
      }
    }
    uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14);
}

void sub_1001A6BC0(uint64_t a1, void (*a2)(uint64_t))
{
  if (a1
    && sub_100058654()
    && (sub_100056E24((uint64_t)"status %!", v4, v5, v6, v7, v8, v9, v10, a1),
        uint64_t v11 = sub_100050B4C(0x54u),
        os_log_type_enabled(v11, OS_LOG_TYPE_ERROR)))
  {
    sub_100745764();
    if (!a2) {
      return;
    }
  }
  else if (!a2)
  {
    return;
  }
  a2(a1);
}

void sub_1001A6C4C(uint64_t a1, void (*a2)(uint64_t, uint64_t, void, uint64_t), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v17 = *((unsigned __int16 *)a3 + 5);
      uint64_t v18 = *((unsigned __int16 *)a3 + 6);
      if (v17 > v18)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v19 = *a3;
          *((_WORD *)a3 + 6) = v18 + 1;
          uint64_t v13 = *(unsigned __int8 *)(v19 + v18);
          if ((int)(v17 - (v18 + 1)) <= 1)
          {
            *((unsigned char *)a3 + 15) = 1;
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            unsigned __int16 v14 = 0;
            int v21 = 0;
          }
          else
          {
            __int16 v20 = v18 + 3;
            unsigned __int16 v14 = *(_WORD *)(v19 + v18 + 1);
            *((_WORD *)a3 + 6) = v20;
            int v21 = (unsigned __int16)(v17 - v20);
          }
          if (v21 != v14) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 900, "length == remaining");
          }
          uint64_t v15 = *a3 + *((unsigned __int16 *)a3 + 6);
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        char v22 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_20:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 897, v22);
      }
    }
    char v22 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_20;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  unsigned __int16 v14 = 0;
  uint64_t v15 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14, v15);
}

uint64_t sub_1001A6DE4(uint64_t a1, uint64_t (*a2)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, uint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t, unint64_t), uint64_t *a3)
{
  uint64_t v3 = a2;
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      int v42 = *((unsigned __int16 *)a3 + 5);
      uint64_t v43 = *((unsigned __int16 *)a3 + 6);
      if (v42 - (int)v43 > 3)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v44 = *a3;
          unsigned int v91 = *(_DWORD *)(*a3 + v43);
          *((_WORD *)a3 + 6) = v43 + 4;
          if (v42 - (unsigned __int16)(v43 + 4) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 979, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v90 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 4));
          *((_WORD *)a3 + 6) = v43 + 8;
          if (v42 - (unsigned __int16)(v43 + 8) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 980, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v89 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 8));
          *((_WORD *)a3 + 6) = v43 + 12;
          if (v42 - (unsigned __int16)(v43 + 12) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 981, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v88 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 12));
          *((_WORD *)a3 + 6) = v43 + 16;
          if (v42 - (unsigned __int16)(v43 + 16) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 982, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v87 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 16));
          *((_WORD *)a3 + 6) = v43 + 20;
          if (v42 - (unsigned __int16)(v43 + 20) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 983, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v86 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 20));
          *((_WORD *)a3 + 6) = v43 + 24;
          if (v42 - (unsigned __int16)(v43 + 24) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 984, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v85 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 24));
          *((_WORD *)a3 + 6) = v43 + 28;
          if (v42 - (unsigned __int16)(v43 + 28) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 985, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v84 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 28));
          *((_WORD *)a3 + 6) = v43 + 32;
          if (v42 - (unsigned __int16)(v43 + 32) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 986, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v83 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 32));
          *((_WORD *)a3 + 6) = v43 + 36;
          if (v42 - (unsigned __int16)(v43 + 36) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 987, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          unsigned int v45 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 36));
          *((_WORD *)a3 + 6) = v43 + 40;
          int v46 = v42 - (unsigned __int16)(v43 + 40);
          unsigned int v108 = v45;
          if ((v46 & 0x1FFFE) != 0)
          {
            if (v46 <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 991, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v47 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 40));
            *((_WORD *)a3 + 6) = v43 + 44;
            if (v42 - (unsigned __int16)(v43 + 44) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 992, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v48 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 44));
            *((_WORD *)a3 + 6) = v43 + 48;
            if (v42 - (unsigned __int16)(v43 + 48) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 993, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v49 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 48));
            *((_WORD *)a3 + 6) = v43 + 52;
            if (v42 - (unsigned __int16)(v43 + 52) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 994, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v50 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 52));
            *((_WORD *)a3 + 6) = v43 + 56;
            if (v42 - (unsigned __int16)(v43 + 56) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 995, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v51 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 56));
            *((_WORD *)a3 + 6) = v43 + 60;
            if (v42 - (unsigned __int16)(v43 + 60) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 996, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v52 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 60));
            *((_WORD *)a3 + 6) = v43 + 64;
            if (v42 - (unsigned __int16)(v43 + 64) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 997, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v53 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 64));
            *((_WORD *)a3 + 6) = v43 + 68;
            if (v42 - (unsigned __int16)(v43 + 68) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 998, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v54 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 68));
            *((_WORD *)a3 + 6) = v43 + 72;
            if (v42 - (unsigned __int16)(v43 + 72) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 999, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v55 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 72));
            *((_WORD *)a3 + 6) = v43 + 76;
            if (v42 - (unsigned __int16)(v43 + 76) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1001, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v56 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 76));
            *((_WORD *)a3 + 6) = v43 + 80;
            if (v42 - (unsigned __int16)(v43 + 80) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1002, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v57 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 80));
            *((_WORD *)a3 + 6) = v43 + 84;
            if (v42 - (unsigned __int16)(v43 + 84) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1003, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v58 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 84));
            *((_WORD *)a3 + 6) = v43 + 88;
            if (v42 - (unsigned __int16)(v43 + 88) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1004, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v59 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 88));
            *((_WORD *)a3 + 6) = v43 + 92;
            if (v42 - (unsigned __int16)(v43 + 92) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1005, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v60 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 92));
            *((_WORD *)a3 + 6) = v43 + 96;
            if (v42 - (unsigned __int16)(v43 + 96) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1006, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v61 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 96));
            *((_WORD *)a3 + 6) = v43 + 100;
            if (v42 - (unsigned __int16)(v43 + 100) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1007, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v62 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 100));
            *((_WORD *)a3 + 6) = v43 + 104;
            if (v42 - (unsigned __int16)(v43 + 104) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1008, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v63 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 104));
            *((_WORD *)a3 + 6) = v43 + 108;
            if (v42 - (unsigned __int16)(v43 + 108) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1009, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v64 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 108));
            *((_WORD *)a3 + 6) = v43 + 112;
            if (v42 - (unsigned __int16)(v43 + 112) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1010, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v65 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 112));
            *((_WORD *)a3 + 6) = v43 + 116;
            if (v42 - (unsigned __int16)(v43 + 116) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1011, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v66 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 116));
            *((_WORD *)a3 + 6) = v43 + 120;
            if (v42 - (unsigned __int16)(v43 + 120) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1012, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            int v67 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 120));
            *((_WORD *)a3 + 6) = v43 + 124;
            if (v42 - (unsigned __int16)(v43 + 124) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1013, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            LODWORD(v107) = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 124));
            HIDWORD(v107) = v67;
            *((_WORD *)a3 + 6) = v43 + 128;
            if (v42 - (unsigned __int16)(v43 + 128) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1014, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v68 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 128));
            *((_WORD *)a3 + 6) = v43 + 132;
            if (v42 - (unsigned __int16)(v43 + 132) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1015, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unint64_t v106 = __PAIR64__(v65, v66);
            unsigned int v69 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 132));
            *((_WORD *)a3 + 6) = v43 + 136;
            if (v42 - (unsigned __int16)(v43 + 136) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1016, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            int v70 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 136));
            *((_WORD *)a3 + 6) = v43 + 140;
            if (v42 - (unsigned __int16)(v43 + 140) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1017, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unint64_t v105 = __PAIR64__(v63, v64);
            unsigned int v71 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 140));
            *((_WORD *)a3 + 6) = v43 + 144;
            if (v42 - (unsigned __int16)(v43 + 144) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1018, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v72 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 144));
            *((_WORD *)a3 + 6) = v43 + 148;
            if (v42 - (unsigned __int16)(v43 + 148) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1019, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unint64_t v104 = __PAIR64__(v61, v62);
            unsigned int v73 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 148));
            *((_WORD *)a3 + 6) = v43 + 152;
            if (v42 - (unsigned __int16)(v43 + 152) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1020, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v74 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 152));
            *((_WORD *)a3 + 6) = v43 + 156;
            if (v42 - (unsigned __int16)(v43 + 156) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1021, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v75 = v48;
            unsigned int v76 = v47;
            unint64_t v103 = __PAIR64__(v59, v60);
            unsigned int v77 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 156));
            *((_WORD *)a3 + 6) = v43 + 160;
            if (v42 - (unsigned __int16)(v43 + 160) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1022, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            int v78 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 160));
            *((_WORD *)a3 + 6) = v43 + 164;
            if (v42 - (unsigned __int16)(v43 + 164) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1023, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unint64_t v102 = __PAIR64__(v57, v58);
            unsigned int v79 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 164));
            *((_WORD *)a3 + 6) = v43 + 168;
            if (v42 - (unsigned __int16)(v43 + 168) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1024, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v80 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 168));
            *((_WORD *)a3 + 6) = v43 + 172;
            if (v42 - (unsigned __int16)(v43 + 172) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1025, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unint64_t v101 = __PAIR64__(v55, v56);
            unsigned int v81 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 172));
            *((_WORD *)a3 + 6) = v43 + 174;
            if (v42 - (unsigned __int16)(v43 + 174) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1026, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            uint64_t result = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 174));
            *((_WORD *)a3 + 6) = v43 + 176;
            if (v42 - (unsigned __int16)(v43 + 176) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1027, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unint64_t v100 = __PAIR64__(v53, v54);
            unsigned int v29 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 176));
            *((_WORD *)a3 + 6) = v43 + 178;
            if (v42 - (unsigned __int16)(v43 + 178) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1028, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unsigned int v30 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 178));
            *((_WORD *)a3 + 6) = v43 + 180;
            if (v42 - (unsigned __int16)(v43 + 180) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1029, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unint64_t v99 = __PAIR64__(v51, v52);
            unsigned int v31 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 180));
            *((_WORD *)a3 + 6) = v43 + 184;
            if (v42 - (unsigned __int16)(v43 + 184) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1030, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v98 = v68;
            unsigned int v32 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 184));
            *((_WORD *)a3 + 6) = v43 + 188;
            if (v42 - (unsigned __int16)(v43 + 188) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1031, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            HIDWORD(v95) = v78;
            unint64_t v96 = __PAIR64__(v69, v77);
            unint64_t v97 = __PAIR64__(v49, v50);
            unsigned int v33 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 188));
            *((_WORD *)a3 + 6) = v43 + 190;
            if (v42 - (unsigned __int16)(v43 + 190) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1032, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            LODWORD(v95) = v70;
            unsigned int v34 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 190));
            *((_WORD *)a3 + 6) = v43 + 192;
            if (v42 - (unsigned __int16)(v43 + 192) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1033, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unsigned int v93 = v71;
            unint64_t v94 = __PAIR64__(v76, v75);
            unsigned int v35 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 192));
            *((_WORD *)a3 + 6) = v43 + 194;
            if (v42 - (unsigned __int16)(v43 + 194) <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1034, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unsigned int v36 = *(unsigned __int16 *)(v44 + (unsigned __int16)(v43 + 194));
            *((_WORD *)a3 + 6) = v43 + 196;
            if (v42 - (unsigned __int16)(v43 + 196) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1035, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v37 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 196));
            *((_WORD *)a3 + 6) = v43 + 200;
            if (v42 - (unsigned __int16)(v43 + 200) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1036, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v26 = v79;
            unsigned int v23 = v72;
            unsigned int v38 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 200));
            *((_WORD *)a3 + 6) = v43 + 204;
            if (v42 - (unsigned __int16)(v43 + 204) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1037, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v27 = v80;
            unsigned int v28 = v81;
            unsigned int v25 = v74;
            unsigned int v24 = v73;
            unsigned int v39 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 204));
            *((_WORD *)a3 + 6) = v43 + 208;
            if (v42 - (unsigned __int16)(v43 + 208) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1038, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            unsigned int v40 = *(_DWORD *)(v44 + (unsigned __int16)(v43 + 208));
            *((_WORD *)a3 + 6) = v43 + 212;
          }
          else
          {
            unint64_t v94 = 0;
            uint64_t v95 = 0;
            unint64_t v96 = 0;
            unint64_t v97 = 0;
            unint64_t v99 = 0;
            unint64_t v100 = 0;
            unint64_t v101 = 0;
            unint64_t v102 = 0;
            unint64_t v103 = 0;
            unint64_t v104 = 0;
            unint64_t v105 = 0;
            unint64_t v106 = 0;
            uint64_t v107 = 0;
            unsigned int v98 = 0;
            unsigned int v93 = 0;
            unsigned int v23 = 0;
            unsigned int v24 = 0;
            unsigned int v25 = 0;
            unsigned int v26 = 0;
            unsigned int v27 = 0;
            unsigned int v28 = 0;
            uint64_t result = 0;
            unsigned int v29 = 0;
            unsigned int v30 = 0;
            unsigned int v31 = 0;
            unsigned int v32 = 0;
            unsigned int v33 = 0;
            unsigned int v34 = 0;
            unsigned int v35 = 0;
            unsigned int v36 = 0;
            unsigned int v37 = 0;
            unsigned int v38 = 0;
            unsigned int v39 = 0;
            unsigned int v40 = 0;
          }
          uint64_t v3 = a2;
          uint64_t v14 = v91;
          uint64_t v16 = v89;
          uint64_t v15 = v90;
          uint64_t v18 = v87;
          uint64_t v17 = v88;
          uint64_t v20 = v85;
          uint64_t v19 = v86;
          unsigned int v22 = v83;
          unsigned int v21 = v84;
          if (a2) {
            return v3(a1, v14, v15, v16, v17, v18, v19, v20, __PAIR64__(v22, v21), __PAIR64__(HIDWORD(v94), v108), __PAIR64__(HIDWORD(v97), v94), __PAIR64__(HIDWORD(v99), v97), __PAIR64__(HIDWORD(v100), v99), __PAIR64__(HIDWORD(v101), v100), __PAIR64__(HIDWORD(v102), v101), __PAIR64__(HIDWORD(v103), v102), __PAIR64__(HIDWORD(v104), v103), __PAIR64__(HIDWORD(v105), v104), __PAIR64__(HIDWORD(v106), v105),
          }
                     __PAIR64__(HIDWORD(v107), v106),
                     __PAIR64__(v98, v107),
                     __PAIR64__(v95, HIDWORD(v96)),
                     __PAIR64__(v23, v93),
                     __PAIR64__(v25, v24),
                     __PAIR64__(HIDWORD(v95), v96),
                     __PAIR64__(v27, v26),
                     __PAIR64__(result, v28),
                     __PAIR64__(v30, v29),
                     __PAIR64__(v32, v31),
                     __PAIR64__(v34, v33),
                     __PAIR64__(v36, v35),
                     __PAIR64__(v38, v37),
                     __PAIR64__(v40, v39));
          return result;
        }
        uint64_t v82 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_76:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 978, v82);
      }
    }
    uint64_t v82 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
    goto LABEL_76;
  }
  uint64_t result = sub_100058654();
  if (result
    && (sub_100056E24((uint64_t)"EnhancedProfilingStats VSC failed with status %!", v6, v7, v8, v9, v10, v11, v12, a1),
        uint64_t v13 = sub_100050B4C(0x54u),
        uint64_t result = os_log_type_enabled(v13, OS_LOG_TYPE_ERROR),
        result))
  {
    sub_100745764();
    uint64_t v14 = 0;
    uint64_t v15 = 0;
    uint64_t v16 = 0;
    uint64_t v17 = 0;
    uint64_t v18 = 0;
    uint64_t v19 = 0;
    uint64_t v20 = 0;
    unsigned int v21 = 0;
    unsigned int v22 = 0;
    unsigned int v108 = 0;
    unint64_t v94 = 0;
    uint64_t v95 = 0;
    unint64_t v96 = 0;
    unint64_t v97 = 0;
    unint64_t v99 = 0;
    unint64_t v100 = 0;
    unint64_t v101 = 0;
    unint64_t v102 = 0;
    unint64_t v103 = 0;
    unint64_t v104 = 0;
    unint64_t v105 = 0;
    unint64_t v106 = 0;
    uint64_t v107 = 0;
    unsigned int v98 = 0;
    unsigned int v93 = 0;
    unsigned int v23 = 0;
    unsigned int v24 = 0;
    unsigned int v25 = 0;
    unsigned int v26 = 0;
    unsigned int v27 = 0;
    unsigned int v28 = 0;
    uint64_t result = 0;
  }
  else
  {
    uint64_t v14 = 0;
    uint64_t v15 = 0;
    uint64_t v16 = 0;
    uint64_t v17 = 0;
    uint64_t v18 = 0;
    uint64_t v19 = 0;
    uint64_t v20 = 0;
    unsigned int v21 = 0;
    unsigned int v22 = 0;
    unsigned int v108 = 0;
    unint64_t v94 = 0;
    uint64_t v95 = 0;
    unint64_t v96 = 0;
    unint64_t v97 = 0;
    unint64_t v99 = 0;
    unint64_t v100 = 0;
    unint64_t v101 = 0;
    unint64_t v102 = 0;
    unint64_t v103 = 0;
    unint64_t v104 = 0;
    unint64_t v105 = 0;
    unint64_t v106 = 0;
    uint64_t v107 = 0;
    unsigned int v98 = 0;
    unsigned int v93 = 0;
    unsigned int v23 = 0;
    unsigned int v24 = 0;
    unsigned int v25 = 0;
    unsigned int v26 = 0;
    unsigned int v27 = 0;
    unsigned int v28 = 0;
  }
  unsigned int v29 = 0;
  unsigned int v30 = 0;
  unsigned int v31 = 0;
  unsigned int v32 = 0;
  unsigned int v33 = 0;
  unsigned int v34 = 0;
  unsigned int v35 = 0;
  unsigned int v36 = 0;
  unsigned int v37 = 0;
  unsigned int v38 = 0;
  unsigned int v39 = 0;
  unsigned int v40 = 0;
  if (v3) {
    return v3(a1, v14, v15, v16, v17, v18, v19, v20, __PAIR64__(v22, v21), __PAIR64__(HIDWORD(v94), v108), __PAIR64__(HIDWORD(v97), v94), __PAIR64__(HIDWORD(v99), v97), __PAIR64__(HIDWORD(v100), v99), __PAIR64__(HIDWORD(v101), v100), __PAIR64__(HIDWORD(v102), v101), __PAIR64__(HIDWORD(v103), v102), __PAIR64__(HIDWORD(v104), v103), __PAIR64__(HIDWORD(v105), v104), __PAIR64__(HIDWORD(v106), v105),
  }
             __PAIR64__(HIDWORD(v107), v106),
             __PAIR64__(v98, v107),
             __PAIR64__(v95, HIDWORD(v96)),
             __PAIR64__(v23, v93),
             __PAIR64__(v25, v24),
             __PAIR64__(HIDWORD(v95), v96),
             __PAIR64__(v27, v26),
             __PAIR64__(result, v28),
             __PAIR64__(v30, v29),
             __PAIR64__(v32, v31),
             __PAIR64__(v34, v33),
             __PAIR64__(v36, v35),
             __PAIR64__(v38, v37),
             __PAIR64__(v40, v39));
  return result;
}

void sub_1001A7DCC(uint64_t a1, void (*a2)(uint64_t, uint64_t, void, void), uint64_t *a3)
{
  if (!a1)
  {
    if (*((unsigned char *)a3 + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v15 = *((unsigned __int16 *)a3 + 5);
      uint64_t v16 = *((unsigned __int16 *)a3 + 6);
      if ((int)(v15 - v16) > 3)
      {
        if (*((unsigned char *)a3 + 14) == 1)
        {
          uint64_t v17 = *a3;
          uint64_t v13 = *(unsigned int *)(*a3 + v16);
          *((_WORD *)a3 + 6) = v16 + 4;
          if (v15 <= (unsigned __int16)(v16 + 4)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1058, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *((_WORD *)a3 + 6) = v16 + 5;
          char v14 = *(unsigned char *)(v17 + (unsigned __int16)(v16 + 4));
          if (a2) {
            goto LABEL_6;
          }
          return;
        }
        uint64_t v18 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_17:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1057, v18);
      }
    }
    uint64_t v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
    goto LABEL_17;
  }
  if (sub_100058654())
  {
    sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
    uint64_t v12 = sub_100050B4C(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
      sub_100745764();
    }
  }
  uint64_t v13 = 0;
  char v14 = 0;
  if (a2) {
LABEL_6:
  }
    a2(a1, v13, v14, 0);
}

void sub_1001A7F18(uint64_t a1, void (*a2)(uint64_t, _OWORD *), uint64_t *a3)
{
  long long v26 = 0u;
  long long v27 = 0u;
  long long v24 = 0u;
  long long v25 = 0u;
  long long v23 = 0u;
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    goto LABEL_17;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_27:
    unsigned int v21 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
LABEL_28:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1078, v21);
  }
  uint64_t v13 = 0;
  unsigned int v14 = *((unsigned __int16 *)a3 + 5);
  unsigned __int16 v15 = *((_WORD *)a3 + 6);
  int v16 = v14 - 1;
  do
  {
    if (v14 <= v15) {
      goto LABEL_27;
    }
    if (*((unsigned char *)a3 + 14) != 1)
    {
      unsigned int v21 = "(*pBs).__RWFlag == BYTESTREAM_READ";
      goto LABEL_28;
    }
    uint64_t v17 = *a3;
    *((_WORD *)a3 + 6) = v15 + 1;
    *((unsigned char *)&v23 + v13) = *(unsigned char *)(v17 + v15);
    if (v14 <= (unsigned __int16)(v15 + 1)) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1079, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    }
    uint64_t v18 = v15 + 2;
    *((_WORD *)a3 + 6) = v18;
    *((unsigned char *)&v23 + v13 + 1) = *(unsigned char *)(v17 + v15 + 1);
    if (v16 <= (unsigned __int16)v18) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1080, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    *(_WORD *)((char *)&v23 + v13 + 2) = *(_WORD *)(v17 + v18);
    v15 += 4;
    *((_WORD *)a3 + 6) = v15;
    v13 += 4;
  }
  while (v13 != 40);
  for (uint64_t i = 0; i != 40; i += 4)
  {
    if (v14 <= v15) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1084, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    }
    *((_WORD *)a3 + 6) = v15 + 1;
    *((unsigned char *)&v25 + i + 8) = *(unsigned char *)(v17 + v15);
    if (v14 <= (unsigned __int16)(v15 + 1)) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1085, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    }
    uint64_t v20 = v15 + 2;
    *((_WORD *)a3 + 6) = v20;
    *((unsigned char *)&v25 + i + 9) = *(unsigned char *)(v17 + v15 + 1);
    if (v16 <= (unsigned __int16)v20) {
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1086, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }
    *(_WORD *)((char *)&v25 + i + 10) = *(_WORD *)(v17 + v20);
    v15 += 4;
    *((_WORD *)a3 + 6) = v15;
  }
LABEL_17:
  if (a2)
  {
    _OWORD v22[2] = v25;
    v22[3] = v26;
    v22[4] = v27;
    v22[0] = v23;
    v22[1] = v24;
    a2(a1, v22);
  }
}

void sub_1001A8188(uint64_t a1, void (*a2)(uint64_t, uint64_t), uint64_t *a3)
{
  if (a1)
  {
    if (sub_100058654())
    {
      sub_100056E24((uint64_t)"status %!", v5, v6, v7, v8, v9, v10, v11, a1);
      uint64_t v12 = sub_100050B4C(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)) {
        sub_100745764();
      }
    }
    uint64_t v13 = 0;
    if (a2) {
      goto LABEL_6;
    }
    return;
  }
  if (*((unsigned char *)a3 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_14;
  }
  uint64_t v14 = *((unsigned __int16 *)a3 + 6);
  if (*((unsigned __int16 *)a3 + 5) <= v14)
  {
LABEL_14:
    int v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_16;
  }
  if (*((unsigned char *)a3 + 14) != 1)
  {
    int v16 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1103, v16);
  }
  uint64_t v15 = *a3;
  *((_WORD *)a3 + 6) = v14 + 1;
  uint64_t v13 = *(unsigned __int8 *)(v15 + v14);
  if (a2) {
LABEL_6:
  }
    a2(a1, v13);
}

void sub_1001A8294(uint64_t a1, uint64_t (*a2)(void, void))
{
  if (a1)
  {
    uint64_t v4 = (void (*)(uint64_t, void))off_100A04F18;
    if (sub_100058654()
      && (sub_100056E24((uint64_t)"status %!, hlCb 0x%x, pCallbackFunc %x", v5, v6, v7, v8, v9, v10, v11, a1),
          uint64_t v12 = sub_100050B4C(0x54u),
          os_log_type_enabled(v12, OS_LOG_TYPE_ERROR)))
    {
      sub_100745764();
      if (!v4) {
        return;
      }
    }
    else if (!v4)
    {
      return;
    }
    v4(a1, 0);
    a2 = 0;
  }
  off_100A04F18 = a2;
}

uint64_t sub_1001A833C(int a1, int a2, uint64_t a3)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(unsigned char *)(v15 + WORD2(v16)) = 1;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(unsigned char *)(v15 + WORD2(v16) + 3) = 0;
        unsigned __int16 v10 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        if (HIBYTE(v16))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v16) - v10 > 3)
        {
          if (BYTE6(v16) == 2)
          {
            *(unsigned char *)(v15 + v10) = a1;
            *(unsigned char *)(v15 + WORD2(v16) + 1) = BYTE1(a1);
            *(unsigned char *)(v15 + WORD2(v16) + 2) = BYTE2(a1);
            *(unsigned char *)(v15 + WORD2(v16) + 3) = HIBYTE(a1);
            unsigned __int16 v11 = WORD2(v16) + 4;
            WORD2(v16) += 4;
            if (HIBYTE(v16))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v16) - v11 > 3)
            {
              if (BYTE6(v16) == 2)
              {
                *(unsigned char *)(v15 + v11) = a2;
                *(unsigned char *)(v15 + WORD2(v16) + 1) = BYTE1(a2);
                *(unsigned char *)(v15 + WORD2(v16) + 2) = BYTE2(a2);
                *(unsigned char *)(v15 + WORD2(v16) + 3) = HIBYTE(a2);
                WORD2(v16) += 4;
                return sub_10001BCBC(226, v15, BYTE4(v16), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2753, v14);
            }
            uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_24;
          }
          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2752, v13);
        }
        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_20;
      }
      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2751, v12);
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001A85D4(char a1, unsigned char *a2, uint64_t a3)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(unsigned char *)(v20 + WORD2(v21)) = 7;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(unsigned char *)(v20 + WORD2(v21) + 3) = 0;
        __int16 v10 = WORD2(v21);
        unsigned __int16 v11 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v21) > v11)
        {
          if (BYTE6(v21) == 2)
          {
            WORD2(v21) = v10 + 5;
            *(unsigned char *)(v20 + v11) = a1;
            if (HIBYTE(v21))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v21) - WORD2(v21) > 2)
            {
              if (BYTE6(v21) == 2)
              {
                uint64_t v12 = v20 + WORD2(v21);
                *(unsigned char *)(v12 + 2) = 0;
                *(_WORD *)uint64_t v12 = 0;
                unsigned __int16 v13 = WORD2(v21) + 3;
                WORD2(v21) += 3;
                if (HIBYTE(v21))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v21) - v13 > 1)
                {
                  if (BYTE6(v21) == 2)
                  {
                    *(unsigned char *)(v20 + v13) = *a2;
                    *(unsigned char *)(v20 + WORD2(v21) + 1) = a2[1];
                    unsigned __int16 v14 = WORD2(v21) + 2;
                    WORD2(v21) += 2;
                    if (HIBYTE(v21))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v21) - v14 > 1)
                    {
                      if (BYTE6(v21) == 2)
                      {
                        *(_WORD *)(v20 + v14) = 0;
                        WORD2(v21) += 2;
                        return sub_10001BCBC(226, v20, BYTE4(v21), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                      }
                      uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2771, v19);
                    }
                    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= (2)";
                    goto LABEL_38;
                  }
                  uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2770, v18);
                }
                uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_34;
              }
              uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2769, v17);
            }
            uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
            goto LABEL_30;
          }
          uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2768, v16);
        }
        uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_26;
      }
      uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2767, v15);
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_22;
  }
  return result;
}

uint64_t sub_1001A890C(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 13;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1001A3480, v5, v6, v7);
          }
          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2787, v11);
        }
        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2786, v10);
    }
    __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001A8A98(char a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (((a2 - 2) & 0xFC) != 0) {
    char v10 = 1;
  }
  else {
    char v10 = 0x16141311u >> (8 * (a2 - 2));
  }
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v11 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(unsigned char *)(v14 + v11) = v10;
          if (HIBYTE(v15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v15) - WORD2(v15) > 3)
          {
            if (BYTE6(v15) == 2)
            {
              *(unsigned char *)(v14 + WORD2(v15)) = a1;
              *(_WORD *)(v14 + WORD2(v15) + 1) = 0;
              *(unsigned char *)(v14 + WORD2(v15) + 3) = 0;
              WORD2(v15) += 4;
              return sub_10001BCBC(496, v14, BYTE4(v15), a3, (uint64_t)sub_1001A3658, v7, v8, v9);
            }
            uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2817, v13);
          }
          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_20;
        }
        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2816, v12);
      }
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001A8C4C(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(528, v10, BYTE4(v11), a2, (uint64_t)sub_1001A4628, v5, v6, v7);
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2832, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001A8D24(char a1, unsigned char *a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(unsigned char *)(v16 + WORD2(v17)) = 18;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(unsigned char *)(v16 + WORD2(v17) + 3) = 0;
        unsigned __int16 v10 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v17) - v10 > 1)
        {
          if (BYTE6(v17) == 2)
          {
            *(unsigned char *)(v16 + v10) = *a2;
            *(unsigned char *)(v16 + WORD2(v17) + 1) = a2[1];
            __int16 v11 = WORD2(v17);
            unsigned __int16 v12 = WORD2(v17) + 2;
            WORD2(v17) += 2;
            if (HIBYTE(v17))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v17) > v12)
            {
              if (BYTE6(v17) == 2)
              {
                WORD2(v17) = v11 + 3;
                *(unsigned char *)(v16 + v12) = a1;
                return sub_10001BCBC(226, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2849, v15);
            }
            uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }
          uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2848, v14);
        }
        uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2847, v13);
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001A8F54(unsigned char *a1, uint64_t a2)
{
  uint64_t v24 = 0;
  uint64_t v25 = 0;
  uint64_t result = sub_100059D70(&v24);
  if (!result)
  {
    if (HIBYTE(v25))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v25) - WORD2(v25) > 3)
    {
      if (BYTE6(v25) == 2)
      {
        *(unsigned char *)(v24 + WORD2(v25)) = 21;
        *(_WORD *)(v24 + WORD2(v25) + 1) = 0;
        *(unsigned char *)(v24 + WORD2(v25) + 3) = 0;
        unsigned __int16 v8 = WORD2(v25) + 4;
        WORD2(v25) += 4;
        if (HIBYTE(v25))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v25) - v8 > 1)
        {
          if (BYTE6(v25) == 2)
          {
            *(unsigned char *)(v24 + v8) = *a1;
            *(unsigned char *)(v24 + WORD2(v25) + 1) = a1[1];
            __int16 v9 = WORD2(v25);
            unsigned __int16 v10 = WORD2(v25) + 2;
            WORD2(v25) += 2;
            if (HIBYTE(v25))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v25) > v10)
            {
              if (BYTE6(v25) == 2)
              {
                char v11 = a1[2];
                WORD2(v25) = v9 + 3;
                *(unsigned char *)(v24 + v10) = v11;
                if (HIBYTE(v25))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v12 = WORD2(v25);
                  if (WORD1(v25) > WORD2(v25))
                  {
                    if (BYTE6(v25) == 2)
                    {
                      char v13 = a1[3];
                      ++WORD2(v25);
                      *(unsigned char *)(v24 + v12) = v13;
                      if (HIBYTE(v25))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v14 = WORD2(v25);
                        if (WORD1(v25) > WORD2(v25))
                        {
                          if (BYTE6(v25) == 2)
                          {
                            char v15 = a1[4];
                            ++WORD2(v25);
                            *(unsigned char *)(v24 + v14) = v15;
                            if (HIBYTE(v25))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v16 = WORD2(v25);
                              if (WORD1(v25) > WORD2(v25))
                              {
                                if (BYTE6(v25) == 2)
                                {
                                  char v17 = a1[5];
                                  ++WORD2(v25);
                                  *(unsigned char *)(v24 + v16) = v17;
                                  return sub_10001BCBC(226, v24, BYTE4(v25), a2, (uint64_t)sub_1001A65D8, v5, v6, v7);
                                }
                                long long v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2871, v23);
                              }
                            }
                            long long v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_45;
                          }
                          unsigned int v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2870, v22);
                        }
                      }
                      unsigned int v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_41;
                    }
                    uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2869, v21);
                  }
                }
                uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_37;
              }
              uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2868, v20);
            }
            uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_33;
          }
          uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2867, v19);
        }
        uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_29;
      }
      uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2866, v18);
    }
    uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001A92F0(char a1, char a2, char a3, uint64_t a4)
{
  uint64_t v21 = 0;
  uint64_t v22 = 0;
  uint64_t result = sub_100059D70(&v21);
  if (!result)
  {
    if (HIBYTE(v22))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v12 = WORD2(v22);
      if (WORD1(v22) > WORD2(v22))
      {
        if (BYTE6(v22) == 2)
        {
          ++WORD2(v22);
          *(unsigned char *)(v21 + v12) = a1;
          if (HIBYTE(v22))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v22) - WORD2(v22) > 2)
          {
            if (BYTE6(v22) == 2)
            {
              uint64_t v13 = v21 + WORD2(v22);
              *(unsigned char *)(v13 + 2) = 0;
              *(_WORD *)uint64_t v13 = 0;
              __int16 v14 = WORD2(v22);
              unsigned __int16 v15 = WORD2(v22) + 3;
              WORD2(v22) += 3;
              if (HIBYTE(v22))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v22) > v15)
              {
                if (BYTE6(v22) == 2)
                {
                  WORD2(v22) = v14 + 4;
                  *(unsigned char *)(v21 + v15) = a2;
                  if (HIBYTE(v22))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v16 = WORD2(v22);
                    if (WORD1(v22) > WORD2(v22))
                    {
                      if (BYTE6(v22) == 2)
                      {
                        ++WORD2(v22);
                        *(unsigned char *)(v21 + v16) = a3;
                        return sub_10001BCBC(383, v21, BYTE4(v22), a4, (uint64_t)sub_1000260B4, v9, v10, v11);
                      }
                      uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3093, v20);
                    }
                  }
                  uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }
                uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3092, v19);
              }
              uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_27;
            }
            uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3091, v18);
          }
          uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
          goto LABEL_23;
        }
        char v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3090, v17);
      }
    }
    char v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001A9550(_WORD *a1, const void *a2, int a3, uint64_t a4)
{
  uint64_t v24 = 0;
  uint64_t v25 = 0;
  uint64_t result = sub_100059D70(&v24);
  if (!result)
  {
    if (HIBYTE(v25))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v9 = WORD2(v25);
      if (WORD1(v25) > WORD2(v25))
      {
        if (BYTE6(v25) == 2)
        {
          ++WORD2(v25);
          *(unsigned char *)(v24 + v9) = 11;
          if (HIBYTE(v25))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v10 = WORD2(v25);
            if (WORD1(v25) > WORD2(v25))
            {
              if (BYTE6(v25) == 2)
              {
                ++WORD2(v25);
                *(unsigned char *)(v24 + v10) = 1;
                if (HIBYTE(v25))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v25) - WORD2(v25) > 1)
                {
                  if (BYTE6(v25) == 2)
                  {
                    *(_WORD *)(v24 + WORD2(v25)) = *a1;
                    __int16 v11 = WORD2(v25);
                    unsigned __int16 v12 = WORD2(v25) + 2;
                    WORD2(v25) += 2;
                    if (HIBYTE(v25))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v25) > v12)
                    {
                      if (BYTE6(v25) == 2)
                      {
                        WORD2(v25) = v11 + 3;
                        *(unsigned char *)(v24 + v12) = 5;
                        uint64_t v13 = v24;
                        uint64_t v14 = WORD2(v25);
                        if (HIBYTE(v25))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v15 = 0;
                        }
                        else
                        {
                          int v15 = WORD1(v25) - WORD2(v25);
                        }
                        if (v15 < a3)
                        {
                          long long v23 = "ByteStream_NumReadBytesAvail(bs) >= (rssiLen)";
                        }
                        else
                        {
                          if (BYTE6(v25) == 2)
                          {
                            memmove((void *)(v13 + v14), a2, a3);
                            WORD2(v25) += a3;
                            return sub_10001BCBC(233, v24, BYTE4(v25), a4, (uint64_t)sub_1000260B4, v16, v17, v18);
                          }
                          long long v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3460, v23);
                      }
                      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3459, v22);
                    }
                    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_36;
                  }
                  uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3458, v21);
                }
                uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_32;
              }
              uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3457, v20);
            }
          }
          uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_28;
        }
        uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3456, v19);
      }
    }
    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_24;
  }
  return result;
}

uint64_t sub_1001A9868(_WORD *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  uint64_t result = sub_100059D70(&v13);
  if (!result)
  {
    if (HIBYTE(v14))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v14) - WORD2(v14) > 1)
    {
      if (BYTE6(v14) == 2)
      {
        *(_WORD *)(v13 + WORD2(v14)) = *a1;
        unsigned __int16 v7 = WORD2(v14) + 2;
        WORD2(v14) += 2;
        if (HIBYTE(v14))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v14) - v7 > 5)
        {
          if (BYTE6(v14) == 2)
          {
            sub_100008A18(v13 + v7, a2, 6uLL);
            WORD2(v14) += 6;
            return sub_10001BCBC(386, v13, BYTE4(v14), a3, (uint64_t)sub_1000260B4, v8, v9, v10);
          }
          unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3703, v12);
        }
        unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
        goto LABEL_17;
      }
      __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3702, v11);
    }
    __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001A99F4(uint64_t a1)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (result) {
    return result;
  }
  if (HIBYTE(v11))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_13;
  }
  uint64_t v6 = WORD2(v11);
  if (WORD1(v11) <= WORD2(v11))
  {
LABEL_13:
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_15;
  }
  if (BYTE6(v11) != 2)
  {
    uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_15:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4116, v8);
  }
  ++WORD2(v11);
  *(unsigned char *)(v10 + v6) = -16;
  if (HIBYTE(v11))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_17;
  }
  uint64_t v7 = WORD2(v11);
  if (WORD1(v11) <= WORD2(v11))
  {
LABEL_17:
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  if (BYTE6(v11) != 2)
  {
    uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4117, v9);
  }
  ++WORD2(v11);
  *(unsigned char *)(v10 + v7) = 3;
  if (off_100A04F18) {
    sub_10025B8C0();
  }
  return sub_10001BCBC(0, v10, BYTE4(v11), a1, (uint64_t)sub_1001A8294, v3, v4, v5);
}

uint64_t sub_1001A9B58(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(_DWORD *)(v12 + WORD2(v13)) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(383, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4134, v11);
        }
        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4133, v10);
    }
    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= (4)";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001A9CB0(char a1, _WORD *a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v7 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(unsigned char *)(v16 + v7) = a1;
          if (HIBYTE(v17))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v17) - WORD2(v17) > 1)
          {
            if (BYTE6(v17) == 2)
            {
              *(_WORD *)(v16 + WORD2(v17)) = 2;
              WORD2(v17) += 2;
              if (sub_1001F7D74() <= 8)
              {
                __int16 v12 = 126;
                unsigned __int8 v11 = BYTE4(v17);
                return sub_10001BCBC(v12, v16, v11, a3, (uint64_t)sub_1000260B4, v8, v9, v10);
              }
              if (HIBYTE(v17))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v17) - WORD2(v17) > 1)
              {
                if (BYTE6(v17) == 2)
                {
                  *(_WORD *)(v16 + WORD2(v17)) = *a2;
                  unsigned __int8 v11 = BYTE4(v17) + 2;
                  WORD2(v17) += 2;
                  __int16 v12 = 258;
                  return sub_10001BCBC(v12, v16, v11, a3, (uint64_t)sub_1000260B4, v8, v9, v10);
                }
                int v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4152, v15);
              }
              int v15 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_27;
            }
            uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4149, v14);
          }
          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_23;
        }
        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4148, v13);
      }
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001A9ED8(unsigned int a1, uint64_t a2)
{
  uint64_t v21 = 0;
  uint64_t v22 = 0;
  uint64_t result = sub_100059D70(&v21);
  unsigned int v8 = 0x101u >> (8 * a1);
  if (a1 <= 2) {
    char v9 = 0x100u >> (8 * a1);
  }
  else {
    char v9 = 0;
  }
  if (a1 <= 2) {
    char v10 = 0x20000u >> (8 * a1);
  }
  else {
    char v10 = 0;
  }
  if (a1 > 2) {
    LOBYTE(v8) = 0;
  }
  if (!result)
  {
    if (HIBYTE(v22))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v11 = WORD2(v22);
      if (WORD1(v22) > WORD2(v22))
      {
        if (BYTE6(v22) == 2)
        {
          ++WORD2(v22);
          *(unsigned char *)(v21 + v11) = v9;
          if (HIBYTE(v22))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v12 = WORD2(v22);
            if (WORD1(v22) > WORD2(v22))
            {
              if (BYTE6(v22) == 2)
              {
                ++WORD2(v22);
                *(unsigned char *)(v21 + v12) = v10;
                if (HIBYTE(v22))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v13 = WORD2(v22);
                  if (WORD1(v22) > WORD2(v22))
                  {
                    if (BYTE6(v22) == 2)
                    {
                      ++WORD2(v22);
                      *(unsigned char *)(v21 + v13) = v8;
                      if (HIBYTE(v22))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v14 = WORD2(v22);
                        if (WORD1(v22) > WORD2(v22))
                        {
                          if (BYTE6(v22) == 2)
                          {
                            ++WORD2(v22);
                            *(unsigned char *)(v21 + v14) = 0;
                            if (HIBYTE(v22))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v15 = WORD2(v22);
                              if (WORD1(v22) > WORD2(v22))
                              {
                                if (BYTE6(v22) == 2)
                                {
                                  ++WORD2(v22);
                                  *(unsigned char *)(v21 + v15) = 0;
                                  return sub_10001BCBC(28, v21, BYTE4(v22), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
                                }
                                uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4210, v20);
                              }
                            }
                            uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_46;
                          }
                          uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4209, v19);
                        }
                      }
                      uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_42;
                    }
                    uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4208, v18);
                  }
                }
                uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_38;
              }
              uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4207, v17);
            }
          }
          uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_34;
        }
        uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4206, v16);
      }
    }
    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_30;
  }
  return result;
}

uint64_t sub_1001AA1BC(const void *a1, unsigned int a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    uint64_t v7 = v14;
    uint64_t v8 = WORD2(v15);
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      unsigned int v9 = 0;
    }
    else
    {
      unsigned int v9 = WORD1(v15) - WORD2(v15);
    }
    if (v9 < a2)
    {
      uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
    }
    else
    {
      if (BYTE6(v15) == 2)
      {
        memmove((void *)(v7 + v8), a1, a2);
        WORD2(v15) += a2;
        return sub_10001BCBC(97, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v10, v11, v12);
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4224, v13);
  }
  return result;
}

uint64_t sub_1001AA2C4(_WORD *a1, uint64_t a2)
{
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t result = sub_100059D70(&v9);
  if (!result)
  {
    if (HIBYTE(v10))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = *a1;
        WORD2(v10) += 2;
        return sub_10001BCBC(72, v9, BYTE4(v10), a2, (uint64_t)sub_1001A332C, v5, v6, v7);
      }
      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4238, v8);
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AA3BC(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(393, v10, BYTE4(v11), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4252, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AA494(int a1, unsigned int a2, uint64_t a3)
{
  uint64_t v17 = 0;
  uint64_t v18 = 0;
  uint64_t result = sub_100059D70(&v17);
  char v7 = 1;
  int __src = 1;
  if (a1 == 1)
  {
    char v8 = 2;
  }
  else
  {
    if (a1) {
      goto LABEL_6;
    }
    char v7 = 0;
    char v8 = 1;
  }
  BYTE2(__src) = v7;
  HIBYTE(__src) = v8;
LABEL_6:
  if (result) {
    return result;
  }
  uint64_t v9 = v17;
  uint64_t v10 = WORD2(v18);
  if (HIBYTE(v18))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    unsigned int v11 = 0;
  }
  else
  {
    unsigned int v11 = WORD1(v18) - WORD2(v18);
  }
  if (v11 < a2)
  {
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
    goto LABEL_16;
  }
  if (BYTE6(v18) != 2)
  {
    uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4288, v15);
  }
  memmove((void *)(v9 + v10), &__src, a2);
  WORD2(v18) += a2;
  return sub_10001BCBC(109, v17, BYTE4(v18), a3, (uint64_t)sub_1000260B4, v12, v13, v14);
}

uint64_t sub_1001AA5C0(unsigned char *a1, uint64_t a2)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(unsigned char *)(v14 + WORD2(v15)) = 0;
        *(unsigned char *)(v14 + WORD2(v15) + 1) = 1;
        unsigned __int16 v8 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v15) - v8 > 1)
        {
          if (BYTE6(v15) == 2)
          {
            *(unsigned char *)(v14 + v8) = *a1;
            *(unsigned char *)(v14 + WORD2(v15) + 1) = a1[1];
            unsigned __int16 v9 = WORD2(v15) + 2;
            WORD2(v15) += 2;
            if (HIBYTE(v15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v15) - v9 > 2)
            {
              if (BYTE6(v15) == 2)
              {
                uint64_t v10 = v14 + v9;
                *(unsigned char *)(v10 + 2) = 0;
                *(_WORD *)uint64_t v10 = 0;
                WORD2(v15) += 3;
                return sub_10001BCBC(131, v14, BYTE4(v15), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
              }
              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4306, v13);
            }
            uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
            goto LABEL_24;
          }
          uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4305, v12);
        }
        uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }
      unsigned int v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4304, v11);
    }
    unsigned int v11 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001AA7D0(const void *a1, int a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    uint64_t v7 = v14;
    uint64_t v8 = WORD2(v15);
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      int v9 = 0;
    }
    else
    {
      int v9 = WORD1(v15) - WORD2(v15);
    }
    if (v9 < a2)
    {
      uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
    }
    else
    {
      if (BYTE6(v15) == 2)
      {
        memmove((void *)(v7 + v8), a1, a2);
        WORD2(v15) += a2;
        return sub_10001BCBC(270, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v10, v11, v12);
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4321, v13);
  }
  return result;
}

uint64_t sub_1001AA8D8(const void *a1, int a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    uint64_t v7 = v14;
    uint64_t v8 = WORD2(v15);
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      int v9 = 0;
    }
    else
    {
      int v9 = WORD1(v15) - WORD2(v15);
    }
    if (v9 < a2)
    {
      uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
    }
    else
    {
      if (BYTE6(v15) == 2)
      {
        memmove((void *)(v7 + v8), a1, a2);
        WORD2(v15) += a2;
        return sub_10001BCBC(277, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v10, v11, v12);
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4335, v13);
  }
  return result;
}

uint64_t sub_1001AA9E0(const void *a1, int a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    uint64_t v7 = v14;
    uint64_t v8 = WORD2(v15);
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      int v9 = 0;
    }
    else
    {
      int v9 = WORD1(v15) - WORD2(v15);
    }
    if (v9 < a2)
    {
      uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
    }
    else
    {
      if (BYTE6(v15) == 2)
      {
        memmove((void *)(v7 + v8), a1, a2);
        WORD2(v15) += a2;
        return sub_10001BCBC(269, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v10, v11, v12);
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4349, v13);
  }
  return result;
}

uint64_t sub_1001AAAE8(unsigned char *a1, _WORD *a2, int a3, uint64_t a4)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v21) - WORD2(v21) > 1)
    {
      if (BYTE6(v21) == 2)
      {
        *(_WORD *)(v20 + WORD2(v21)) = *a2;
        unsigned __int16 v9 = WORD2(v21) + 2;
        WORD2(v21) += 2;
        if (HIBYTE(v21))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v21) - v9 > 1)
        {
          if (BYTE6(v21) == 2)
          {
            *(unsigned char *)(v20 + v9) = *a1;
            *(unsigned char *)(v20 + WORD2(v21) + 1) = a1[1];
            unsigned __int16 v10 = WORD2(v21) + 2;
            WORD2(v21) += 2;
            uint64_t v11 = v20;
            if (HIBYTE(v21))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              int v12 = 0;
            }
            else
            {
              int v12 = WORD1(v21) - v10;
            }
            int v13 = a3 - 4;
            if (v12 < v13)
            {
              uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= ((length - 4))";
            }
            else
            {
              if (BYTE6(v21) == 2)
              {
                memmove((void *)(v11 + v10), a2 + 2, v13);
                WORD2(v21) += v13;
                return sub_10001BCBC(268, v20, BYTE4(v21), a4, (uint64_t)sub_1000260B4, v14, v15, v16);
              }
              uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            }
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4365, v19);
          }
          uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4364, v18);
        }
        uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_22;
      }
      uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_18:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4363, v17);
    }
    uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= (2)";
    goto LABEL_18;
  }
  return result;
}

uint64_t sub_1001AAD10(unsigned char *a1, char a2, __int16 a3, __int16 a4, __int16 a5, __int16 a6, uint64_t a7)
{
  uint64_t v33 = 0;
  uint64_t v34 = 0;
  uint64_t result = sub_100059D70(&v33);
  if (!result)
  {
    if (HIBYTE(v34))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v34) - WORD2(v34) > 3)
    {
      if (BYTE6(v34) == 2)
      {
        *(unsigned char *)(v33 + WORD2(v34)) = 8;
        *(_WORD *)(v33 + WORD2(v34) + 1) = 0;
        *(unsigned char *)(v33 + WORD2(v34) + 3) = 0;
        unsigned __int16 v18 = WORD2(v34) + 4;
        WORD2(v34) += 4;
        if (HIBYTE(v34))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v34) - v18 > 1)
        {
          if (BYTE6(v34) == 2)
          {
            *(unsigned char *)(v33 + v18) = *a1;
            *(unsigned char *)(v33 + WORD2(v34) + 1) = a1[1];
            __int16 v19 = WORD2(v34);
            unsigned __int16 v20 = WORD2(v34) + 2;
            WORD2(v34) += 2;
            if (HIBYTE(v34))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v34) > v20)
            {
              if (BYTE6(v34) == 2)
              {
                WORD2(v34) = v19 + 3;
                *(unsigned char *)(v33 + v20) = a2;
                if (HIBYTE(v34))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v21 = WORD2(v34);
                  if (WORD1(v34) > WORD2(v34))
                  {
                    if (BYTE6(v34) == 2)
                    {
                      ++WORD2(v34);
                      *(unsigned char *)(v33 + v21) = 0;
                      if (HIBYTE(v34))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else if (WORD1(v34) - WORD2(v34) > 1)
                      {
                        if (BYTE6(v34) == 2)
                        {
                          *(_WORD *)(v33 + WORD2(v34)) = a3;
                          unsigned __int16 v22 = WORD2(v34) + 2;
                          WORD2(v34) += 2;
                          if (HIBYTE(v34))
                          {
                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }
                          else if (WORD1(v34) - v22 > 1)
                          {
                            if (BYTE6(v34) == 2)
                            {
                              *(unsigned char *)(v33 + v22) = a4;
                              *(unsigned char *)(v33 + WORD2(v34) + 1) = HIBYTE(a4);
                              unsigned __int16 v23 = WORD2(v34) + 2;
                              WORD2(v34) += 2;
                              if (HIBYTE(v34))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }
                              else if (WORD1(v34) - v23 > 1)
                              {
                                if (BYTE6(v34) == 2)
                                {
                                  *(unsigned char *)(v33 + v23) = a5;
                                  *(unsigned char *)(v33 + WORD2(v34) + 1) = HIBYTE(a5);
                                  unsigned __int16 v24 = WORD2(v34) + 2;
                                  WORD2(v34) += 2;
                                  if (HIBYTE(v34))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else if (WORD1(v34) - v24 > 1)
                                  {
                                    if (BYTE6(v34) == 2)
                                    {
                                      *(unsigned char *)(v33 + v24) = a6;
                                      *(unsigned char *)(v33 + WORD2(v34) + 1) = HIBYTE(a6);
                                      WORD2(v34) += 2;
                                      return sub_10001BCBC(226, v33, BYTE4(v34), a7, (uint64_t)sub_1000260B4, v15, v16, v17);
                                    }
                                    unsigned int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4387, v32);
                                  }
                                  unsigned int v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_59;
                                }
                                unsigned int v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4386, v31);
                              }
                              unsigned int v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                              goto LABEL_55;
                            }
                            unsigned int v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4385, v30);
                          }
                          unsigned int v30 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                          goto LABEL_51;
                        }
                        unsigned int v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_47:
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4384, v29);
                      }
                      unsigned int v29 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                      goto LABEL_47;
                    }
                    unsigned int v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4383, v28);
                  }
                }
                unsigned int v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_43;
              }
              long long v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4382, v27);
            }
            long long v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_39;
          }
          long long v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4381, v26);
        }
        long long v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_35;
      }
      uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4380, v25);
    }
    uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_31;
  }
  return result;
}

uint64_t sub_1001AB228(_WORD *a1, char a2, int a3, int a4, int a5, int a6, int a7, int a8, char a9, uint64_t a10)
{
  uint64_t v34 = 0;
  uint64_t v35 = 0;
  uint64_t result = sub_100059D70(&v34);
  if (a3) {
    char v22 = 2;
  }
  else {
    char v22 = 0;
  }
  if (a4) {
    char v23 = 4;
  }
  else {
    char v23 = 0;
  }
  if (a5) {
    char v24 = 8;
  }
  else {
    char v24 = 0;
  }
  if (a6) {
    char v25 = 16;
  }
  else {
    char v25 = 0;
  }
  if (a7) {
    char v26 = 64;
  }
  else {
    char v26 = 0;
  }
  if (a8) {
    char v27 = 0x80;
  }
  else {
    char v27 = 0;
  }
  if (!result)
  {
    if (HIBYTE(v35))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v35) - WORD2(v35) > 1)
    {
      if (BYTE6(v35) == 2)
      {
        *(_WORD *)(v34 + WORD2(v35)) = *a1;
        __int16 v28 = WORD2(v35);
        unsigned __int16 v29 = WORD2(v35) + 2;
        WORD2(v35) += 2;
        if (HIBYTE(v35))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v35) > v29)
        {
          if (BYTE6(v35) == 2)
          {
            WORD2(v35) = v28 + 3;
            *(unsigned char *)(v34 + v29) = v22 | a2 | v23 | v24 | v25 | v26 | v27;
            if (HIBYTE(v35))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else
            {
              uint64_t v30 = WORD2(v35);
              if (WORD1(v35) > WORD2(v35))
              {
                if (BYTE6(v35) == 2)
                {
                  ++WORD2(v35);
                  *(unsigned char *)(v34 + v30) = a9;
                  return sub_10001BCBC(477, v34, BYTE4(v35), a10, (uint64_t)sub_1000260B4, v19, v20, v21);
                }
                uint64_t v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4408, v33);
              }
            }
            uint64_t v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_42;
          }
          unsigned int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4407, v32);
        }
        unsigned int v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_38;
      }
      unsigned int v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4406, v31);
    }
    unsigned int v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_34;
  }
  return result;
}

uint64_t sub_1001AB4A4(int a1, uint64_t a2)
{
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  uint64_t result = sub_100059D70(&v13);
  int v16 = 0;
  uint64_t v15 = 0;
  if (!result)
  {
    if (a1)
    {
      if (HIBYTE(v14))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else if (WORD1(v14) - WORD2(v14) > 11)
      {
        if (BYTE6(v14) == 2)
        {
          uint64_t v8 = &qword_1007BA294;
LABEL_11:
          uint64_t v9 = v13 + WORD2(v14);
          uint64_t v10 = *v8;
          *(_DWORD *)(v9 + 8) = *((_DWORD *)v8 + 2);
          *(void *)uint64_t v9 = v10;
          WORD2(v14) += 12;
          return sub_10001BCBC(39, v13, BYTE4(v14), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4425, v11);
      }
      uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= (12)";
      goto LABEL_16;
    }
    if (HIBYTE(v14))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v14) - WORD2(v14) > 11)
    {
      if (BYTE6(v14) == 2)
      {
        uint64_t v8 = &v15;
        goto LABEL_11;
      }
      int v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4427, v12);
    }
    int v12 = "ByteStream_NumReadBytesAvail(bs) >= (12)";
    goto LABEL_20;
  }
  return result;
}

uint64_t sub_1001AB640(int a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1 != 0;
          return sub_10001BCBC(385, v10, BYTE4(v11), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4442, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AB720(char *a1, uint64_t a2)
{
  uint64_t v40 = 0;
  uint64_t v41 = 0;
  uint64_t result = sub_100059D70(&v40);
  if (!result)
  {
    if (HIBYTE(v41))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v41);
      if (WORD1(v41) > WORD2(v41))
      {
        if (BYTE6(v41) == 2)
        {
          char v9 = *a1;
          ++WORD2(v41);
          *(unsigned char *)(v40 + v8) = v9;
          if (HIBYTE(v41))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v41) - WORD2(v41) > 1)
          {
            if (BYTE6(v41) == 2)
            {
              *(_WORD *)(v40 + WORD2(v41)) = *((_WORD *)a1 + 1);
              __int16 v10 = WORD2(v41);
              LOWORD(v11) = WORD2(v41) + 2;
              WORD2(v41) += 2;
              if (!*a1) {
                return sub_10001BCBC(289, v40, v11, a2, (uint64_t)sub_1001A65D8, v5, v6, v7);
              }
              if (HIBYTE(v41))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v41) > (unsigned __int16)v11)
              {
                if (BYTE6(v41) == 2)
                {
                  char v12 = a1[4];
                  WORD2(v41) = v10 + 3;
                  *(unsigned char *)(v40 + (unsigned __int16)v11) = v12;
                  if (HIBYTE(v41))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v13 = WORD2(v41);
                    if (WORD1(v41) > WORD2(v41))
                    {
                      if (BYTE6(v41) == 2)
                      {
                        char v14 = a1[5];
                        ++WORD2(v41);
                        *(unsigned char *)(v40 + v13) = v14;
                        if (HIBYTE(v41))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else
                        {
                          uint64_t v15 = WORD2(v41);
                          if (WORD1(v41) > WORD2(v41))
                          {
                            if (BYTE6(v41) == 2)
                            {
                              char v16 = a1[6];
                              ++WORD2(v41);
                              *(unsigned char *)(v40 + v15) = v16;
                              if (HIBYTE(v41))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }
                              else if (WORD1(v41) - WORD2(v41) > 1)
                              {
                                if (BYTE6(v41) == 2)
                                {
                                  *(_WORD *)(v40 + WORD2(v41)) = *((_WORD *)a1 + 4);
                                  unsigned __int16 v17 = WORD2(v41) + 2;
                                  WORD2(v41) += 2;
                                  if (HIBYTE(v41))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else if (WORD1(v41) - v17 > 1)
                                  {
                                    if (BYTE6(v41) == 2)
                                    {
                                      *(unsigned char *)(v40 + v17) = a1[10];
                                      *(unsigned char *)(v40 + WORD2(v41) + 1) = a1[11];
                                      __int16 v18 = WORD2(v41);
                                      unsigned __int16 v19 = WORD2(v41) + 2;
                                      WORD2(v41) += 2;
                                      if (HIBYTE(v41))
                                      {
                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }
                                      else if (WORD1(v41) > v19)
                                      {
                                        if (BYTE6(v41) == 2)
                                        {
                                          char v20 = a1[12];
                                          WORD2(v41) = v18 + 3;
                                          *(unsigned char *)(v40 + v19) = v20;
                                          if (HIBYTE(v41))
                                          {
                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }
                                          else
                                          {
                                            uint64_t v21 = WORD2(v41);
                                            if (WORD1(v41) > WORD2(v41))
                                            {
                                              if (BYTE6(v41) == 2)
                                              {
                                                char v22 = a1[13];
                                                ++WORD2(v41);
                                                *(unsigned char *)(v40 + v21) = v22;
                                                if (HIBYTE(v41))
                                                {
                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }
                                                else
                                                {
                                                  uint64_t v23 = WORD2(v41);
                                                  if (WORD1(v41) > WORD2(v41))
                                                  {
                                                    if (BYTE6(v41) == 2)
                                                    {
                                                      char v24 = a1[14];
                                                      ++WORD2(v41);
                                                      *(unsigned char *)(v40 + v23) = v24;
                                                      if (HIBYTE(v41))
                                                      {
                                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }
                                                      else
                                                      {
                                                        uint64_t v25 = WORD2(v41);
                                                        if (WORD1(v41) > WORD2(v41))
                                                        {
                                                          if (BYTE6(v41) == 2)
                                                          {
                                                            char v26 = a1[15];
                                                            ++WORD2(v41);
                                                            *(unsigned char *)(v40 + v25) = v26;
                                                            if (HIBYTE(v41))
                                                            {
                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sourc"
                                                                                     "es/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                            }
                                                            else
                                                            {
                                                              uint64_t v11 = WORD2(v41);
                                                              if (WORD1(v41) > WORD2(v41))
                                                              {
                                                                if (BYTE6(v41) == 2)
                                                                {
                                                                  char v27 = a1[16];
                                                                  ++WORD2(v41);
                                                                  *(unsigned char *)(v40 + v11) = v27;
                                                                  LOBYTE(v11) = BYTE4(v41);
                                                                  return sub_10001BCBC(289, v40, v11, a2, (uint64_t)sub_1001A65D8, v5, v6, v7);
                                                                }
                                                                unsigned int v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
                                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4470, v39);
                                                              }
                                                            }
                                                            unsigned int v39 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                            goto LABEL_89;
                                                          }
                                                          unsigned int v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_85:
                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4469, v38);
                                                        }
                                                      }
                                                      unsigned int v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                      goto LABEL_85;
                                                    }
                                                    unsigned int v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_81:
                                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4468, v37);
                                                  }
                                                }
                                                unsigned int v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_81;
                                              }
                                              unsigned int v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_77:
                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4467, v36);
                                            }
                                          }
                                          unsigned int v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_77;
                                        }
                                        uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4466, v35);
                                      }
                                      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                      goto LABEL_73;
                                    }
                                    uint64_t v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4465, v34);
                                  }
                                  uint64_t v34 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_69;
                                }
                                uint64_t v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4464, v33);
                              }
                              uint64_t v33 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                              goto LABEL_65;
                            }
                            unsigned int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4463, v32);
                          }
                        }
                        unsigned int v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_61;
                      }
                      unsigned int v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4462, v31);
                    }
                  }
                  unsigned int v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_57;
                }
                uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_53:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4461, v30);
              }
              uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_53;
            }
            unsigned __int16 v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4458, v29);
          }
          unsigned __int16 v29 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_49;
        }
        __int16 v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4457, v28);
      }
    }
    __int16 v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_45;
  }
  return result;
}

uint64_t *sub_1001ABDB0(uint64_t *result, char *a2)
{
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_18;
  }
  uint64_t v2 = *((unsigned __int16 *)result + 6);
  if (*((unsigned __int16 *)result + 5) <= v2)
  {
LABEL_18:
    uint64_t v13 = "ByteStream_NumReadBytesAvail(*bs) >= 1";
    goto LABEL_20;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    uint64_t v13 = "(*bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4482, v13);
  }
  char v3 = *a2;
  uint64_t v4 = *result;
  *((_WORD *)result + 6) = v2 + 1;
  *(unsigned char *)(v4 + v2) = v3;
  if (*((unsigned char *)result + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_22;
  }
  uint64_t v5 = *((unsigned __int16 *)result + 6);
  if (*((unsigned __int16 *)result + 5) <= v5)
  {
LABEL_22:
    char v14 = "ByteStream_NumReadBytesAvail(*bs) >= 1";
    goto LABEL_24;
  }
  if (*((unsigned char *)result + 14) != 2)
  {
    char v14 = "(*bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4483, v14);
  }
  char v6 = a2[1];
  uint64_t v7 = *result;
  *((_WORD *)result + 6) = v5 + 1;
  *(unsigned char *)(v7 + v5) = v6;
  for (uint64_t i = 2; i != 12; ++i)
  {
    if (*((unsigned char *)result + 15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_14:
      char v12 = "ByteStream_NumReadBytesAvail(*bs) >= 1";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4485, v12);
    }
    uint64_t v9 = *((unsigned __int16 *)result + 6);
    if (*((unsigned __int16 *)result + 5) <= v9) {
      goto LABEL_14;
    }
    if (*((unsigned char *)result + 14) != 2)
    {
      char v12 = "(*bs).__RWFlag == BYTESTREAM_WRITE";
      goto LABEL_16;
    }
    char v10 = a2[i];
    uint64_t v11 = *result;
    *((_WORD *)result + 6) = v9 + 1;
    *(unsigned char *)(v11 + v9) = v10;
  }
  return result;
}

uint64_t sub_1001ABF48(char *a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          char v6 = *a1;
          ++WORD2(v12);
          *(unsigned char *)(v11 + v5) = v6;
          sub_1001ABDB0(&v11, a1 + 1);
          sub_1001ABDB0(&v11, a1 + 13);
          sub_1001ABDB0(&v11, a1 + 25);
          sub_1001ABDB0(&v11, a1 + 37);
          return sub_10001BCBC(465, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v7, v8, v9);
        }
        char v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4495, v10);
      }
    }
    char v10 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AC060(char *a1, uint64_t a2)
{
  uint64_t v30 = 0;
  uint64_t v31 = 0;
  uint64_t result = sub_100059D70(&v30);
  if (result) {
    return result;
  }
  if (HIBYTE(v31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_32;
  }
  uint64_t v8 = WORD2(v31);
  if (WORD1(v31) <= WORD2(v31))
  {
LABEL_32:
    char v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }
  if (BYTE6(v31) != 2)
  {
    char v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4514, v24);
  }
  char v9 = *a1;
  ++WORD2(v31);
  *(unsigned char *)(v30 + v8) = v9;
  if (HIBYTE(v31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_36;
  }
  uint64_t v10 = WORD2(v31);
  if (WORD1(v31) <= WORD2(v31))
  {
LABEL_36:
    uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_38;
  }
  if (BYTE6(v31) != 2)
  {
    uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4515, v25);
  }
  char v11 = a1[1];
  ++WORD2(v31);
  *(unsigned char *)(v30 + v10) = v11;
  if (HIBYTE(v31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_40;
  }
  uint64_t v12 = WORD2(v31);
  if (WORD1(v31) <= WORD2(v31))
  {
LABEL_40:
    char v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_42;
  }
  if (BYTE6(v31) != 2)
  {
    char v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4516, v26);
  }
  char v13 = a1[2];
  ++WORD2(v31);
  *(unsigned char *)(v30 + v12) = v13;
  if (HIBYTE(v31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_44;
  }
  uint64_t v14 = WORD2(v31);
  if (WORD1(v31) <= WORD2(v31))
  {
LABEL_44:
    char v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_46;
  }
  if (BYTE6(v31) != 2)
  {
    char v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4517, v27);
  }
  char v15 = a1[3];
  ++WORD2(v31);
  *(unsigned char *)(v30 + v14) = v15;
  if (HIBYTE(v31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_48;
  }
  uint64_t v16 = WORD2(v31);
  if (WORD1(v31) <= WORD2(v31))
  {
LABEL_48:
    __int16 v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_50;
  }
  if (BYTE6(v31) != 2)
  {
    __int16 v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4518, v28);
  }
  char v17 = a1[4];
  ++WORD2(v31);
  *(unsigned char *)(v30 + v16) = v17;
  if (HIBYTE(v31))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_52;
  }
  uint64_t v18 = WORD2(v31);
  if (WORD1(v31) <= WORD2(v31))
  {
LABEL_52:
    unsigned __int16 v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_54;
  }
  if (BYTE6(v31) != 2)
  {
    unsigned __int16 v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4519, v29);
  }
  char v19 = a1[5];
  ++WORD2(v31);
  *(unsigned char *)(v30 + v18) = v19;
  for (uint64_t i = 6; i != 16; ++i)
  {
    if (HIBYTE(v31))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_28:
      uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_30:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4521, v23);
    }
    uint64_t v21 = WORD2(v31);
    if (WORD1(v31) <= WORD2(v31)) {
      goto LABEL_28;
    }
    if (BYTE6(v31) != 2)
    {
      uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
      goto LABEL_30;
    }
    char v22 = a1[i];
    ++WORD2(v31);
    *(unsigned char *)(v30 + v21) = v22;
  }
  return sub_10001BCBC(478, v30, BYTE4(v31), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
}

uint64_t sub_1001AC434(_WORD *a1, __int16 a2, uint64_t a3)
{
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  uint64_t result = sub_100059D70(&v13);
  if (!result)
  {
    if (HIBYTE(v14))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v14) - WORD2(v14) > 1)
    {
      if (BYTE6(v14) == 2)
      {
        *(_WORD *)(v13 + WORD2(v14)) = *a1;
        unsigned __int16 v10 = WORD2(v14) + 2;
        WORD2(v14) += 2;
        if (HIBYTE(v14))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v14) - v10 > 1)
        {
          if (BYTE6(v14) == 2)
          {
            *(unsigned char *)(v13 + v10) = a2;
            *(unsigned char *)(v13 + WORD2(v14) + 1) = HIBYTE(a2);
            WORD2(v14) += 2;
            return sub_10001BCBC(371, v13, BYTE4(v14), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
          }
          uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4538, v12);
        }
        uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_17;
      }
      char v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4537, v11);
    }
    char v11 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001AC5CC(__int16 a1, uint64_t a2)
{
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t result = sub_100059D70(&v9);
  if (!result)
  {
    if (HIBYTE(v10))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v10) - WORD2(v10) > 1)
    {
      if (BYTE6(v10) == 2)
      {
        *(_WORD *)(v9 + WORD2(v10)) = a1;
        WORD2(v10) += 2;
        return sub_10001BCBC(411, v9, BYTE4(v10), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
      }
      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4553, v8);
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AC6C0(_WORD *a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(_WORD *)(v14 + WORD2(v15)) = *a1;
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(unsigned char *)(v14 + v11) = a2;
            return sub_10001BCBC(394, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
          }
          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4569, v13);
        }
        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4568, v12);
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001AC83C(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(283, v10, BYTE4(v11), a2, (uint64_t)sub_1001A65D8, v5, v6, v7);
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4584, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AC914(char a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(unsigned char *)(v11 + WORD2(v12)) = 27;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(unsigned char *)(v11 + v8) = a1;
            *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
            *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
            WORD2(v12) += 4;
            return sub_10001BCBC(226, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4600, v10);
        }
        uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }
      uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4599, v9);
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001ACAD8(int a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(unsigned char *)(v20 + WORD2(v21)) = 19;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(unsigned char *)(v20 + WORD2(v21) + 3) = 0;
        __int16 v12 = WORD2(v21);
        unsigned __int16 v13 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v21) > v13)
        {
          if (BYTE6(v21) == 2)
          {
            WORD2(v21) = v12 + 5;
            *(unsigned char *)(v20 + v13) = a1;
            if (!a1) {
              return sub_10001BCBC(226, v20, BYTE4(v21), a4, (uint64_t)sub_1001A65D8, v9, v10, v11);
            }
            if (HIBYTE(v21))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else
            {
              uint64_t v14 = WORD2(v21);
              if (WORD1(v21) > WORD2(v21))
              {
                if (BYTE6(v21) == 2)
                {
                  ++WORD2(v21);
                  *(unsigned char *)(v20 + v14) = a2;
                  if (HIBYTE(v21))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v15 = WORD2(v21);
                    if (WORD1(v21) > WORD2(v21))
                    {
                      if (BYTE6(v21) == 2)
                      {
                        ++WORD2(v21);
                        *(unsigned char *)(v20 + v15) = a3;
                        return sub_10001BCBC(226, v20, BYTE4(v21), a4, (uint64_t)sub_1001A65D8, v9, v10, v11);
                      }
                      char v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4620, v19);
                    }
                  }
                  char v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_33;
                }
                uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4619, v18);
              }
            }
            uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_29;
          }
          char v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4616, v17);
        }
        char v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_25;
      }
      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_21:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4615, v16);
    }
    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_21;
  }
  return result;
}

uint64_t sub_1001ACD68(int a1, char a2, char a3, char a4, char a5, char a6, uint64_t a7)
{
  uint64_t v38 = 0;
  uint64_t v39 = 0;
  uint64_t result = sub_100059D70(&v38);
  if (!result)
  {
    if (HIBYTE(v39))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v39) - WORD2(v39) > 3)
    {
      if (BYTE6(v39) == 2)
      {
        *(unsigned char *)(v38 + WORD2(v39)) = 61;
        *(_WORD *)(v38 + WORD2(v39) + 1) = 0;
        *(unsigned char *)(v38 + WORD2(v39) + 3) = 0;
        __int16 v18 = WORD2(v39);
        unsigned __int16 v19 = WORD2(v39) + 4;
        WORD2(v39) += 4;
        if (HIBYTE(v39))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v39) > v19)
        {
          if (BYTE6(v39) == 2)
          {
            WORD2(v39) = v18 + 5;
            *(unsigned char *)(v38 + v19) = a1;
            if (!a1)
            {
              unsigned __int8 v27 = BYTE4(v39);
              return sub_10001BCBC(226, v38, v27, a7, (uint64_t)sub_1001A65D8, v15, v16, v17);
            }
            if (HIBYTE(v39))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else
            {
              uint64_t v20 = WORD2(v39);
              if (WORD1(v39) > WORD2(v39))
              {
                if (BYTE6(v39) == 2)
                {
                  ++WORD2(v39);
                  *(unsigned char *)(v38 + v20) = a2;
                  if (HIBYTE(v39))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v21 = WORD2(v39);
                    if (WORD1(v39) > WORD2(v39))
                    {
                      if (BYTE6(v39) == 2)
                      {
                        ++WORD2(v39);
                        *(unsigned char *)(v38 + v21) = a3;
                        if (HIBYTE(v39))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else
                        {
                          uint64_t v22 = WORD2(v39);
                          if (WORD1(v39) > WORD2(v39))
                          {
                            if (BYTE6(v39) == 2)
                            {
                              ++WORD2(v39);
                              *(unsigned char *)(v38 + v22) = a4;
                              if (HIBYTE(v39))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }
                              else if (WORD1(v39) > WORD2(v39))
                              {
                                if (BYTE6(v39) == 2)
                                {
                                  *(unsigned char *)(v38 + WORD2(v39)) = 0;
                                  __int16 v23 = WORD2(v39);
                                  unsigned __int16 v24 = ++WORD2(v39);
                                  if (HIBYTE(v39))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else if (WORD1(v39) > v24)
                                  {
                                    if (BYTE6(v39) == 2)
                                    {
                                      WORD2(v39) = v23 + 2;
                                      *(unsigned char *)(v38 + v24) = a5;
                                      if (HIBYTE(v39))
                                      {
                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }
                                      else if (WORD1(v39) > WORD2(v39))
                                      {
                                        if (BYTE6(v39) == 2)
                                        {
                                          *(unsigned char *)(v38 + WORD2(v39)) = 0;
                                          __int16 v25 = WORD2(v39);
                                          unsigned __int16 v26 = ++WORD2(v39);
                                          if (HIBYTE(v39))
                                          {
                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }
                                          else if (WORD1(v39) > v26)
                                          {
                                            if (BYTE6(v39) == 2)
                                            {
                                              WORD2(v39) = v25 + 2;
                                              *(unsigned char *)(v38 + v26) = a6;
                                              if (HIBYTE(v39))
                                              {
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }
                                              else if (WORD1(v39) - WORD2(v39) > 1)
                                              {
                                                if (BYTE6(v39) == 2)
                                                {
                                                  *(_WORD *)(v38 + WORD2(v39)) = 0;
                                                  unsigned __int8 v27 = BYTE4(v39) + 2;
                                                  WORD2(v39) += 2;
                                                  return sub_10001BCBC(226, v38, v27, a7, (uint64_t)sub_1001A65D8, v15, v16, v17);
                                                }
                                                unsigned int v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_76:
                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4647, v37);
                                              }
                                              unsigned int v37 = "ByteStream_NumReadBytesAvail(bs) >= (2)";
                                              goto LABEL_76;
                                            }
                                            unsigned int v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_72:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4646, v36);
                                          }
                                          unsigned int v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_72;
                                        }
                                        uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_68:
                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4645, v35);
                                      }
                                      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                                      goto LABEL_68;
                                    }
                                    uint64_t v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_64:
                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4644, v34);
                                  }
                                  uint64_t v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_64;
                                }
                                uint64_t v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_60:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4643, v33);
                              }
                              uint64_t v33 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                              goto LABEL_60;
                            }
                            unsigned int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4642, v32);
                          }
                        }
                        unsigned int v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_56;
                      }
                      uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4641, v31);
                    }
                  }
                  uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_52;
                }
                uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4640, v30);
              }
            }
            uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_48;
          }
          unsigned __int16 v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4637, v29);
        }
        unsigned __int16 v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_44;
      }
      __int16 v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4636, v28);
    }
    __int16 v28 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_40;
  }
  return result;
}

uint64_t sub_1001AD2FC(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = -15;
          return sub_10001BCBC(284, v8, BYTE4(v9), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4663, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AD3D4(uint64_t a1)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(unsigned char *)(v11 + v6) = 80;
          if (HIBYTE(v12))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v12) - WORD2(v12) > 3)
          {
            if (BYTE6(v12) == 2)
            {
              *(unsigned char *)(v11 + WORD2(v12)) = 0;
              *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
              *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
              unsigned __int16 v7 = WORD2(v12) + 4;
              WORD2(v12) += 4;
              if (HIBYTE(v12))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v12) - v7 > 1)
              {
                if (BYTE6(v12) == 2)
                {
                  *(unsigned char *)(v11 + v7) = 2;
                  *(unsigned char *)(v11 + WORD2(v12) + 1) = 0;
                  WORD2(v12) += 2;
                  return sub_10001BCBC(284, v11, BYTE4(v12), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
                }
                uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4680, v10);
              }
              uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_24;
            }
            uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4679, v9);
          }
          uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_20;
        }
        uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4678, v8);
      }
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001AD5F0(int a1, int a2, uint64_t a3)
{
  uint64_t v25 = 0;
  uint64_t v26 = 0;
  uint64_t result = sub_100059D70(&v25);
  if (!result)
  {
    if (a1)
    {
      if (HIBYTE(v26))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else
      {
        uint64_t v10 = WORD2(v26);
        if (WORD1(v26) > WORD2(v26))
        {
          if (BYTE6(v26) == 2)
          {
            ++WORD2(v26);
            *(unsigned char *)(v25 + v10) = 81;
            if (HIBYTE(v26))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else
            {
              uint64_t v11 = WORD2(v26);
              if (WORD1(v26) > WORD2(v26))
              {
                if (BYTE6(v26) == 2)
                {
                  ++WORD2(v26);
                  *(unsigned char *)(v25 + v11) = 1;
                  if (HIBYTE(v26))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else if (WORD1(v26) - WORD2(v26) > 1)
                  {
                    if (BYTE6(v26) == 2)
                    {
                      *(_WORD *)(v25 + WORD2(v26)) = __PAIR16__((2 * a2) >> 24, 2 * a2);
                      unsigned __int16 v12 = WORD2(v26) + 2;
                      WORD2(v26) += 2;
                      if (HIBYTE(v26))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else if (WORD1(v26) - v12 > 3)
                      {
                        if (BYTE6(v26) == 2)
                        {
                          *(unsigned char *)(v25 + v12) = 112;
                          *(_WORD *)(v25 + WORD2(v26) + 1) = 23;
                          *(unsigned char *)(v25 + WORD2(v26) + 3) = 0;
                          WORD2(v26) += 4;
                          if (sub_1001F7D74()
                            && sub_1001F7D74() <= 0x7CF
                            && sub_1001F7D74() >= 0x13)
                          {
                            if (HIBYTE(v26))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else if (WORD1(v26) - WORD2(v26) > 3)
                            {
                              if (BYTE6(v26) == 2)
                              {
                                *(unsigned char *)(v25 + WORD2(v26)) = -112;
                                char v13 = 11;
LABEL_33:
                                *(unsigned char *)(v25 + WORD2(v26) + 1) = v13;
                                *(unsigned char *)(v25 + WORD2(v26) + 2) = 72;
                                *(unsigned char *)(v25 + WORD2(v26) + 3) = 4;
                                unsigned __int8 v16 = BYTE4(v26) + 4;
                                WORD2(v26) += 4;
                                return sub_10001BCBC(284, v25, v16, a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                              }
                              unsigned __int16 v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_67:
                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4701, v24);
                            }
                            unsigned __int16 v24 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                            goto LABEL_67;
                          }
                          if (HIBYTE(v26))
                          {
                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }
                          else if (WORD1(v26) - WORD2(v26) > 3)
                          {
                            if (BYTE6(v26) == 2)
                            {
                              char v13 = 0;
                              *(unsigned char *)(v25 + WORD2(v26)) = 0;
                              goto LABEL_33;
                            }
                            __int16 v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_63:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4703, v23);
                          }
                          __int16 v23 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                          goto LABEL_63;
                        }
                        uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4698, v20);
                      }
                      uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                      goto LABEL_51;
                    }
                    unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_47:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4697, v19);
                  }
                  unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                  goto LABEL_47;
                }
                __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4696, v18);
              }
            }
            __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_43;
          }
          uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4695, v17);
        }
      }
      uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_39;
    }
    if (HIBYTE(v26))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v14 = WORD2(v26);
      if (WORD1(v26) > WORD2(v26))
      {
        if (BYTE6(v26) == 2)
        {
          ++WORD2(v26);
          *(unsigned char *)(v25 + v14) = 81;
          if (HIBYTE(v26))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v15 = WORD2(v26);
            if (WORD1(v26) > WORD2(v26))
            {
              if (BYTE6(v26) == 2)
              {
                ++WORD2(v26);
                *(unsigned char *)(v25 + v15) = 0;
                unsigned __int8 v16 = BYTE4(v26);
                return sub_10001BCBC(284, v25, v16, a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4710, v22);
            }
          }
          uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_59;
        }
        uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4709, v21);
      }
    }
    uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_55;
  }
  return result;
}

uint64_t sub_1001ADAFC(int a1, uint64_t a2)
{
  uint64_t v13 = 0;
  uint64_t v14 = 0;
  uint64_t result = sub_100059D70(&v13);
  if (!result)
  {
    if (HIBYTE(v14))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v14);
      if (WORD1(v14) > WORD2(v14))
      {
        if (BYTE6(v14) == 2)
        {
          ++WORD2(v14);
          *(unsigned char *)(v13 + v8) = -7;
          if (HIBYTE(v14))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v14) - WORD2(v14) > 3)
          {
            if (BYTE6(v14) == 2)
            {
              *(_WORD *)(v13 + WORD2(v14)) = a1;
              *(unsigned char *)(v13 + WORD2(v14) + 2) = BYTE2(a1);
              *(unsigned char *)(v13 + WORD2(v14) + 3) = HIBYTE(a1);
              unsigned __int16 v9 = WORD2(v14) + 4;
              WORD2(v14) += 4;
              if (HIBYTE(v14))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v14) - v9 > 3)
              {
                if (BYTE6(v14) == 2)
                {
                  *(unsigned char *)(v13 + v9) = 0;
                  *(_WORD *)(v13 + WORD2(v14) + 1) = 0;
                  *(unsigned char *)(v13 + WORD2(v14) + 3) = 0;
                  WORD2(v14) += 4;
                  return sub_10001BCBC(284, v13, BYTE4(v14), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
                }
                unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4726, v12);
              }
              unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
              goto LABEL_24;
            }
            uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4725, v11);
          }
          uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_20;
        }
        uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4724, v10);
      }
    }
    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001ADD44(char a1, __int16 a2, __int16 a3, char a4, char a5, int a6, char a7, char a8, char a9, uint64_t a10)
{
  uint64_t v38 = 0;
  uint64_t v39 = 0;
  uint64_t result = sub_100059D70(&v38);
  if (!result)
  {
    if (HIBYTE(v39))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v22 = WORD2(v39);
      if (WORD1(v39) > WORD2(v39))
      {
        if (BYTE6(v39) == 2)
        {
          ++WORD2(v39);
          *(unsigned char *)(v38 + v22) = a1;
          if (HIBYTE(v39))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v39) - WORD2(v39) > 1)
          {
            if (BYTE6(v39) == 2)
            {
              *(_WORD *)(v38 + WORD2(v39)) = a2;
              unsigned __int16 v23 = WORD2(v39) + 2;
              WORD2(v39) += 2;
              if (HIBYTE(v39))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v39) - v23 > 1)
              {
                if (BYTE6(v39) == 2)
                {
                  *(unsigned char *)(v38 + v23) = a3;
                  *(unsigned char *)(v38 + WORD2(v39) + 1) = HIBYTE(a3);
                  __int16 v24 = WORD2(v39);
                  unsigned __int16 v25 = WORD2(v39) + 2;
                  WORD2(v39) += 2;
                  if (HIBYTE(v39))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else if (WORD1(v39) > v25)
                  {
                    if (BYTE6(v39) == 2)
                    {
                      WORD2(v39) = v24 + 3;
                      *(unsigned char *)(v38 + v25) = a4;
                      if (HIBYTE(v39))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v26 = WORD2(v39);
                        if (WORD1(v39) > WORD2(v39))
                        {
                          if (BYTE6(v39) == 2)
                          {
                            ++WORD2(v39);
                            *(unsigned char *)(v38 + v26) = a5;
                            if (!a6) {
                              return sub_10001BCBC(585, v38, BYTE4(v39), a10, (uint64_t)sub_1000260B4, v19, v20, v21);
                            }
                            if (HIBYTE(v39))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v27 = WORD2(v39);
                              if (WORD1(v39) > WORD2(v39))
                              {
                                if (BYTE6(v39) == 2)
                                {
                                  ++WORD2(v39);
                                  *(unsigned char *)(v38 + v27) = a7;
                                  if (HIBYTE(v39))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else
                                  {
                                    uint64_t v28 = WORD2(v39);
                                    if (WORD1(v39) > WORD2(v39))
                                    {
                                      if (BYTE6(v39) == 2)
                                      {
                                        ++WORD2(v39);
                                        *(unsigned char *)(v38 + v28) = a8;
                                        if (HIBYTE(v39))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else
                                        {
                                          uint64_t v29 = WORD2(v39);
                                          if (WORD1(v39) > WORD2(v39))
                                          {
                                            if (BYTE6(v39) == 2)
                                            {
                                              ++WORD2(v39);
                                              *(unsigned char *)(v38 + v29) = a9;
                                              return sub_10001BCBC(585, v38, BYTE4(v39), a10, (uint64_t)sub_1000260B4, v19, v20, v21);
                                            }
                                            unsigned int v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4747, v37);
                                          }
                                        }
                                        unsigned int v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_61;
                                      }
                                      unsigned int v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4746, v36);
                                    }
                                  }
                                  unsigned int v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_57;
                                }
                                uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_53:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4745, v35);
                              }
                            }
                            uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_53;
                          }
                          uint64_t v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4743, v34);
                        }
                      }
                      uint64_t v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_49;
                    }
                    uint64_t v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4742, v33);
                  }
                  uint64_t v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_45;
                }
                unsigned int v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4741, v32);
              }
              unsigned int v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_41;
            }
            uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4740, v31);
          }
          uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_37;
        }
        uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4739, v30);
      }
    }
    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_33;
  }
  return result;
}

uint64_t sub_1001AE1D4(char a1, char a2, char a3, char a4, char a5, char a6, char a7, char a8, char a9, char a10, char a11, char a12, char a13, char a14, char a15, char a16, int a17, int a18, int a19, int a20,int a21,int a22,int a23,int a24,int a25,int a26,int a27,int a28,int a29,int a30,int a31,int a32,int a33,int a34,int a35,int a36,int a37,int a38,int a39,int a40,int a41,int a42,char a43,char a44,__int16 a45,char a46,uint64_t a47)
{
  uint64_t v147 = 0;
  uint64_t v148 = 0;
  uint64_t result = sub_100059D70(&v147);
  if (!result)
  {
    if (HIBYTE(v148))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v59 = WORD2(v148);
      if (WORD1(v148) > WORD2(v148))
      {
        if (BYTE6(v148) == 2)
        {
          ++WORD2(v148);
          *(unsigned char *)(v147 + v59) = a1;
          if (HIBYTE(v148))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v60 = WORD2(v148);
            if (WORD1(v148) > WORD2(v148))
            {
              if (BYTE6(v148) == 2)
              {
                ++WORD2(v148);
                *(unsigned char *)(v147 + v60) = a2;
                if (HIBYTE(v148))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v61 = WORD2(v148);
                  if (WORD1(v148) > WORD2(v148))
                  {
                    if (BYTE6(v148) == 2)
                    {
                      ++WORD2(v148);
                      *(unsigned char *)(v147 + v61) = a3;
                      if (HIBYTE(v148))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v62 = WORD2(v148);
                        if (WORD1(v148) > WORD2(v148))
                        {
                          if (BYTE6(v148) == 2)
                          {
                            ++WORD2(v148);
                            *(unsigned char *)(v147 + v62) = a4;
                            if (HIBYTE(v148))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v63 = WORD2(v148);
                              if (WORD1(v148) > WORD2(v148))
                              {
                                if (BYTE6(v148) == 2)
                                {
                                  ++WORD2(v148);
                                  *(unsigned char *)(v147 + v63) = a5;
                                  if (HIBYTE(v148))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else
                                  {
                                    uint64_t v64 = WORD2(v148);
                                    if (WORD1(v148) > WORD2(v148))
                                    {
                                      if (BYTE6(v148) == 2)
                                      {
                                        ++WORD2(v148);
                                        *(unsigned char *)(v147 + v64) = a6;
                                        if (HIBYTE(v148))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else
                                        {
                                          uint64_t v65 = WORD2(v148);
                                          if (WORD1(v148) > WORD2(v148))
                                          {
                                            if (BYTE6(v148) == 2)
                                            {
                                              ++WORD2(v148);
                                              *(unsigned char *)(v147 + v65) = a7;
                                              if (HIBYTE(v148))
                                              {
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }
                                              else
                                              {
                                                uint64_t v66 = WORD2(v148);
                                                if (WORD1(v148) > WORD2(v148))
                                                {
                                                  if (BYTE6(v148) == 2)
                                                  {
                                                    ++WORD2(v148);
                                                    *(unsigned char *)(v147 + v66) = a8;
                                                    if (HIBYTE(v148))
                                                    {
                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }
                                                    else
                                                    {
                                                      uint64_t v67 = WORD2(v148);
                                                      if (WORD1(v148) > WORD2(v148))
                                                      {
                                                        if (BYTE6(v148) == 2)
                                                        {
                                                          ++WORD2(v148);
                                                          *(unsigned char *)(v147 + v67) = a9;
                                                          if (HIBYTE(v148))
                                                          {
                                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }
                                                          else
                                                          {
                                                            uint64_t v68 = WORD2(v148);
                                                            if (WORD1(v148) > WORD2(v148))
                                                            {
                                                              if (BYTE6(v148) == 2)
                                                              {
                                                                ++WORD2(v148);
                                                                *(unsigned char *)(v147 + v68) = a10;
                                                                if (HIBYTE(v148))
                                                                {
                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/S"
                                                                                         "ources/MobileBluetooth_base/Sta"
                                                                                         "ck/vsc/bcm/bcm_vsc.c");
                                                                }
                                                                else
                                                                {
                                                                  uint64_t v69 = WORD2(v148);
                                                                  if (WORD1(v148) > WORD2(v148))
                                                                  {
                                                                    if (BYTE6(v148) == 2)
                                                                    {
                                                                      ++WORD2(v148);
                                                                      *(unsigned char *)(v147 + v69) = a11;
                                                                      if (HIBYTE(v148))
                                                                      {
                                                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple"
                                                                                               ".xbs/Sources/MobileBlueto"
                                                                                               "oth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                      }
                                                                      else
                                                                      {
                                                                        uint64_t v70 = WORD2(v148);
                                                                        if (WORD1(v148) > WORD2(v148))
                                                                        {
                                                                          if (BYTE6(v148) == 2)
                                                                          {
                                                                            ++WORD2(v148);
                                                                            *(unsigned char *)(v147 + v70) = a12;
                                                                            if (HIBYTE(v148))
                                                                            {
                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                            }
                                                                            else
                                                                            {
                                                                              uint64_t v71 = WORD2(v148);
                                                                              if (WORD1(v148) > WORD2(v148))
                                                                              {
                                                                                if (BYTE6(v148) == 2)
                                                                                {
                                                                                  ++WORD2(v148);
                                                                                  *(unsigned char *)(v147 + v71) = a13;
                                                                                  if (HIBYTE(v148))
                                                                                  {
                                                                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                  }
                                                                                  else
                                                                                  {
                                                                                    uint64_t v72 = WORD2(v148);
                                                                                    if (WORD1(v148) > WORD2(v148))
                                                                                    {
                                                                                      if (BYTE6(v148) == 2)
                                                                                      {
                                                                                        ++WORD2(v148);
                                                                                        *(unsigned char *)(v147 + v72) = a14;
                                                                                        if (HIBYTE(v148))
                                                                                        {
                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                          uint64_t v73 = WORD2(v148);
                                                                                          if (WORD1(v148) > WORD2(v148))
                                                                                          {
                                                                                            if (BYTE6(v148) == 2)
                                                                                            {
                                                                                              ++WORD2(v148);
                                                                                              *(unsigned char *)(v147 + v73) = a15;
                                                                                              if (HIBYTE(v148))
                                                                                              {
                                                                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                              }
                                                                                              else
                                                                                              {
                                                                                                uint64_t v74 = WORD2(v148);
                                                                                                if (WORD1(v148) > WORD2(v148))
                                                                                                {
                                                                                                  if (BYTE6(v148) == 2)
                                                                                                  {
                                                                                                    ++WORD2(v148);
                                                                                                    *(unsigned char *)(v147 + v74) = a16;
                                                                                                    if (HIBYTE(v148))
                                                                                                    {
                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                    }
                                                                                                    else if (WORD1(v148) - WORD2(v148) > 3)
                                                                                                    {
                                                                                                      if (BYTE6(v148) == 2)
                                                                                                      {
                                                                                                        *(_DWORD *)(v147 + WORD2(v148)) = a17;
                                                                                                        unsigned __int16 v75 = WORD2(v148) + 4;
                                                                                                        WORD2(v148) += 4;
                                                                                                        if (HIBYTE(v148))
                                                                                                        {
                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                        }
                                                                                                        else if (WORD1(v148) - v75 > 3)
                                                                                                        {
                                                                                                          if (BYTE6(v148) == 2)
                                                                                                          {
                                                                                                            *(unsigned char *)(v147 + v75) = a18;
                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a18 + 1);
                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a18);
                                                                                                            unsigned __int16 v76 = WORD2(v148) + 4;
                                                                                                            WORD2(v148) += 4;
                                                                                                            if (HIBYTE(v148))
                                                                                                            {
                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                            }
                                                                                                            else if (WORD1(v148) - v76 > 3)
                                                                                                            {
                                                                                                              if (BYTE6(v148) == 2)
                                                                                                              {
                                                                                                                *(unsigned char *)(v147 + v76) = a19;
                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a19 + 1);
                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a19);
                                                                                                                unsigned __int16 v77 = WORD2(v148) + 4;
                                                                                                                WORD2(v148) += 4;
                                                                                                                if (HIBYTE(v148))
                                                                                                                {
                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                }
                                                                                                                else if (WORD1(v148) - v77 > 3)
                                                                                                                {
                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                  {
                                                                                                                    *(unsigned char *)(v147 + v77) = a20;
                                                                                                                    *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a20 + 1);
                                                                                                                    *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a20);
                                                                                                                    unsigned __int16 v78 = WORD2(v148) + 4;
                                                                                                                    WORD2(v148) += 4;
                                                                                                                    if (HIBYTE(v148))
                                                                                                                    {
                                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                    }
                                                                                                                    else if (WORD1(v148) - v78 > 3)
                                                                                                                    {
                                                                                                                      if (BYTE6(v148) == 2)
                                                                                                                      {
                                                                                                                        *(unsigned char *)(v147 + v78) = a21;
                                                                                                                        *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a21 + 1);
                                                                                                                        *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a21);
                                                                                                                        unsigned __int16 v79 = WORD2(v148) + 4;
                                                                                                                        WORD2(v148) += 4;
                                                                                                                        if (HIBYTE(v148))
                                                                                                                        {
                                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                        }
                                                                                                                        else if (WORD1(v148) - v79 > 3)
                                                                                                                        {
                                                                                                                          if (BYTE6(v148) == 2)
                                                                                                                          {
                                                                                                                            *(unsigned char *)(v147 + v79) = a22;
                                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a22 + 1);
                                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a22);
                                                                                                                            unsigned __int16 v80 = WORD2(v148) + 4;
                                                                                                                            WORD2(v148) += 4;
                                                                                                                            if (HIBYTE(v148))
                                                                                                                            {
                                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                            }
                                                                                                                            else if (WORD1(v148) - v80 > 3)
                                                                                                                            {
                                                                                                                              if (BYTE6(v148) == 2)
                                                                                                                              {
                                                                                                                                *(unsigned char *)(v147 + v80) = a23;
                                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a23 + 1);
                                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a23);
                                                                                                                                unsigned __int16 v81 = WORD2(v148) + 4;
                                                                                                                                WORD2(v148) += 4;
                                                                                                                                if (HIBYTE(v148))
                                                                                                                                {
                                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                }
                                                                                                                                else if (WORD1(v148) - v81 > 3)
                                                                                                                                {
                                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                                  {
                                                                                                                                    *(unsigned char *)(v147 + v81) = a24;
                                                                                                                                    *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a24 + 1);
                                                                                                                                    *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a24);
                                                                                                                                    unsigned __int16 v82 = WORD2(v148) + 4;
                                                                                                                                    WORD2(v148) += 4;
                                                                                                                                    if (HIBYTE(v148))
                                                                                                                                    {
                                                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                    }
                                                                                                                                    else if (WORD1(v148) - v82 > 3)
                                                                                                                                    {
                                                                                                                                      if (BYTE6(v148) == 2)
                                                                                                                                      {
                                                                                                                                        *(unsigned char *)(v147 + v82) = a25;
                                                                                                                                        *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a25 + 1);
                                                                                                                                        *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a25);
                                                                                                                                        unsigned __int16 v83 = WORD2(v148) + 4;
                                                                                                                                        WORD2(v148) += 4;
                                                                                                                                        if (HIBYTE(v148))
                                                                                                                                        {
                                                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                        }
                                                                                                                                        else if (WORD1(v148) - v83 > 3)
                                                                                                                                        {
                                                                                                                                          if (BYTE6(v148) == 2)
                                                                                                                                          {
                                                                                                                                            *(unsigned char *)(v147 + v83) = a26;
                                                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a26 + 1);
                                                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a26);
                                                                                                                                            unsigned __int16 v84 = WORD2(v148) + 4;
                                                                                                                                            WORD2(v148) += 4;
                                                                                                                                            if (HIBYTE(v148))
                                                                                                                                            {
                                                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                            }
                                                                                                                                            else if (WORD1(v148) - v84 > 3)
                                                                                                                                            {
                                                                                                                                              if (BYTE6(v148) == 2)
                                                                                                                                              {
                                                                                                                                                *(unsigned char *)(v147 + v84) = a27;
                                                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a27 + 1);
                                                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a27);
                                                                                                                                                unsigned __int16 v85 = WORD2(v148) + 4;
                                                                                                                                                WORD2(v148) += 4;
                                                                                                                                                if (HIBYTE(v148))
                                                                                                                                                {
                                                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                }
                                                                                                                                                else if (WORD1(v148) - v85 > 3)
                                                                                                                                                {
                                                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                                                  {
                                                                                                                                                    *(unsigned char *)(v147 + v85) = a28;
                                                                                                                                                    *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a28 + 1);
                                                                                                                                                    *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a28);
                                                                                                                                                    unsigned __int16 v86 = WORD2(v148) + 4;
                                                                                                                                                    WORD2(v148) += 4;
                                                                                                                                                    if (HIBYTE(v148))
                                                                                                                                                    {
                                                                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                    }
                                                                                                                                                    else if (WORD1(v148) - v86 > 3)
                                                                                                                                                    {
                                                                                                                                                      if (BYTE6(v148) == 2)
                                                                                                                                                      {
                                                                                                                                                        *(unsigned char *)(v147 + v86) = a29;
                                                                                                                                                        *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a29 + 1);
                                                                                                                                                        *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a29);
                                                                                                                                                        unsigned __int16 v87 = WORD2(v148) + 4;
                                                                                                                                                        WORD2(v148) += 4;
                                                                                                                                                        if (HIBYTE(v148))
                                                                                                                                                        {
                                                                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                        }
                                                                                                                                                        else if (WORD1(v148) - v87 > 3)
                                                                                                                                                        {
                                                                                                                                                          if (BYTE6(v148) == 2)
                                                                                                                                                          {
                                                                                                                                                            *(unsigned char *)(v147 + v87) = a30;
                                                                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a30 + 1);
                                                                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a30);
                                                                                                                                                            unsigned __int16 v88 = WORD2(v148) + 4;
                                                                                                                                                            WORD2(v148) += 4;
                                                                                                                                                            if (HIBYTE(v148))
                                                                                                                                                            {
                                                                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                            }
                                                                                                                                                            else if (WORD1(v148) - v88 > 3)
                                                                                                                                                            {
                                                                                                                                                              if (BYTE6(v148) == 2)
                                                                                                                                                              {
                                                                                                                                                                *(unsigned char *)(v147 + v88) = a31;
                                                                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a31 + 1);
                                                                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a31);
                                                                                                                                                                unsigned __int16 v89 = WORD2(v148) + 4;
                                                                                                                                                                WORD2(v148) += 4;
                                                                                                                                                                if (HIBYTE(v148))
                                                                                                                                                                {
                                                                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                }
                                                                                                                                                                else if (WORD1(v148) - v89 > 3)
                                                                                                                                                                {
                                                                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                                                                  {
                                                                                                                                                                    *(unsigned char *)(v147 + v89) = a32;
                                                                                                                                                                    *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a32 + 1);
                                                                                                                                                                    *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a32);
                                                                                                                                                                    unsigned __int16 v90 = WORD2(v148) + 4;
                                                                                                                                                                    WORD2(v148) += 4;
                                                                                                                                                                    if (HIBYTE(v148))
                                                                                                                                                                    {
                                                                                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                    }
                                                                                                                                                                    else if (WORD1(v148) - v90 > 3)
                                                                                                                                                                    {
                                                                                                                                                                      if (BYTE6(v148) == 2)
                                                                                                                                                                      {
                                                                                                                                                                        *(unsigned char *)(v147 + v90) = a33;
                                                                                                                                                                        *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a33 + 1);
                                                                                                                                                                        *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a33);
                                                                                                                                                                        unsigned __int16 v91 = WORD2(v148) + 4;
                                                                                                                                                                        WORD2(v148) += 4;
                                                                                                                                                                        if (HIBYTE(v148))
                                                                                                                                                                        {
                                                                                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                        }
                                                                                                                                                                        else if (WORD1(v148) - v91 > 3)
                                                                                                                                                                        {
                                                                                                                                                                          if (BYTE6(v148) == 2)
                                                                                                                                                                          {
                                                                                                                                                                            *(unsigned char *)(v147 + v91) = a34;
                                                                                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a34 + 1);
                                                                                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a34);
                                                                                                                                                                            unsigned __int16 v92 = WORD2(v148) + 4;
                                                                                                                                                                            WORD2(v148) += 4;
                                                                                                                                                                            if (HIBYTE(v148))
                                                                                                                                                                            {
                                                                                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                            }
                                                                                                                                                                            else if (WORD1(v148) - v92 > 3)
                                                                                                                                                                            {
                                                                                                                                                                              if (BYTE6(v148) == 2)
                                                                                                                                                                              {
                                                                                                                                                                                *(unsigned char *)(v147 + v92) = a35;
                                                                                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a35 + 1);
                                                                                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a35);
                                                                                                                                                                                unsigned __int16 v93 = WORD2(v148) + 4;
                                                                                                                                                                                WORD2(v148) += 4;
                                                                                                                                                                                if (HIBYTE(v148))
                                                                                                                                                                                {
                                                                                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                }
                                                                                                                                                                                else if (WORD1(v148) - v93 > 3)
                                                                                                                                                                                {
                                                                                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                                                                                  {
                                                                                                                                                                                    *(unsigned char *)(v147 + v93) = a36;
                                                                                                                                                                                    *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a36 + 1);
                                                                                                                                                                                    *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a36);
                                                                                                                                                                                    unsigned __int16 v94 = WORD2(v148) + 4;
                                                                                                                                                                                    WORD2(v148) += 4;
                                                                                                                                                                                    if (HIBYTE(v148))
                                                                                                                                                                                    {
                                                                                                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                    }
                                                                                                                                                                                    else if (WORD1(v148) - v94 > 3)
                                                                                                                                                                                    {
                                                                                                                                                                                      if (BYTE6(v148) == 2)
                                                                                                                                                                                      {
                                                                                                                                                                                        *(unsigned char *)(v147 + v94) = a37;
                                                                                                                                                                                        *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a37 + 1);
                                                                                                                                                                                        *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a37);
                                                                                                                                                                                        unsigned __int16 v95 = WORD2(v148) + 4;
                                                                                                                                                                                        WORD2(v148) += 4;
                                                                                                                                                                                        if (HIBYTE(v148))
                                                                                                                                                                                        {
                                                                                                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                        }
                                                                                                                                                                                        else if (WORD1(v148) - v95 > 3)
                                                                                                                                                                                        {
                                                                                                                                                                                          if (BYTE6(v148) == 2)
                                                                                                                                                                                          {
                                                                                                                                                                                            *(unsigned char *)(v147 + v95) = a38;
                                                                                                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a38 + 1);
                                                                                                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a38);
                                                                                                                                                                                            unsigned __int16 v96 = WORD2(v148) + 4;
                                                                                                                                                                                            WORD2(v148) += 4;
                                                                                                                                                                                            if (HIBYTE(v148))
                                                                                                                                                                                            {
                                                                                                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                            }
                                                                                                                                                                                            else if (WORD1(v148) - v96 > 3)
                                                                                                                                                                                            {
                                                                                                                                                                                              if (BYTE6(v148) == 2)
                                                                                                                                                                                              {
                                                                                                                                                                                                *(unsigned char *)(v147 + v96) = a39;
                                                                                                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a39 + 1);
                                                                                                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a39);
                                                                                                                                                                                                unsigned __int16 v97 = WORD2(v148) + 4;
                                                                                                                                                                                                WORD2(v148) += 4;
                                                                                                                                                                                                if (HIBYTE(v148))
                                                                                                                                                                                                {
                                                                                                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                                }
                                                                                                                                                                                                else if (WORD1(v148) - v97 > 3)
                                                                                                                                                                                                {
                                                                                                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                                                                                                  {
                                                                                                                                                                                                    *(unsigned char *)(v147 + v97) = a40;
                                                                                                                                                                                                    *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a40 + 1);
                                                                                                                                                                                                    *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a40);
                                                                                                                                                                                                    unsigned __int16 v98 = WORD2(v148) + 4;
                                                                                                                                                                                                    WORD2(v148) += 4;
                                                                                                                                                                                                    if (HIBYTE(v148))
                                                                                                                                                                                                    {
                                                                                                                                                                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                                    }
                                                                                                                                                                                                    else if (WORD1(v148) - v98 > 3)
                                                                                                                                                                                                    {
                                                                                                                                                                                                      if (BYTE6(v148) == 2)
                                                                                                                                                                                                      {
                                                                                                                                                                                                        *(unsigned char *)(v147 + v98) = a41;
                                                                                                                                                                                                        *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a41 + 1);
                                                                                                                                                                                                        *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a41);
                                                                                                                                                                                                        unsigned __int16 v99 = WORD2(v148) + 4;
                                                                                                                                                                                                        WORD2(v148) += 4;
                                                                                                                                                                                                        if (HIBYTE(v148))
                                                                                                                                                                                                        {
                                                                                                                                                                                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                                        }
                                                                                                                                                                                                        else if (WORD1(v148) - v99 > 3)
                                                                                                                                                                                                        {
                                                                                                                                                                                                          if (BYTE6(v148) == 2)
                                                                                                                                                                                                          {
                                                                                                                                                                                                            *(unsigned char *)(v147 + v99) = a42;
                                                                                                                                                                                                            *(_WORD *)(v147 + WORD2(v148) + 1) = *(_WORD *)((char *)&a42 + 1);
                                                                                                                                                                                                            *(unsigned char *)(v147 + WORD2(v148) + 3) = HIBYTE(a42);
                                                                                                                                                                                                            unsigned __int16 v100 = WORD2(v148) + 4;
                                                                                                                                                                                                            WORD2(v148) += 4;
                                                                                                                                                                                                            if (HIBYTE(v148))
                                                                                                                                                                                                            {
                                                                                                                                                                                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                                            }
                                                                                                                                                                                                            else if (WORD1(v148) - v100 > 3)
                                                                                                                                                                                                            {
                                                                                                                                                                                                              if (BYTE6(v148) == 2)
                                                                                                                                                                                                              {
                                                                                                                                                                                                                *(unsigned char *)(v147 + v100) = a43;
                                                                                                                                                                                                                *(unsigned char *)(v147 + WORD2(v148) + 1) = a44;
                                                                                                                                                                                                                *(_WORD *)(v147 + WORD2(v148) + 2) = a45;
                                                                                                                                                                                                                __int16 v101 = WORD2(v148);
                                                                                                                                                                                                                unsigned __int16 v102 = WORD2(v148) + 4;
                                                                                                                                                                                                                WORD2(v148) += 4;
                                                                                                                                                                                                                if (HIBYTE(v148))
                                                                                                                                                                                                                {
                                                                                                                                                                                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                                                                                                                                                }
                                                                                                                                                                                                                else if (WORD1(v148) > v102)
                                                                                                                                                                                                                {
                                                                                                                                                                                                                  if (BYTE6(v148) == 2)
                                                                                                                                                                                                                  {
                                                                                                                                                                                                                    WORD2(v148) = v101 + 5;
                                                                                                                                                                                                                    *(unsigned char *)(v147 + v102) = a46;
                                                                                                                                                                                                                    return sub_10001BCBC(641, v147, BYTE4(v148), a47, (uint64_t)sub_1000260B4, v56, v57, v58);
                                                                                                                                                                                                                  }
                                                                                                                                                                                                                  uint64_t v146 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_311:
                                                                                                                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4818, v146);
                                                                                                                                                                                                                }
                                                                                                                                                                                                                uint64_t v146 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                                                                                                                                                goto LABEL_311;
                                                                                                                                                                                                              }
                                                                                                                                                                                                              uint64_t v145 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_307:
                                                                                                                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4816, v145);
                                                                                                                                                                                                            }
                                                                                                                                                                                                            uint64_t v145 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                                            goto LABEL_307;
                                                                                                                                                                                                          }
                                                                                                                                                                                                          uint64_t v144 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_303:
                                                                                                                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4814, v144);
                                                                                                                                                                                                        }
                                                                                                                                                                                                        uint64_t v144 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                                        goto LABEL_303;
                                                                                                                                                                                                      }
                                                                                                                                                                                                      uint64_t v143 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_299:
                                                                                                                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4813, v143);
                                                                                                                                                                                                    }
                                                                                                                                                                                                    uint64_t v143 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                                    goto LABEL_299;
                                                                                                                                                                                                  }
                                                                                                                                                                                                  uint64_t v142 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_295:
                                                                                                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4812, v142);
                                                                                                                                                                                                }
                                                                                                                                                                                                uint64_t v142 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                                goto LABEL_295;
                                                                                                                                                                                              }
                                                                                                                                                                                              uint64_t v141 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_291:
                                                                                                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4811, v141);
                                                                                                                                                                                            }
                                                                                                                                                                                            uint64_t v141 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                            goto LABEL_291;
                                                                                                                                                                                          }
                                                                                                                                                                                          uint64_t v140 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_287:
                                                                                                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4809, v140);
                                                                                                                                                                                        }
                                                                                                                                                                                        uint64_t v140 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                        goto LABEL_287;
                                                                                                                                                                                      }
                                                                                                                                                                                      uint64_t v139 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_283:
                                                                                                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4807, v139);
                                                                                                                                                                                    }
                                                                                                                                                                                    uint64_t v139 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                    goto LABEL_283;
                                                                                                                                                                                  }
                                                                                                                                                                                  uint64_t v138 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_279:
                                                                                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4806, v138);
                                                                                                                                                                                }
                                                                                                                                                                                uint64_t v138 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                                goto LABEL_279;
                                                                                                                                                                              }
                                                                                                                                                                              BOOL v137 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_275:
                                                                                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4805, v137);
                                                                                                                                                                            }
                                                                                                                                                                            BOOL v137 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                            goto LABEL_275;
                                                                                                                                                                          }
                                                                                                                                                                          char v136 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_271:
                                                                                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4804, v136);
                                                                                                                                                                        }
                                                                                                                                                                        char v136 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                        goto LABEL_271;
                                                                                                                                                                      }
                                                                                                                                                                      uint64_t v135 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_267:
                                                                                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4802, v135);
                                                                                                                                                                    }
                                                                                                                                                                    uint64_t v135 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                    goto LABEL_267;
                                                                                                                                                                  }
                                                                                                                                                                  uint64_t v134 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_263:
                                                                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4801, v134);
                                                                                                                                                                }
                                                                                                                                                                uint64_t v134 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                                goto LABEL_263;
                                                                                                                                                              }
                                                                                                                                                              uint64_t v133 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_259:
                                                                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4800, v133);
                                                                                                                                                            }
                                                                                                                                                            uint64_t v133 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                            goto LABEL_259;
                                                                                                                                                          }
                                                                                                                                                          uint64_t v132 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_255:
                                                                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4799, v132);
                                                                                                                                                        }
                                                                                                                                                        uint64_t v132 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                        goto LABEL_255;
                                                                                                                                                      }
                                                                                                                                                      uint64_t v131 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_251:
                                                                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4797, v131);
                                                                                                                                                    }
                                                                                                                                                    uint64_t v131 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                    goto LABEL_251;
                                                                                                                                                  }
                                                                                                                                                  uint64_t v130 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_247:
                                                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4796, v130);
                                                                                                                                                }
                                                                                                                                                uint64_t v130 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                                goto LABEL_247;
                                                                                                                                              }
                                                                                                                                              uint64_t v129 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_243:
                                                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4795, v129);
                                                                                                                                            }
                                                                                                                                            uint64_t v129 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                            goto LABEL_243;
                                                                                                                                          }
                                                                                                                                          uint64_t v128 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_239:
                                                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4794, v128);
                                                                                                                                        }
                                                                                                                                        uint64_t v128 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                        goto LABEL_239;
                                                                                                                                      }
                                                                                                                                      uint64_t v127 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_235:
                                                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4792, v127);
                                                                                                                                    }
                                                                                                                                    uint64_t v127 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                    goto LABEL_235;
                                                                                                                                  }
                                                                                                                                  uint64_t v126 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_231:
                                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4790, v126);
                                                                                                                                }
                                                                                                                                uint64_t v126 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                                goto LABEL_231;
                                                                                                                              }
                                                                                                                              uint64_t v125 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_227:
                                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4789, v125);
                                                                                                                            }
                                                                                                                            uint64_t v125 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                            goto LABEL_227;
                                                                                                                          }
                                                                                                                          uint64_t v124 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_223:
                                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4788, v124);
                                                                                                                        }
                                                                                                                        uint64_t v124 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                        goto LABEL_223;
                                                                                                                      }
                                                                                                                      uint64_t v123 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_219:
                                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4787, v123);
                                                                                                                    }
                                                                                                                    uint64_t v123 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                    goto LABEL_219;
                                                                                                                  }
                                                                                                                  uint64_t v122 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_215:
                                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4785, v122);
                                                                                                                }
                                                                                                                uint64_t v122 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                                goto LABEL_215;
                                                                                                              }
                                                                                                              uint64_t v121 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_211:
                                                                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4784, v121);
                                                                                                            }
                                                                                                            uint64_t v121 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                            goto LABEL_211;
                                                                                                          }
                                                                                                          uint64_t v120 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_207:
                                                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4783, v120);
                                                                                                        }
                                                                                                        uint64_t v120 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                        goto LABEL_207;
                                                                                                      }
                                                                                                      uint64_t v119 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_203:
                                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4782, v119);
                                                                                                    }
                                                                                                    uint64_t v119 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                                    goto LABEL_203;
                                                                                                  }
                                                                                                  uint64_t v118 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_199:
                                                                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4781, v118);
                                                                                                }
                                                                                              }
                                                                                              uint64_t v118 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                              goto LABEL_199;
                                                                                            }
                                                                                            int v117 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_195:
                                                                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4780, v117);
                                                                                          }
                                                                                        }
                                                                                        int v117 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                        goto LABEL_195;
                                                                                      }
                                                                                      uint64_t v116 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_191:
                                                                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4779, v116);
                                                                                    }
                                                                                  }
                                                                                  uint64_t v116 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                  goto LABEL_191;
                                                                                }
                                                                                uint64_t v115 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_187:
                                                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4778, v115);
                                                                              }
                                                                            }
                                                                            uint64_t v115 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                            goto LABEL_187;
                                                                          }
                                                                          uint64_t v114 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_183:
                                                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4777, v114);
                                                                        }
                                                                      }
                                                                      uint64_t v114 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                      goto LABEL_183;
                                                                    }
                                                                    uint64_t v113 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_179:
                                                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4776, v113);
                                                                  }
                                                                }
                                                                uint64_t v113 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                goto LABEL_179;
                                                              }
                                                              uint64_t v112 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_175:
                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4775, v112);
                                                            }
                                                          }
                                                          uint64_t v112 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                          goto LABEL_175;
                                                        }
                                                        uint64_t v111 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_171:
                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4774, v111);
                                                      }
                                                    }
                                                    uint64_t v111 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_171;
                                                  }
                                                  uint64_t v110 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_167:
                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4773, v110);
                                                }
                                              }
                                              uint64_t v110 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_167;
                                            }
                                            uint64_t v109 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_163:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4772, v109);
                                          }
                                        }
                                        uint64_t v109 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_163;
                                      }
                                      unsigned int v108 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_159:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4771, v108);
                                    }
                                  }
                                  unsigned int v108 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                  goto LABEL_159;
                                }
                                uint64_t v107 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_155:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4770, v107);
                              }
                            }
                            uint64_t v107 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_155;
                          }
                          unint64_t v106 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_151:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4769, v106);
                        }
                      }
                      unint64_t v106 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_151;
                    }
                    unint64_t v105 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_147:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4768, v105);
                  }
                }
                unint64_t v105 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_147;
              }
              unint64_t v104 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_143:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4767, v104);
            }
          }
          unint64_t v104 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_143;
        }
        unint64_t v103 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_139:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4766, v103);
      }
    }
    unint64_t v103 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_139;
  }
  return result;
}

uint64_t sub_1001AFEC0(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(643, v10, BYTE4(v11), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4836, v9);
      }
    }
    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001AFF98(char a1, char a2, int a3, int a4, int a5, int a6, int a7, int a8, char a9, char a10, __int16 a11, char a12, uint64_t a13)
{
  uint64_t v47 = 0;
  uint64_t v48 = 0;
  uint64_t result = sub_100059D70(&v47);
  if (!result)
  {
    if (HIBYTE(v48))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v25 = WORD2(v48);
      if (WORD1(v48) > WORD2(v48))
      {
        if (BYTE6(v48) == 2)
        {
          ++WORD2(v48);
          *(unsigned char *)(v47 + v25) = 0;
          if (HIBYTE(v48))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v26 = WORD2(v48);
            if (WORD1(v48) > WORD2(v48))
            {
              if (BYTE6(v48) == 2)
              {
                ++WORD2(v48);
                *(unsigned char *)(v47 + v26) = a1;
                if (HIBYTE(v48))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v27 = WORD2(v48);
                  if (WORD1(v48) > WORD2(v48))
                  {
                    if (BYTE6(v48) == 2)
                    {
                      ++WORD2(v48);
                      *(unsigned char *)(v47 + v27) = a2;
                      if (HIBYTE(v48))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else if (WORD1(v48) - WORD2(v48) > 3)
                      {
                        if (BYTE6(v48) == 2)
                        {
                          *(_WORD *)(v47 + WORD2(v48)) = a3;
                          *(unsigned char *)(v47 + WORD2(v48) + 2) = BYTE2(a3);
                          *(unsigned char *)(v47 + WORD2(v48) + 3) = HIBYTE(a3);
                          unsigned __int16 v28 = WORD2(v48) + 4;
                          WORD2(v48) += 4;
                          if (HIBYTE(v48))
                          {
                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }
                          else if (WORD1(v48) - v28 > 3)
                          {
                            if (BYTE6(v48) == 2)
                            {
                              *(unsigned char *)(v47 + v28) = a4;
                              *(unsigned char *)(v47 + WORD2(v48) + 1) = BYTE1(a4);
                              *(unsigned char *)(v47 + WORD2(v48) + 2) = BYTE2(a4);
                              *(unsigned char *)(v47 + WORD2(v48) + 3) = HIBYTE(a4);
                              unsigned __int16 v29 = WORD2(v48) + 4;
                              WORD2(v48) += 4;
                              if (HIBYTE(v48))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }
                              else if (WORD1(v48) - v29 > 3)
                              {
                                if (BYTE6(v48) == 2)
                                {
                                  *(unsigned char *)(v47 + v29) = a5;
                                  *(unsigned char *)(v47 + WORD2(v48) + 1) = BYTE1(a5);
                                  *(unsigned char *)(v47 + WORD2(v48) + 2) = BYTE2(a5);
                                  *(unsigned char *)(v47 + WORD2(v48) + 3) = HIBYTE(a5);
                                  unsigned __int16 v30 = WORD2(v48) + 4;
                                  WORD2(v48) += 4;
                                  if (HIBYTE(v48))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else if (WORD1(v48) - v30 > 3)
                                  {
                                    if (BYTE6(v48) == 2)
                                    {
                                      *(unsigned char *)(v47 + v30) = a6;
                                      *(unsigned char *)(v47 + WORD2(v48) + 1) = BYTE1(a6);
                                      *(unsigned char *)(v47 + WORD2(v48) + 2) = BYTE2(a6);
                                      *(unsigned char *)(v47 + WORD2(v48) + 3) = HIBYTE(a6);
                                      unsigned __int16 v31 = WORD2(v48) + 4;
                                      WORD2(v48) += 4;
                                      if (HIBYTE(v48))
                                      {
                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }
                                      else if (WORD1(v48) - v31 > 3)
                                      {
                                        if (BYTE6(v48) == 2)
                                        {
                                          *(unsigned char *)(v47 + v31) = a7;
                                          *(unsigned char *)(v47 + WORD2(v48) + 1) = BYTE1(a7);
                                          *(unsigned char *)(v47 + WORD2(v48) + 2) = BYTE2(a7);
                                          *(unsigned char *)(v47 + WORD2(v48) + 3) = HIBYTE(a7);
                                          unsigned __int16 v32 = WORD2(v48) + 4;
                                          WORD2(v48) += 4;
                                          if (HIBYTE(v48))
                                          {
                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }
                                          else if (WORD1(v48) - v32 > 3)
                                          {
                                            if (BYTE6(v48) == 2)
                                            {
                                              *(unsigned char *)(v47 + v32) = a8;
                                              *(unsigned char *)(v47 + WORD2(v48) + 1) = BYTE1(a8);
                                              *(unsigned char *)(v47 + WORD2(v48) + 2) = BYTE2(a8);
                                              *(unsigned char *)(v47 + WORD2(v48) + 3) = HIBYTE(a8);
                                              unsigned __int16 v33 = WORD2(v48) + 4;
                                              WORD2(v48) += 4;
                                              if (HIBYTE(v48))
                                              {
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }
                                              else if (WORD1(v48) - v33 > 3)
                                              {
                                                if (BYTE6(v48) == 2)
                                                {
                                                  *(unsigned char *)(v47 + v33) = a9;
                                                  *(unsigned char *)(v47 + WORD2(v48) + 1) = a10;
                                                  *(_WORD *)(v47 + WORD2(v48) + 2) = a11;
                                                  __int16 v34 = WORD2(v48);
                                                  unsigned __int16 v35 = WORD2(v48) + 4;
                                                  WORD2(v48) += 4;
                                                  if (HIBYTE(v48))
                                                  {
                                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileB"
                                                                           "luetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                  }
                                                  else if (WORD1(v48) > v35)
                                                  {
                                                    if (BYTE6(v48) == 2)
                                                    {
                                                      WORD2(v48) = v34 + 5;
                                                      *(unsigned char *)(v47 + v35) = a12;
                                                      return sub_10001BCBC(657, v47, BYTE4(v48), a13, (uint64_t)sub_1000260B4, v22, v23, v24);
                                                    }
                                                    int v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_80:
                                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4864, v46);
                                                  }
                                                  int v46 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                  goto LABEL_80;
                                                }
                                                unsigned int v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_76:
                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4863, v45);
                                              }
                                              unsigned int v45 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                              goto LABEL_76;
                                            }
                                            uint64_t v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_72:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4862, v44);
                                          }
                                          uint64_t v44 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                          goto LABEL_72;
                                        }
                                        uint64_t v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_68:
                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4861, v43);
                                      }
                                      uint64_t v43 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                      goto LABEL_68;
                                    }
                                    int v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_64:
                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4860, v42);
                                  }
                                  int v42 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                  goto LABEL_64;
                                }
                                uint64_t v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_60:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4859, v41);
                              }
                              uint64_t v41 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                              goto LABEL_60;
                            }
                            uint64_t v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4858, v40);
                          }
                          uint64_t v40 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                          goto LABEL_56;
                        }
                        uint64_t v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4857, v39);
                      }
                      uint64_t v39 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                      goto LABEL_52;
                    }
                    uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4856, v38);
                  }
                }
                uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_48;
              }
              unsigned int v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4855, v37);
            }
          }
          unsigned int v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_44;
        }
        unsigned int v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4854, v36);
      }
    }
    unsigned int v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_40;
  }
  return result;
}

uint64_t sub_1001B0734(char a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v10 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(unsigned char *)(v16 + v10) = 1;
          if (HIBYTE(v17))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v11 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                ++WORD2(v17);
                *(unsigned char *)(v16 + v11) = a1;
                if (HIBYTE(v17))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v12 = WORD2(v17);
                  if (WORD1(v17) > WORD2(v17))
                  {
                    if (BYTE6(v17) == 2)
                    {
                      ++WORD2(v17);
                      *(unsigned char *)(v16 + v12) = a2;
                      return sub_10001BCBC(657, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                    }
                    uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4880, v15);
                  }
                }
                uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_24;
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4879, v14);
            }
          }
          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }
        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4878, v13);
      }
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001B090C(int a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(unsigned char *)(v11 + v8) = 16;
          if (HIBYTE(v12))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v12) - WORD2(v12) > 3)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              *(unsigned char *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
              *(unsigned char *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
              WORD2(v12) += 4;
              return sub_10001BCBC(291, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
            }
            uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4895, v10);
          }
          uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_17;
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4894, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B0AA4(char *a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v13);
      if (WORD1(v13) > WORD2(v13))
      {
        if (BYTE6(v13) == 2)
        {
          char v6 = *a1;
          ++WORD2(v13);
          *(unsigned char *)(v12 + v5) = v6;
          if (HIBYTE(v13))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v13) - WORD2(v13) > 5)
          {
            if (BYTE6(v13) == 2)
            {
              sub_100008A18(v12 + WORD2(v13), (uint64_t)(a1 + 1), 6uLL);
              WORD2(v13) += 6;
              return sub_10001BCBC(328, v12, BYTE4(v13), a2, (uint64_t)sub_1001A6868, v7, v8, v9);
            }
            uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4909, v11);
          }
          uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_17;
        }
        uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4908, v10);
      }
    }
    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B0C0C(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(329, v10, BYTE4(v11), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4924, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001B0CE4(char a1, __int16 a2, __int16 a3, char a4, char a5, char a6, uint64_t a7)
{
  uint64_t v30 = 0;
  uint64_t v31 = 0;
  uint64_t result = sub_100059D70(&v30);
  if (!result)
  {
    if (HIBYTE(v31))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v18 = WORD2(v31);
      if (WORD1(v31) > WORD2(v31))
      {
        if (BYTE6(v31) == 2)
        {
          ++WORD2(v31);
          *(unsigned char *)(v30 + v18) = a1;
          if (HIBYTE(v31))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v31) - WORD2(v31) > 1)
          {
            if (BYTE6(v31) == 2)
            {
              *(_WORD *)(v30 + WORD2(v31)) = a2;
              unsigned __int16 v19 = WORD2(v31) + 2;
              WORD2(v31) += 2;
              if (HIBYTE(v31))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v31) - v19 > 1)
              {
                if (BYTE6(v31) == 2)
                {
                  *(unsigned char *)(v30 + v19) = a3;
                  *(unsigned char *)(v30 + WORD2(v31) + 1) = HIBYTE(a3);
                  __int16 v20 = WORD2(v31);
                  unsigned __int16 v21 = WORD2(v31) + 2;
                  WORD2(v31) += 2;
                  if (HIBYTE(v31))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else if (WORD1(v31) > v21)
                  {
                    if (BYTE6(v31) == 2)
                    {
                      WORD2(v31) = v20 + 3;
                      *(unsigned char *)(v30 + v21) = a4;
                      if (HIBYTE(v31))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v22 = WORD2(v31);
                        if (WORD1(v31) > WORD2(v31))
                        {
                          if (BYTE6(v31) == 2)
                          {
                            ++WORD2(v31);
                            *(unsigned char *)(v30 + v22) = a5;
                            if (HIBYTE(v31))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v23 = WORD2(v31);
                              if (WORD1(v31) > WORD2(v31))
                              {
                                if (BYTE6(v31) == 2)
                                {
                                  ++WORD2(v31);
                                  *(unsigned char *)(v30 + v23) = a6;
                                  return sub_10001BCBC(330, v30, BYTE4(v31), a7, (uint64_t)sub_1000260B4, v15, v16, v17);
                                }
                                unsigned __int16 v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4944, v29);
                              }
                            }
                            unsigned __int16 v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_45;
                          }
                          unsigned __int16 v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4943, v28);
                        }
                      }
                      unsigned __int16 v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_41;
                    }
                    uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4942, v27);
                  }
                  uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_37;
                }
                uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4941, v26);
              }
              uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_33;
            }
            uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4940, v25);
          }
          uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_29;
        }
        uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4939, v24);
      }
    }
    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001B1078(char a1, unsigned int a2, const void *a3, uint64_t a4)
{
  uint64_t v18 = 0;
  uint64_t v19 = 0;
  uint64_t result = sub_100059D70(&v18);
  if (!result)
  {
    if (HIBYTE(v19))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v9 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(unsigned char *)(v18 + v9) = a1;
          if (HIBYTE(v19))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v10 = WORD2(v19);
            if (WORD1(v19) > WORD2(v19))
            {
              if (BYTE6(v19) == 2)
              {
                if (a2 >= 0x1F) {
                  char v11 = 31;
                }
                else {
                  char v11 = a2;
                }
                ++WORD2(v19);
                *(unsigned char *)(v18 + v10) = v11;
                if (HIBYTE(v19))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v19) - WORD2(v19) > 30)
                {
                  if (BYTE6(v19) == 2)
                  {
                    memmove((void *)(v18 + WORD2(v19)), a3, 0x1FuLL);
                    WORD2(v19) += 31;
                    return sub_10001BCBC(331, v18, BYTE4(v19), a4, (uint64_t)sub_1000260B4, v12, v13, v14);
                  }
                  uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4961, v17);
                }
                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= (31)";
                goto LABEL_27;
              }
              uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4960, v16);
            }
          }
          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4959, v15);
      }
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001B1270(char a1, unsigned int a2, const void *a3, uint64_t a4)
{
  uint64_t v18 = 0;
  uint64_t v19 = 0;
  uint64_t result = sub_100059D70(&v18);
  if (!result)
  {
    if (HIBYTE(v19))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v9 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(unsigned char *)(v18 + v9) = a1;
          if (HIBYTE(v19))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v10 = WORD2(v19);
            if (WORD1(v19) > WORD2(v19))
            {
              if (BYTE6(v19) == 2)
              {
                if (a2 >= 0x1F) {
                  char v11 = 31;
                }
                else {
                  char v11 = a2;
                }
                ++WORD2(v19);
                *(unsigned char *)(v18 + v10) = v11;
                if (HIBYTE(v19))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v19) - WORD2(v19) > 30)
                {
                  if (BYTE6(v19) == 2)
                  {
                    memmove((void *)(v18 + WORD2(v19)), a3, 0x1FuLL);
                    WORD2(v19) += 31;
                    return sub_10001BCBC(332, v18, BYTE4(v19), a4, (uint64_t)sub_1000260B4, v12, v13, v14);
                  }
                  uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4978, v17);
                }
                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= (31)";
                goto LABEL_27;
              }
              uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4977, v16);
            }
          }
          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4976, v15);
      }
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001B1468(char a1, char a2, int a3, char a4, uint64_t a5)
{
  uint64_t v22 = 0;
  uint64_t v23 = 0;
  uint64_t result = sub_100059D70(&v22);
  if (!result)
  {
    if (HIBYTE(v23))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v14 = WORD2(v23);
      if (WORD1(v23) > WORD2(v23))
      {
        if (BYTE6(v23) == 2)
        {
          ++WORD2(v23);
          *(unsigned char *)(v22 + v14) = a1;
          if (HIBYTE(v23))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v15 = WORD2(v23);
            if (WORD1(v23) > WORD2(v23))
            {
              if (BYTE6(v23) == 2)
              {
                ++WORD2(v23);
                *(unsigned char *)(v22 + v15) = a2;
                if (HIBYTE(v23))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v23) - WORD2(v23) > 3)
                {
                  if (BYTE6(v23) == 2)
                  {
                    *(_WORD *)(v22 + WORD2(v23)) = a3;
                    *(unsigned char *)(v22 + WORD2(v23) + 2) = BYTE2(a3);
                    *(unsigned char *)(v22 + WORD2(v23) + 3) = HIBYTE(a3);
                    __int16 v16 = WORD2(v23);
                    unsigned __int16 v17 = WORD2(v23) + 4;
                    WORD2(v23) += 4;
                    if (HIBYTE(v23))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v23) > v17)
                    {
                      if (BYTE6(v23) == 2)
                      {
                        WORD2(v23) = v16 + 5;
                        *(unsigned char *)(v22 + v17) = a4;
                        return sub_10001BCBC(333, v22, BYTE4(v23), a5, (uint64_t)sub_1000260B4, v11, v12, v13);
                      }
                      unsigned __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4996, v21);
                    }
                    unsigned __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }
                  __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4995, v20);
                }
                __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                goto LABEL_27;
              }
              uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4994, v19);
            }
          }
          uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4993, v18);
      }
    }
    uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001B1708(char a1, char *a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v7 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(unsigned char *)(v16 + v7) = a1;
          if (HIBYTE(v17))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v8 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                char v9 = *a2;
                ++WORD2(v17);
                *(unsigned char *)(v16 + v8) = v9;
                if (HIBYTE(v17))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v17) - WORD2(v17) > 5)
                {
                  if (BYTE6(v17) == 2)
                  {
                    sub_100008A18(v16 + WORD2(v17), (uint64_t)(a2 + 1), 6uLL);
                    WORD2(v17) += 6;
                    return sub_10001BCBC(334, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v10, v11, v12);
                  }
                  uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5014, v15);
                }
                uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_24;
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5013, v14);
            }
          }
          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }
        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5012, v13);
      }
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001B18F4(void *a1, uint64_t a2)
{
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t result = sub_100059D70(&v9);
  if (!result)
  {
    if (HIBYTE(v10))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v10) - WORD2(v10) > 7)
    {
      if (BYTE6(v10) == 2)
      {
        *(void *)(v9 + WORD2(v10)) = *a1;
        WORD2(v10) += 8;
        return sub_10001BCBC(316, v9, BYTE4(v10), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
      }
      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5030, v8);
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= (8)";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001B19D8(char a1, __int16 a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v15) - WORD2(v15) > 1)
    {
      if (BYTE6(v15) == 2)
      {
        *(unsigned char *)(v14 + WORD2(v15) + 1) = a2;
        *(unsigned char *)(v14 + WORD2(v15)) = HIBYTE(a2);
        __int16 v10 = WORD2(v15);
        unsigned __int16 v11 = WORD2(v15) + 2;
        WORD2(v15) += 2;
        if (HIBYTE(v15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v15) > v11)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v10 + 3;
            *(unsigned char *)(v14 + v11) = a1;
            return sub_10001BCBC(327, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
          }
          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5046, v13);
        }
        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5045, v12);
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B1B50(__int16 a1, char a2, uint64_t a3, uint64_t a4)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v16) - WORD2(v16) > 1)
    {
      if (BYTE6(v16) == 2)
      {
        *(_WORD *)(v15 + WORD2(v16)) = a1;
        __int16 v11 = WORD2(v16);
        unsigned __int16 v12 = WORD2(v16) + 2;
        WORD2(v16) += 2;
        if (HIBYTE(v16))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v16) > v12)
        {
          if (BYTE6(v16) == 2)
          {
            WORD2(v16) = v11 + 3;
            *(unsigned char *)(v15 + v12) = a2;
            return sub_10001BCBC(87, v15, BYTE4(v16), a4, (uint64_t)sub_1000260B4, v8, v9, v10);
          }
          uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5062, v14);
        }
        uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5061, v13);
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B1CC8(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 28;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5181, v11);
        }
        __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5180, v10);
    }
    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B1E54(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(431, v10, BYTE4(v11), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5195, v9);
      }
    }
    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001B1F2C(__int16 a1, char a2, char a3, char *a4, unsigned int a5, uint64_t a6)
{
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  uint64_t result = sub_100059D70(&v26);
  if (result) {
    return result;
  }
  if (HIBYTE(v27))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_24;
  }
  if (WORD1(v27) - WORD2(v27) <= 1)
  {
LABEL_24:
    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_26;
  }
  if (BYTE6(v27) != 2)
  {
    uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5209, v23);
  }
  *(_WORD *)(v26 + WORD2(v27)) = a1;
  __int16 v16 = WORD2(v27);
  unsigned __int16 v17 = WORD2(v27) + 2;
  WORD2(v27) += 2;
  if (HIBYTE(v27))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_28;
  }
  if (WORD1(v27) <= v17)
  {
LABEL_28:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_30;
  }
  if (BYTE6(v27) != 2)
  {
    uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5210, v24);
  }
  WORD2(v27) = v16 + 3;
  *(unsigned char *)(v26 + v17) = a2;
  if (HIBYTE(v27))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_32;
  }
  uint64_t v18 = WORD2(v27);
  if (WORD1(v27) <= WORD2(v27))
  {
LABEL_32:
    uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }
  if (BYTE6(v27) != 2)
  {
    uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5211, v25);
  }
  ++WORD2(v27);
  *(unsigned char *)(v26 + v18) = a3;
  if (a5)
  {
    uint64_t v19 = a5;
    while (!HIBYTE(v27))
    {
      uint64_t v20 = WORD2(v27);
      if (WORD1(v27) <= WORD2(v27)) {
        goto LABEL_20;
      }
      if (BYTE6(v27) != 2)
      {
        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_22;
      }
      char v21 = *a4++;
      ++WORD2(v27);
      *(unsigned char *)(v26 + v20) = v21;
      if (!--v19) {
        return sub_10001BCBC(586, v26, BYTE4(v27), a6, (uint64_t)sub_1000260B4, v13, v14, v15);
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_20:
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_22:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5213, v22);
  }
  return sub_10001BCBC(586, v26, BYTE4(v27), a6, (uint64_t)sub_1000260B4, v13, v14, v15);
}

uint64_t sub_1001B21BC(char a1, __int16 a2, char a3, char a4, char a5, char a6, char a7, char a8, char a9, __int16 a10, char a11, char a12, char a13, char a14, char a15, int a16, int a17, char a18, char a19, __int16 a20,char a21,int a22,uint64_t a23)
{
  uint64_t v70 = 0;
  uint64_t v71 = 0;
  uint64_t result = sub_100059D70(&v70);
  if (!result)
  {
    if (HIBYTE(v71))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v35 = WORD2(v71);
      if (WORD1(v71) > WORD2(v71))
      {
        if (BYTE6(v71) == 2)
        {
          ++WORD2(v71);
          *(unsigned char *)(v70 + v35) = a1;
          if (HIBYTE(v71))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v71) - WORD2(v71) > 1)
          {
            if (BYTE6(v71) == 2)
            {
              *(_WORD *)(v70 + WORD2(v71)) = a2;
              __int16 v36 = WORD2(v71);
              unsigned __int16 v37 = WORD2(v71) + 2;
              WORD2(v71) += 2;
              if (HIBYTE(v71))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v71) > v37)
              {
                if (BYTE6(v71) == 2)
                {
                  WORD2(v71) = v36 + 3;
                  *(unsigned char *)(v70 + v37) = a3;
                  if (HIBYTE(v71))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v38 = WORD2(v71);
                    if (WORD1(v71) > WORD2(v71))
                    {
                      if (BYTE6(v71) == 2)
                      {
                        ++WORD2(v71);
                        *(unsigned char *)(v70 + v38) = a4;
                        if (HIBYTE(v71))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else
                        {
                          uint64_t v39 = WORD2(v71);
                          if (WORD1(v71) > WORD2(v71))
                          {
                            if (BYTE6(v71) == 2)
                            {
                              ++WORD2(v71);
                              *(unsigned char *)(v70 + v39) = a5;
                              if (HIBYTE(v71))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }
                              else
                              {
                                uint64_t v40 = WORD2(v71);
                                if (WORD1(v71) > WORD2(v71))
                                {
                                  if (BYTE6(v71) == 2)
                                  {
                                    ++WORD2(v71);
                                    *(unsigned char *)(v70 + v40) = a6;
                                    if (HIBYTE(v71))
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }
                                    else
                                    {
                                      uint64_t v41 = WORD2(v71);
                                      if (WORD1(v71) > WORD2(v71))
                                      {
                                        if (BYTE6(v71) == 2)
                                        {
                                          ++WORD2(v71);
                                          *(unsigned char *)(v70 + v41) = a7;
                                          if (HIBYTE(v71))
                                          {
                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                          }
                                          else
                                          {
                                            uint64_t v42 = WORD2(v71);
                                            if (WORD1(v71) > WORD2(v71))
                                            {
                                              if (BYTE6(v71) == 2)
                                              {
                                                ++WORD2(v71);
                                                *(unsigned char *)(v70 + v42) = a8;
                                                if (HIBYTE(v71))
                                                {
                                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBlu"
                                                                         "etooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                }
                                                else
                                                {
                                                  uint64_t v43 = WORD2(v71);
                                                  if (WORD1(v71) > WORD2(v71))
                                                  {
                                                    if (BYTE6(v71) == 2)
                                                    {
                                                      ++WORD2(v71);
                                                      *(unsigned char *)(v70 + v43) = a9;
                                                      if (HIBYTE(v71))
                                                      {
                                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mob"
                                                                               "ileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                      }
                                                      else if (WORD1(v71) - WORD2(v71) > 1)
                                                      {
                                                        if (BYTE6(v71) == 2)
                                                        {
                                                          *(_WORD *)(v70 + WORD2(v71)) = a10;
                                                          unsigned __int16 v44 = WORD2(v71) + 2;
                                                          WORD2(v71) += 2;
                                                          if (HIBYTE(v71))
                                                          {
                                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }
                                                          else if (WORD1(v71) - v44 > 1)
                                                          {
                                                            if (BYTE6(v71) == 2)
                                                            {
                                                              *(unsigned char *)(v70 + v44) = a11;
                                                              *(unsigned char *)(v70 + WORD2(v71) + 1) = a12;
                                                              unsigned __int16 v45 = WORD2(v71) + 2;
                                                              WORD2(v71) += 2;
                                                              if (HIBYTE(v71))
                                                              {
                                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sou"
                                                                                       "rces/MobileBluetooth_base/Stack/v"
                                                                                       "sc/bcm/bcm_vsc.c");
                                                              }
                                                              else if (WORD1(v71) - v45 > 1)
                                                              {
                                                                if (BYTE6(v71) == 2)
                                                                {
                                                                  *(unsigned char *)(v70 + v45) = a13;
                                                                  *(unsigned char *)(v70 + WORD2(v71) + 1) = a14;
                                                                  __int16 v46 = WORD2(v71);
                                                                  unsigned __int16 v47 = WORD2(v71) + 2;
                                                                  WORD2(v71) += 2;
                                                                  if (HIBYTE(v71))
                                                                  {
                                                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs"
                                                                                           "/Sources/MobileBluetooth_base"
                                                                                           "/Stack/vsc/bcm/bcm_vsc.c");
                                                                  }
                                                                  else if (WORD1(v71) > v47)
                                                                  {
                                                                    if (BYTE6(v71) == 2)
                                                                    {
                                                                      WORD2(v71) = v46 + 3;
                                                                      *(unsigned char *)(v70 + v47) = a15;
                                                                      if (HIBYTE(v71))
                                                                      {
                                                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple"
                                                                                               ".xbs/Sources/MobileBlueto"
                                                                                               "oth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                      }
                                                                      else if (WORD1(v71) - WORD2(v71) > 3)
                                                                      {
                                                                        if (BYTE6(v71) == 2)
                                                                        {
                                                                          *(_DWORD *)(v70 + WORD2(v71)) = a16;
                                                                          unsigned __int16 v48 = WORD2(v71) + 4;
                                                                          WORD2(v71) += 4;
                                                                          if (HIBYTE(v71))
                                                                          {
                                                                            sub_10025A794((uint64_t)"/Library/Caches/com.a"
                                                                                                   "pple.xbs/Sources/Mobi"
                                                                                                   "leBluetooth_base/Stac"
                                                                                                   "k/vsc/bcm/bcm_vsc.c");
                                                                          }
                                                                          else if (WORD1(v71) - v48 > 3)
                                                                          {
                                                                            if (BYTE6(v71) == 2)
                                                                            {
                                                                              *(unsigned char *)(v70 + v48) = a17;
                                                                              *(_WORD *)(v70 + WORD2(v71) + 1) = *(_WORD *)((char *)&a17 + 1);
                                                                              *(unsigned char *)(v70 + WORD2(v71) + 3) = HIBYTE(a17);
                                                                              unsigned __int16 v49 = WORD2(v71) + 4;
                                                                              WORD2(v71) += 4;
                                                                              if (HIBYTE(v71))
                                                                              {
                                                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                              }
                                                                              else if (WORD1(v71) - v49 > 3)
                                                                              {
                                                                                if (BYTE6(v71) == 2)
                                                                                {
                                                                                  *(unsigned char *)(v70 + v49) = a18;
                                                                                  *(unsigned char *)(v70 + WORD2(v71) + 1) = a19;
                                                                                  *(_WORD *)(v70 + WORD2(v71) + 2) = a20;
                                                                                  __int16 v50 = WORD2(v71);
                                                                                  unsigned __int16 v51 = WORD2(v71) + 4;
                                                                                  WORD2(v71) += 4;
                                                                                  if (HIBYTE(v71))
                                                                                  {
                                                                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                  }
                                                                                  else if (WORD1(v71) > v51)
                                                                                  {
                                                                                    if (BYTE6(v71) == 2)
                                                                                    {
                                                                                      WORD2(v71) = v50 + 5;
                                                                                      *(unsigned char *)(v70 + v51) = a21;
                                                                                      if (HIBYTE(v71))
                                                                                      {
                                                                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                                                      }
                                                                                      else if (WORD1(v71) - WORD2(v71) > 3)
                                                                                      {
                                                                                        if (BYTE6(v71) == 2)
                                                                                        {
                                                                                          *(_DWORD *)(v70 + WORD2(v71)) = a22;
                                                                                          WORD2(v71) += 4;
                                                                                          return sub_10001BCBC(616, v70, BYTE4(v71), a23, (uint64_t)sub_1000260B4, v32, v33, v34);
                                                                                        }
                                                                                        uint64_t v69 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_129:
                                                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5244, v69);
                                                                                      }
                                                                                      uint64_t v69 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                                      goto LABEL_129;
                                                                                    }
                                                                                    uint64_t v68 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_125:
                                                                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5243, v68);
                                                                                  }
                                                                                  uint64_t v68 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                                  goto LABEL_125;
                                                                                }
                                                                                uint64_t v67 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_121:
                                                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5242, v67);
                                                                              }
                                                                              uint64_t v67 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                              goto LABEL_121;
                                                                            }
                                                                            uint64_t v66 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_117:
                                                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5241, v66);
                                                                          }
                                                                          uint64_t v66 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                          goto LABEL_117;
                                                                        }
                                                                        uint64_t v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_113:
                                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5240, v65);
                                                                      }
                                                                      uint64_t v65 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                                                                      goto LABEL_113;
                                                                    }
                                                                    uint64_t v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_109:
                                                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5239, v64);
                                                                  }
                                                                  uint64_t v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                                  goto LABEL_109;
                                                                }
                                                                uint64_t v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_105:
                                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5238, v63);
                                                              }
                                                              uint64_t v63 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                                              goto LABEL_105;
                                                            }
                                                            uint64_t v62 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_101:
                                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5237, v62);
                                                          }
                                                          uint64_t v62 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                                          goto LABEL_101;
                                                        }
                                                        uint64_t v61 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_97:
                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5236, v61);
                                                      }
                                                      uint64_t v61 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                                      goto LABEL_97;
                                                    }
                                                    uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_93:
                                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5235, v60);
                                                  }
                                                }
                                                uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                goto LABEL_93;
                                              }
                                              uint64_t v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5234, v59);
                                            }
                                          }
                                          uint64_t v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                          goto LABEL_89;
                                        }
                                        uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_85:
                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5233, v58);
                                      }
                                    }
                                    uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_85;
                                  }
                                  uint64_t v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_81:
                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5232, v57);
                                }
                              }
                              uint64_t v57 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_81;
                            }
                            uint64_t v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_77:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5231, v56);
                          }
                        }
                        uint64_t v56 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_77;
                      }
                      unsigned int v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5230, v55);
                    }
                  }
                  unsigned int v55 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_73;
                }
                unsigned int v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5229, v54);
              }
              unsigned int v54 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_69;
            }
            unsigned int v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5228, v53);
          }
          unsigned int v53 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_65;
        }
        unsigned int v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 5227, v52);
      }
    }
    unsigned int v52 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_61;
  }
  return result;
}

uint64_t sub_1001B2C64(__int16 a1, __int16 a2, uint64_t a3)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(unsigned char *)(v15 + WORD2(v16)) = 59;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(unsigned char *)(v15 + WORD2(v16) + 3) = 0;
        unsigned __int16 v10 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        if (HIBYTE(v16))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v16) - v10 > 1)
        {
          if (BYTE6(v16) == 2)
          {
            *(unsigned char *)(v15 + v10) = a1;
            *(unsigned char *)(v15 + WORD2(v16) + 1) = HIBYTE(a1);
            unsigned __int16 v11 = WORD2(v16) + 2;
            WORD2(v16) += 2;
            if (HIBYTE(v16))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v16) - v11 > 1)
            {
              if (BYTE6(v16) == 2)
              {
                *(unsigned char *)(v15 + v11) = a2;
                *(unsigned char *)(v15 + WORD2(v16) + 1) = HIBYTE(a2);
                WORD2(v16) += 2;
                return sub_10001BCBC(226, v15, BYTE4(v16), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6074, v14);
            }
            uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_24;
          }
          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6073, v13);
        }
        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }
      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6072, v12);
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001B2EAC(__int16 a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(unsigned char *)(v11 + v8) = 9;
          if (HIBYTE(v12))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v12) - WORD2(v12) > 1)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              WORD2(v12) += 2;
              return sub_10001BCBC(496, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
            }
            unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6329, v10);
          }
          unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6328, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B301C(char a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v10 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(unsigned char *)(v14 + v10) = a1;
          if (HIBYTE(v15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v11 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                ++WORD2(v15);
                *(unsigned char *)(v14 + v11) = a2;
                return sub_10001BCBC(392, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6375, v13);
            }
          }
          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }
        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6374, v12);
      }
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B3178(char a1, __int16 a2, const void *a3, unsigned int a4, uint64_t a5)
{
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  uint64_t result = sub_100059D70(&v26);
  if (!result)
  {
    if (HIBYTE(v27))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v11 = WORD2(v27);
      if (WORD1(v27) > WORD2(v27))
      {
        if (BYTE6(v27) == 2)
        {
          ++WORD2(v27);
          *(unsigned char *)(v26 + v11) = a1;
          if (HIBYTE(v27))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v27) - WORD2(v27) > 1)
          {
            if (BYTE6(v27) == 2)
            {
              *(_WORD *)(v26 + WORD2(v27)) = a2;
              unsigned __int16 v12 = WORD2(v27) + 2;
              WORD2(v27) += 2;
              uint64_t v13 = v26;
              if (HIBYTE(v27))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v14 = 0;
              }
              else
              {
                int v14 = WORD1(v27) - v12;
              }
              if (v14 < (int)a4)
              {
                uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
              }
              else
              {
                if (BYTE6(v27) == 2)
                {
                  memmove((void *)(v13 + v12), a3, a4);
                  unsigned __int16 v18 = WORD2(v27) + a4;
                  WORD2(v27) += a4;
                  if (a4 <= 0xE5)
                  {
                    uint64_t v19 = v26;
                    if (HIBYTE(v27))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v20 = 0;
                    }
                    else
                    {
                      int v20 = WORD1(v27) - v18;
                    }
                    size_t v21 = 230 - a4;
                    if (v20 < (int)v21)
                    {
                      uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= (230 - dataLen)";
                    }
                    else
                    {
                      if (BYTE6(v27) == 2)
                      {
                        bzero((void *)(v19 + v18), v21);
                        LOBYTE(v18) = BYTE4(v27) + v21;
                        WORD2(v27) += v21;
                        return sub_10001BCBC(407, v26, v18, a5, (uint64_t)sub_1001A8188, v15, v16, v17);
                      }
                      uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6990, v25);
                  }
                  return sub_10001BCBC(407, v26, v18, a5, (uint64_t)sub_1001A8188, v15, v16, v17);
                }
                uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              }
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6988, v24);
            }
            uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6987, v23);
          }
          uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_29;
        }
        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6986, v22);
      }
    }
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001B342C(const void *a1, int a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    uint64_t v7 = v14;
    uint64_t v8 = WORD2(v15);
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      int v9 = 0;
    }
    else
    {
      int v9 = WORD1(v15) - WORD2(v15);
    }
    if (v9 < a2)
    {
      uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
    }
    else
    {
      if (BYTE6(v15) == 2)
      {
        memmove((void *)(v7 + v8), a1, a2);
        WORD2(v15) += a2;
        return sub_10001BCBC(408, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v10, v11, v12);
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
    }
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7004, v13);
  }
  return result;
}

uint64_t sub_1001B3534(__int16 a1, const void *a2, int a3, uint64_t a4)
{
  uint64_t v17 = 0;
  uint64_t v18 = 0;
  uint64_t result = sub_100059D70(&v17);
  if (!result)
  {
    if (HIBYTE(v18))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v18) - WORD2(v18) > 1)
    {
      if (BYTE6(v18) == 2)
      {
        *(_WORD *)(v17 + WORD2(v18)) = a1;
        unsigned __int16 v9 = WORD2(v18) + 2;
        WORD2(v18) += 2;
        uint64_t v10 = v17;
        if (HIBYTE(v18))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v11 = 0;
        }
        else
        {
          int v11 = WORD1(v18) - v9;
        }
        if (v11 < a3)
        {
          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
        }
        else
        {
          if (BYTE6(v18) == 2)
          {
            memmove((void *)(v10 + v9), a2, a3);
            WORD2(v18) += a3;
            return sub_10001BCBC(525, v17, BYTE4(v18), a4, (uint64_t)sub_1000260B4, v12, v13, v14);
          }
          uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7019, v16);
      }
      uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_15:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7018, v15);
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_15;
  }
  return result;
}

uint64_t sub_1001B36D0(uint64_t a1, uint64_t a2)
{
  uint64_t v9 = 0;
  uint64_t v10 = 0;
  uint64_t result = sub_100059D70(&v9);
  if (!result)
  {
    if (HIBYTE(v10))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v10) - WORD2(v10) > 5)
    {
      if (BYTE6(v10) == 2)
      {
        sub_100008A18(v9 + WORD2(v10), a1, 6uLL);
        WORD2(v10) += 6;
        return sub_10001BCBC(1, v9, BYTE4(v10), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
      }
      uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7033, v8);
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001B37BC(__int16 a1, unsigned int a2, char *a3, uint64_t a4)
{
  uint64_t v22 = 0;
  uint64_t v23 = 0;
  uint64_t result = sub_100059D70(&v22);
  if (result) {
    return result;
  }
  if (HIBYTE(v23))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_24;
  }
  uint64_t v12 = WORD2(v23);
  if (WORD1(v23) <= WORD2(v23))
  {
LABEL_24:
    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_26;
  }
  if (BYTE6(v23) != 2)
  {
    uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7046, v19);
  }
  ++WORD2(v23);
  *(unsigned char *)(v22 + v12) = 14;
  if (HIBYTE(v23))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_28;
  }
  if (WORD1(v23) - WORD2(v23) <= 1)
  {
LABEL_28:
    int v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_30;
  }
  if (BYTE6(v23) != 2)
  {
    int v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7047, v20);
  }
  *(_WORD *)(v22 + WORD2(v23)) = a1;
  __int16 v13 = WORD2(v23);
  unsigned __int16 v14 = WORD2(v23) + 2;
  WORD2(v23) += 2;
  if (HIBYTE(v23))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_32;
  }
  if (WORD1(v23) <= v14)
  {
LABEL_32:
    size_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }
  if (BYTE6(v23) != 2)
  {
    size_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7048, v21);
  }
  WORD2(v23) = v13 + 3;
  *(unsigned char *)(v22 + v14) = a2;
  if (a2)
  {
    uint64_t v15 = a2;
    while (!HIBYTE(v23))
    {
      uint64_t v16 = WORD2(v23);
      if (WORD1(v23) <= WORD2(v23)) {
        goto LABEL_20;
      }
      if (BYTE6(v23) != 2)
      {
        uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_22;
      }
      char v17 = *a3++;
      ++WORD2(v23);
      *(unsigned char *)(v22 + v16) = v17;
      if (!--v15) {
        return sub_10001BCBC(291, v22, BYTE4(v23), a4, (uint64_t)sub_1000260B4, v9, v10, v11);
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_20:
    uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_22:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7050, v18);
  }
  return sub_10001BCBC(291, v22, BYTE4(v23), a4, (uint64_t)sub_1000260B4, v9, v10, v11);
}

uint64_t sub_1001B3A40(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v10 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(unsigned char *)(v16 + v10) = 15;
          if (HIBYTE(v17))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v17) - WORD2(v17) > 1)
          {
            if (BYTE6(v17) == 2)
            {
              *(_WORD *)(v16 + WORD2(v17)) = a1;
              __int16 v11 = WORD2(v17);
              unsigned __int16 v12 = WORD2(v17) + 2;
              WORD2(v17) += 2;
              if (HIBYTE(v17))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v17) > v12)
              {
                if (BYTE6(v17) == 2)
                {
                  WORD2(v17) = v11 + 3;
                  *(unsigned char *)(v16 + v12) = a2;
                  return sub_10001BCBC(291, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                }
                uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7066, v15);
              }
              uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }
            unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7065, v14);
          }
          unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_20;
        }
        __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7064, v13);
      }
    }
    __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001B3C34(int a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (result) {
    return result;
  }
  if (HIBYTE(v12))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_11;
  }
  uint64_t v8 = WORD2(v12);
  if (WORD1(v12) <= WORD2(v12))
  {
LABEL_11:
    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  if (BYTE6(v12) != 2)
  {
    uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7079, v10);
  }
  if (a1) {
    char v9 = 1;
  }
  else {
    char v9 = 2;
  }
  ++WORD2(v12);
  *(unsigned char *)(v11 + v8) = v9;
  return sub_10001BCBC(569, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
}

uint64_t sub_1001B3D18(unint64_t a1, uint64_t a2)
{
  uint64_t v18 = 0;
  uint64_t v19 = 0;
  uint64_t result = sub_100059D70(&v18);
  if (!result)
  {
    if (HIBYTE(v19))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(unsigned char *)(v18 + v5) = 4;
          uint64_t v6 = sub_1002284B8(a1);
          int v15 = v6;
          char v17 = BYTE6(v6);
          __int16 v16 = WORD2(v6);
          if (HIBYTE(v19))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v19) - WORD2(v19) > 5)
          {
            if (BYTE6(v19) == 2)
            {
              sub_100008A18(v18 + WORD2(v19), (uint64_t)&v15 + 1, 6uLL);
              __int16 v10 = WORD2(v19);
              unsigned __int16 v11 = WORD2(v19) + 6;
              WORD2(v19) += 6;
              if (HIBYTE(v19))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v19) > v11)
              {
                if (BYTE6(v19) == 2)
                {
                  WORD2(v19) = v10 + 7;
                  *(unsigned char *)(v18 + v11) = v15;
                  return sub_10001BCBC(569, v18, BYTE4(v19), a2, (uint64_t)sub_1000260B4, v7, v8, v9);
                }
                unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7095, v14);
              }
              unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }
            __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7094, v13);
          }
          __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_20;
        }
        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7092, v12);
      }
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001B3F1C(unint64_t a1, uint64_t a2)
{
  uint64_t v18 = 0;
  uint64_t v19 = 0;
  uint64_t result = sub_100059D70(&v18);
  if (!result)
  {
    if (HIBYTE(v19))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(unsigned char *)(v18 + v5) = 5;
          uint64_t v6 = sub_1002284B8(a1);
          int v15 = v6;
          char v17 = BYTE6(v6);
          __int16 v16 = WORD2(v6);
          if (HIBYTE(v19))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v19) - WORD2(v19) > 5)
          {
            if (BYTE6(v19) == 2)
            {
              sub_100008A18(v18 + WORD2(v19), (uint64_t)&v15 + 1, 6uLL);
              __int16 v10 = WORD2(v19);
              unsigned __int16 v11 = WORD2(v19) + 6;
              WORD2(v19) += 6;
              if (HIBYTE(v19))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v19) > v11)
              {
                if (BYTE6(v19) == 2)
                {
                  WORD2(v19) = v10 + 7;
                  *(unsigned char *)(v18 + v11) = v15;
                  return sub_10001BCBC(569, v18, BYTE4(v19), a2, (uint64_t)sub_1000260B4, v7, v8, v9);
                }
                unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7111, v14);
              }
              unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }
            __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7110, v13);
          }
          __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_20;
        }
        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7108, v12);
      }
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001B4120(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 3;
          return sub_10001BCBC(569, v8, BYTE4(v9), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7124, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001B41F8(unint64_t a1, int a2, unsigned int a3, const void *a4, uint64_t a5)
{
  if (a3 < 0x10) {
    return 101;
  }
  uint64_t v29 = 0;
  uint64_t v30 = 0;
  uint64_t result = sub_100059D70(&v29);
  if (!result)
  {
    if (HIBYTE(v30))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v11 = WORD2(v30);
      if (WORD1(v30) > WORD2(v30))
      {
        if (BYTE6(v30) == 2)
        {
          ++WORD2(v30);
          *(unsigned char *)(v29 + v11) = 8;
          uint64_t v12 = sub_1002284B8(a1);
          int v26 = v12;
          char v28 = BYTE6(v12);
          __int16 v27 = WORD2(v12);
          if (a2) {
            char v13 = 2;
          }
          else {
            char v13 = 0;
          }
          if (a2) {
            char v14 = 3;
          }
          else {
            char v14 = 1;
          }
          if ((a1 & 0xFF000000000000) != 0) {
            char v13 = v14;
          }
          if (HIBYTE(v30))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v15 = WORD2(v30);
            if (WORD1(v30) > WORD2(v30))
            {
              if (BYTE6(v30) == 2)
              {
                ++WORD2(v30);
                *(unsigned char *)(v29 + v15) = v13;
                if (HIBYTE(v30))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v30) - WORD2(v30) > 5)
                {
                  if (BYTE6(v30) == 2)
                  {
                    sub_100008A18(v29 + WORD2(v30), (uint64_t)&v26 + 1, 6uLL);
                    unsigned __int16 v16 = WORD2(v30) + 6;
                    WORD2(v30) += 6;
                    uint64_t v17 = v29;
                    if (HIBYTE(v30))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v18 = 0;
                    }
                    else
                    {
                      int v18 = WORD1(v30) - v16;
                    }
                    if (v18 < (int)a3)
                    {
                      uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= (ltkLen)";
                    }
                    else
                    {
                      if (BYTE6(v30) == 2)
                      {
                        memmove((void *)(v17 + v16), a4, a3);
                        WORD2(v30) += a3;
                        return sub_10001BCBC(291, v29, BYTE4(v30), a5, (uint64_t)sub_1000260B4, v19, v20, v21);
                      }
                      uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7445, v25);
                  }
                  uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7444, v24);
                }
                uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_39;
              }
              uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7443, v23);
            }
          }
          uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_35;
        }
        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7435, v22);
      }
    }
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_31;
  }
  return result;
}

uint64_t sub_1001B44D4(unint64_t a1, int a2, uint64_t a3)
{
  uint64_t v21 = 0;
  uint64_t v22 = 0;
  uint64_t result = sub_100059D70(&v21);
  if (!result)
  {
    if (HIBYTE(v22))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v7 = WORD2(v22);
      if (WORD1(v22) > WORD2(v22))
      {
        if (BYTE6(v22) == 2)
        {
          ++WORD2(v22);
          *(unsigned char *)(v21 + v7) = 9;
          uint64_t v8 = sub_1002284B8(a1);
          int v18 = v8;
          char v20 = BYTE6(v8);
          __int16 v19 = WORD2(v8);
          if (a2) {
            char v9 = 2;
          }
          else {
            char v9 = 0;
          }
          if (a2) {
            char v10 = 3;
          }
          else {
            char v10 = 1;
          }
          if ((a1 & 0xFF000000000000) != 0) {
            char v9 = v10;
          }
          if (HIBYTE(v22))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v11 = WORD2(v22);
            if (WORD1(v22) > WORD2(v22))
            {
              if (BYTE6(v22) == 2)
              {
                ++WORD2(v22);
                *(unsigned char *)(v21 + v11) = v9;
                if (HIBYTE(v22))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v22) - WORD2(v22) > 5)
                {
                  if (BYTE6(v22) == 2)
                  {
                    sub_100008A18(v21 + WORD2(v22), (uint64_t)&v18 + 1, 6uLL);
                    WORD2(v22) += 6;
                    return sub_10001BCBC(291, v21, BYTE4(v22), a3, (uint64_t)sub_1000260B4, v12, v13, v14);
                  }
                  uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7469, v17);
                }
                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_32;
              }
              unsigned __int16 v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7468, v16);
            }
          }
          unsigned __int16 v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_28;
        }
        uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7460, v15);
      }
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_24;
  }
  return result;
}

uint64_t sub_1001B4700(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 10;
          return sub_10001BCBC(291, v8, BYTE4(v9), a1, (uint64_t)sub_1001A6C4C, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7484, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001B47D8(unint64_t a1, int a2, char a3, int a4, const void *a5, uint64_t a6)
{
  uint64_t v36 = 0;
  uint64_t v37 = 0;
  uint64_t result = sub_100059D70(&v36);
  if (!result)
  {
    if (HIBYTE(v37))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v13 = WORD2(v37);
      if (WORD1(v37) > WORD2(v37))
      {
        if (BYTE6(v37) == 2)
        {
          ++WORD2(v37);
          *(unsigned char *)(v36 + v13) = 11;
          uint64_t v14 = sub_1002284B8(a1);
          int v33 = v14;
          char v35 = BYTE6(v14);
          __int16 v34 = WORD2(v14);
          if (a2) {
            char v15 = 2;
          }
          else {
            char v15 = 0;
          }
          if (a2) {
            char v16 = 3;
          }
          else {
            char v16 = 1;
          }
          if ((a1 & 0xFF000000000000) != 0) {
            char v15 = v16;
          }
          if (HIBYTE(v37))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v17 = WORD2(v37);
            if (WORD1(v37) > WORD2(v37))
            {
              if (BYTE6(v37) == 2)
              {
                ++WORD2(v37);
                *(unsigned char *)(v36 + v17) = v15;
                if (HIBYTE(v37))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v37) - WORD2(v37) > 5)
                {
                  if (BYTE6(v37) == 2)
                  {
                    sub_100008A18(v36 + WORD2(v37), (uint64_t)&v33 + 1, 6uLL);
                    __int16 v21 = WORD2(v37);
                    unsigned __int16 v22 = WORD2(v37) + 6;
                    WORD2(v37) += 6;
                    if (HIBYTE(v37))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v37) > v22)
                    {
                      if (BYTE6(v37) == 2)
                      {
                        if (a4) {
                          char v23 = a3;
                        }
                        else {
                          char v23 = 1;
                        }
                        WORD2(v37) = v21 + 7;
                        *(unsigned char *)(v36 + v22) = v23;
                        if (HIBYTE(v37))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v37) - WORD2(v37) > 1)
                        {
                          if (BYTE6(v37) == 2)
                          {
                            *(_WORD *)(v36 + WORD2(v37)) = a4;
                            unsigned __int16 v24 = WORD2(v37) + 2;
                            WORD2(v37) += 2;
                            if (a4)
                            {
                              uint64_t v25 = v36;
                              if (HIBYTE(v37))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                                int v26 = 0;
                              }
                              else
                              {
                                int v26 = WORD1(v37) - v24;
                              }
                              if (v26 < a4)
                              {
                                uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= (length)";
                              }
                              else
                              {
                                if (BYTE6(v37) == 2)
                                {
                                  memmove((void *)(v25 + v24), a5, a4);
                                  LOBYTE(v24) = BYTE4(v37) + a4;
                                  WORD2(v37) += a4;
                                  return sub_10001BCBC(291, v36, v24, a6, (uint64_t)sub_1000260B4, v18, v19, v20);
                                }
                                uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                              }
                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7514, v32);
                            }
                            return sub_10001BCBC(291, v36, v24, a6, (uint64_t)sub_1000260B4, v18, v19, v20);
                          }
                          uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7512, v31);
                        }
                        uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_56;
                      }
                      uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7511, v30);
                    }
                    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_52;
                  }
                  uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7510, v29);
                }
                uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_48;
              }
              char v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7509, v28);
            }
          }
          char v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_44;
        }
        __int16 v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7499, v27);
      }
    }
    __int16 v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_40;
  }
  return result;
}

uint64_t sub_1001B4BC0(__int16 a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(unsigned char *)(v11 + v8) = 12;
          if (HIBYTE(v12))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v12) - WORD2(v12) > 1)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              WORD2(v12) += 2;
              return sub_10001BCBC(291, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
            }
            char v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7530, v10);
          }
          char v10 = "ByteStream_NumReadBytesAvail(bs) >= 2";
          goto LABEL_17;
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7529, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001B4D30(char a1, char a2, char a3, char a4, char a5, uint64_t a6)
{
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  uint64_t result = sub_100059D70(&v26);
  if (!result)
  {
    if (HIBYTE(v27))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v16 = WORD2(v27);
      if (WORD1(v27) > WORD2(v27))
      {
        if (BYTE6(v27) == 2)
        {
          ++WORD2(v27);
          *(unsigned char *)(v26 + v16) = a1;
          if (HIBYTE(v27))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v17 = WORD2(v27);
            if (WORD1(v27) > WORD2(v27))
            {
              if (BYTE6(v27) == 2)
              {
                ++WORD2(v27);
                *(unsigned char *)(v26 + v17) = a2;
                if (HIBYTE(v27))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v18 = WORD2(v27);
                  if (WORD1(v27) > WORD2(v27))
                  {
                    if (BYTE6(v27) == 2)
                    {
                      ++WORD2(v27);
                      *(unsigned char *)(v26 + v18) = a3;
                      if (HIBYTE(v27))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v19 = WORD2(v27);
                        if (WORD1(v27) > WORD2(v27))
                        {
                          if (BYTE6(v27) == 2)
                          {
                            ++WORD2(v27);
                            *(unsigned char *)(v26 + v19) = a4;
                            if (HIBYTE(v27))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v20 = WORD2(v27);
                              if (WORD1(v27) > WORD2(v27))
                              {
                                if (BYTE6(v27) == 2)
                                {
                                  ++WORD2(v27);
                                  *(unsigned char *)(v26 + v20) = a5;
                                  return sub_10001BCBC(652, v26, BYTE4(v27), a6, (uint64_t)sub_1000260B4, v13, v14, v15);
                                }
                                uint64_t v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7548, v25);
                              }
                            }
                            uint64_t v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_38;
                          }
                          unsigned __int16 v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7547, v24);
                        }
                      }
                      unsigned __int16 v24 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_34;
                    }
                    char v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7546, v23);
                  }
                }
                char v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_30;
              }
              unsigned __int16 v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7545, v22);
            }
          }
          unsigned __int16 v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_26;
        }
        __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7544, v21);
      }
    }
    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }
  return result;
}

uint64_t sub_1001B5008(unsigned int a1, uint64_t a2, uint64_t a3)
{
  uint64_t v24 = 0;
  uint64_t v25 = 0;
  uint64_t result = sub_100059D70(&v24);
  if (result) {
    return result;
  }
  if (HIBYTE(v25))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_44;
  }
  uint64_t v10 = WORD2(v25);
  if (WORD1(v25) <= WORD2(v25))
  {
LABEL_44:
    unsigned __int16 v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_46;
  }
  if (BYTE6(v25) != 2)
  {
    unsigned __int16 v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7562, v22);
  }
  ++WORD2(v25);
  *(unsigned char *)(v24 + v10) = 17;
  if (HIBYTE(v25))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_48;
  }
  uint64_t v11 = WORD2(v25);
  if (WORD1(v25) <= WORD2(v25))
  {
LABEL_48:
    char v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_50;
  }
  if (BYTE6(v25) != 2)
  {
    char v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7563, v23);
  }
  ++WORD2(v25);
  *(unsigned char *)(v24 + v11) = a1;
  if (a1)
  {
    uint64_t v12 = a1;
    uint64_t v13 = (unsigned char *)(a2 + 4);
    while (!HIBYTE(v25))
    {
      if (WORD1(v25) - WORD2(v25) <= 1) {
        goto LABEL_28;
      }
      if (BYTE6(v25) != 2)
      {
        uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_30;
      }
      *(_WORD *)(v24 + WORD2(v25)) = *((_WORD *)v13 - 2);
      unsigned __int16 v14 = WORD2(v25) + 2;
      WORD2(v25) += 2;
      if (HIBYTE(v25))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_32:
        uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_34:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7567, v19);
      }
      if (WORD1(v25) - v14 <= 1) {
        goto LABEL_32;
      }
      if (BYTE6(v25) != 2)
      {
        uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_34;
      }
      *(unsigned char *)(v24 + v14) = *(v13 - 2);
      *(unsigned char *)(v24 + WORD2(v25) + 1) = *(v13 - 1);
      unsigned __int16 v15 = WORD2(v25) + 2;
      WORD2(v25) += 2;
      if (HIBYTE(v25))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_36:
        uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_38:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7568, v20);
      }
      if (WORD1(v25) - v15 <= 1) {
        goto LABEL_36;
      }
      if (BYTE6(v25) != 2)
      {
        uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_38;
      }
      *(unsigned char *)(v24 + v15) = *v13;
      *(unsigned char *)(v24 + WORD2(v25) + 1) = v13[1];
      unsigned __int16 v16 = WORD2(v25) + 2;
      WORD2(v25) += 2;
      if (HIBYTE(v25))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_40:
        __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_42:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7569, v21);
      }
      if (WORD1(v25) - v16 <= 1) {
        goto LABEL_40;
      }
      if (BYTE6(v25) != 2)
      {
        __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_42;
      }
      *(unsigned char *)(v24 + v16) = v13[2];
      *(unsigned char *)(v24 + WORD2(v25) + 1) = v13[3];
      unsigned __int8 v17 = BYTE4(v25) + 2;
      WORD2(v25) += 2;
      v13 += 8;
      if (!--v12) {
        return sub_10001BCBC(291, v24, v17, a3, (uint64_t)sub_1000260B4, v7, v8, v9);
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_28:
    uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_30:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 7566, v18);
  }
  unsigned __int8 v17 = BYTE4(v25);
  return sub_10001BCBC(291, v24, v17, a3, (uint64_t)sub_1000260B4, v7, v8, v9);
}

void (**sub_1001B53E8(void (**result)(uint64_t a1, uint64_t a2), const void *a2))(uint64_t a1, uint64_t a2)
{
  *uint64_t result = sub_1001B5484;
  if (a2) {
    return (void (**)(uint64_t, uint64_t))memcpy(&off_100A04F20, a2, 0x1C8uLL);
  }
  return result;
}

void *sub_1001B5410(void *a1)
{
  memcpy(a1, off_10099DF30, 0x8F0uLL);
  sub_10019AE6C(sub_1001A679C);

  return sub_10019C348(sub_100026010);
}

void *sub_1001B5468(void *__src)
{
  if (__src) {
    return memcpy(&unk_100A050E8, __src, 0x1C8uLL);
  }
  return __src;
}

void sub_1001B5484(uint64_t a1, uint64_t a2)
{
  uint64_t v2 = (unsigned char *)(a1 + 15);
  if (*(unsigned char *)(a1 + 15))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_774;
  }
  uint64_t v5 = (unsigned __int16 *)(a1 + 12);
  uint64_t v4 = *(unsigned __int16 *)(a1 + 12);
  uint64_t v6 = *(unsigned __int16 *)(a1 + 10);
  if (v6 <= v4)
  {
LABEL_774:
    v379 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
    goto LABEL_776;
  }
  if (*(unsigned char *)(a1 + 14) != 1)
  {
    v379 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_776:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1360, v379);
  }
  uint64_t v7 = a2;
  uint64_t v8 = *(void *)a1;
  uint64_t v9 = v4 + 1;
  *(_WORD *)(a1 + 12) = v4 + 1;
  unsigned int v10 = *(unsigned __int8 *)(v8 + v4);
  if (v10 > 0xB4)
  {
    switch(*(unsigned char *)(v8 + v4))
    {
      case 0xE5:
        uint64_t v11 = off_100A04FE0;
        if (!off_100A04FE0) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          unsigned __int16 v12 = *(_WORD *)(v8 + v9);
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1783, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 4;
          if (v6 <= (unsigned __int16)(v4 + 4)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1784, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v13 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 3));
          *uint64_t v5 = v4 + 5;
          ((void (*)(void, uint64_t, void))v11)(v12, v13, *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4)));
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1782, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xE6:
        uint64_t v141 = (void (*)(size_t *))off_100A050D0;
        if (!off_100A050D0) {
          goto LABEL_756;
        }
        *(void *)&long long v405 = 0;
        *(_OWORD *)size = 0u;
        memset(ptr, 0, sizeof(ptr));
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
          LOBYTE(size[0]) = *(unsigned char *)(v8 + v9);
          if ((int)v6 - ((int)v4 + 2) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2298, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[0]) = *(_DWORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 6;
          if (v6 <= (unsigned __int16)(v4 + 6)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2299, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 7;
          LOBYTE(size[1]) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 6));
          if ((int)(v6 - (unsigned __int16)(v4 + 7)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2300, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 7));
          *uint64_t v5 = v4 + 11;
          if ((int)(v6 - (unsigned __int16)(v4 + 11)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2301, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 11));
          *uint64_t v5 = v4 + 15;
          if ((int)(v6 - (unsigned __int16)(v4 + 15)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2302, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 15));
          *uint64_t v5 = v4 + 19;
          if ((int)(v6 - (unsigned __int16)(v4 + 19)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2303, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 19));
          *uint64_t v5 = v4 + 23;
          if ((int)(v6 - (unsigned __int16)(v4 + 23)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2304, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 23));
          *uint64_t v5 = v4 + 27;
          if ((int)(v6 - (unsigned __int16)(v4 + 27)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2305, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 27));
          *uint64_t v5 = v4 + 31;
          if ((int)(v6 - (unsigned __int16)(v4 + 31)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2306, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 31));
          *uint64_t v5 = v4 + 35;
          if ((int)(v6 - (unsigned __int16)(v4 + 35)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2307, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 35));
          *uint64_t v5 = v4 + 39;
          if ((int)(v6 - (unsigned __int16)(v4 + 39)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2308, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 39));
          *uint64_t v5 = v4 + 43;
          if ((int)(v6 - (unsigned __int16)(v4 + 43)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2309, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v405) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 43));
          *uint64_t v5 = v4 + 47;
          if (v6 <= (unsigned __int16)(v4 + 47)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2310, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 48;
          BYTE4(v405) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 47));
          if (v6 <= (unsigned __int16)(v4 + 48)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2311, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 49;
          BYTE5(v405) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 48));
          if (v6 <= (unsigned __int16)(v4 + 49)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2312, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 50;
          BYTE6(v405) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 49));
LABEL_433:
          v141(size);
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2297, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      case 0xE7:
      case 0xEA:
      case 0xF1:
      case 0xF2:
      case 0xF3:
      case 0xF4:
      case 0xF5:
      case 0xF6:
      case 0xF8:
      case 0xF9:
      case 0xFC:
        goto LABEL_756;
      case 0xE8:
        unsigned int v53 = (void (*)(uint64_t, uint64_t))qword_100A04FE8;
        if (!qword_100A04FE8) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v58 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v58 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1798, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
LABEL_300:
          uint64_t v153 = v55 | (v56 << 8);
          *uint64_t v5 = v4 + 4;
          uint64_t v154 = *(unsigned __int8 *)(v8 + v57);
LABEL_301:
          v53(v153, v154);
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1797, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xE9:
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (v6 > (unsigned __int16)v9)
        {
          uint64_t v142 = v4 + 2;
          *uint64_t v5 = v4 + 2;
          int v143 = *(unsigned __int8 *)(v8 + v9);
          switch(v143)
          {
            case 1:
              uint64_t v144 = (unsigned __int16)(v6 - v142);
              if (v144 >= 8)
              {
                if (!off_100A05098) {
                  goto LABEL_756;
                }
                WORD2(size[0]) = 0;
                LODWORD(size[0]) = 0;
                if ((int)v6 - (int)v142 <= 5) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1236, "ByteStream_NumReadBytesAvail(*pBs) >= OI_BD_ADDR_BYTE_SIZE");
                }
                sub_100008A18((uint64_t)size, v8 + v142, 6uLL);
                unsigned __int16 v145 = *v5;
                unsigned __int16 v146 = *v5 + 6;
                *uint64_t v5 = v146;
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  unsigned int v147 = *(unsigned __int16 *)(a1 + 10);
                  if (v147 > v146)
                  {
                    if (*(unsigned char *)(a1 + 14) == 1)
                    {
                      uint64_t v148 = *(void *)a1;
                      *(_WORD *)(a1 + 12) = v145 + 7;
                      if (v147 <= (unsigned __int16)(v145 + 7)) {
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1238, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                      }
                      uint64_t v149 = *(unsigned __int8 *)(v148 + v146);
                      *uint64_t v5 = v145 + 8;
                      off_100A05098(LODWORD(size[0]) | ((unint64_t)WORD2(size[0]) << 32), v149, *(unsigned __int8 *)(v148 + (unsigned __int16)(v145 + 7)), v7);
                      goto LABEL_756;
                    }
                    v389 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_1073:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1237, v389);
                  }
                }
                v389 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
                goto LABEL_1073;
              }
              if (!sub_100058654()) {
                goto LABEL_756;
              }
              sub_100056E24((uint64_t)"Sensor state report event returned invalid length %d of data", v337, v338, v339, v340, v341, v342, v343, v144);
              v344 = sub_100050B4C(0x54u);
              if (!os_log_type_enabled(v344, OS_LOG_TYPE_ERROR)) {
                goto LABEL_756;
              }
              goto LABEL_718;
            case 2:
              if ((int)(v6 - (unsigned __int16)v142) <= 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1272, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              int v309 = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 2));
              *uint64_t v5 = v4 + 4;
              if (!sub_100197864(v309))
              {
                if (!sub_100058654()) {
                  goto LABEL_756;
                }
                sub_100056E24((uint64_t)"RSSI Prox alert: ACL handle invalid", v353, v354, v355, v356, v357, v358, v359, v390);
                v360 = sub_100050B4C(0x54u);
                if (!os_log_type_enabled(v360, OS_LOG_TYPE_ERROR)) {
                  goto LABEL_756;
                }
LABEL_718:
                sub_100744F6C();
                goto LABEL_756;
              }
              if (*v2)
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else
              {
                unsigned int v310 = *(unsigned __int16 *)(a1 + 10);
                unsigned int v311 = *(unsigned __int16 *)(a1 + 12);
                if (v310 > v311)
                {
                  if (*(unsigned char *)(a1 + 14) == 1)
                  {
                    *(_WORD *)(a1 + 12) = v311 + 1;
                    if (v310 <= v311 + 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1277, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                    }
                    *uint64_t v5 = v311 + 2;
                    if (off_100A04F30) {
                      off_100A04F30();
                    }
                    goto LABEL_756;
                  }
                  v387 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_1009:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1276, v387);
                }
              }
              v387 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
              goto LABEL_1009;
            case 3:
            case 4:
            case 5:
            case 6:
            case 8:
            case 9:
            case 10:
              goto LABEL_756;
            case 7:
              unsigned int v312 = v6 - (unsigned __int16)v142;
              if ((v312 & 0x1FFFE) != 0)
              {
                if (off_100A04F28) {
                  off_100A04F28(v8 + (unsigned __int16)v142, (v312 >> 1), v8 + (unsigned __int16)v142 + (unsigned __int16)(v312 >> 1), (v312 >> 1));
                }
                goto LABEL_756;
              }
              if (!sub_100058654()) {
                goto LABEL_756;
              }
              sub_100056E24((uint64_t)"LostDevice size is zero", v345, v346, v347, v348, v349, v350, v351, v390);
              v352 = sub_100050B4C(0x54u);
              if (!os_log_type_enabled(v352, OS_LOG_TYPE_ERROR)) {
                goto LABEL_756;
              }
              goto LABEL_718;
            case 11:
              if ((int)(v6 - (unsigned __int16)v142) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1294, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              uint64_t v313 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 2));
              *uint64_t v5 = v4 + 6;
              if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1295, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              uint64_t v314 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 6));
              *uint64_t v5 = v4 + 10;
              if (off_100A04F38) {
                off_100A04F38(v313, v314);
              }
              goto LABEL_756;
            case 12:
              if ((int)(v6 - (unsigned __int16)v142) <= 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1311, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              unsigned __int16 v315 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 2));
              *uint64_t v5 = v4 + 4;
              if (v6 <= (unsigned __int16)(v4 + 4)) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1312, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              }
              *uint64_t v5 = v4 + 5;
              uint64_t v316 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4));
              if (off_100A05108) {
                off_100A05108(v315, v316);
              }
              if (v316 && off_100A04F40) {
                off_100A04F40(v315, v316);
              }
              goto LABEL_756;
            default:
              if (v143 == 33)
              {
                if (v6 <= (unsigned __int16)v142) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1335, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                }
                *uint64_t v5 = v4 + 3;
                if (v6 <= (unsigned __int16)(v4 + 3)) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1336, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                }
                uint64_t v301 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 2));
                *uint64_t v5 = v4 + 4;
                if ((int)v6 - ((int)v4 + 4) <= 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1337, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                }
                uint64_t v302 = *(unsigned __int8 *)(v8 + v4 + 3);
                unsigned __int16 v303 = *(_WORD *)(v8 + v4 + 4);
                *uint64_t v5 = v4 + 6;
                if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1338, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                }
                v304 = (unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 6));
                int v305 = *v304;
                int v306 = v304[1];
                *uint64_t v5 = v4 + 8;
                if (off_100A05028) {
                  off_100A05028(v301, v302, v303, v305 | (v306 << 8));
                }
              }
              goto LABEL_756;
          }
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1501, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      case 0xEB:
        unsigned int v53 = (void (*)(uint64_t, uint64_t))off_100A05280;
        if (!off_100A05280) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v150 = v8 + v9;
          int v151 = *(unsigned __int8 *)(v8 + v9);
          int v152 = *(unsigned __int8 *)(v150 + 1);
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2140, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v153 = v151 | (v152 << 8);
          *uint64_t v5 = v4 + 4;
          uint64_t v154 = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 3)) != 0;
          goto LABEL_301;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2139, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xEC:
        if (!off_100A04F98) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          __int16 v155 = ((uint64_t (*)(void, void))off_100A04F98)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12), 0);
        }
        else
        {
          __int16 v155 = ((uint64_t (*)(uint64_t, void))off_100A04F98)(v8 + (unsigned __int16)v9, (v6 - v9));
        }
        unsigned __int16 v254 = *v5 + v155;
        *uint64_t v5 = v254;
        if (*v2) {
          goto LABEL_499;
        }
        if (*(unsigned __int16 *)(a1 + 10) != v254) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1600, "ByteStream_NumReadBytesAvail(*pBs) == 0");
        }
        return;
      case 0xED:
        int v156 = (void (*)(uint64_t, uint64_t))qword_100A050A8;
        if (!qword_100A050A8) {
          goto LABEL_756;
        }
        unint64_t v157 = v6 - (unsigned __int16)v9;
        if (v157 > 0x26)
        {
          uint64_t v190 = v8 + (unsigned __int16)v9;
          goto LABEL_461;
        }
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"BT_VSE_HID_LATENCY_STATISTICS - Invalid data size %lu", v158, v159, v160, v161, v162, v163, v164, v157);
          v165 = sub_100050B4C(0x54u);
          if (os_log_type_enabled(v165, OS_LOG_TYPE_ERROR)) {
            goto LABEL_718;
          }
        }
        goto LABEL_756;
      case 0xEE:
        if (!off_100A050C0) {
          goto LABEL_756;
        }
        size[0] = 0;
        size[1] = 0;
        *(void **)((char *)ptr + 7) = 0;
        ptr[0] = 0;
        *(_WORD *)&uint8_t buf[4] = 0;
        *(_DWORD *)int buf = 0;
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v166 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v166 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2246, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          goto LABEL_659;
        }
        if ((int)(v6 - (unsigned __int16)v9) <= 1)
        {
          *uint64_t v2 = 1;
LABEL_659:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v317 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v317 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2247, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          unsigned __int16 v255 = 0;
          goto LABEL_661;
        }
        unsigned __int16 v255 = *(_WORD *)(v8 + v9);
        *(_WORD *)(a1 + 12) = v4 + 3;
        if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v4 + 3))
        {
          *uint64_t v2 = 1;
LABEL_661:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v318 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v318 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2248, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          uint64_t v257 = 0;
          goto LABEL_663;
        }
        uint64_t v256 = *(void *)a1;
        *(_WORD *)(a1 + 12) = v4 + 4;
        uint64_t v257 = *(unsigned __int8 *)(v256 + (unsigned __int16)(v4 + 3));
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 4) <= 1)
        {
          *uint64_t v2 = 1;
LABEL_663:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v319 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v319 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2249, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          unsigned __int16 v258 = 0;
          goto LABEL_665;
        }
        unsigned __int16 v258 = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v4 + 4));
        *(_WORD *)(a1 + 12) = v4 + 6;
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 6) <= 1)
        {
          *uint64_t v2 = 1;
LABEL_665:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v320 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v320 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2250, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          unsigned __int16 v259 = 0;
          goto LABEL_667;
        }
        unsigned __int16 v259 = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v4 + 6));
        *(_WORD *)(a1 + 12) = v4 + 8;
        if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v4 + 8))
        {
          *uint64_t v2 = 1;
LABEL_667:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          unint64_t v261 = 0;
          goto LABEL_668;
        }
        uint64_t v260 = *(void *)a1;
        *(_WORD *)(a1 + 12) = v4 + 9;
        unint64_t v261 = (unint64_t)*(unsigned __int8 *)(v260 + (unsigned __int16)(v4 + 8)) << 48;
        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 9) >= 6)
        {
          sub_100008A18((uint64_t)buf, *(void *)a1 + (unsigned __int16)(v4 + 9), 6uLL);
          *(_WORD *)(a1 + 12) += 6;
          goto LABEL_669;
        }
LABEL_668:
        *uint64_t v2 = 1;
LABEL_669:
        if (!v258) {
          goto LABEL_676;
        }
        if (*(unsigned char *)(a1 + 14) == 1)
        {
          if (*v2)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v321 = 0;
          }
          else
          {
            int v321 = *(unsigned __int16 *)(a1 + 10) - *(unsigned __int16 *)(a1 + 12);
          }
          if (v321 >= v258)
          {
            __memmove_chk();
            *v5 += v258;
LABEL_676:
            off_100A050C0(v255, v257, v258, v259, v261 | ((unint64_t)buf[0] << 40) | ((unint64_t)buf[1] << 32) | ((unint64_t)buf[2] << 24) | ((unint64_t)buf[3] << 16) | ((unint64_t)buf[4] << 8) | buf[5], size);
            goto LABEL_756;
          }
          v386 = "ByteStream_NumReadBytesAvail(*pBs) >= (length)";
        }
        else
        {
          v386 = "(*pBs).__RWFlag == BYTESTREAM_READ";
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2252, v386);
      case 0xEF:
        if (*v2)
        {
          v381 = v2;
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v382 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v382 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2350, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
        }
        else
        {
          if ((int)(v6 - (unsigned __int16)v9) > 3)
          {
            int v59 = *(_DWORD *)(v8 + v9);
            *(_WORD *)(a1 + 12) = v4 + 5;
            if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v4 + 5))
            {
              uint64_t v60 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v4 + 6;
              uint64_t v61 = (unsigned __int16)(v4 + 5);
              int v62 = *(unsigned __int8 *)(v60 + v61);
              if (!*(unsigned char *)(v60 + v61)) {
                goto LABEL_756;
              }
              int v63 = 0;
              while (1)
              {
                long long v405 = 0u;
                long long v406 = 0u;
                *(_OWORD *)size = 0u;
                memset(ptr, 0, sizeof(ptr));
                if (*(unsigned char *)(a1 + 14) != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2356, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2) {
                  break;
                }
                uint64_t v64 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) - (int)v64 < 2) {
                  goto LABEL_102;
                }
                unsigned int v65 = *(unsigned __int16 *)(*(void *)a1 + v64);
                *(_WORD *)(a1 + 12) = v64 + 2;
LABEL_103:
                WORD1(ptr[1]) = v65 & 0x1F;
                BYTE4(ptr[1]) = (v65 >> 5) & 3;
                BYTE6(ptr[3]) = (v65 & 0x80) != 0;
                BYTE5(ptr[3]) = BYTE1(v65) & 0x3F;
                BYTE4(ptr[3]) = (v65 & 0x4000) != 0;
                HIBYTE(ptr[3]) = v65 >> 15;
                uint64_t v66 = (v65 & 0x1F) - 16;
                if v66 < 0xE && ((0x2C2Du >> v66))
                {
                  char v77 = byte_1007BA2A0[v66];
                }
                else
                {
                  BYTE3(ptr[3]) = 1;
                  int v67 = sub_100058654();
                  if (v65)
                  {
                    if ((v65 & 4) != 0)
                    {
                      if (v67)
                      {
                        sub_100056E24((uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_CONNECTABLE & EXTENDED_ADVERTISING_EVENT_TYPE_DIRECTED_ADV", v68, v69, v70, v71, v72, v73, v74, v390);
                        unsigned __int16 v83 = sub_100050B4C(0x54u);
                        if (os_log_type_enabled(v83, OS_LOG_TYPE_DEFAULT))
                        {
                          unsigned __int16 v84 = sub_100050714();
                          *(_DWORD *)int buf = 136446210;
                          *(void *)&uint8_t buf[4] = v84;
                          _os_log_impl((void *)&_mh_execute_header, v83, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                        }
                      }
                      char v77 = 1;
                    }
                    else
                    {
                      if (v67)
                      {
                        sub_100056E24((uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_CONNECTABLE", v68, v69, v70, v71, v72, v73, v74, v390);
                        unsigned __int16 v78 = sub_100050B4C(0x54u);
                        BOOL v79 = os_log_type_enabled(v78, OS_LOG_TYPE_DEFAULT);
                        char v77 = 0;
                        if (!v79) {
                          goto LABEL_125;
                        }
                        unsigned __int16 v80 = sub_100050714();
                        *(_DWORD *)int buf = 136446210;
                        *(void *)&uint8_t buf[4] = v80;
                        _os_log_impl((void *)&_mh_execute_header, v78, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                      }
                      char v77 = 0;
                    }
                  }
                  else if ((v65 & 8) != 0)
                  {
                    if (v67)
                    {
                      sub_100056E24((uint64_t)"legacy=false EXTENDED_ADVERTISING_EVENT_TYPE_SCAN_RSP", v68, v69, v70, v71, v72, v73, v74, v390);
                      unsigned __int16 v81 = sub_100050B4C(0x54u);
                      if (os_log_type_enabled(v81, OS_LOG_TYPE_DEFAULT))
                      {
                        unsigned __int16 v82 = sub_100050714();
                        *(_DWORD *)int buf = 136446210;
                        *(void *)&uint8_t buf[4] = v82;
                        _os_log_impl((void *)&_mh_execute_header, v81, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                      }
                    }
                    char v77 = 4;
                  }
                  else
                  {
                    if (v67)
                    {
                      sub_100056E24((uint64_t)"legacy=false LE_ADVERTISING_TYPE_NON_CONNECTABLE_UNDIRECTED", v68, v69, v70, v71, v72, v73, v74, v390);
                      unsigned __int16 v75 = sub_100050B4C(0x54u);
                      if (os_log_type_enabled(v75, OS_LOG_TYPE_DEFAULT))
                      {
                        unsigned __int16 v76 = sub_100050714();
                        *(_DWORD *)int buf = 136446210;
                        *(void *)&uint8_t buf[4] = v76;
                        _os_log_impl((void *)&_mh_execute_header, v75, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
                      }
                    }
                    char v77 = 3;
                  }
                }
LABEL_125:
                LOBYTE(size[0]) = (16 * BYTE5(ptr[3]) - 80) | v77;
                int v85 = *(unsigned __int8 *)(a1 + 14);
                if ((v59 & 2) != 0)
                {
                  if (v85 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2406, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*v2)
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v87 = *(unsigned __int8 *)(a1 + 14);
                    *(unsigned char *)(a1 + 15) = 1;
                    if (v87 != 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2407, "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                    goto LABEL_146;
                  }
                  uint64_t v92 = *(unsigned __int16 *)(a1 + 12);
                  if (*(unsigned __int16 *)(a1 + 10) <= v92)
                  {
                    *uint64_t v2 = 1;
LABEL_146:
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    goto LABEL_147;
                  }
                  uint64_t v93 = *(void *)a1;
                  *(_WORD *)(a1 + 12) = v92 + 1;
                  BYTE3(v405) = *(unsigned char *)(v93 + v92);
                  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v92 + 1) >= 6)
                  {
                    uint64_t v90 = *(void *)a1 + (unsigned __int16)(v92 + 1);
                    unsigned __int16 v91 = (char *)&v405 + 4;
                    goto LABEL_142;
                  }
                }
                else
                {
                  if (v85 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2409, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*v2)
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v86 = *(unsigned __int8 *)(a1 + 14);
                    *(unsigned char *)(a1 + 15) = 1;
                    if (v86 != 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2410, "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                    goto LABEL_146;
                  }
                  uint64_t v88 = *(unsigned __int16 *)(a1 + 12);
                  if (*(unsigned __int16 *)(a1 + 10) <= v88)
                  {
                    *uint64_t v2 = 1;
                    goto LABEL_146;
                  }
                  uint64_t v89 = *(void *)a1;
                  *(_WORD *)(a1 + 12) = v88 + 1;
                  BYTE1(size[0]) = *(unsigned char *)(v89 + v88);
                  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v88 + 1) >= 6)
                  {
                    uint64_t v90 = *(void *)a1 + (unsigned __int16)(v88 + 1);
                    unsigned __int16 v91 = (char *)size + 2;
LABEL_142:
                    sub_100008A18((uint64_t)v91, v90, 6uLL);
                    *(_WORD *)(a1 + 12) += 6;
                    goto LABEL_148;
                  }
                }
LABEL_147:
                *uint64_t v2 = 1;
LABEL_148:
                if (*(unsigned char *)(a1 + 14) != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2412, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v94 = *(unsigned __int8 *)(a1 + 14);
                }
                else
                {
                  uint64_t v95 = *(unsigned __int16 *)(a1 + 12);
                  if (*(unsigned __int16 *)(a1 + 10) > v95)
                  {
                    uint64_t v96 = *(void *)a1;
                    *(_WORD *)(a1 + 12) = v95 + 1;
                    unsigned int v97 = *(unsigned __int8 *)(v96 + v95);
                    BYTE5(ptr[1]) = *(unsigned char *)(v96 + v95);
                    int v94 = 1;
                    int v98 = 1;
                    goto LABEL_155;
                  }
                  int v94 = 1;
                }
                int v98 = 0;
                *uint64_t v2 = 1;
                unsigned int v97 = BYTE5(ptr[1]);
LABEL_155:
                LOBYTE(v405) = v97 >> 7;
                BYTE1(v405) = (v97 & 0x40) != 0;
                BYTE2(v405) = (v97 & 0x20) != 0;
                if (v94 != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2418, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (!v98)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v109 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v109 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2419, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
LABEL_168:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v110 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v110 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2420, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
LABEL_169:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v111 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v111 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2421, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
LABEL_170:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v112 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v112 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2422, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
LABEL_171:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v113 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v113 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2423, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
LABEL_172:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v114 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v114 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2424, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
LABEL_173:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  goto LABEL_174;
                }
                uint64_t v99 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v99)
                {
                  *uint64_t v2 = 1;
                  goto LABEL_168;
                }
                uint64_t v100 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v99 + 1;
                BYTE6(ptr[1]) = *(unsigned char *)(v100 + v99);
                if (*(unsigned __int16 *)(a1 + 10) <= (v99 + 1))
                {
                  *uint64_t v2 = 1;
                  goto LABEL_169;
                }
                uint64_t v101 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v99 + 2;
                HIBYTE(ptr[1]) = *(unsigned char *)(v101 + v99 + 1);
                if (*(unsigned __int16 *)(a1 + 10) <= (v99 + 2))
                {
                  *uint64_t v2 = 1;
                  goto LABEL_170;
                }
                uint64_t v102 = *(void *)a1;
                uint64_t v103 = v99 + 3;
                *(_WORD *)(a1 + 12) = v99 + 3;
                LOBYTE(ptr[2]) = *(unsigned char *)(v102 + v99 + 2);
                if (*(unsigned __int16 *)(a1 + 10) <= (v99 + 3))
                {
                  *uint64_t v2 = 1;
                  goto LABEL_171;
                }
                uint64_t v104 = *(void *)a1;
                unsigned __int16 v105 = v99 + 4;
                *(_WORD *)(a1 + 12) = v105;
                LOBYTE(ptr[1]) = *(unsigned char *)(v104 + v103);
                if (*(unsigned __int16 *)(a1 + 10) - v105 <= 1)
                {
                  *uint64_t v2 = 1;
                  goto LABEL_172;
                }
                WORD1(ptr[2]) = *(_WORD *)(*(void *)a1 + v105);
                unsigned __int16 v106 = v105 + 2;
                *(_WORD *)(a1 + 12) = v105 + 2;
                if (*(unsigned __int16 *)(a1 + 10) <= (unsigned __int16)(v105 + 2))
                {
                  *uint64_t v2 = 1;
                  goto LABEL_173;
                }
                uint64_t v107 = *(void *)a1;
                unsigned __int16 v108 = v105 + 3;
                *(_WORD *)(a1 + 12) = v108;
                BYTE4(ptr[2]) = *(unsigned char *)(v107 + v106);
                if (*(unsigned __int16 *)(a1 + 10) - v108 >= 6)
                {
                  sub_100008A18((uint64_t)&ptr[2] + 5, *(void *)a1 + v108, 6uLL);
                  *(_WORD *)(a1 + 12) += 6;
                  goto LABEL_175;
                }
LABEL_174:
                *uint64_t v2 = 1;
LABEL_175:
                if ((v59 & 2) == 0) {
                  goto LABEL_187;
                }
                if (*(unsigned char *)(a1 + 14) != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2427, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v115 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v115 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2428, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_185;
                }
                uint64_t v116 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v116)
                {
                  *uint64_t v2 = 1;
LABEL_185:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  goto LABEL_186;
                }
                uint64_t v117 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v116 + 1;
                BYTE1(size[0]) = *(unsigned char *)(v117 + v116);
                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v116 + 1) >= 6)
                {
                  sub_100008A18((uint64_t)size + 2, *(void *)a1 + (unsigned __int16)(v116 + 1), 6uLL);
                  *(_WORD *)(a1 + 12) += 6;
                  goto LABEL_187;
                }
LABEL_186:
                *uint64_t v2 = 1;
LABEL_187:
                int v118 = *(unsigned __int8 *)(a1 + 14);
                if ((v59 & 8) == 0) {
                  goto LABEL_200;
                }
                if (v118 != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2432, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v119 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v119 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2433, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_197;
                }
                uint64_t v120 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v120)
                {
                  *uint64_t v2 = 1;
LABEL_197:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v125 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v125 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2434, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_198;
                }
                uint64_t v121 = *(void *)a1;
                uint64_t v122 = v120 + 1;
                *(_WORD *)(a1 + 12) = v120 + 1;
                BYTE8(v406) = *(unsigned char *)(v121 + v120);
                if (*(unsigned __int16 *)(a1 + 10) > (v120 + 1))
                {
                  uint64_t v123 = *(void *)a1;
                  unsigned __int16 v124 = v120 + 2;
                  *(_WORD *)(a1 + 12) = v124;
                  BYTE9(v406) = *(unsigned char *)(v123 + v122);
                  if (*(unsigned __int16 *)(a1 + 10) - v124 >= 2)
                  {
                    WORD5(v406) = *(_WORD *)(*(void *)a1 + v124);
                    *(_WORD *)(a1 + 12) = v124 + 2;
                    goto LABEL_201;
                  }
                  int v118 = 1;
                  goto LABEL_199;
                }
                *uint64_t v2 = 1;
LABEL_198:
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v118 = *(unsigned __int8 *)(a1 + 14);
LABEL_199:
                *uint64_t v2 = 1;
LABEL_200:
                if (v118 != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2437, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
LABEL_201:
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v126 = *(unsigned __int16 *)(a1 + 12);
                  if (*(unsigned __int16 *)(a1 + 10) > v126)
                  {
                    uint64_t v127 = *(void *)a1;
                    *(_WORD *)(a1 + 12) = v126 + 1;
                    size_t v128 = *(unsigned __int8 *)(v127 + v126);
                    LOWORD(size[1]) = *(unsigned __int8 *)(v127 + v126);
                    goto LABEL_206;
                  }
                }
                *uint64_t v2 = 1;
                size_t v128 = LOWORD(size[1]);
LABEL_206:
                uint64_t v129 = sub_100022FE8(v128);
                ptr[0] = v129;
                if (v129)
                {
                  uint64_t v130 = LOWORD(size[1]);
                  if (LOWORD(size[1]))
                  {
                    if (*(unsigned char *)(a1 + 14) != 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2440, "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                    uint64_t v131 = v129;
                    uint64_t v132 = *(void *)a1;
                    uint64_t v133 = *(unsigned __int16 *)(a1 + 12);
                    if (*v2)
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v134 = 0;
                    }
                    else
                    {
                      int v134 = *(unsigned __int16 *)(a1 + 10) - v133;
                    }
                    if (v134 >= LOWORD(size[1]))
                    {
                      uint64_t v135 = (char *)(v132 + v133);
                      char v136 = &v131[v130];
                      do
                      {
                        char v137 = *v135++;
                        *v131++ = v137;
                      }
                      while (v131 < v136);
                      *v5 += LOWORD(size[1]);
                    }
                    else
                    {
                      *uint64_t v2 = 1;
                    }
                  }
                }
                sub_10005986C((unsigned __int16 *)size);
                sub_100023010(ptr[0]);
                if (++v63 == v62) {
                  goto LABEL_756;
                }
              }
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_102:
              unsigned int v65 = 0;
              *uint64_t v2 = 1;
              goto LABEL_103;
            }
LABEL_809:
            *uint64_t v2 = 1;
            goto LABEL_810;
          }
          v381 = v2;
          *uint64_t v2 = 1;
        }
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        uint64_t v2 = v381;
        goto LABEL_809;
      case 0xF0:
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          int v167 = *(unsigned __int16 *)(v8 + v9);
          *uint64_t v5 = v4 + 3;
          if (v167 == 768)
          {
            if ((int)(v6 - (unsigned __int16)(v4 + 3)) <= 3) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1483, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
            }
            uint64_t v168 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 3));
            *uint64_t v5 = v4 + 7;
            if (off_100A04F18)
            {
              off_100A04F18(0, v168);
              off_100A04F18 = 0;
            }
          }
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1480, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xF7:
        if (*v2) {
          goto LABEL_811;
        }
        if (v6 <= (unsigned __int16)v9) {
          goto LABEL_812;
        }
        *uint64_t v5 = v4 + 2;
        if (v6 <= (unsigned __int16)(v4 + 2)) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1511, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v138 = *(unsigned __int8 *)(v8 + v9);
        uint64_t v9 = v4 + 3;
        *uint64_t v5 = v4 + 3;
        if (v6 <= (unsigned __int16)(v4 + 3)) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1512, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        int v139 = *(unsigned __int8 *)(v8 + v4 + 2);
        *uint64_t v5 = v4 + 4;
        if (!v138 && v139 == 146) {
          goto LABEL_231;
        }
        goto LABEL_756;
      case 0xFA:
        v169 = (void (*)(void))off_100A04FF0;
        if (!off_100A04FF0) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          goto LABEL_901;
        }
        if (v6 <= (unsigned __int16)v9) {
LABEL_901:
        }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1809, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        goto LABEL_401;
      case 0xFB:
        unsigned int v53 = (void (*)(uint64_t, uint64_t))qword_100A04FD8;
        if (!qword_100A04FD8) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v170 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v170 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1768, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          goto LABEL_300;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1767, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xFD:
        unsigned int v53 = (void (*)(uint64_t, uint64_t))qword_100A04FD0;
        if (!qword_100A04FD0) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v171 = v8 + v9;
          int v172 = *(unsigned __int8 *)(v8 + v9);
          int v173 = *(unsigned __int8 *)(v171 + 1);
          *uint64_t v5 = v4 + 3;
          if ((int)(v6 - (unsigned __int16)(v4 + 3)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1754, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v153 = v172 | (v173 << 8);
          uint64_t v154 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 3));
          *uint64_t v5 = v4 + 7;
          goto LABEL_301;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1753, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0xFE:
        unsigned int v53 = (void (*)(uint64_t, uint64_t))qword_100A04FC8;
        if (!qword_100A04FC8) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v140 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v140 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1739, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          goto LABEL_300;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1738, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      default:
        switch(*(unsigned char *)(v8 + v4))
        {
          case 0xB5:
            if (*v2)
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (v6 > (unsigned __int16)v9)
            {
              *uint64_t v5 = v4 + 2;
              if (v6 <= (unsigned __int16)(v4 + 2)) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1641, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              }
              uint64_t v22 = *(unsigned __int8 *)(v8 + v9);
              *uint64_t v5 = v4 + 3;
              if (v6 <= (unsigned __int16)(v4 + 3)) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1642, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              }
              uint64_t v23 = *(unsigned __int8 *)(v8 + v4 + 2);
              *uint64_t v5 = v4 + 4;
              if (off_100A04FB8) {
                off_100A04FB8(v22, v23, *(unsigned __int8 *)(v8 + v4 + 3), v8 + v4 + 4, (v6 - (v4 + 4)));
              }
              goto LABEL_756;
            }
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1640, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          case 0xB6:
          case 0xB7:
          case 0xBA:
          case 0xBC:
          case 0xBD:
          case 0xBE:
          case 0xBF:
            goto LABEL_756;
          case 0xB8:
            int v156 = (void (*)(uint64_t, uint64_t))off_100A05020;
            if (!off_100A05020) {
              goto LABEL_756;
            }
            if (!*v2) {
              goto LABEL_450;
            }
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            unsigned __int8 v174 = 0;
            int v156 = (void (*)(uint64_t, uint64_t))off_100A05020;
            uint64_t v8 = *(void *)a1;
            LOWORD(v9) = *(_WORD *)(a1 + 12);
            goto LABEL_451;
          case 0xB9:
            v175 = (void (*)(uint64_t))off_100A05048;
            if (!off_100A05048) {
              goto LABEL_756;
            }
            goto LABEL_396;
          case 0xBB:
            v175 = (void (*)(uint64_t))qword_100A05060;
            if (!qword_100A05060) {
              goto LABEL_756;
            }
            goto LABEL_396;
          case 0xC0:
            if (!off_100A05068) {
              goto LABEL_756;
            }
            if (*v2)
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              __int16 v176 = ((uint64_t (*)(void, void))off_100A05068)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12), 0);
            }
            else
            {
              __int16 v176 = ((uint64_t (*)(uint64_t, void))off_100A05068)(v8 + (unsigned __int16)v9, (v6 - v9));
            }
            unsigned __int16 v262 = *v5 + v176;
            *uint64_t v5 = v262;
            if (*v2) {
              goto LABEL_499;
            }
            if (*(unsigned __int16 *)(a1 + 10) != v262) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1614, "ByteStream_NumReadBytesAvail(*pBs) == 0");
            }
            return;
          case 0xC1:
            if (*v2)
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (v6 > (unsigned __int16)v9)
            {
              *uint64_t v5 = v4 + 2;
              if ((int)v6 - ((int)v4 + 2) <= 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1377, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              int v177 = *(unsigned __int8 *)(v8 + v9);
              int v178 = *(unsigned __int16 *)(v8 + v4 + 2);
              *uint64_t v5 = v4 + 4;
              v179 = sub_100197864(v178);
              if (*v2)
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else
              {
                int v180 = *(unsigned __int16 *)(a1 + 10);
                uint64_t v181 = *(unsigned __int16 *)(a1 + 12);
                if (v180 - (int)v181 > 3)
                {
                  if (*(unsigned char *)(a1 + 14) == 1)
                  {
                    uint64_t v182 = *(void *)a1;
                    uint64_t v183 = *(unsigned int *)(*(void *)a1 + v181);
                    *(_WORD *)(a1 + 12) = v181 + 4;
                    if (v180 - (unsigned __int16)(v181 + 4) <= 3) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1380, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                    }
                    uint64_t v184 = *(unsigned int *)(v182 + (unsigned __int16)(v181 + 4));
                    *uint64_t v5 = v181 + 8;
                    if (v180 - (unsigned __int16)(v181 + 8) <= 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1381, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                    }
                    unsigned __int16 v185 = *(_WORD *)(v182 + (unsigned __int16)(v181 + 8));
                    *uint64_t v5 = v181 + 10;
                    if (v180 - (unsigned __int16)(v181 + 10) <= 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1382, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
                    }
                    v186 = v179;
                    unsigned __int8 v187 = *(unsigned char *)(v182 + (unsigned __int16)(v181 + 10));
                    *uint64_t v5 = v181 + 12;
                    if ((v187 & (v177 == 10)) != 0) {
                      LOBYTE(v177) = -118;
                    }
                    LODWORD(size[0]) = 0;
                    *(_DWORD *)int buf = 0;
                    sub_10010BB74(size, (__darwin_suseconds_t *)buf);
                    BOOL v189 = v177 != 1 && v177 != 0 && v186 == 0;
                    if (v189 || v177 == 10)
                    {
                      if (sub_100058654())
                      {
                        sub_100056E24((uint64_t)"updateBTControllerClockCB size is zero", v230, v231, v232, v233, v234, v235, v236, v390);
                        v237 = sub_100050B4C(0x54u);
                        if (os_log_type_enabled(v237, OS_LOG_TYPE_ERROR)) {
                          sub_100744F6C();
                        }
                      }
                    }
                    else if (off_100A05078)
                    {
                      off_100A05078(v186, v177, v183, v184, v185, LODWORD(size[0]), *(unsigned int *)buf);
                    }
                    goto LABEL_756;
                  }
                  v383 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_825:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1379, v383);
                }
              }
              v383 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
              goto LABEL_825;
            }
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1376, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          default:
            switch(*(unsigned char *)(v8 + v4))
            {
              case 0xCD:
                size[0] = 0;
                size[1] = 0;
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if ((int)(v6 - (unsigned __int16)v9) > 1)
                {
                  int v33 = *(unsigned __int16 *)(v8 + v9);
                  *uint64_t v5 = v4 + 3;
                  __int16 v34 = sub_100197864(v33);
                  if (*v2)
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    unsigned int v35 = *(unsigned __int16 *)(a1 + 10);
                    int v36 = *(unsigned __int16 *)(a1 + 12);
                    if ((int)(v35 - v36) > 3)
                    {
                      if (*(unsigned char *)(a1 + 14) == 1)
                      {
                        uint64_t v37 = *(void *)a1;
                        *(_WORD *)(a1 + 12) = v36 + 4;
                        if ((int)(v35 - (unsigned __int16)(v36 + 4)) <= 3) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1426, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                        }
                        *uint64_t v5 = v36 + 8;
                        if ((int)(v35 - (unsigned __int16)(v36 + 8)) <= 3) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1427, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                        }
                        *uint64_t v5 = v36 + 12;
                        if ((int)(v35 - (unsigned __int16)(v36 + 12)) <= 3) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1428, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
                        }
                        uint64_t v38 = 0;
                        unsigned __int16 v39 = v36 + 16;
                        *uint64_t v5 = v36 + 16;
                        BOOL v40 = v35 >= (unsigned __int16)(v36 + 16);
                        unsigned int v41 = v35 - (unsigned __int16)(v36 + 16);
                        if (v40) {
                          uint64_t v42 = v41;
                        }
                        else {
                          uint64_t v42 = 0;
                        }
                        do
                        {
                          if (v42 == v38) {
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1432, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                          }
                          unsigned __int16 v43 = v39;
                          uint64_t v44 = v39++;
                          *uint64_t v5 = v39;
                          *((unsigned char *)size + v38++) = *(unsigned char *)(v37 + v44);
                        }
                        while (v38 != 16);
                        if (v35 <= v39) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1435, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                        }
                        *uint64_t v5 = v43 + 2;
                        if (v35 <= (unsigned __int16)(v43 + 2)) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1436, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                        }
                        *uint64_t v5 = v43 + 3;
                        if (v35 <= (unsigned __int16)(v43 + 3)) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1437, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                        }
                        *uint64_t v5 = v43 + 4;
                        if ((int)(v35 - (unsigned __int16)(v43 + 4)) <= 1)
                        {
                          *uint64_t v2 = 1;
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else
                        {
                          *uint64_t v5 = v43 + 6;
                          if (v35 > (unsigned __int16)(v43 + 6))
                          {
                            *uint64_t v5 = v43 + 7;
                            if (v34)
                            {
                              if (off_100A05070) {
                                off_100A05070(v34);
                              }
                            }
                            else if (sub_100058654())
                            {
                              sub_100056E24((uint64_t)"updateBTControllerClockCB size is zero", v238, v239, v240, v241, v242, v243, v244, v390);
                              v245 = sub_100050B4C(0x54u);
                              if (os_log_type_enabled(v245, OS_LOG_TYPE_ERROR)) {
                                sub_100744F6C();
                              }
                            }
                            goto LABEL_756;
                          }
                        }
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1439, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                      }
                      v384 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_842:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1425, v384);
                    }
                  }
                  v384 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
                  goto LABEL_842;
                }
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1423, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              case 0xCF:
                v175 = (void (*)(uint64_t))qword_100A04FA8;
                if (!qword_100A04FA8) {
                  goto LABEL_756;
                }
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  uint64_t v222 = 0;
                }
                else
                {
                  uint64_t v222 = v6 - (unsigned __int16)v9;
                  if (v222 == 123)
                  {
                    uint64_t v214 = v8 + (unsigned __int16)v9;
                    goto LABEL_397;
                  }
                }
                if (sub_100058654())
                {
                  sub_100056E24((uint64_t)"BT_VSE_PHY_STATISTIC_DUAL_CORE - Invalid data size %lu", v293, v294, v295, v296, v297, v298, v299, v222);
                  v300 = sub_100050B4C(0x54u);
                  if (os_log_type_enabled(v300, OS_LOG_TYPE_ERROR)) {
                    goto LABEL_718;
                  }
                }
                goto LABEL_756;
              case 0xD5:
                uint64_t v141 = (void (*)(size_t *))qword_100A050E0;
                if (!qword_100A050E0) {
                  goto LABEL_756;
                }
                BYTE1(size[1]) = 0;
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (v6 > (unsigned __int16)v9)
                {
                  *uint64_t v5 = v4 + 2;
                  LOBYTE(size[0]) = *(unsigned char *)(v8 + v9);
                  if (v6 <= (unsigned __int16)(v4 + 2)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2331, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 3;
                  BYTE1(size[0]) = *(unsigned char *)(v8 + v4 + 2);
                  if (v6 <= (unsigned __int16)(v4 + 3)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2332, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 4;
                  BYTE2(size[0]) = *(unsigned char *)(v8 + v4 + 3);
                  if (v6 <= (unsigned __int16)(v4 + 4)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2333, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 5;
                  BYTE3(size[0]) = *(unsigned char *)(v8 + v4 + 4);
                  if (v6 <= (unsigned __int16)(v4 + 5)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2334, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 6;
                  BYTE4(size[0]) = *(unsigned char *)(v8 + v4 + 5);
                  if (v6 <= (unsigned __int16)(v4 + 6)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2335, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 7;
                  BYTE5(size[0]) = *(unsigned char *)(v8 + v4 + 6);
                  if (v6 <= (unsigned __int16)(v4 + 7)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2336, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 8;
                  BYTE6(size[0]) = *(unsigned char *)(v8 + v4 + 7);
                  if (v6 <= (unsigned __int16)(v4 + 8)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2337, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 9;
                  HIBYTE(size[0]) = *(unsigned char *)(v8 + v4 + 8);
                  if (v6 <= (unsigned __int16)(v4 + 9)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2338, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 10;
                  LOBYTE(size[1]) = *(unsigned char *)(v8 + v4 + 9);
                  if (v6 <= (unsigned __int16)(v4 + 10)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2339, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 11;
                  BYTE1(size[1]) = *(unsigned char *)(v8 + v4 + 10);
                  goto LABEL_433;
                }
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2330, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              case 0xD6:
                uint64_t v141 = (void (*)(size_t *))qword_100A050D8;
                if (!qword_100A050D8) {
                  goto LABEL_756;
                }
                if (*v2)
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (v6 > (unsigned __int16)v9)
                {
                  *uint64_t v5 = v4 + 2;
                  LOBYTE(size[0]) = *(unsigned char *)(v8 + v9);
                  if (v6 <= (unsigned __int16)(v4 + 2)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2321, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 3;
                  BYTE1(size[0]) = *(unsigned char *)(v8 + v4 + 2);
                  if (v6 <= (unsigned __int16)(v4 + 3)) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2322, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
                  }
                  *uint64_t v5 = v4 + 4;
                  BYTE2(size[0]) = *(unsigned char *)(v8 + v4 + 3);
                  goto LABEL_433;
                }
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2320, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
              default:
                goto LABEL_756;
            }
        }
    }
  }
  if (*(unsigned __int8 *)(v8 + v4) <= 0x85u)
  {
    switch(*(unsigned char *)(v8 + v4))
    {
      case 0x12:
        if (!off_100A04FF8) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
          if ((int)v6 - ((int)v4 + 2) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1827, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          uint64_t v24 = *(unsigned __int8 *)(v8 + v9);
          unsigned __int16 v25 = *(_WORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 4;
          if (v6 <= (unsigned __int16)(v4 + 4)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1828, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 5;
          if ((int)(v6 - (unsigned __int16)(v4 + 5)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1829, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v26 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4));
          uint64_t v27 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 5));
          *uint64_t v5 = v4 + 9;
          if ((int)(v6 - (unsigned __int16)(v4 + 9)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1830, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v28 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 9));
          *uint64_t v5 = v4 + 13;
          if (v6 <= (unsigned __int16)(v4 + 13)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1831, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 14;
          if (v6 <= (unsigned __int16)(v4 + 14)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1832, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          uint64_t v29 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 13));
          *uint64_t v5 = v4 + 15;
          uint64_t v30 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 14));
          if (v6 - (unint64_t)(unsigned __int16)(v4 + 15) < 2)
          {
            unsigned __int16 v32 = -1;
          }
          else
          {
            uint64_t v31 = (unsigned __int16)(v4 + 15);
            if ((int)v6 - (int)v31 <= 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1834, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
            }
            unsigned __int16 v32 = *(_WORD *)(v8 + v31);
            *uint64_t v5 = v4 + 17;
          }
          uint64_t v246 = v25;
          uint64_t v247 = v32;
          off_100A051C0(v24, v246, v26, v27, v28, v29, v30, v247);
          off_100A04FF8(v24, v246, v26, v27, v28, v29, v30, v247);
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1826, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      case 0x13:
        unsigned __int16 v48 = off_100A05000;
        if (!off_100A05000) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          unsigned __int16 v49 = *(_WORD *)(v8 + v9);
          *uint64_t v5 = v4 + 3;
          if ((int)(v6 - (unsigned __int16)(v4 + 3)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1857, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          unsigned __int16 v50 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 3));
          *uint64_t v5 = v4 + 5;
          if ((int)(v6 - (unsigned __int16)(v4 + 5)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1858, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v51 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 5));
          *uint64_t v5 = v4 + 9;
          if ((int)(v6 - (unsigned __int16)(v4 + 9)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1859, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          uint64_t v52 = *(unsigned int *)(v8 + (unsigned __int16)(v4 + 9));
          *uint64_t v5 = v4 + 13;
          ((void (*)(void, void, uint64_t, uint64_t))v48)(v49, v50, v51, v52);
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1856, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0x14:
        unsigned int v53 = (void (*)(uint64_t, uint64_t))qword_100A05008;
        if (!qword_100A05008) {
          goto LABEL_756;
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if ((int)(v6 - (unsigned __int16)v9) > 1)
        {
          uint64_t v54 = v8 + v9;
          int v55 = *(unsigned __int8 *)(v8 + v9);
          int v56 = *(unsigned __int8 *)(v54 + 1);
          unsigned __int16 v57 = v4 + 3;
          *uint64_t v5 = v4 + 3;
          if (v6 <= (unsigned __int16)(v4 + 3)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1873, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          goto LABEL_300;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1872, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      case 0x15:
      case 0x16:
      case 0x17:
      case 0x18:
      case 0x19:
      case 0x1A:
        goto LABEL_756;
      case 0x1B:
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
LABEL_231:
          if (*(unsigned char *)(v8 + v9) == 3)
          {
            sub_10010CFF0(v8, *(unsigned __int16 *)(a1 + 8));
            if ((byte_100A052B0 & 1) == 0) {
              byte_100A052B0 = 1;
            }
          }
          goto LABEL_756;
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1530, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      default:
        if (v10 != 90)
        {
          if (v10 != 128) {
            goto LABEL_756;
          }
          if (*v2)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if ((int)(v6 - (unsigned __int16)v9) > 1)
          {
            unsigned __int16 v45 = *(_WORD *)(v8 + v9);
            *uint64_t v5 = v4 + 3;
            if (v6 <= (unsigned __int16)(v4 + 3)) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1625, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
            }
            *uint64_t v5 = v4 + 4;
            if (v6 <= (unsigned __int16)(v4 + 4)) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1626, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
            }
            uint64_t v46 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 3));
            *uint64_t v5 = v4 + 5;
            if (off_100A04F50) {
              off_100A04F50(v45, v46, *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 4)));
            }
            goto LABEL_756;
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1624, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        if (*v2)
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (v6 > (unsigned __int16)v9)
        {
          *uint64_t v5 = v4 + 2;
          unsigned int v223 = *(unsigned __int8 *)(v8 + v9);
          if (*(unsigned char *)(v8 + v9))
          {
            int v224 = 0;
            while (!*v2)
            {
              int v225 = *(unsigned __int16 *)(a1 + 10);
              uint64_t v226 = *(unsigned __int16 *)(a1 + 12);
              if (v225 - (int)v226 <= 1) {
                goto LABEL_786;
              }
              if (*(unsigned char *)(a1 + 14) != 1)
              {
                v380 = "(*pBs).__RWFlag == BYTESTREAM_READ";
                goto LABEL_788;
              }
              v227 = (unsigned __int8 *)(*(void *)a1 + v226);
              int v228 = *v227;
              int v229 = v227[1];
              *(_WORD *)(a1 + 12) = v226 + 2;
              if (v225 - (unsigned __int16)(v226 + 2) <= 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1462, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
              }
              *uint64_t v5 = v226 + 4;
              if (sub_100197864(v228 | (v229 << 8)) && off_100A04F20) {
                ((void (*)(void))off_100A04F20)();
              }
              if (++v224 >= v223) {
                goto LABEL_756;
              }
            }
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_786:
            v380 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
LABEL_788:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1461, v380);
          }
LABEL_756:
          if (!*v2) {
            return;
          }
LABEL_810:
          sub_10010B394(136);
LABEL_811:
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_812:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1510, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
        }
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1457, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    }
  }
  switch(*(unsigned char *)(v8 + v4))
  {
    case 0x86:
      long long v415 = 0u;
      memset(v416, 0, 27);
      long long v413 = 0u;
      long long v414 = 0u;
      long long v411 = 0u;
      long long v412 = 0u;
      long long v409 = 0u;
      long long v410 = 0u;
      long long v407 = 0u;
      long long v408 = 0u;
      long long v405 = 0u;
      long long v406 = 0u;
      *(_OWORD *)size = 0u;
      memset(ptr, 0, sizeof(ptr));
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else if ((int)(v6 - (unsigned __int16)v9) > 1)
      {
        *uint64_t v5 = v4 + 3;
        __strlcpy_chk();
        if (sub_100058654())
        {
          sub_100056E24((uint64_t)"controller debug - %s", v14, v15, v16, v17, v18, v19, v20, (uint64_t)size);
          __int16 v21 = sub_100050B4C(0x54u);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
          {
            *(_DWORD *)int buf = 136446210;
            *(void *)&uint8_t buf[4] = sub_100050714();
            _os_log_impl((void *)&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
          }
        }
        goto LABEL_756;
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1680, "ByteStream_NumReadBytesAvail(*pBs) >= (2)");
    case 0x87:
    case 0x89:
    case 0x8A:
    case 0x8B:
    case 0x8D:
    case 0x90:
    case 0x91:
    case 0x92:
    case 0x93:
    case 0x94:
    case 0x95:
    case 0x96:
    case 0x97:
    case 0x98:
    case 0x9C:
    case 0xA0:
    case 0xA1:
      goto LABEL_756;
    case 0x88:
      if (!off_100A04F88) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        __int16 v207 = ((uint64_t (*)(void, void))off_100A04F88)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12), 0);
      }
      else
      {
        __int16 v207 = ((uint64_t (*)(uint64_t, void))off_100A04F88)(v8 + (unsigned __int16)v9, (v6 - v9));
      }
      unsigned __int16 v263 = *v5 + v207;
      *uint64_t v5 = v263;
      if (*v2) {
        goto LABEL_499;
      }
      if (*(unsigned __int16 *)(a1 + 10) != v263) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1572, "ByteStream_NumReadBytesAvail(*pBs) == 0");
      }
      return;
    case 0x8C:
      if (!off_100A050B0) {
        goto LABEL_756;
      }
      long long v405 = 0u;
      long long v406 = 0u;
      *(_OWORD *)size = 0u;
      memset(ptr, 0, sizeof(ptr));
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else if (v6 > (unsigned __int16)v9)
      {
        *uint64_t v5 = v4 + 2;
        if ((int)v6 - ((int)v4 + 2) > 1)
        {
          uint64_t v208 = *(unsigned __int8 *)(v8 + v9);
          unsigned __int16 v209 = *(_WORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 4;
          unsigned __int16 v392 = v209;
          if (v6 <= (unsigned __int16)(v4 + 4))
          {
            *uint64_t v2 = 1;
            memset(v397, 0, 7);
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            *uint64_t v5 = v4 + 5;
            memset(v397, 0, 7);
            if (v6 > (unsigned __int16)(v4 + 5))
            {
              *uint64_t v5 = v4 + 6;
              LOBYTE(v397[0]) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 5));
              uint64_t v210 = LOBYTE(v397[0]);
              BOOL v211 = (v397[0] & 0xFE) == 2;
              if (LOBYTE(v397[0]) == 3)
              {
                uint64_t v210 = 1;
                LOBYTE(v397[0]) = 1;
              }
              else if (LOBYTE(v397[0]) == 2)
              {
                uint64_t v210 = 0;
                LOBYTE(v397[0]) = 0;
              }
              if (*(unsigned char *)(a1 + 14) == 1)
              {
                uint64_t v361 = *(unsigned __int16 *)(a1 + 12);
                BOOL v394 = v211;
                if (*(unsigned __int16 *)(a1 + 10) - (int)v361 >= 6)
                {
                  sub_100008A18((uint64_t)v397 + 1, *(void *)a1 + v361, 6uLL);
                  *(_WORD *)(a1 + 12) += 6;
                  uint64_t v253 = BYTE1(v397[0]);
                  uint64_t v252 = BYTE2(v397[0]);
                  unsigned int v251 = HIBYTE(v397[0]);
                  unsigned int v250 = LOBYTE(v397[1]);
                  unsigned int v249 = BYTE1(v397[1]);
                  unsigned int v248 = BYTE2(v397[1]);
                  uint64_t v210 = LOBYTE(v397[0]);
LABEL_466:
                  *(_DWORD *)((char *)v396 + 3) = 0;
                  v396[0] = 0;
                  if (*(unsigned char *)(a1 + 14) != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2185, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*v2)
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v273 = *(unsigned __int16 *)(a1 + 12);
                    if (*(unsigned __int16 *)(a1 + 10) - (int)v273 >= 6)
                    {
                      sub_100008A18((uint64_t)v396 + 1, *(void *)a1 + v273, 6uLL);
                      *(_WORD *)(a1 + 12) += 6;
                      goto LABEL_507;
                    }
                  }
                  *uint64_t v2 = 1;
LABEL_507:
                  LOBYTE(v396[0]) = 1;
                  ptr[1] = (void *)(((unint64_t)BYTE2(v396[0]) << 32) | ((unint64_t)BYTE1(v396[0]) << 40) | ((unint64_t)HIBYTE(v396[0]) << 24) | ((unint64_t)LOBYTE(v396[1]) << 16) | ((unint64_t)BYTE1(v396[1]) << 8) | BYTE2(v396[1]) | 0x1000000000000);
                  *(_DWORD *)((char *)v395 + 3) = 0;
                  v395[0] = 0;
                  if (*(unsigned char *)(a1 + 14) != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2190, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  unint64_t v274 = (v253 << 40) | (v252 << 32) | ((unint64_t)v251 << 24) | ((unint64_t)v250 << 16) | ((unint64_t)v249 << 8) | v248 | (v210 << 48);
                  if (*v2)
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    BOOL v275 = v394;
                  }
                  else
                  {
                    uint64_t v276 = *(unsigned __int16 *)(a1 + 12);
                    BOOL v275 = v394;
                    if (*(unsigned __int16 *)(a1 + 10) - (int)v276 >= 6)
                    {
                      sub_100008A18((uint64_t)v395 + 1, *(void *)a1 + v276, 6uLL);
                      *(_WORD *)(a1 + 12) += 6;
                      goto LABEL_513;
                    }
                  }
                  *uint64_t v2 = 1;
LABEL_513:
                  unint64_t v277 = (unint64_t)BYTE2(v395[0]) << 32;
                  v278 = (void *)(v277 | ((unint64_t)BYTE1(v395[0]) << 40) | ((unint64_t)HIBYTE(v395[0]) << 24) | ((unint64_t)LOBYTE(v395[1]) << 16) | ((unint64_t)BYTE1(v395[1]) << 8) | BYTE2(v395[1]) | 0x1000000000000);
                  if (v275) {
                    v279 = (void *)(v277 | ((unint64_t)BYTE1(v395[0]) << 40) | ((unint64_t)HIBYTE(v395[0]) << 24) | ((unint64_t)LOBYTE(v395[1]) << 16) | ((unint64_t)BYTE1(v395[1]) << 8) | BYTE2(v395[1]) | 0x1000000000000);
                  }
                  else {
                    v279 = (void *)v274;
                  }
                  if (!v275) {
                    v278 = 0;
                  }
                  ptr[0] = v279;
                  ptr[2] = v278;
                  if (*(unsigned char *)(a1 + 14) != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2196, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  if (*v2)
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v280 = *(unsigned __int8 *)(a1 + 14);
                    *(unsigned char *)(a1 + 15) = 1;
                    if (v280 != 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2197, "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                  }
                  else
                  {
                    uint64_t v281 = *(unsigned __int16 *)(a1 + 12);
                    if (*(unsigned __int16 *)(a1 + 10) - (int)v281 > 1)
                    {
                      LOWORD(ptr[3]) = *(_WORD *)(*(void *)a1 + v281);
                      *(_WORD *)(a1 + 12) = v281 + 2;
                      if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v281 + 2) > 1)
                      {
                        WORD1(ptr[3]) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v281 + 2));
                        *(_WORD *)(a1 + 12) = v281 + 4;
                        if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v281 + 4) > 1)
                        {
                          WORD2(ptr[3]) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v281 + 4));
                          unsigned __int16 v282 = v281 + 6;
                          *(_WORD *)(a1 + 12) = v281 + 6;
                          if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v281 + 6))
                          {
                            uint64_t v283 = *(void *)a1;
                            unsigned __int16 v284 = v281 + 7;
                            *(_WORD *)(a1 + 12) = v284;
                            BYTE6(ptr[3]) = *(unsigned char *)(v283 + v282);
                            if (*(unsigned __int16 *)(a1 + 10) > v284)
                            {
                              uint64_t v285 = v284;
                              uint64_t v286 = *(void *)a1;
                              unsigned __int16 v287 = v284 + 1;
                              *(_WORD *)(a1 + 12) = v287;
                              HIBYTE(ptr[3]) = *(unsigned char *)(v286 + v285);
                              if (*(unsigned __int16 *)(a1 + 10) - v287 > 1)
                              {
                                uint64_t v288 = v287;
                                uint64_t v289 = *(void *)a1;
                                LOWORD(v405) = *(_WORD *)(*(void *)a1 + v288);
                                *(_WORD *)(a1 + 12) = v288 + 2;
                                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v288 + 2) > 1)
                                {
                                  WORD1(v405) = *(_WORD *)(v289 + (unsigned __int16)(v288 + 2));
                                  unsigned __int16 v290 = v288 + 4;
                                  *(_WORD *)(a1 + 12) = v290;
                                  int v291 = 8;
                                  BYTE12(v405) = 8;
                                  int v292 = *(unsigned __int16 *)(a1 + 10) - v290;
LABEL_685:
                                  if (v292 >= v291)
                                  {
                                    __memmove_chk();
                                    unsigned __int16 v328 = *(_WORD *)(a1 + 12) + BYTE12(v405);
                                    *(_WORD *)(a1 + 12) = v328;
                                    if (*(unsigned char *)(a1 + 14) != 1) {
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2208, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                    }
                                    if (*v2)
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                      int v329 = *(unsigned __int8 *)(a1 + 14);
                                      *(unsigned char *)(a1 + 15) = 1;
                                      if (v329 != 1) {
                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2209, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                      }
                                    }
                                    else
                                    {
                                      if (*(unsigned __int16 *)(a1 + 10) > v328)
                                      {
                                        uint64_t v330 = *(void *)a1;
                                        *(_WORD *)(a1 + 12) = v328 + 1;
                                        BYTE13(v405) = *(unsigned char *)(v330 + v328);
                                        if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v328 + 1))
                                        {
                                          uint64_t v331 = *(void *)a1;
                                          *(_WORD *)(a1 + 12) = v328 + 2;
                                          BYTE14(v405) = *(unsigned char *)(v331 + (unsigned __int16)(v328 + 1));
                                          if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v328 + 2) > 1)
                                          {
                                            LOWORD(v406) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v328 + 2));
                                            *(_WORD *)(a1 + 12) = v328 + 4;
                                            if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v328 + 4) > 1)
                                            {
                                              WORD1(v406) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v328 + 4));
                                              *(_WORD *)(a1 + 12) = v328 + 6;
                                              if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v328 + 6) > 1)
                                              {
                                                WORD2(v406) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v328 + 6));
                                                *(_WORD *)(a1 + 12) = v328 + 8;
                                                if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v328 + 8) > 1)
                                                {
                                                  WORD3(v406) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v328 + 8));
                                                  *(_WORD *)(a1 + 12) = v328 + 10;
                                                  if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v328 + 10) >= 2)
                                                  {
                                                    WORD4(v406) = *(_WORD *)(*(void *)a1
                                                                           + (unsigned __int16)(v328 + 10));
                                                    *(_WORD *)(a1 + 12) = v328 + 12;
LABEL_706:
                                                    size[0] = (size_t)sub_100197864(v392);
                                                    long long v400 = *(_OWORD *)&ptr[2];
                                                    long long v401 = v405;
                                                    long long v402 = v406;
                                                    *(_OWORD *)int buf = *(_OWORD *)size;
                                                    long long v399 = *(_OWORD *)ptr;
                                                    off_100A050B0(v208, buf);
                                                    goto LABEL_756;
                                                  }
LABEL_705:
                                                  *uint64_t v2 = 1;
                                                  goto LABEL_706;
                                                }
                                                *uint64_t v2 = 1;
LABEL_704:
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                goto LABEL_705;
                                              }
                                              *uint64_t v2 = 1;
LABEL_703:
                                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetoo"
                                                                     "th_base/Stack/vsc/bcm/bcm_vsc.c");
                                              int v336 = *(unsigned __int8 *)(a1 + 14);
                                              *(unsigned char *)(a1 + 15) = 1;
                                              if (v336 != 1) {
                                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2214, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                              }
                                              goto LABEL_704;
                                            }
                                            *uint64_t v2 = 1;
LABEL_702:
                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth"
                                                                   "_base/Stack/vsc/bcm/bcm_vsc.c");
                                            int v335 = *(unsigned __int8 *)(a1 + 14);
                                            *(unsigned char *)(a1 + 15) = 1;
                                            if (v335 != 1) {
                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2213, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                            }
                                            goto LABEL_703;
                                          }
                                          *uint64_t v2 = 1;
LABEL_701:
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                          int v334 = *(unsigned __int8 *)(a1 + 14);
                                          *(unsigned char *)(a1 + 15) = 1;
                                          if (v334 != 1) {
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2212, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                          }
                                          goto LABEL_702;
                                        }
                                        *uint64_t v2 = 1;
LABEL_700:
                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                        int v333 = *(unsigned __int8 *)(a1 + 14);
                                        *(unsigned char *)(a1 + 15) = 1;
                                        if (v333 != 1) {
                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2211, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                        }
                                        goto LABEL_701;
                                      }
                                      *uint64_t v2 = 1;
                                    }
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                    int v332 = *(unsigned __int8 *)(a1 + 14);
                                    *(unsigned char *)(a1 + 15) = 1;
                                    if (v332 != 1) {
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2210, "(*pBs).__RWFlag == BYTESTREAM_READ");
                                    }
                                    goto LABEL_700;
                                  }
                                  v385 = "ByteStream_NumReadBytesAvail(*pBs) >= (params.featuresLength)";
LABEL_924:
                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2206, v385);
                                }
                                *uint64_t v2 = 1;
                                BYTE12(v405) = 8;
LABEL_684:
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                                int v292 = 0;
                                int v291 = BYTE12(v405);
                                goto LABEL_685;
                              }
                              *uint64_t v2 = 1;
LABEL_683:
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v327 = *(unsigned __int8 *)(a1 + 14);
                              *(unsigned char *)(a1 + 15) = 1;
                              BYTE12(v405) = 8;
                              if (v327 != 1)
                              {
                                v385 = "(*pBs).__RWFlag == BYTESTREAM_READ";
                                goto LABEL_924;
                              }
                              goto LABEL_684;
                            }
                            *uint64_t v2 = 1;
LABEL_682:
                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            int v326 = *(unsigned __int8 *)(a1 + 14);
                            *(unsigned char *)(a1 + 15) = 1;
                            if (v326 != 1) {
                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2203, "(*pBs).__RWFlag == BYTESTREAM_READ");
                            }
                            goto LABEL_683;
                          }
                          *uint64_t v2 = 1;
LABEL_681:
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v325 = *(unsigned __int8 *)(a1 + 14);
                          *(unsigned char *)(a1 + 15) = 1;
                          if (v325 != 1) {
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2202, "(*pBs).__RWFlag == BYTESTREAM_READ");
                          }
                          goto LABEL_682;
                        }
                        *uint64_t v2 = 1;
LABEL_680:
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        int v324 = *(unsigned __int8 *)(a1 + 14);
                        *(unsigned char *)(a1 + 15) = 1;
                        if (v324 != 1) {
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2201, "(*pBs).__RWFlag == BYTESTREAM_READ");
                        }
                        goto LABEL_681;
                      }
                      *uint64_t v2 = 1;
LABEL_679:
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v323 = *(unsigned __int8 *)(a1 + 14);
                      *(unsigned char *)(a1 + 15) = 1;
                      if (v323 != 1) {
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2199, "(*pBs).__RWFlag == BYTESTREAM_READ");
                      }
                      goto LABEL_680;
                    }
                    *uint64_t v2 = 1;
                  }
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v322 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v322 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2198, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_679;
                }
LABEL_465:
                unsigned int v248 = 0;
                unsigned int v249 = 0;
                unsigned int v250 = 0;
                unsigned int v251 = 0;
                uint64_t v252 = 0;
                uint64_t v253 = 0;
                *uint64_t v2 = 1;
                goto LABEL_466;
              }
              goto LABEL_922;
            }
          }
          *(unsigned char *)(a1 + 15) = 1;
          if (*(unsigned char *)(a1 + 14) == 1)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            BOOL v394 = 0;
            uint64_t v210 = 0;
            goto LABEL_465;
          }
LABEL_922:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2181, "(*pBs).__RWFlag == BYTESTREAM_READ");
        }
LABEL_914:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2162, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      *uint64_t v2 = 1;
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      goto LABEL_914;
    case 0x8E:
      if (!off_100A04FA0) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        unint64_t v212 = 0;
      }
      else
      {
        unint64_t v212 = v6 - (unsigned __int16)v9;
      }
      if (v212 > 0xCD || v212 == 39)
      {
        off_100A04FA0(*(void *)a1 + *(unsigned __int16 *)(a1 + 12), v7);
        goto LABEL_756;
      }
      if (sub_100058654())
      {
        sub_100056E24((uint64_t)"BT_VSE_PHY_STATISTIC - Invalid data size %lu", v264, v265, v266, v267, v268, v269, v270, v212);
        v271 = sub_100050B4C(0x54u);
        if (os_log_type_enabled(v271, OS_LOG_TYPE_ERROR)) {
          goto LABEL_718;
        }
      }
      goto LABEL_756;
    case 0x8F:
      if (!off_100A04F90) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        __int16 v213 = ((uint64_t (*)(void, void))off_100A04F90)(*(void *)a1 + *(unsigned __int16 *)(a1 + 12), 0);
      }
      else
      {
        __int16 v213 = ((uint64_t (*)(uint64_t, void))off_100A04F90)(v8 + (unsigned __int16)v9, (v6 - v9));
      }
      unsigned __int16 v272 = *v5 + v213;
      *uint64_t v5 = v272;
      if (*v2)
      {
LABEL_499:
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        goto LABEL_756;
      }
      if (*(unsigned __int16 *)(a1 + 10) != v272) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1586, "ByteStream_NumReadBytesAvail(*pBs) == 0");
      }
      return;
    case 0x99:
      int v156 = (void (*)(uint64_t, uint64_t))qword_100A05030;
      if (!qword_100A05030) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        unsigned __int8 v174 = 0;
        uint64_t v8 = *(void *)a1;
        LOWORD(v9) = *(_WORD *)(a1 + 12);
        int v156 = (void (*)(uint64_t, uint64_t))qword_100A05030;
      }
      else
      {
LABEL_450:
        unsigned __int8 v174 = v6 - v9;
      }
LABEL_451:
      uint64_t v190 = v8 + (unsigned __int16)v9;
      a2 = v174;
      goto LABEL_461;
    case 0x9A:
      v175 = (void (*)(uint64_t))qword_100A05050;
      if (qword_100A05050) {
        goto LABEL_396;
      }
      goto LABEL_756;
    case 0x9B:
      v175 = (void (*)(uint64_t))qword_100A05038;
      if (!qword_100A05038) {
        goto LABEL_756;
      }
LABEL_396:
      uint64_t v214 = v8 + (unsigned __int16)v9;
LABEL_397:
      v175(v214);
      goto LABEL_756;
    case 0x9D:
      int v156 = (void (*)(uint64_t, uint64_t))qword_100A04FB0;
      if (!qword_100A04FB0) {
        goto LABEL_756;
      }
      uint64_t v190 = v8 + (unsigned __int16)v9;
      goto LABEL_461;
    case 0x9E:
      if (v6 <= (unsigned __int16)v9) {
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1961, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
      }
      uint64_t v191 = v4 + 2;
      *uint64_t v5 = v4 + 2;
      switch(*(unsigned char *)(v8 + v9))
      {
        case 0:
          if (!qword_100A05080) {
            goto LABEL_756;
          }
          size[0] = 0;
          size[1] = 0;
          LOWORD(ptr[0]) = 0;
          if (*(unsigned char *)(a1 + 14) != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1969, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          if (*v2)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v192 = *(unsigned __int8 *)(a1 + 14);
            *(unsigned char *)(a1 + 15) = 1;
            if (v192 != 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1970, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }
            goto LABEL_730;
          }
          if ((int)v6 - (int)v191 <= 1)
          {
            *uint64_t v2 = 1;
LABEL_730:
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            goto LABEL_731;
          }
          LOWORD(size[0]) = *(_WORD *)(*(void *)a1 + v191);
          *(_WORD *)(a1 + 12) = v4 + 4;
          if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 4) >= 6)
          {
            sub_100008A18((uint64_t)size + 2, *(void *)a1 + (unsigned __int16)(v4 + 4), 6uLL);
            *(_WORD *)(a1 + 12) += 6;
            goto LABEL_732;
          }
LABEL_731:
          *uint64_t v2 = 1;
LABEL_732:
          if (*(unsigned char *)(a1 + 14) != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1971, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          if (*v2)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v362 = *(unsigned __int8 *)(a1 + 14);
            *(unsigned char *)(a1 + 15) = 1;
            if (v362 != 1) {
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1972, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }
          }
          else
          {
            uint64_t v363 = *(unsigned __int16 *)(a1 + 12);
            if (*(unsigned __int16 *)(a1 + 10) > v363)
            {
              uint64_t v364 = *(void *)a1;
              *(_WORD *)(a1 + 12) = v363 + 1;
              LOBYTE(size[1]) = *(unsigned char *)(v364 + v363);
              if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v363 + 1))
              {
                uint64_t v365 = *(void *)a1;
                *(_WORD *)(a1 + 12) = v363 + 2;
                BYTE1(size[1]) = *(unsigned char *)(v365 + (unsigned __int16)(v363 + 1));
                if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v363 + 2))
                {
                  uint64_t v366 = *(void *)a1;
                  *(_WORD *)(a1 + 12) = v363 + 3;
                  BYTE2(size[1]) = *(unsigned char *)(v366 + (unsigned __int16)(v363 + 2));
                  if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v363 + 3))
                  {
                    uint64_t v367 = *(void *)a1;
                    *(_WORD *)(a1 + 12) = v363 + 4;
                    BYTE3(size[1]) = *(unsigned char *)(v367 + (unsigned __int16)(v363 + 3));
                    if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v363 + 4) > 1)
                    {
                      uint64_t v368 = (unsigned __int16)(v363 + 4);
                      WORD2(size[1]) = *(_WORD *)(*(void *)a1 + v368);
                      *(_WORD *)(a1 + 12) = v363 + 6;
                      if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v363 + 6) > 1)
                      {
                        HIWORD(size[1]) = *(_WORD *)(*(void *)a1 + (unsigned __int16)(v363 + 6));
                        unsigned __int16 v369 = v363 + 8;
                        *(_WORD *)(a1 + 12) = v368 + 4;
                        if (*(unsigned __int16 *)(a1 + 10) > (unsigned __int16)(v368 + 4))
                        {
                          uint64_t v370 = *(void *)a1;
                          unsigned __int16 v371 = v368 + 5;
                          *(_WORD *)(a1 + 12) = v371;
                          LOBYTE(ptr[0]) = *(unsigned char *)(v370 + v369);
                          if (*(unsigned __int16 *)(a1 + 10) > v371)
                          {
                            uint64_t v372 = *(void *)a1;
                            *(_WORD *)(a1 + 12) = v371 + 1;
                            BYTE1(ptr[0]) = *(unsigned char *)(v372 + v371);
LABEL_754:
                            v307 = (void (*)(size_t *))qword_100A05080;
                            goto LABEL_755;
                          }
LABEL_753:
                          *uint64_t v2 = 1;
                          goto LABEL_754;
                        }
                        *uint64_t v2 = 1;
LABEL_752:
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        goto LABEL_753;
                      }
                      *uint64_t v2 = 1;
LABEL_751:
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v378 = *(unsigned __int8 *)(a1 + 14);
                      *(unsigned char *)(a1 + 15) = 1;
                      if (v378 != 1) {
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1978, "(*pBs).__RWFlag == BYTESTREAM_READ");
                      }
                      goto LABEL_752;
                    }
                    *uint64_t v2 = 1;
LABEL_750:
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v377 = *(unsigned __int8 *)(a1 + 14);
                    *(unsigned char *)(a1 + 15) = 1;
                    if (v377 != 1) {
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1977, "(*pBs).__RWFlag == BYTESTREAM_READ");
                    }
                    goto LABEL_751;
                  }
                  *uint64_t v2 = 1;
LABEL_749:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v376 = *(unsigned __int8 *)(a1 + 14);
                  *(unsigned char *)(a1 + 15) = 1;
                  if (v376 != 1) {
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1976, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }
                  goto LABEL_750;
                }
                *uint64_t v2 = 1;
LABEL_748:
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v375 = *(unsigned __int8 *)(a1 + 14);
                *(unsigned char *)(a1 + 15) = 1;
                if (v375 != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1975, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                goto LABEL_749;
              }
              *uint64_t v2 = 1;
LABEL_747:
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              int v374 = *(unsigned __int8 *)(a1 + 14);
              *(unsigned char *)(a1 + 15) = 1;
              if (v374 != 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1974, "(*pBs).__RWFlag == BYTESTREAM_READ");
              }
              goto LABEL_748;
            }
            *uint64_t v2 = 1;
          }
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          int v373 = *(unsigned __int8 *)(a1 + 14);
          *(unsigned char *)(a1 + 15) = 1;
          if (v373 != 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1973, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
          goto LABEL_747;
        case 1:
          v307 = (void (*)(size_t *))off_100A05088;
          if (!off_100A05088) {
            goto LABEL_756;
          }
          int v417 = 0;
          memset(v416, 0, sizeof(v416));
          long long v414 = 0u;
          long long v415 = 0u;
          long long v412 = 0u;
          long long v413 = 0u;
          long long v410 = 0u;
          long long v411 = 0u;
          long long v408 = 0u;
          long long v409 = 0u;
          long long v406 = 0u;
          long long v407 = 0u;
          long long v405 = 0u;
          *(_OWORD *)size = 0u;
          memset(ptr, 0, sizeof(ptr));
          if ((int)(v6 - (unsigned __int16)v191) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1993, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 2));
          *uint64_t v5 = v4 + 6;
          if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1994, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 6));
          *uint64_t v5 = v4 + 10;
          if ((int)(v6 - (unsigned __int16)(v4 + 10)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1995, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 10));
          *uint64_t v5 = v4 + 14;
          if ((int)(v6 - (unsigned __int16)(v4 + 14)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1996, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 14));
          *uint64_t v5 = v4 + 18;
          if ((int)(v6 - (unsigned __int16)(v4 + 18)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1997, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 18));
          *uint64_t v5 = v4 + 22;
          if ((int)(v6 - (unsigned __int16)(v4 + 22)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1998, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 22));
          *uint64_t v5 = v4 + 26;
          if ((int)(v6 - (unsigned __int16)(v4 + 26)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1999, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 26));
          *uint64_t v5 = v4 + 30;
          if ((int)(v6 - (unsigned __int16)(v4 + 30)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2000, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 30));
          *uint64_t v5 = v4 + 34;
          if ((int)(v6 - (unsigned __int16)(v4 + 34)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2001, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 34));
          *uint64_t v5 = v4 + 38;
          if ((int)(v6 - (unsigned __int16)(v4 + 38)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2002, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 38));
          *uint64_t v5 = v4 + 42;
          int v308 = v6 - (unsigned __int16)(v4 + 42);
          if ((v308 & 0x1FFFE) == 0) {
            goto LABEL_755;
          }
          if (v308 <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2006, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 42));
          *uint64_t v5 = v4 + 46;
          if ((int)(v6 - (unsigned __int16)(v4 + 46)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2007, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 46));
          *uint64_t v5 = v4 + 50;
          if ((int)(v6 - (unsigned __int16)(v4 + 50)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2008, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v405) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 50));
          *uint64_t v5 = v4 + 54;
          if ((int)(v6 - (unsigned __int16)(v4 + 54)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2009, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v405) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 54));
          *uint64_t v5 = v4 + 58;
          if ((int)(v6 - (unsigned __int16)(v4 + 58)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2010, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v405) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 58));
          *uint64_t v5 = v4 + 62;
          if ((int)(v6 - (unsigned __int16)(v4 + 62)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2011, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v405) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 62));
          *uint64_t v5 = v4 + 66;
          if ((int)(v6 - (unsigned __int16)(v4 + 66)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2012, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v406) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 66));
          *uint64_t v5 = v4 + 70;
          if ((int)(v6 - (unsigned __int16)(v4 + 70)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2013, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v406) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 70));
          *uint64_t v5 = v4 + 74;
          if ((int)(v6 - (unsigned __int16)(v4 + 74)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2014, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v406) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 74));
          *uint64_t v5 = v4 + 78;
          if ((int)(v6 - (unsigned __int16)(v4 + 78)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2016, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v406) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 78));
          *uint64_t v5 = v4 + 82;
          if ((int)(v6 - (unsigned __int16)(v4 + 82)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2017, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v407) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 82));
          *uint64_t v5 = v4 + 86;
          if ((int)(v6 - (unsigned __int16)(v4 + 86)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2018, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v407) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 86));
          *uint64_t v5 = v4 + 90;
          if ((int)(v6 - (unsigned __int16)(v4 + 90)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2019, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v407) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 90));
          *uint64_t v5 = v4 + 94;
          if ((int)(v6 - (unsigned __int16)(v4 + 94)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2020, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v407) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 94));
          *uint64_t v5 = v4 + 98;
          if ((int)(v6 - (unsigned __int16)(v4 + 98)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2021, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v408) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 98));
          *uint64_t v5 = v4 + 102;
          if ((int)(v6 - (unsigned __int16)(v4 + 102)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2022, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v408) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 102));
          *uint64_t v5 = v4 + 106;
          if ((int)(v6 - (unsigned __int16)(v4 + 106)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2023, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v408) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 106));
          *uint64_t v5 = v4 + 110;
          if ((int)(v6 - (unsigned __int16)(v4 + 110)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2024, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v408) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 110));
          *uint64_t v5 = v4 + 114;
          if ((int)(v6 - (unsigned __int16)(v4 + 114)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2025, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v409) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 114));
          *uint64_t v5 = v4 + 118;
          if ((int)(v6 - (unsigned __int16)(v4 + 118)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2026, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v409) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 118));
          *uint64_t v5 = v4 + 122;
          if ((int)(v6 - (unsigned __int16)(v4 + 122)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2027, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v409) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 122));
          *uint64_t v5 = v4 + 126;
          if ((int)(v6 - (unsigned __int16)(v4 + 126)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2028, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v409) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 126));
          *uint64_t v5 = v4 + 130;
          if ((int)(v6 - (unsigned __int16)(v4 + 130)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2029, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 130));
          *uint64_t v5 = v4 + 134;
          if ((int)(v6 - (unsigned __int16)(v4 + 134)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2030, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 134));
          *uint64_t v5 = v4 + 138;
          if ((int)(v6 - (unsigned __int16)(v4 + 138)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2031, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 138));
          *uint64_t v5 = v4 + 142;
          if ((int)(v6 - (unsigned __int16)(v4 + 142)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2032, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v410) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 142));
          *uint64_t v5 = v4 + 146;
          if ((int)(v6 - (unsigned __int16)(v4 + 146)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2033, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 146));
          *uint64_t v5 = v4 + 150;
          if ((int)(v6 - (unsigned __int16)(v4 + 150)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2034, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 150));
          *uint64_t v5 = v4 + 154;
          if ((int)(v6 - (unsigned __int16)(v4 + 154)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2035, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 154));
          *uint64_t v5 = v4 + 158;
          if ((int)(v6 - (unsigned __int16)(v4 + 158)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2036, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v411) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 158));
          *uint64_t v5 = v4 + 162;
          if ((int)(v6 - (unsigned __int16)(v4 + 162)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2037, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 162));
          *uint64_t v5 = v4 + 166;
          if ((int)(v6 - (unsigned __int16)(v4 + 166)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2038, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 166));
          *uint64_t v5 = v4 + 170;
          if ((int)(v6 - (unsigned __int16)(v4 + 170)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2039, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v412) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 170));
          *uint64_t v5 = v4 + 174;
          if ((int)(v6 - (unsigned __int16)(v4 + 174)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2040, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          HIDWORD(v412) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 174));
          *uint64_t v5 = v4 + 176;
          if ((int)(v6 - (unsigned __int16)(v4 + 176)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2041, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          LODWORD(v413) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 176));
          *uint64_t v5 = v4 + 178;
          if ((int)(v6 - (unsigned __int16)(v4 + 178)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2042, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD1(v413) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 178));
          *uint64_t v5 = v4 + 180;
          if ((int)(v6 - (unsigned __int16)(v4 + 180)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2043, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD2(v413) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 180));
          *uint64_t v5 = v4 + 182;
          if ((int)(v6 - (unsigned __int16)(v4 + 182)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2044, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v413) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 182));
          *uint64_t v5 = v4 + 186;
          if ((int)(v6 - (unsigned __int16)(v4 + 186)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2045, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(v414) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 186));
          *uint64_t v5 = v4 + 190;
          if ((int)(v6 - (unsigned __int16)(v4 + 190)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2046, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD1(v414) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 190));
          *uint64_t v5 = v4 + 192;
          if ((int)(v6 - (unsigned __int16)(v4 + 192)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2047, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          DWORD2(v414) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 192));
          *uint64_t v5 = v4 + 194;
          if ((int)(v6 - (unsigned __int16)(v4 + 194)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2048, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          HIDWORD(v414) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 194));
          *uint64_t v5 = v4 + 196;
          if ((int)(v6 - (unsigned __int16)(v4 + 196)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2049, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          LODWORD(v415) = *(unsigned __int16 *)(v8 + (unsigned __int16)(v4 + 196));
          *uint64_t v5 = v4 + 198;
          if ((int)(v6 - (unsigned __int16)(v4 + 198)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2050, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD1(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 198));
          *uint64_t v5 = v4 + 202;
          if ((int)(v6 - (unsigned __int16)(v4 + 202)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2051, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          DWORD2(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 202));
          *uint64_t v5 = v4 + 206;
          if ((int)(v6 - (unsigned __int16)(v4 + 206)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2052, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(v415) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 206));
          *uint64_t v5 = v4 + 210;
          if ((int)(v6 - (unsigned __int16)(v4 + 210)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2053, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[0] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 210));
          *uint64_t v5 = v4 + 214;
          if ((int)(v6 - (unsigned __int16)(v4 + 214)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2054, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[1] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 214));
          *uint64_t v5 = v4 + 218;
          if ((int)(v6 - (unsigned __int16)(v4 + 218)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2055, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[2] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 218));
          *uint64_t v5 = v4 + 222;
          if ((int)(v6 - (unsigned __int16)(v4 + 222)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2056, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[3] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 222));
          *uint64_t v5 = v4 + 226;
          if ((int)(v6 - (unsigned __int16)(v4 + 226)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2057, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[4] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 226));
          *uint64_t v5 = v4 + 230;
          if ((int)(v6 - (unsigned __int16)(v4 + 230)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2058, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[5] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 230));
          *uint64_t v5 = v4 + 234;
          if ((int)(v6 - (unsigned __int16)(v4 + 234)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2059, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[6] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 234));
          *uint64_t v5 = v4 + 238;
          if ((int)(v6 - (unsigned __int16)(v4 + 238)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2060, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          v416[7] = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 238));
          *uint64_t v5 = v4 + 242;
          if (*v2)
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (*(unsigned __int16 *)(a1 + 10) - (unsigned __int16)(v4 + 242) > 3)
          {
            if (*(unsigned char *)(a1 + 14) == 1)
            {
              int v417 = *(_DWORD *)(*(void *)a1 + (unsigned __int16)(v4 + 242));
              *(_WORD *)(a1 + 12) = v4 + 246;
LABEL_755:
              v307(size);
              goto LABEL_756;
            }
            v388 = "(*pBs).__RWFlag == BYTESTREAM_READ";
LABEL_1068:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2061, v388);
          }
          v388 = "ByteStream_NumReadBytesAvail(*pBs) >= 4";
          goto LABEL_1068;
        case 2:
          v307 = (void (*)(size_t *))qword_100A050A0;
          if (!qword_100A050A0) {
            goto LABEL_756;
          }
          LODWORD(ptr[2]) = 0;
          if ((int)(v6 - (unsigned __int16)v191) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2098, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 2));
          *uint64_t v5 = v4 + 6;
          if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2099, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 6));
          *uint64_t v5 = v4 + 10;
          if ((int)(v6 - (unsigned __int16)(v4 + 10)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2100, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 10));
          *uint64_t v5 = v4 + 14;
          if ((int)(v6 - (unsigned __int16)(v4 + 14)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2101, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 14));
          *uint64_t v5 = v4 + 18;
          if ((int)(v6 - (unsigned __int16)(v4 + 18)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2102, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 18));
          *uint64_t v5 = v4 + 22;
          if ((int)(v6 - (unsigned __int16)(v4 + 22)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2103, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 22));
          *uint64_t v5 = v4 + 26;
          if ((int)(v6 - (unsigned __int16)(v4 + 26)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2104, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 26));
          *uint64_t v5 = v4 + 30;
          if ((int)(v6 - (unsigned __int16)(v4 + 30)) <= 3) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2105, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
          }
          HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 30));
          *uint64_t v5 = v4 + 34;
          if (v6 <= (unsigned __int16)(v4 + 34)) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2106, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
          }
          *uint64_t v5 = v4 + 35;
          LOBYTE(ptr[2]) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 34));
          goto LABEL_755;
        case 3:
          v307 = (void (*)(size_t *))qword_100A05090;
          if (!qword_100A05090) {
            goto LABEL_756;
          }
          *(_OWORD *)size = 0u;
          memset(ptr, 0, 28);
          if (v6 <= (unsigned __int16)v191)
          {
            *uint64_t v2 = 1;
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            *uint64_t v5 = v4 + 3;
            LOBYTE(size[0]) = *(unsigned char *)(v8 + (unsigned __int16)(v4 + 2));
            if ((int)v6 - ((int)v4 + 3) > 3)
            {
              HIDWORD(size[0]) = *(_DWORD *)(v8 + v4 + 3);
              *uint64_t v5 = v4 + 7;
              if ((int)(v6 - (unsigned __int16)(v4 + 7)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2079, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 7));
              *uint64_t v5 = v4 + 11;
              if ((int)(v6 - (unsigned __int16)(v4 + 11)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2080, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(size[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 11));
              *uint64_t v5 = v4 + 15;
              if ((int)(v6 - (unsigned __int16)(v4 + 15)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2081, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 15));
              *uint64_t v5 = v4 + 19;
              if ((int)(v6 - (unsigned __int16)(v4 + 19)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2082, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(ptr[0]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 19));
              *uint64_t v5 = v4 + 23;
              if ((int)(v6 - (unsigned __int16)(v4 + 23)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2083, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 23));
              *uint64_t v5 = v4 + 27;
              if ((int)(v6 - (unsigned __int16)(v4 + 27)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2084, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(ptr[1]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 27));
              *uint64_t v5 = v4 + 31;
              if ((int)(v6 - (unsigned __int16)(v4 + 31)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2085, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 31));
              *uint64_t v5 = v4 + 35;
              if ((int)(v6 - (unsigned __int16)(v4 + 35)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2086, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              HIDWORD(ptr[2]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 35));
              *uint64_t v5 = v4 + 39;
              if ((int)(v6 - (unsigned __int16)(v4 + 39)) <= 3) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2087, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
              }
              LODWORD(ptr[3]) = *(_DWORD *)(v8 + (unsigned __int16)(v4 + 39));
              *uint64_t v5 = v4 + 43;
              goto LABEL_755;
            }
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2078, "ByteStream_NumReadBytesAvail(*pBs) >= 4");
        default:
          goto LABEL_756;
      }
    case 0x9F:
      v169 = (void (*)(void))qword_100A05040;
      if (!qword_100A05040) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else if (v6 > (unsigned __int16)v9)
      {
LABEL_401:
        *uint64_t v5 = v4 + 2;
        v169(*(unsigned __int8 *)(v8 + v9));
        goto LABEL_756;
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1918, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    case 0xA2:
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else if (v6 > (unsigned __int16)v9)
      {
        *uint64_t v5 = v4 + 2;
        if ((int)v6 - ((int)v4 + 2) <= 1) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1549, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v215 = *(_WORD *)(v8 + v4 + 2);
        *uint64_t v5 = v4 + 4;
        if ((int)(v6 - (unsigned __int16)(v4 + 4)) <= 1) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1550, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v216 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 4));
        *uint64_t v5 = v4 + 6;
        if ((int)(v6 - (unsigned __int16)(v4 + 6)) <= 1) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1551, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v217 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 6));
        *uint64_t v5 = v4 + 8;
        if ((int)(v6 - (unsigned __int16)(v4 + 8)) <= 1) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1552, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        unsigned __int16 v218 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 8));
        *uint64_t v5 = v4 + 10;
        if ((int)(v6 - (unsigned __int16)(v4 + 10)) <= 1) {
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1553, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
        }
        v219 = (unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 10));
        int v220 = *v219;
        int v221 = v219[1];
        *uint64_t v5 = v4 + 12;
        if (off_100A04F48) {
          off_100A04F48(v215, v216, v217, v218, v220 | (v221 << 8));
        }
        goto LABEL_756;
      }
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 1548, "ByteStream_NumReadBytesAvail(*pBs) >= 1");
    case 0xA3:
      v193 = off_100A050C8;
      if (!off_100A050C8) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else if (v6 > (unsigned __int16)v9)
      {
        *uint64_t v5 = v4 + 2;
        if ((int)v6 - ((int)v4 + 2) > 1)
        {
          uint64_t v194 = *(unsigned __int8 *)(v8 + v9);
          unsigned __int16 v195 = *(_WORD *)(v8 + v4 + 2);
          *uint64_t v5 = v4 + 4;
          if ((int)(v6 - (unsigned __int16)(v4 + 4)) <= 1) {
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2270, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
          }
          unsigned __int16 v196 = *(_WORD *)(v8 + (unsigned __int16)(v4 + 4));
          *uint64_t v5 = v4 + 6;
          if (v6 <= (unsigned __int16)(v4 + 6))
          {
            uint64_t v197 = 0;
            *uint64_t v2 = 1;
            *(_OWORD *)size = 0u;
            memset(ptr, 0, 24);
          }
          else
          {
            *uint64_t v5 = v4 + 7;
            uint64_t v197 = *(unsigned __int8 *)(v8 + (unsigned __int16)(v4 + 6));
            *(_OWORD *)size = 0u;
            memset(ptr, 0, 24);
            if (v197)
            {
              unsigned __int16 v391 = v195;
              unsigned int v393 = v194;
              v198 = size;
              uint64_t v199 = v197;
              while (1)
              {
                *(_WORD *)&uint8_t buf[4] = 0;
                *(_DWORD *)int buf = 0;
                if (*(unsigned char *)(a1 + 14) != 1) {
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2277, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }
                if (*v2) {
                  break;
                }
                uint64_t v201 = *(unsigned __int16 *)(a1 + 12);
                if (*(unsigned __int16 *)(a1 + 10) <= v201)
                {
                  *uint64_t v2 = 1;
LABEL_370:
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  unsigned __int8 v206 = 0;
LABEL_371:
                  *uint64_t v2 = 1;
                  goto LABEL_372;
                }
                uint64_t v202 = *(void *)a1;
                uint64_t v203 = v201 + 1;
                *(_WORD *)(a1 + 12) = v201 + 1;
                unsigned __int8 v204 = *(unsigned char *)(v202 + v201);
                int v205 = v204;
                if (v204 == 3) {
                  unsigned __int8 v204 = 1;
                }
                if (v205 == 2) {
                  unsigned __int8 v206 = 0;
                }
                else {
                  unsigned __int8 v206 = v204;
                }
                if (*(unsigned __int16 *)(a1 + 10) - (int)v203 < 6) {
                  goto LABEL_371;
                }
                sub_100008A18((uint64_t)buf, *(void *)a1 + v203, 6uLL);
                *(_WORD *)(a1 + 12) += 6;
LABEL_372:
                *v198++ = ((unint64_t)v206 << 48) | ((unint64_t)buf[0] << 40) | ((unint64_t)buf[1] << 32) | ((unint64_t)buf[2] << 24) | ((unint64_t)buf[3] << 16) | ((unint64_t)buf[4] << 8) | buf[5];
                if (!--v199)
                {
                  ((void (*)(void, void, void, uint64_t, size_t *))off_100A050C8)(v393, v196, v391, v197, size);
                  goto LABEL_756;
                }
              }
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              int v200 = *(unsigned __int8 *)(a1 + 14);
              *(unsigned char *)(a1 + 15) = 1;
              if (v200 != 1) {
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2285, "(*pBs).__RWFlag == BYTESTREAM_READ");
              }
              goto LABEL_370;
            }
          }
          ((void (*)(uint64_t, void, void, uint64_t, size_t *))v193)(v194, v196, v195, v197, size);
          goto LABEL_756;
        }
LABEL_910:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2269, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
      }
      *uint64_t v2 = 1;
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      goto LABEL_910;
    default:
      if (v10 != 175) {
        goto LABEL_756;
      }
      if (*v2)
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        unsigned __int16 v47 = 0;
      }
      else
      {
        unsigned __int16 v47 = v6 - v9;
      }
      int v156 = (void (*)(uint64_t, uint64_t))qword_100A04FC0;
      if (!qword_100A04FC0) {
        goto LABEL_756;
      }
      uint64_t v190 = *(void *)a1 + *(unsigned __int16 *)(a1 + 12);
      a2 = v47;
LABEL_461:
      v156(v190, a2);
      goto LABEL_756;
  }
}

uint64_t sub_1001BB494(uint64_t a1)
{
  uint64_t v7 = 0;
  uint64_t v8 = 0;
  uint64_t result = sub_100059D70(&v7);
  if (!result)
  {
    if (HIBYTE(v8))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(unsigned char *)(v7 + WORD2(v8)) = 5;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(unsigned char *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10001BCBC(226, v7, BYTE4(v8), a1, (uint64_t)sub_1001A2F64, v3, v4, v5);
      }
      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2618, v6);
    }
    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001BB5A4(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 11;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2586, v11);
        }
        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      unsigned int v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2585, v10);
    }
    unsigned int v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BB730(uint64_t a1)
{
  uint64_t v7 = 0;
  uint64_t v8 = 0;
  uint64_t result = sub_100059D70(&v7);
  if (!result)
  {
    if (HIBYTE(v8))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(unsigned char *)(v7 + WORD2(v8)) = 10;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(unsigned char *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10001BCBC(226, v7, BYTE4(v8), a1, (uint64_t)sub_1001A2F64, v3, v4, v5);
      }
      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2604, v6);
    }
    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001BB840(_WORD *a1, char a2, char a3, uint64_t a4)
{
  uint64_t v22 = 0;
  uint64_t v23 = 0;
  if (!sub_100059D70(&v22))
  {
    if (HIBYTE(v23))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v23) - WORD2(v23) > 3)
    {
      if (BYTE6(v23) == 2)
      {
        *(unsigned char *)(v22 + WORD2(v23)) = 9;
        *(_WORD *)(v22 + WORD2(v23) + 1) = 0;
        *(unsigned char *)(v22 + WORD2(v23) + 3) = 0;
        unsigned __int16 v12 = WORD2(v23) + 4;
        WORD2(v23) += 4;
        if (HIBYTE(v23))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v23) - v12 > 3)
        {
          if (BYTE6(v23) == 2)
          {
            *(_DWORD *)(v22 + v12) = 0;
            unsigned __int16 v13 = WORD2(v23) + 4;
            WORD2(v23) += 4;
            if (HIBYTE(v23))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v23) > v13)
            {
              if (BYTE6(v23) == 2)
              {
                *(unsigned char *)(v22 + v13) = 0;
                __int16 v14 = WORD2(v23);
                unsigned __int16 v15 = ++WORD2(v23);
                if (HIBYTE(v23))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v23) > v15)
                {
                  if (BYTE6(v23) == 2)
                  {
                    WORD2(v23) = v14 + 2;
                    *(unsigned char *)(v22 + v15) = a3 | (16 * a2);
                    if (HIBYTE(v23))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v23) - WORD2(v23) > 1)
                    {
                      if (BYTE6(v23) == 2)
                      {
                        *(_WORD *)(v22 + WORD2(v23)) = *a1;
                        unsigned __int8 v11 = BYTE4(v23) + 2;
                        WORD2(v23) += 2;
                        return sub_10001BCBC(226, v22, v11, a4, (uint64_t)sub_1000260B4, v8, v9, v10);
                      }
                      __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_39:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2635, v21);
                    }
                    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_39;
                  }
                  uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2634, v20);
                }
                uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_35;
              }
              uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2633, v19);
            }
            uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
            goto LABEL_31;
          }
          uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2632, v18);
        }
        uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= (4)";
        goto LABEL_27;
      }
      uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2631, v17);
    }
    uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_23;
  }
  unsigned __int8 v11 = BYTE4(v23);
  return sub_10001BCBC(226, v22, v11, a4, (uint64_t)sub_1000260B4, v8, v9, v10);
}

uint64_t sub_1001BBB7C(unsigned char *a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  if (!sub_100059D70(&v16))
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(unsigned char *)(v16 + WORD2(v17)) = 43;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(unsigned char *)(v16 + WORD2(v17) + 3) = 0;
        unsigned __int16 v9 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v17) - v9 > 1)
        {
          if (BYTE6(v17) == 2)
          {
            *(unsigned char *)(v16 + v9) = *a1;
            *(unsigned char *)(v16 + WORD2(v17) + 1) = a1[1];
            __int16 v10 = WORD2(v17);
            unsigned __int16 v11 = WORD2(v17) + 2;
            WORD2(v17) += 2;
            if (HIBYTE(v17))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v17) > v11)
            {
              if (BYTE6(v17) == 2)
              {
                WORD2(v17) = v10 + 3;
                *(unsigned char *)(v16 + v11) = a2;
                return sub_10001BCBC(226, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v6, v7, v8);
              }
              unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2651, v15);
            }
            unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }
          __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2650, v14);
        }
        __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }
      unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2649, v13);
    }
    unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return sub_10001BCBC(226, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v6, v7, v8);
}

uint64_t sub_1001BBDAC(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 15;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2666, v11);
        }
        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2665, v10);
    }
    __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BBF38(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 16;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2681, v11);
        }
        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2680, v10);
    }
    __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BC0C4(char a1, uint64_t a2)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v15) - WORD2(v15) > 3)
    {
      if (BYTE6(v15) == 2)
      {
        *(unsigned char *)(v14 + WORD2(v15)) = 25;
        *(_WORD *)(v14 + WORD2(v15) + 1) = 0;
        *(unsigned char *)(v14 + WORD2(v15) + 3) = 0;
        __int16 v8 = WORD2(v15);
        unsigned __int16 v9 = WORD2(v15) + 4;
        WORD2(v15) += 4;
        if (HIBYTE(v15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v15) > v9)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v8 + 5;
            *(unsigned char *)(v14 + v9) = a1;
            if (HIBYTE(v15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v15) - WORD2(v15) > 2)
            {
              if (BYTE6(v15) == 2)
              {
                uint64_t v10 = v14 + WORD2(v15);
                *(unsigned char *)(v10 + 2) = 0;
                *(_WORD *)uint64_t v10 = 0;
                WORD2(v15) += 3;
                return sub_10001BCBC(226, v14, BYTE4(v15), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
              }
              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2697, v13);
            }
            uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
            goto LABEL_24;
          }
          uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2696, v12);
        }
        uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }
      unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2695, v11);
    }
    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001BC2D8(unsigned char *a1, char a2, uint64_t a3)
{
  uint64_t v18 = 0;
  uint64_t v19 = 0;
  uint64_t result = sub_100059D70(&v18);
  if (!result)
  {
    if (HIBYTE(v19))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v10 = WORD2(v19);
      if (WORD1(v19) > WORD2(v19))
      {
        if (BYTE6(v19) == 2)
        {
          ++WORD2(v19);
          *(unsigned char *)(v18 + v10) = 20;
          if (HIBYTE(v19))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v19) - WORD2(v19) > 1)
          {
            if (BYTE6(v19) == 2)
            {
              *(_WORD *)(v18 + WORD2(v19)) = 0;
              unsigned __int16 v11 = WORD2(v19) + 2;
              WORD2(v19) += 2;
              if (HIBYTE(v19))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v19) - v11 > 1)
              {
                if (BYTE6(v19) == 2)
                {
                  *(unsigned char *)(v18 + v11 + 1) = *a1;
                  *(unsigned char *)(v18 + WORD2(v19)) = a1[1];
                  __int16 v12 = WORD2(v19);
                  unsigned __int16 v13 = WORD2(v19) + 2;
                  WORD2(v19) += 2;
                  if (HIBYTE(v19))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else if (WORD1(v19) > v13)
                  {
                    if (BYTE6(v19) == 2)
                    {
                      WORD2(v19) = v12 + 3;
                      *(unsigned char *)(v18 + v13) = a2;
                      return sub_10001BCBC(226, v18, BYTE4(v19), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                    }
                    uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2717, v17);
                  }
                  uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }
                uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2716, v16);
              }
              uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 2";
              goto LABEL_27;
            }
            uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2714, v15);
          }
          uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= (2)";
          goto LABEL_23;
        }
        uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2713, v14);
      }
    }
    uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001BC54C(unsigned int a1, uint64_t a2)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (a1 > 3) {
    return 101;
  }
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v15) - WORD2(v15) > 3)
    {
      if (BYTE6(v15) == 2)
      {
        *(unsigned char *)(v14 + WORD2(v15)) = 0;
        *(_WORD *)(v14 + WORD2(v15) + 1) = 0;
        *(unsigned char *)(v14 + WORD2(v15) + 3) = 0;
        __int16 v8 = WORD2(v15);
        unsigned __int16 v9 = WORD2(v15) + 4;
        WORD2(v15) += 4;
        if (HIBYTE(v15))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v15) > v9)
        {
          if (BYTE6(v15) == 2)
          {
            WORD2(v15) = v8 + 5;
            *(unsigned char *)(v14 + v9) = a1;
            if (HIBYTE(v15))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v15) - WORD2(v15) > 2)
            {
              if (BYTE6(v15) == 2)
              {
                uint64_t v10 = v14 + WORD2(v15);
                *(unsigned char *)(v10 + 2) = 0;
                *(_WORD *)uint64_t v10 = 0;
                WORD2(v15) += 3;
                return sub_10001BCBC(226, v14, BYTE4(v15), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
              }
              unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2737, v13);
            }
            unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
            goto LABEL_26;
          }
          __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2736, v12);
        }
        __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_22;
      }
      unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_18:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2735, v11);
    }
    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_18;
  }
  return result;
}

uint64_t sub_1001BC76C(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 14;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2887, v11);
        }
        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2886, v10);
    }
    uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BC8F8(int a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(unsigned char *)(v11 + WORD2(v12)) = 30;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(unsigned char *)(v11 + v8) = a1;
            *(unsigned char *)(v11 + WORD2(v12) + 1) = BYTE1(a1);
            *(unsigned char *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
            *(unsigned char *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
            WORD2(v12) += 4;
            return sub_10001BCBC(226, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2901, v10);
        }
        uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }
      unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2900, v9);
    }
    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BCAC8(int a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(unsigned char *)(v11 + WORD2(v12)) = 4;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(unsigned char *)(v11 + v8) = a1;
            *(unsigned char *)(v11 + WORD2(v12) + 1) = BYTE1(a1);
            *(unsigned char *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
            *(unsigned char *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
            WORD2(v12) += 4;
            return sub_10001BCBC(226, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          uint64_t v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2916, v10);
        }
        uint64_t v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }
      unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2915, v9);
    }
    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BCC98(int a1, int a2, uint64_t a3)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(unsigned char *)(v15 + WORD2(v16)) = 31;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(unsigned char *)(v15 + WORD2(v16) + 3) = 0;
        unsigned __int16 v10 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        if (HIBYTE(v16))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v16) - v10 > 3)
        {
          if (BYTE6(v16) == 2)
          {
            *(unsigned char *)(v15 + v10) = a1;
            *(unsigned char *)(v15 + WORD2(v16) + 1) = BYTE1(a1);
            *(unsigned char *)(v15 + WORD2(v16) + 2) = BYTE2(a1);
            *(unsigned char *)(v15 + WORD2(v16) + 3) = HIBYTE(a1);
            unsigned __int16 v11 = WORD2(v16) + 4;
            WORD2(v16) += 4;
            if (HIBYTE(v16))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v16) - v11 > 3)
            {
              if (BYTE6(v16) == 2)
              {
                *(unsigned char *)(v15 + v11) = a2;
                *(unsigned char *)(v15 + WORD2(v16) + 1) = BYTE1(a2);
                *(unsigned char *)(v15 + WORD2(v16) + 2) = BYTE2(a2);
                *(unsigned char *)(v15 + WORD2(v16) + 3) = HIBYTE(a2);
                WORD2(v16) += 4;
                return sub_10001BCBC(226, v15, BYTE4(v16), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2931, v14);
            }
            uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_24;
          }
          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2930, v13);
        }
        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_20;
      }
      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2929, v12);
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001BCF30(unsigned char *a1, __int16 a2, __int16 a3, __int16 a4, __int16 a5, uint64_t a6)
{
  uint64_t v27 = 0;
  uint64_t v28 = 0;
  uint64_t result = sub_100059D70(&v27);
  if (!result)
  {
    if (HIBYTE(v28))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v28) - WORD2(v28) > 3)
    {
      if (BYTE6(v28) == 2)
      {
        *(unsigned char *)(v27 + WORD2(v28)) = 33;
        *(_WORD *)(v27 + WORD2(v28) + 1) = 0;
        *(unsigned char *)(v27 + WORD2(v28) + 3) = 0;
        unsigned __int16 v16 = WORD2(v28) + 4;
        WORD2(v28) += 4;
        if (HIBYTE(v28))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v28) - v16 > 1)
        {
          if (BYTE6(v28) == 2)
          {
            *(unsigned char *)(v27 + v16) = *a1;
            *(unsigned char *)(v27 + WORD2(v28) + 1) = a1[1];
            unsigned __int16 v17 = WORD2(v28) + 2;
            WORD2(v28) += 2;
            if (HIBYTE(v28))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v28) - v17 > 1)
            {
              if (BYTE6(v28) == 2)
              {
                *(unsigned char *)(v27 + v17) = a2;
                *(unsigned char *)(v27 + WORD2(v28) + 1) = HIBYTE(a2);
                unsigned __int16 v18 = WORD2(v28) + 2;
                WORD2(v28) += 2;
                if (HIBYTE(v28))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v28) - v18 > 1)
                {
                  if (BYTE6(v28) == 2)
                  {
                    *(unsigned char *)(v27 + v18) = a3;
                    *(unsigned char *)(v27 + WORD2(v28) + 1) = HIBYTE(a3);
                    unsigned __int16 v19 = WORD2(v28) + 2;
                    WORD2(v28) += 2;
                    if (HIBYTE(v28))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v28) - v19 > 1)
                    {
                      if (BYTE6(v28) == 2)
                      {
                        *(unsigned char *)(v27 + v19) = a4;
                        *(unsigned char *)(v27 + WORD2(v28) + 1) = HIBYTE(a4);
                        unsigned __int16 v20 = WORD2(v28) + 2;
                        WORD2(v28) += 2;
                        if (HIBYTE(v28))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v28) - v20 > 1)
                        {
                          if (BYTE6(v28) == 2)
                          {
                            *(unsigned char *)(v27 + v20) = a5;
                            *(unsigned char *)(v27 + WORD2(v28) + 1) = HIBYTE(a5);
                            WORD2(v28) += 2;
                            return sub_10001BCBC(226, v27, BYTE4(v28), a6, (uint64_t)sub_1000260B4, v13, v14, v15);
                          }
                          uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2950, v26);
                        }
                        uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_45;
                      }
                      unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2949, v25);
                    }
                    unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_41;
                  }
                  uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2948, v24);
                }
                uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_37;
              }
              uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2947, v23);
            }
            uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }
          uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2946, v22);
        }
        uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_29;
      }
      __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2945, v21);
    }
    __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001BD34C(__int16 a1, __int16 a2, __int16 a3, __int16 a4, uint64_t a5)
{
  uint64_t v23 = 0;
  uint64_t v24 = 0;
  uint64_t result = sub_100059D70(&v23);
  if (!result)
  {
    if (HIBYTE(v24))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v24) - WORD2(v24) > 3)
    {
      if (BYTE6(v24) == 2)
      {
        *(unsigned char *)(v23 + WORD2(v24)) = 34;
        *(_WORD *)(v23 + WORD2(v24) + 1) = 0;
        *(unsigned char *)(v23 + WORD2(v24) + 3) = 0;
        unsigned __int16 v14 = WORD2(v24) + 4;
        WORD2(v24) += 4;
        if (HIBYTE(v24))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v24) - v14 > 1)
        {
          if (BYTE6(v24) == 2)
          {
            *(unsigned char *)(v23 + v14) = a1;
            *(unsigned char *)(v23 + WORD2(v24) + 1) = HIBYTE(a1);
            unsigned __int16 v15 = WORD2(v24) + 2;
            WORD2(v24) += 2;
            if (HIBYTE(v24))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v24) - v15 > 1)
            {
              if (BYTE6(v24) == 2)
              {
                *(unsigned char *)(v23 + v15) = a2;
                *(unsigned char *)(v23 + WORD2(v24) + 1) = HIBYTE(a2);
                unsigned __int16 v16 = WORD2(v24) + 2;
                WORD2(v24) += 2;
                if (HIBYTE(v24))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v24) - v16 > 1)
                {
                  if (BYTE6(v24) == 2)
                  {
                    *(unsigned char *)(v23 + v16) = a3;
                    *(unsigned char *)(v23 + WORD2(v24) + 1) = HIBYTE(a3);
                    unsigned __int16 v17 = WORD2(v24) + 2;
                    WORD2(v24) += 2;
                    if (HIBYTE(v24))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v24) - v17 > 1)
                    {
                      if (BYTE6(v24) == 2)
                      {
                        *(unsigned char *)(v23 + v17) = a4;
                        *(unsigned char *)(v23 + WORD2(v24) + 1) = HIBYTE(a4);
                        WORD2(v24) += 2;
                        return sub_10001BCBC(226, v23, BYTE4(v24), a5, (uint64_t)sub_1000260B4, v11, v12, v13);
                      }
                      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2968, v22);
                    }
                    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_38;
                  }
                  __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2967, v21);
                }
                __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_34;
              }
              unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2966, v20);
            }
            unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_30;
          }
          unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2965, v19);
        }
        unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_26;
      }
      unsigned __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2964, v18);
    }
    unsigned __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_22;
  }
  return result;
}

uint64_t sub_1001BD6CC(uint64_t a1)
{
  uint64_t v7 = 0;
  uint64_t v8 = 0;
  uint64_t result = sub_100059D70(&v7);
  if (!result)
  {
    if (HIBYTE(v8))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(unsigned char *)(v7 + WORD2(v8)) = 35;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(unsigned char *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10001BCBC(226, v7, BYTE4(v8), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
      }
      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2982, v6);
    }
    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001BD7DC(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 37;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2996, v11);
        }
        uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2995, v10);
    }
    unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BD968(char a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(unsigned char *)(v16 + WORD2(v17)) = 38;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(unsigned char *)(v16 + WORD2(v17) + 3) = 0;
        __int16 v10 = WORD2(v17);
        unsigned __int16 v11 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v17) > v11)
        {
          if (BYTE6(v17) == 2)
          {
            WORD2(v17) = v10 + 5;
            *(unsigned char *)(v16 + v11) = a1;
            if (HIBYTE(v17))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else
            {
              uint64_t v12 = WORD2(v17);
              if (WORD1(v17) > WORD2(v17))
              {
                if (BYTE6(v17) == 2)
                {
                  ++WORD2(v17);
                  *(unsigned char *)(v16 + v12) = a2;
                  return sub_10001BCBC(226, v16, BYTE4(v17), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                }
                unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3012, v15);
              }
            }
            unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }
          unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3011, v14);
        }
        unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }
      uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3010, v13);
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001BDB78(char a1, char a2, __int16 a3, __int16 a4, __int16 a5, uint64_t a6)
{
  uint64_t v25 = 0;
  uint64_t v26 = 0;
  uint64_t result = sub_100059D70(&v25);
  if (!result)
  {
    if (HIBYTE(v26))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v16 = WORD2(v26);
      if (WORD1(v26) > WORD2(v26))
      {
        if (BYTE6(v26) == 2)
        {
          ++WORD2(v26);
          *(unsigned char *)(v25 + v16) = a1;
          if (HIBYTE(v26))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v17 = WORD2(v26);
            if (WORD1(v26) > WORD2(v26))
            {
              if (BYTE6(v26) == 2)
              {
                ++WORD2(v26);
                *(unsigned char *)(v25 + v17) = a2;
                if (HIBYTE(v26))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v26) - WORD2(v26) > 1)
                {
                  if (BYTE6(v26) == 2)
                  {
                    *(_WORD *)(v25 + WORD2(v26)) = a4;
                    unsigned __int16 v18 = WORD2(v26) + 2;
                    WORD2(v26) += 2;
                    if (HIBYTE(v26))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v26) - v18 > 1)
                    {
                      if (BYTE6(v26) == 2)
                      {
                        *(unsigned char *)(v25 + v18) = a5;
                        *(unsigned char *)(v25 + WORD2(v26) + 1) = HIBYTE(a5);
                        unsigned __int16 v19 = WORD2(v26) + 2;
                        WORD2(v26) += 2;
                        if (HIBYTE(v26))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v26) - v19 > 1)
                        {
                          if (BYTE6(v26) == 2)
                          {
                            *(unsigned char *)(v25 + v19) = a3;
                            *(unsigned char *)(v25 + WORD2(v26) + 1) = HIBYTE(a3);
                            WORD2(v26) += 2;
                            return sub_10001BCBC(517, v25, BYTE4(v26), a6, (uint64_t)sub_1000260B4, v13, v14, v15);
                          }
                          uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3029, v24);
                        }
                        uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_38;
                      }
                      uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3028, v23);
                    }
                    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_34;
                  }
                  uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3027, v22);
                }
                uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_30;
              }
              __int16 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3026, v21);
            }
          }
          __int16 v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_26;
        }
        unsigned __int16 v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3025, v20);
      }
    }
    unsigned __int16 v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }
  return result;
}

uint64_t sub_1001BDEA4(char a1, char a2, char a3, char a4, char a5, __int16 a6, __int16 a7, uint64_t a8)
{
  uint64_t v33 = 0;
  uint64_t v34 = 0;
  uint64_t result = sub_100059D70(&v33);
  if (!result)
  {
    if (HIBYTE(v34))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v20 = WORD2(v34);
      if (WORD1(v34) > WORD2(v34))
      {
        if (BYTE6(v34) == 2)
        {
          ++WORD2(v34);
          *(unsigned char *)(v33 + v20) = a1;
          if (HIBYTE(v34))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v21 = WORD2(v34);
            if (WORD1(v34) > WORD2(v34))
            {
              if (BYTE6(v34) == 2)
              {
                ++WORD2(v34);
                *(unsigned char *)(v33 + v21) = a2;
                if (HIBYTE(v34))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v22 = WORD2(v34);
                  if (WORD1(v34) > WORD2(v34))
                  {
                    if (BYTE6(v34) == 2)
                    {
                      ++WORD2(v34);
                      *(unsigned char *)(v33 + v22) = a3;
                      if (HIBYTE(v34))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else
                      {
                        uint64_t v23 = WORD2(v34);
                        if (WORD1(v34) > WORD2(v34))
                        {
                          if (BYTE6(v34) == 2)
                          {
                            ++WORD2(v34);
                            *(unsigned char *)(v33 + v23) = a4;
                            if (HIBYTE(v34))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else
                            {
                              uint64_t v24 = WORD2(v34);
                              if (WORD1(v34) > WORD2(v34))
                              {
                                if (BYTE6(v34) == 2)
                                {
                                  ++WORD2(v34);
                                  *(unsigned char *)(v33 + v24) = a5;
                                  if (HIBYTE(v34))
                                  {
                                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/St"
                                                           "ack/vsc/bcm/bcm_vsc.c");
                                  }
                                  else if (WORD1(v34) - WORD2(v34) > 1)
                                  {
                                    if (BYTE6(v34) == 2)
                                    {
                                      *(_WORD *)(v33 + WORD2(v34)) = a7;
                                      unsigned __int16 v25 = WORD2(v34) + 2;
                                      WORD2(v34) += 2;
                                      if (HIBYTE(v34))
                                      {
                                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_bas"
                                                               "e/Stack/vsc/bcm/bcm_vsc.c");
                                      }
                                      else if (WORD1(v34) - v25 > 1)
                                      {
                                        if (BYTE6(v34) == 2)
                                        {
                                          *(unsigned char *)(v33 + v25) = a6;
                                          *(unsigned char *)(v33 + WORD2(v34) + 1) = HIBYTE(a6);
                                          WORD2(v34) += 2;
                                          return sub_10001BCBC(553, v33, BYTE4(v34), a8, (uint64_t)sub_1000260B4, v17, v18, v19);
                                        }
                                        unsigned __int16 v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6107, v32);
                                      }
                                      unsigned __int16 v32 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                      goto LABEL_52;
                                    }
                                    uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6106, v31);
                                  }
                                  uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                  goto LABEL_48;
                                }
                                uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6105, v30);
                              }
                            }
                            uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_44;
                          }
                          uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6104, v29);
                        }
                      }
                      uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                      goto LABEL_40;
                    }
                    uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6103, v28);
                  }
                }
                uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_36;
              }
              uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6102, v27);
            }
          }
          uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_32;
        }
        uint64_t v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6101, v26);
      }
    }
    uint64_t v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }
  return result;
}

uint64_t sub_1001BE2B4(char a1, char a2, unsigned __int8 a3, char *a4, _WORD *a5, unsigned char *a6, char a7, char a8, unsigned char *a9, char a10, uint64_t a11)
{
  uint64_t v46 = 0;
  uint64_t v47 = 0;
  uint64_t result = sub_100059D70(&v46);
  if (result) {
    return result;
  }
  LOBYTE(v23) = 0;
  int v25 = 3;
  unsigned __int8 v26 = a3;
  do
  {
    LOBYTE(v23) = (v26 & 1) + v23;
    v26 >>= 1;
    --v25;
  }
  while (v25);
  if (HIBYTE(v47))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_55;
  }
  uint64_t v27 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_55:
    unsigned int v41 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_57;
  }
  if (BYTE6(v47) != 2)
  {
    unsigned int v41 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6137, v41);
  }
  ++WORD2(v47);
  *(unsigned char *)(v46 + v27) = a1;
  if (HIBYTE(v47))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_59;
  }
  uint64_t v28 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_59:
    uint64_t v42 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_61;
  }
  if (BYTE6(v47) != 2)
  {
    uint64_t v42 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6138, v42);
  }
  ++WORD2(v47);
  *(unsigned char *)(v46 + v28) = a2;
  if (HIBYTE(v47))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_63;
  }
  uint64_t v29 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_63:
    unsigned __int16 v43 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_65;
  }
  if (BYTE6(v47) != 2)
  {
    unsigned __int16 v43 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6139, v43);
  }
  ++WORD2(v47);
  *(unsigned char *)(v46 + v29) = a3;
  if (HIBYTE(v47))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_67;
  }
  uint64_t v30 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_67:
    uint64_t v44 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_69;
  }
  if (BYTE6(v47) != 2)
  {
    uint64_t v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6140, v44);
  }
  ++WORD2(v47);
  *(unsigned char *)(v46 + v30) = (4 * a10) | a7;
  if (HIBYTE(v47))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_71;
  }
  uint64_t v31 = WORD2(v47);
  if (WORD1(v47) <= WORD2(v47))
  {
LABEL_71:
    unsigned __int16 v45 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_73;
  }
  if (BYTE6(v47) != 2)
  {
    unsigned __int16 v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6141, v45);
  }
  ++WORD2(v47);
  *(unsigned char *)(v46 + v31) = a8;
  if ((_BYTE)v23)
  {
    uint64_t v23 = v23;
    while (!HIBYTE(v47))
    {
      uint64_t v32 = WORD2(v47);
      if (WORD1(v47) <= WORD2(v47)) {
        goto LABEL_39;
      }
      if (BYTE6(v47) != 2)
      {
        uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_41;
      }
      char v33 = *a4;
      ++WORD2(v47);
      *(unsigned char *)(v46 + v32) = v33;
      if (HIBYTE(v47))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_43:
        uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_45:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6145, v38);
      }
      if (WORD1(v47) - WORD2(v47) <= 1) {
        goto LABEL_43;
      }
      if (BYTE6(v47) != 2)
      {
        uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_45;
      }
      *(_WORD *)(v46 + WORD2(v47)) = *a5;
      unsigned __int16 v34 = WORD2(v47) + 2;
      WORD2(v47) += 2;
      if (HIBYTE(v47))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_47:
        unsigned __int16 v39 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_49:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6146, v39);
      }
      if (WORD1(v47) - v34 <= 1) {
        goto LABEL_47;
      }
      if (BYTE6(v47) != 2)
      {
        unsigned __int16 v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_49;
      }
      *(unsigned char *)(v46 + v34) = *a6;
      *(unsigned char *)(v46 + WORD2(v47) + 1) = a6[1];
      unsigned __int16 v35 = WORD2(v47) + 2;
      WORD2(v47) += 2;
      if (HIBYTE(v47))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_51:
        BOOL v40 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_53:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6147, v40);
      }
      if (WORD1(v47) - v35 <= 1) {
        goto LABEL_51;
      }
      if (BYTE6(v47) != 2)
      {
        BOOL v40 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_53;
      }
      *(unsigned char *)(v46 + v35) = *a9;
      *(unsigned char *)(v46 + WORD2(v47) + 1) = a9[1];
      unsigned __int8 v36 = BYTE4(v47) + 2;
      a9 += 2;
      WORD2(v47) += 2;
      a6 += 2;
      ++a5;
      ++a4;
      if (!--v23) {
        return sub_10001BCBC(567, v46, v36, a11, (uint64_t)sub_1000260B4, v20, v21, v22);
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_39:
    uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_41:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6144, v37);
  }
  unsigned __int8 v36 = BYTE4(v47);
  return sub_10001BCBC(567, v46, v36, a11, (uint64_t)sub_1000260B4, v20, v21, v22);
}

uint64_t sub_1001BE83C(char a1, __int16 a2, char a3, __int16 a4, char a5, uint64_t a6)
{
  uint64_t v28 = 0;
  uint64_t v29 = 0;
  uint64_t result = sub_100059D70(&v28);
  if (!result)
  {
    if (HIBYTE(v29))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v29) - WORD2(v29) > 3)
    {
      if (BYTE6(v29) == 2)
      {
        *(unsigned char *)(v28 + WORD2(v29)) = 44;
        *(_WORD *)(v28 + WORD2(v29) + 1) = 0;
        *(unsigned char *)(v28 + WORD2(v29) + 3) = 0;
        __int16 v16 = WORD2(v29);
        unsigned __int16 v17 = WORD2(v29) + 4;
        WORD2(v29) += 4;
        if (HIBYTE(v29))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v29) > v17)
        {
          if (BYTE6(v29) == 2)
          {
            WORD2(v29) = v16 + 5;
            *(unsigned char *)(v28 + v17) = a1;
            if (HIBYTE(v29))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v29) - WORD2(v29) > 1)
            {
              if (BYTE6(v29) == 2)
              {
                *(_WORD *)(v28 + WORD2(v29)) = a2;
                __int16 v18 = WORD2(v29);
                unsigned __int16 v19 = WORD2(v29) + 2;
                WORD2(v29) += 2;
                if (HIBYTE(v29))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v29) > v19)
                {
                  if (BYTE6(v29) == 2)
                  {
                    WORD2(v29) = v18 + 3;
                    *(unsigned char *)(v28 + v19) = a3;
                    if (HIBYTE(v29))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v29) - WORD2(v29) > 1)
                    {
                      if (BYTE6(v29) == 2)
                      {
                        *(_WORD *)(v28 + WORD2(v29)) = a4;
                        __int16 v20 = WORD2(v29);
                        unsigned __int16 v21 = WORD2(v29) + 2;
                        WORD2(v29) += 2;
                        if (HIBYTE(v29))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v29) > v21)
                        {
                          if (BYTE6(v29) == 2)
                          {
                            WORD2(v29) = v20 + 3;
                            *(unsigned char *)(v28 + v21) = a5;
                            return sub_10001BCBC(226, v28, BYTE4(v29), a6, (uint64_t)sub_1001A65D8, v13, v14, v15);
                          }
                          uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6169, v27);
                        }
                        uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_45;
                      }
                      unsigned __int8 v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6168, v26);
                    }
                    unsigned __int8 v26 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_41;
                  }
                  int v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6167, v25);
                }
                int v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_37;
              }
              uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6166, v24);
            }
            uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }
          uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6165, v23);
        }
        uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_29;
      }
      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6164, v22);
    }
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001BEC00(uint64_t a1)
{
  uint64_t v7 = 0;
  uint64_t v8 = 0;
  uint64_t result = sub_100059D70(&v7);
  if (!result)
  {
    if (HIBYTE(v8))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v8) - WORD2(v8) > 3)
    {
      if (BYTE6(v8) == 2)
      {
        *(unsigned char *)(v7 + WORD2(v8)) = 45;
        *(_WORD *)(v7 + WORD2(v8) + 1) = 0;
        *(unsigned char *)(v7 + WORD2(v8) + 3) = 0;
        WORD2(v8) += 4;
        return sub_10001BCBC(226, v7, BYTE4(v8), a1, (uint64_t)sub_1001A6974, v3, v4, v5);
      }
      uint64_t v6 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6184, v6);
    }
    uint64_t v6 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001BED10(char a1, __int16 a2, uint64_t a3)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(unsigned char *)(v15 + WORD2(v16)) = 46;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(unsigned char *)(v15 + WORD2(v16) + 3) = 0;
        __int16 v10 = WORD2(v16);
        unsigned __int16 v11 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        if (HIBYTE(v16))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v16) > v11)
        {
          if (BYTE6(v16) == 2)
          {
            WORD2(v16) = v10 + 5;
            *(unsigned char *)(v15 + v11) = a1;
            if (HIBYTE(v16))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v16) - WORD2(v16) > 1)
            {
              if (BYTE6(v16) == 2)
              {
                *(_WORD *)(v15 + WORD2(v16)) = a2;
                WORD2(v16) += 2;
                return sub_10001BCBC(226, v15, BYTE4(v16), a3, (uint64_t)sub_1001A65D8, v7, v8, v9);
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6201, v14);
            }
            uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_24;
          }
          uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6200, v13);
        }
        uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_20;
      }
      uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6199, v12);
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001BEF3C(char a1, __int16 a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(unsigned char *)(v20 + WORD2(v21)) = 49;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(unsigned char *)(v20 + WORD2(v21) + 3) = 0;
        __int16 v12 = WORD2(v21);
        unsigned __int16 v13 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v21) > v13)
        {
          if (BYTE6(v21) == 2)
          {
            WORD2(v21) = v12 + 5;
            *(unsigned char *)(v20 + v13) = a1;
            if (HIBYTE(v21))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v21) - WORD2(v21) > 1)
            {
              if (BYTE6(v21) == 2)
              {
                *(_WORD *)(v20 + WORD2(v21)) = a2;
                __int16 v14 = WORD2(v21);
                unsigned __int16 v15 = WORD2(v21) + 2;
                WORD2(v21) += 2;
                if (HIBYTE(v21))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v21) > v15)
                {
                  if (BYTE6(v21) == 2)
                  {
                    WORD2(v21) = v14 + 3;
                    *(unsigned char *)(v20 + v15) = a3;
                    return sub_10001BCBC(226, v20, BYTE4(v21), a4, (uint64_t)sub_1001A65D8, v9, v10, v11);
                  }
                  unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6237, v19);
                }
                unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_31;
              }
              __int16 v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6236, v18);
            }
            __int16 v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_27;
          }
          unsigned __int16 v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6235, v17);
        }
        unsigned __int16 v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_23;
      }
      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6234, v16);
    }
    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001BF1E4(char a1, unsigned char *a2, uint64_t a3)
{
  uint64_t v17 = 0;
  uint64_t v18 = 0;
  uint64_t result = sub_100059D70(&v17);
  if (!result)
  {
    if (HIBYTE(v18))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v18) - WORD2(v18) > 3)
    {
      if (BYTE6(v18) == 2)
      {
        *(unsigned char *)(v17 + WORD2(v18)) = 48;
        *(_WORD *)(v17 + WORD2(v18) + 1) = 0;
        *(unsigned char *)(v17 + WORD2(v18) + 3) = 0;
        __int16 v10 = WORD2(v18);
        unsigned __int16 v11 = WORD2(v18) + 4;
        WORD2(v18) += 4;
        if (HIBYTE(v18))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v18) > v11)
        {
          if (BYTE6(v18) == 2)
          {
            WORD2(v18) = v10 + 5;
            *(unsigned char *)(v17 + v11) = a1;
            if (HIBYTE(v18))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v18) > WORD2(v18))
            {
              if (BYTE6(v18) == 2)
              {
                *(unsigned char *)(v17 + WORD2(v18)) = 0;
                unsigned __int16 v12 = ++WORD2(v18);
                if (HIBYTE(v18))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v18) - v12 > 1)
                {
                  if (BYTE6(v18) == 2)
                  {
                    *(unsigned char *)(v17 + v12) = *a2;
                    *(unsigned char *)(v17 + WORD2(v18) + 1) = a2[1];
                    WORD2(v18) += 2;
                    return sub_10001BCBC(226, v17, BYTE4(v18), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                  }
                  uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2477, v16);
                }
                uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_31;
              }
              unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2476, v15);
            }
            unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
            goto LABEL_27;
          }
          __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2475, v14);
        }
        __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_23;
      }
      unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2473, v13);
    }
    unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001BF490(__int16 a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(unsigned char *)(v20 + WORD2(v21)) = 47;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(unsigned char *)(v20 + WORD2(v21) + 3) = 0;
        unsigned __int16 v12 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v21) - v12 > 1)
        {
          if (BYTE6(v21) == 2)
          {
            *(unsigned char *)(v20 + v12) = a1;
            *(unsigned char *)(v20 + WORD2(v21) + 1) = HIBYTE(a1);
            __int16 v13 = WORD2(v21);
            unsigned __int16 v14 = WORD2(v21) + 2;
            WORD2(v21) += 2;
            if (HIBYTE(v21))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v21) > v14)
            {
              if (BYTE6(v21) == 2)
              {
                WORD2(v21) = v13 + 3;
                *(unsigned char *)(v20 + v14) = a2;
                if (HIBYTE(v21))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v15 = WORD2(v21);
                  if (WORD1(v21) > WORD2(v21))
                  {
                    if (BYTE6(v21) == 2)
                    {
                      ++WORD2(v21);
                      *(unsigned char *)(v20 + v15) = a3;
                      return sub_10001BCBC(226, v20, BYTE4(v21), a4, (uint64_t)sub_1001A65D8, v9, v10, v11);
                    }
                    unsigned __int16 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6219, v19);
                  }
                }
                unsigned __int16 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_31;
              }
              uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6218, v18);
            }
            uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_27;
          }
          uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6217, v17);
        }
        uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_23;
      }
      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6216, v16);
    }
    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001BF738(unsigned int a1, unsigned int a2, uint64_t a3)
{
  uint64_t v17 = 0;
  uint64_t v18 = 0;
  uint64_t result = sub_100059D70(&v17);
  if (!result)
  {
    if (HIBYTE(v18))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v18) - WORD2(v18) > 3)
    {
      if (BYTE6(v18) == 2)
      {
        *(unsigned char *)(v17 + WORD2(v18)) = 50;
        *(_WORD *)(v17 + WORD2(v18) + 1) = 0;
        *(unsigned char *)(v17 + WORD2(v18) + 3) = 0;
        unsigned __int16 v10 = WORD2(v18) + 4;
        WORD2(v18) += 4;
        if (HIBYTE(v18))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v18) - v10 > 3)
        {
          if (BYTE6(v18) == 2)
          {
            double v11 = (double)a1 / 1.25;
            *(unsigned char *)(v17 + v10) = v11;
            *(unsigned char *)(v17 + WORD2(v18) + 1) = (unsigned __int16)v11 >> 8;
            *(unsigned char *)(v17 + WORD2(v18) + 2) = v11 >> 16;
            *(unsigned char *)(v17 + WORD2(v18) + 3) = v11 >> 24;
            unsigned __int16 v12 = WORD2(v18) + 4;
            WORD2(v18) += 4;
            if (HIBYTE(v18))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v18) - v12 > 3)
            {
              if (BYTE6(v18) == 2)
              {
                double v13 = (double)a2 / 1.25;
                *(unsigned char *)(v17 + v12) = v13;
                *(unsigned char *)(v17 + WORD2(v18) + 1) = (unsigned __int16)v13 >> 8;
                *(unsigned char *)(v17 + WORD2(v18) + 2) = v13 >> 16;
                *(unsigned char *)(v17 + WORD2(v18) + 3) = v13 >> 24;
                WORD2(v18) += 4;
                return sub_10001BCBC(226, v17, BYTE4(v18), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2500, v16);
            }
            uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
            goto LABEL_24;
          }
          uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2499, v15);
        }
        uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_20;
      }
      unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2497, v14);
    }
    unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001BF9EC(char a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v12) - WORD2(v12) > 3)
    {
      if (BYTE6(v12) == 2)
      {
        *(unsigned char *)(v11 + WORD2(v12)) = 51;
        *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
        *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
        unsigned __int16 v8 = WORD2(v12) + 4;
        WORD2(v12) += 4;
        if (HIBYTE(v12))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v12) - v8 > 3)
        {
          if (BYTE6(v12) == 2)
          {
            *(unsigned char *)(v11 + v8) = a1;
            *(_WORD *)(v11 + WORD2(v12) + 1) = 0;
            *(unsigned char *)(v11 + WORD2(v12) + 3) = 0;
            WORD2(v12) += 4;
            return sub_10001BCBC(226, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
          }
          unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2519, v10);
        }
        unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
        goto LABEL_17;
      }
      uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2518, v9);
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001BFBB0(int a1, _WORD *a2, uint64_t a3)
{
  uint64_t v18 = 0;
  uint64_t v19 = 0;
  uint64_t result = sub_100059D70(&v18);
  if (!result)
  {
    if (HIBYTE(v19))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v19) - WORD2(v19) > 3)
    {
      if (BYTE6(v19) == 2)
      {
        *(unsigned char *)(v18 + WORD2(v19)) = 53;
        *(_WORD *)(v18 + WORD2(v19) + 1) = 0;
        *(unsigned char *)(v18 + WORD2(v19) + 3) = 0;
        __int16 v10 = WORD2(v19);
        unsigned __int16 v11 = WORD2(v19) + 4;
        WORD2(v19) += 4;
        if (HIBYTE(v19))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v19) > v11)
        {
          if (BYTE6(v19) == 2)
          {
            WORD2(v19) = v10 + 5;
            *(unsigned char *)(v18 + v11) = 1;
            if (HIBYTE(v19))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v19) - WORD2(v19) > 1)
            {
              if (BYTE6(v19) == 2)
              {
                *(_WORD *)(v18 + WORD2(v19)) = *a2;
                unsigned __int16 v12 = WORD2(v19) + 2;
                WORD2(v19) += 2;
                if (a1)
                {
                  if (HIBYTE(v19))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else if (WORD1(v19) - v12 > 3)
                  {
                    if (BYTE6(v19) == 2)
                    {
                      *(_DWORD *)(v18 + v12) = 0;
LABEL_20:
                      WORD2(v19) += 4;
                      return sub_10001BCBC(226, v18, BYTE4(v19), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
                    }
                    uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2541, v16);
                  }
                  uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= (4)";
                  goto LABEL_37;
                }
                if (HIBYTE(v19))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v19) - v12 > 3)
                {
                  if (BYTE6(v19) == 2)
                  {
                    *(unsigned char *)(v18 + v12) = 0x80;
                    *(_WORD *)(v18 + WORD2(v19) + 1) = 0;
                    *(unsigned char *)(v18 + WORD2(v19) + 3) = 0;
                    goto LABEL_20;
                  }
                  uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_41:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2543, v17);
                }
                uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 4";
                goto LABEL_41;
              }
              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2538, v15);
            }
            uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 2";
            goto LABEL_33;
          }
          unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_29:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2537, v14);
        }
        unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_29;
      }
      double v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2536, v13);
    }
    double v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001BFF14(uint64_t a1, uint64_t a2)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v16) - WORD2(v16) > 3)
    {
      if (BYTE6(v16) == 2)
      {
        *(unsigned char *)(v15 + WORD2(v16)) = 52;
        *(_WORD *)(v15 + WORD2(v16) + 1) = 0;
        *(unsigned char *)(v15 + WORD2(v16) + 3) = 0;
        unsigned __int16 v5 = WORD2(v16) + 4;
        WORD2(v16) += 4;
        v14[0] = BYTE5(a1);
        v14[1] = BYTE4(a1);
        char v14[2] = BYTE3(a1);
        v14[3] = BYTE2(a1);
        v14[4] = BYTE1(a1);
        v14[5] = a1;
        if (HIBYTE(v16))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v16) - v5 > 5)
        {
          if (BYTE6(v16) == 2)
          {
            sub_100008A18(v15 + v5, (uint64_t)v14, 6uLL);
            __int16 v9 = WORD2(v16);
            unsigned __int16 v10 = WORD2(v16) + 6;
            WORD2(v16) += 6;
            if (HIBYTE(v16))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v16) > v10)
            {
              if (BYTE6(v16) == 2)
              {
                WORD2(v16) = v9 + 7;
                *(unsigned char *)(v15 + v10) = BYTE6(a1);
                return sub_10001BCBC(226, v15, BYTE4(v16), a2, (uint64_t)sub_1000260B4, v6, v7, v8);
              }
              double v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2566, v13);
            }
            double v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }
          unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2565, v12);
        }
        unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
        goto LABEL_20;
      }
      unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 2562, v11);
    }
    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001C0158(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 54;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1001A65D8, v5, v6, v7);
          }
          unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6252, v11);
        }
        unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6251, v10);
    }
    unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001C02E4(__int16 a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v21) - WORD2(v21) > 3)
    {
      if (BYTE6(v21) == 2)
      {
        *(unsigned char *)(v20 + WORD2(v21)) = 57;
        *(_WORD *)(v20 + WORD2(v21) + 1) = 0;
        *(unsigned char *)(v20 + WORD2(v21) + 3) = 0;
        unsigned __int16 v12 = WORD2(v21) + 4;
        WORD2(v21) += 4;
        if (HIBYTE(v21))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v21) - v12 > 1)
        {
          if (BYTE6(v21) == 2)
          {
            *(unsigned char *)(v20 + v12) = a1;
            *(unsigned char *)(v20 + WORD2(v21) + 1) = HIBYTE(a1);
            __int16 v13 = WORD2(v21);
            unsigned __int16 v14 = WORD2(v21) + 2;
            WORD2(v21) += 2;
            if (HIBYTE(v21))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v21) > v14)
            {
              if (BYTE6(v21) == 2)
              {
                WORD2(v21) = v13 + 3;
                *(unsigned char *)(v20 + v14) = a2;
                if (HIBYTE(v21))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v15 = WORD2(v21);
                  if (WORD1(v21) > WORD2(v21))
                  {
                    if (BYTE6(v21) == 2)
                    {
                      ++WORD2(v21);
                      *(unsigned char *)(v20 + v15) = a3;
                      return sub_10001BCBC(226, v20, BYTE4(v21), a4, (uint64_t)sub_1001A65D8, v9, v10, v11);
                    }
                    uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6269, v19);
                  }
                }
                uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_31;
              }
              uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6268, v18);
            }
            uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_27;
          }
          uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6267, v17);
        }
        uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_23;
      }
      uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6266, v16);
    }
    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C058C(__int16 a1, char a2, uint64_t a3)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v17) - WORD2(v17) > 3)
    {
      if (BYTE6(v17) == 2)
      {
        *(unsigned char *)(v16 + WORD2(v17)) = 64;
        *(_WORD *)(v16 + WORD2(v17) + 1) = 0;
        *(unsigned char *)(v16 + WORD2(v17) + 3) = 0;
        unsigned __int16 v10 = WORD2(v17) + 4;
        WORD2(v17) += 4;
        if (HIBYTE(v17))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v17) - v10 > 1)
        {
          if (BYTE6(v17) == 2)
          {
            *(unsigned char *)(v16 + v10) = a1;
            *(unsigned char *)(v16 + WORD2(v17) + 1) = HIBYTE(a1);
            __int16 v11 = WORD2(v17);
            unsigned __int16 v12 = WORD2(v17) + 2;
            WORD2(v17) += 2;
            if (HIBYTE(v17))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else if (WORD1(v17) > v12)
            {
              if (BYTE6(v17) == 2)
              {
                WORD2(v17) = v11 + 3;
                *(unsigned char *)(v16 + v12) = a2;
                return sub_10001BCBC(226, v16, BYTE4(v17), a3, (uint64_t)sub_1001A65D8, v7, v8, v9);
              }
              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6285, v15);
            }
            uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
            goto LABEL_24;
          }
          unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6284, v14);
        }
        unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_20;
      }
      __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6283, v13);
    }
    __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001C07B8(char a1, uint64_t a2)
{
  uint64_t v12 = 0;
  uint64_t v13 = 0;
  uint64_t result = sub_100059D70(&v12);
  if (!result)
  {
    if (HIBYTE(v13))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else if (WORD1(v13) - WORD2(v13) > 3)
    {
      if (BYTE6(v13) == 2)
      {
        *(unsigned char *)(v12 + WORD2(v13)) = 66;
        *(_WORD *)(v12 + WORD2(v13) + 1) = 0;
        *(unsigned char *)(v12 + WORD2(v13) + 3) = 0;
        __int16 v8 = WORD2(v13);
        unsigned __int16 v9 = WORD2(v13) + 4;
        WORD2(v13) += 4;
        if (HIBYTE(v13))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else if (WORD1(v13) > v9)
        {
          if (BYTE6(v13) == 2)
          {
            WORD2(v13) = v8 + 5;
            *(unsigned char *)(v12 + v9) = a1;
            return sub_10001BCBC(226, v12, BYTE4(v13), a2, (uint64_t)sub_1001A65D8, v5, v6, v7);
          }
          __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6299, v11);
        }
        __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_17;
      }
      unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 6298, v10);
    }
    unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001C0944(int a1, uint64_t a2)
{
  uint64_t v11 = 0;
  uint64_t v12 = 0;
  uint64_t result = sub_100059D70(&v11);
  if (!result)
  {
    if (HIBYTE(v12))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v12);
      if (WORD1(v12) > WORD2(v12))
      {
        if (BYTE6(v12) == 2)
        {
          ++WORD2(v12);
          *(unsigned char *)(v11 + v8) = 1;
          if (HIBYTE(v12))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v12) - WORD2(v12) > 3)
          {
            if (BYTE6(v12) == 2)
            {
              *(_WORD *)(v11 + WORD2(v12)) = a1;
              *(unsigned char *)(v11 + WORD2(v12) + 2) = BYTE2(a1);
              *(unsigned char *)(v11 + WORD2(v12) + 3) = HIBYTE(a1);
              WORD2(v12) += 4;
              return sub_10001BCBC(233, v11, BYTE4(v12), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
            }
            unsigned __int16 v10 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3121, v10);
          }
          unsigned __int16 v10 = "ByteStream_NumReadBytesAvail(bs) >= 4";
          goto LABEL_17;
        }
        unsigned __int16 v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3120, v9);
      }
    }
    unsigned __int16 v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001C0ADC(char a1, uint64_t a2, const void *a3, int a4, uint64_t a5)
{
  uint64_t v23 = 0;
  uint64_t v24 = 0;
  uint64_t result = sub_100059D70(&v23);
  if (!result)
  {
    if (HIBYTE(v24))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v11 = WORD2(v24);
      if (WORD1(v24) > WORD2(v24))
      {
        if (BYTE6(v24) == 2)
        {
          ++WORD2(v24);
          *(unsigned char *)(v23 + v11) = 2;
          uint64_t v12 = v23;
          uint64_t v13 = WORD2(v24);
          if (HIBYTE(v24))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v14 = 0;
          }
          else
          {
            int v14 = WORD1(v24) - WORD2(v24);
          }
          if (v14 < a4)
          {
            uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= (IrkLength)";
          }
          else
          {
            if (BYTE6(v24) == 2)
            {
              memmove((void *)(v12 + v13), a3, a4);
              unsigned __int16 v15 = WORD2(v24) + a4;
              WORD2(v24) += a4;
              if (HIBYTE(v24))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v24) > v15)
              {
                if (BYTE6(v24) == 2)
                {
                  WORD2(v24) = v15 + 1;
                  *(unsigned char *)(v23 + v15) = a1;
                  if (HIBYTE(v24))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else if (WORD1(v24) - WORD2(v24) > 5)
                  {
                    if (BYTE6(v24) == 2)
                    {
                      sub_100008A18(v23 + WORD2(v24), a2, 6uLL);
                      WORD2(v24) += 6;
                      return sub_10001BCBC(233, v23, BYTE4(v24), a5, (uint64_t)sub_1000260B4, v16, v17, v18);
                    }
                    uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3143, v22);
                  }
                  uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                  goto LABEL_32;
                }
                uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3142, v21);
              }
              uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_28;
            }
            uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3141, v20);
        }
        uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_21:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3140, v19);
      }
    }
    uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_21;
  }
  return result;
}

uint64_t sub_1001C0D74(char a1, uint64_t a2, uint64_t a3)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v7 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(unsigned char *)(v15 + v7) = 3;
          if (HIBYTE(v16))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v8 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(unsigned char *)(v15 + v8) = a1;
                if (HIBYTE(v16))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v16) - WORD2(v16) > 5)
                {
                  if (BYTE6(v16) == 2)
                  {
                    sub_100008A18(v15 + WORD2(v16), a2, 6uLL);
                    WORD2(v16) += 6;
                    return sub_10001BCBC(233, v15, BYTE4(v16), a3, (uint64_t)sub_1000260B4, v9, v10, v11);
                  }
                  int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3158, v14);
                }
                int v14 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_24;
              }
              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3157, v13);
            }
          }
          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }
        uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3156, v12);
      }
    }
    uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001C0F60(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 4;
          return sub_10001BCBC(233, v8, BYTE4(v9), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3171, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001C1038(uint64_t a1)
{
  uint64_t v21 = 0;
  uint64_t v22 = 0;
  uint64_t result = sub_100059D70(&v21);
  if (!result)
  {
    if (HIBYTE(v22))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v22);
      if (WORD1(v22) > WORD2(v22))
      {
        if (BYTE6(v22) == 2)
        {
          ++WORD2(v22);
          *(unsigned char *)(v21 + v6) = 5;
          if (HIBYTE(v22))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v7 = WORD2(v22);
            if (WORD1(v22) > WORD2(v22))
            {
              if (BYTE6(v22) == 2)
              {
                ++WORD2(v22);
                *(unsigned char *)(v21 + v7) = 0;
                if (HIBYTE(v22))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v22) - WORD2(v22) > 5)
                {
                  if (BYTE6(v22) == 2)
                  {
                    uint64_t v8 = v21 + WORD2(v22);
                    *(_WORD *)(v8 + 4) = 0;
                    *(_DWORD *)uint64_t v8 = 0;
                    __int16 v9 = WORD2(v22);
                    unsigned __int16 v10 = WORD2(v22) + 6;
                    WORD2(v22) += 6;
                    if (HIBYTE(v22))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v22) > v10)
                    {
                      if (BYTE6(v22) == 2)
                      {
                        WORD2(v22) = v9 + 7;
                        *(unsigned char *)(v21 + v10) = 2;
                        if (HIBYTE(v22))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else
                        {
                          uint64_t v11 = WORD2(v22);
                          if (WORD1(v22) > WORD2(v22))
                          {
                            if (BYTE6(v22) == 2)
                            {
                              ++WORD2(v22);
                              *(unsigned char *)(v21 + v11) = 4;
                              if (HIBYTE(v22))
                              {
                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/"
                                                       "vsc/bcm/bcm_vsc.c");
                              }
                              else
                              {
                                uint64_t v12 = WORD2(v22);
                                if (WORD1(v22) > WORD2(v22))
                                {
                                  if (BYTE6(v22) == 2)
                                  {
                                    ++WORD2(v22);
                                    *(unsigned char *)(v21 + v12) = 0;
                                    if (HIBYTE(v22))
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }
                                    else if (WORD1(v22) - WORD2(v22) > 2)
                                    {
                                      if (BYTE6(v22) == 2)
                                      {
                                        uint64_t v13 = v21 + WORD2(v22);
                                        *(unsigned char *)(v13 + 2) = 0;
                                        *(_WORD *)uint64_t v13 = 0;
                                        WORD2(v22) += 3;
                                        return sub_10001BCBC(233, v21, BYTE4(v22), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
                                      }
                                      uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3191, v20);
                                    }
                                    uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= (3)";
                                    goto LABEL_52;
                                  }
                                  uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3190, v19);
                                }
                              }
                              uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                              goto LABEL_48;
                            }
                            uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3189, v18);
                          }
                        }
                        uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_44;
                      }
                      uint64_t v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3188, v17);
                    }
                    uint64_t v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_40;
                  }
                  uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_36:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3187, v16);
                }
                uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_36;
              }
              uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_32:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3186, v15);
            }
          }
          uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_32;
        }
        int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_28:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3185, v14);
      }
    }
    int v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_28;
  }
  return result;
}

uint64_t sub_1001C1408(uint64_t a1)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(unsigned char *)(v15 + v6) = 5;
          if (HIBYTE(v16))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v7 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(unsigned char *)(v15 + v7) = 2;
                if (HIBYTE(v16))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v16) - WORD2(v16) > 5)
                {
                  if (BYTE6(v16) == 2)
                  {
                    uint64_t v8 = v15 + WORD2(v16);
                    *(_WORD *)(v8 + 4) = 0;
                    *(_DWORD *)uint64_t v8 = 0;
                    __int16 v9 = WORD2(v16);
                    unsigned __int16 v10 = WORD2(v16) + 6;
                    WORD2(v16) += 6;
                    if (HIBYTE(v16))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v16) > v10)
                    {
                      if (BYTE6(v16) == 2)
                      {
                        WORD2(v16) = v9 + 7;
                        *(unsigned char *)(v15 + v10) = 2;
                        return sub_10001BCBC(233, v15, BYTE4(v16), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
                      }
                      int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3208, v14);
                    }
                    int v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }
                  uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3207, v13);
                }
                uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_27;
              }
              uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3206, v12);
            }
          }
          uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3205, v11);
      }
    }
    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C1660(uint64_t a1)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(unsigned char *)(v15 + v6) = 7;
          if (HIBYTE(v16))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v7 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(unsigned char *)(v15 + v7) = 2;
                if (HIBYTE(v16))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v16) - WORD2(v16) > 5)
                {
                  if (BYTE6(v16) == 2)
                  {
                    uint64_t v8 = v15 + WORD2(v16);
                    *(_WORD *)(v8 + 4) = 0;
                    *(_DWORD *)uint64_t v8 = 0;
                    __int16 v9 = WORD2(v16);
                    unsigned __int16 v10 = WORD2(v16) + 6;
                    WORD2(v16) += 6;
                    if (HIBYTE(v16))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v16) > v10)
                    {
                      if (BYTE6(v16) == 2)
                      {
                        WORD2(v16) = v9 + 7;
                        *(unsigned char *)(v15 + v10) = 2;
                        return sub_10001BCBC(233, v15, BYTE4(v16), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
                      }
                      int v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3225, v14);
                    }
                    int v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }
                  uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3224, v13);
                }
                uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_27;
              }
              uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3223, v12);
            }
          }
          uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3222, v11);
      }
    }
    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C18B8(uint64_t a1, unsigned int a2, int a3, uint64_t a4)
{
  uint64_t v29 = 0;
  uint64_t v30 = 0;
  uint64_t result = sub_100059D70(&v29);
  if (result) {
    return result;
  }
  if (HIBYTE(v30))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_38;
  }
  uint64_t v12 = WORD2(v30);
  if (WORD1(v30) <= WORD2(v30))
  {
LABEL_38:
    uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_40;
  }
  if (BYTE6(v30) != 2)
  {
    uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_40:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3239, v23);
  }
  ++WORD2(v30);
  *(unsigned char *)(v29 + v12) = 7;
  if (a3)
  {
    if (HIBYTE(v30))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v13 = WORD2(v30);
      if (WORD1(v30) > WORD2(v30))
      {
        if (BYTE6(v30) == 2)
        {
          char v14 = 0;
          goto LABEL_14;
        }
        uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_56:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3242, v27);
      }
    }
    uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_56;
  }
  if (HIBYTE(v30))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_58;
  }
  unsigned int v13 = WORD2(v30);
  if (WORD1(v30) <= WORD2(v30))
  {
LABEL_58:
    uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_60;
  }
  if (BYTE6(v30) != 2)
  {
    uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_60:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3244, v28);
  }
  char v14 = 1;
LABEL_14:
  WORD2(v30) = v13 + 1;
  *(unsigned char *)(v29 + v13) = v14;
  if (HIBYTE(v30))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_42;
  }
  if (WORD1(v30) - WORD2(v30) <= 5)
  {
LABEL_42:
    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
    goto LABEL_44;
  }
  if (BYTE6(v30) != 2)
  {
    uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_44:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3246, v24);
  }
  uint64_t v15 = v29 + WORD2(v30);
  *(_WORD *)(v15 + 4) = 0;
  *(_DWORD *)uint64_t v15 = 0;
  __int16 v16 = WORD2(v30);
  unsigned __int16 v17 = WORD2(v30) + 6;
  WORD2(v30) += 6;
  if (HIBYTE(v30))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_46;
  }
  if (WORD1(v30) <= v17)
  {
LABEL_46:
    int v25 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_48;
  }
  if (BYTE6(v30) != 2)
  {
    int v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_48:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3247, v25);
  }
  WORD2(v30) = v16 + 7;
  *(unsigned char *)(v29 + v17) = 2;
  if (HIBYTE(v30))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_50;
  }
  uint64_t v18 = WORD2(v30);
  if (WORD1(v30) <= WORD2(v30))
  {
LABEL_50:
    unsigned __int8 v26 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_52;
  }
  if (BYTE6(v30) != 2)
  {
    unsigned __int8 v26 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_52:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3248, v26);
  }
  ++WORD2(v30);
  *(unsigned char *)(v29 + v18) = 0;
  if (a2 == 2 || a2 == 16 || (sub_10025B8C0(), a2))
  {
    uint64_t v19 = a2;
    while (!HIBYTE(v30))
    {
      uint64_t v20 = WORD2(v30);
      if (WORD1(v30) <= WORD2(v30)) {
        goto LABEL_34;
      }
      if (BYTE6(v30) != 2)
      {
        uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_36;
      }
      char v21 = *(unsigned char *)(a1 - 1 + v19--);
      ++WORD2(v30);
      *(unsigned char *)(v29 + v20) = v21;
      if ((unint64_t)(v19 + 1) <= 1) {
        return sub_10001BCBC(233, v29, BYTE4(v30), a4, (uint64_t)sub_1000260B4, v9, v10, v11);
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_34:
    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_36:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3256, v22);
  }
  return sub_10001BCBC(233, v29, BYTE4(v30), a4, (uint64_t)sub_1000260B4, v9, v10, v11);
}

uint64_t sub_1001C1CB8(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 28;
          return sub_10001BCBC(233, v8, BYTE4(v9), a1, (uint64_t)sub_1001A2F64, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3343, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001C1D90(const void *a1, int a2, char a3, uint64_t a4)
{
  uint64_t v33 = 0;
  uint64_t v34 = 0;
  uint64_t result = sub_100059D70(&v33);
  if (!result)
  {
    if (HIBYTE(v34))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v9 = WORD2(v34);
      if (WORD1(v34) > WORD2(v34))
      {
        if (BYTE6(v34) == 2)
        {
          ++WORD2(v34);
          *(unsigned char *)(v33 + v9) = 29;
          uint64_t v10 = v33;
          uint64_t v11 = WORD2(v34);
          if (HIBYTE(v34))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v12 = 0;
          }
          else
          {
            int v12 = WORD1(v34) - WORD2(v34);
          }
          if (v12 < a2)
          {
            uint64_t v28 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
          }
          else
          {
            if (BYTE6(v34) == 2)
            {
              memmove((void *)(v10 + v11), a1, a2);
              unsigned __int16 v13 = WORD2(v34) + a2;
              WORD2(v34) += a2;
              uint64_t v14 = v33;
              if (HIBYTE(v34))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v15 = 0;
              }
              else
              {
                int v15 = WORD1(v34) - v13;
              }
              int v16 = 21 - a2;
              if (v15 < 21 - a2)
              {
                uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= (21 - dataLen)";
              }
              else
              {
                if (BYTE6(v34) == 2)
                {
                  bzero((void *)(v14 + v13), v16);
                  unsigned __int16 v17 = WORD2(v34) + v16;
                  WORD2(v34) += v16;
                  uint64_t v18 = v33;
                  if (HIBYTE(v34))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v19 = 0;
                  }
                  else
                  {
                    int v19 = WORD1(v34) - v17;
                  }
                  if (v19 < a2)
                  {
                    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                  }
                  else
                  {
                    if (BYTE6(v34) == 2)
                    {
                      memset((void *)(v18 + v17), 255, a2);
                      unsigned __int16 v20 = WORD2(v34) + a2;
                      WORD2(v34) = v20;
                      uint64_t v21 = v33;
                      if (HIBYTE(v34))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        int v22 = 0;
                      }
                      else
                      {
                        int v22 = WORD1(v34) - v20;
                      }
                      if (v22 < v16)
                      {
                        uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= (21 - dataLen)";
                      }
                      else
                      {
                        if (BYTE6(v34) == 2)
                        {
                          bzero((void *)(v21 + v20), v16);
                          unsigned __int16 v26 = WORD2(v34) + v16;
                          WORD2(v34) += v16;
                          if (HIBYTE(v34))
                          {
                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }
                          else if (WORD1(v34) > v26)
                          {
                            if (BYTE6(v34) == 2)
                            {
                              WORD2(v34) = v26 + 1;
                              *(unsigned char *)(v33 + v26) = a3;
                              return sub_10001BCBC(233, v33, BYTE4(v34), a4, (uint64_t)sub_1000260B4, v23, v24, v25);
                            }
                            uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3362, v32);
                          }
                          uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                          goto LABEL_49;
                        }
                        uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                      }
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3361, v31);
                    }
                    uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                  }
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3360, v30);
                }
                uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              }
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3359, v29);
            }
            uint64_t v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3358, v28);
        }
        uint64_t v27 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3357, v27);
      }
    }
    uint64_t v27 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_33;
  }
  return result;
}

uint64_t sub_1001C2150(const void *a1, int a2, uint64_t a3)
{
  uint64_t v25 = 0;
  uint64_t v26 = 0;
  uint64_t result = sub_100059D70(&v25);
  if (!result)
  {
    if (HIBYTE(v26))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v7 = WORD2(v26);
      if (WORD1(v26) > WORD2(v26))
      {
        if (BYTE6(v26) == 2)
        {
          ++WORD2(v26);
          *(unsigned char *)(v25 + v7) = 31;
          uint64_t v8 = v25;
          uint64_t v9 = WORD2(v26);
          if (HIBYTE(v26))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            int v10 = 0;
          }
          else
          {
            int v10 = WORD1(v26) - WORD2(v26);
          }
          if (v10 < a2)
          {
            int v22 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
          }
          else
          {
            if (BYTE6(v26) == 2)
            {
              memmove((void *)(v8 + v9), a1, a2);
              unsigned __int16 v11 = WORD2(v26) + a2;
              WORD2(v26) += a2;
              uint64_t v12 = v25;
              if (HIBYTE(v26))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                int v13 = 0;
              }
              else
              {
                int v13 = WORD1(v26) - v11;
              }
              int v14 = 21 - a2;
              if (v13 < 21 - a2)
              {
                uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= (21 - dataLen)";
              }
              else
              {
                if (BYTE6(v26) == 2)
                {
                  bzero((void *)(v12 + v11), v14);
                  unsigned __int16 v15 = WORD2(v26) + v14;
                  WORD2(v26) += v14;
                  uint64_t v16 = v25;
                  if (HIBYTE(v26))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    int v17 = 0;
                  }
                  else
                  {
                    int v17 = WORD1(v26) - v15;
                  }
                  if (v17 < a2)
                  {
                    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                  }
                  else
                  {
                    if (BYTE6(v26) == 2)
                    {
                      memset((void *)(v16 + v15), 255, a2);
                      WORD2(v26) += a2;
                      return sub_10001BCBC(233, v25, BYTE4(v26), a3, (uint64_t)sub_1000260B4, v18, v19, v20);
                    }
                    uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                  }
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3379, v24);
                }
                uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              }
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3378, v23);
            }
            int v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          }
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3377, v22);
        }
        uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_25:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3376, v21);
      }
    }
    uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_25;
  }
  return result;
}

uint64_t sub_1001C23FC(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 32;
          return sub_10001BCBC(233, v8, BYTE4(v9), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3393, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001C24D4(const void *a1, int a2, const void *a3, int a4, char a5, char a6, int a7, int a8, uint64_t a9, uint64_t a10)
{
  uint64_t v54 = 0;
  uint64_t v55 = 0;
  uint64_t result = sub_100059D70(&v54);
  if (!result)
  {
    if (a7)
    {
      if (HIBYTE(v55))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else
      {
        unsigned int v19 = WORD2(v55);
        if (WORD1(v55) > WORD2(v55))
        {
          if (BYTE6(v55) == 2)
          {
            char v20 = 50;
            goto LABEL_11;
          }
          uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3408, v51);
        }
      }
      uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_78;
    }
    if (HIBYTE(v55))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v19 = WORD2(v55);
      if (WORD1(v55) > WORD2(v55))
      {
        if (BYTE6(v55) == 2)
        {
          char v20 = 51;
LABEL_11:
          WORD2(v55) = v19 + 1;
          *(unsigned char *)(v54 + v19) = v20;
          if (a8)
          {
            if (HIBYTE(v55))
            {
              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
            }
            else
            {
              unsigned int v21 = WORD2(v55);
              if (WORD1(v55) > WORD2(v55))
              {
                char v22 = BYTE6(v55);
                if (BYTE6(v55) != 2)
                {
                  uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                  goto LABEL_85;
                }
LABEL_20:
                WORD2(v55) = v21 + 1;
                *(unsigned char *)(v54 + v21) = v22;
                if (HIBYTE(v55))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v55) - WORD2(v55) > 5)
                {
                  if (BYTE6(v55) == 2)
                  {
                    uint64_t v24 = v54 + WORD2(v55);
                    *(_WORD *)(v24 + 4) = 0;
                    *(_DWORD *)uint64_t v24 = 0;
                    unsigned __int16 v25 = WORD2(v55) + 6;
                    WORD2(v55) += 6;
                    uint64_t v26 = v54;
                    if (HIBYTE(v55))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v27 = 0;
                    }
                    else
                    {
                      int v27 = WORD1(v55) - v25;
                    }
                    if (v27 < a2)
                    {
                      unsigned __int16 v45 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                    }
                    else
                    {
                      if (BYTE6(v55) == 2)
                      {
                        memmove((void *)(v26 + v25), a1, a2);
                        unsigned __int16 v28 = WORD2(v55) + a2;
                        WORD2(v55) += a2;
                        uint64_t v29 = v54;
                        if (HIBYTE(v55))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v30 = 0;
                        }
                        else
                        {
                          int v30 = WORD1(v55) - v28;
                        }
                        int v31 = 22 - a2;
                        if (v30 < v31)
                        {
                          uint64_t v46 = "ByteStream_NumReadBytesAvail(bs) >= (22 - dataLen)";
                        }
                        else
                        {
                          if (BYTE6(v55) == 2)
                          {
                            bzero((void *)(v29 + v28), v31);
                            unsigned __int16 v32 = WORD2(v55) + v31;
                            WORD2(v55) = v32;
                            uint64_t v33 = v54;
                            if (HIBYTE(v55))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v34 = 0;
                            }
                            else
                            {
                              int v34 = WORD1(v55) - v32;
                            }
                            if (v34 < a4)
                            {
                              uint64_t v47 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                            }
                            else
                            {
                              if (BYTE6(v55) == 2)
                              {
                                memmove((void *)(v33 + v32), a3, a4);
                                unsigned __int16 v35 = WORD2(v55) + a4;
                                WORD2(v55) += a4;
                                uint64_t v36 = v54;
                                if (HIBYTE(v55))
                                {
                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                  int v37 = 0;
                                }
                                else
                                {
                                  int v37 = WORD1(v55) - v35;
                                }
                                int v38 = 22 - a4;
                                if (v37 < v38)
                                {
                                  unsigned __int16 v48 = "ByteStream_NumReadBytesAvail(bs) >= (22 - maskLen)";
                                }
                                else
                                {
                                  if (BYTE6(v55) == 2)
                                  {
                                    bzero((void *)(v36 + v35), v38);
                                    unsigned __int16 v42 = WORD2(v55) + v38;
                                    WORD2(v55) += v38;
                                    if (HIBYTE(v55))
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }
                                    else if (WORD1(v55) > v42)
                                    {
                                      if (BYTE6(v55) == 2)
                                      {
                                        WORD2(v55) = v42 + 1;
                                        *(unsigned char *)(v54 + v42) = a5;
                                        if (HIBYTE(v55))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else
                                        {
                                          uint64_t v43 = WORD2(v55);
                                          if (WORD1(v55) > WORD2(v55))
                                          {
                                            if (BYTE6(v55) == 2)
                                            {
                                              ++WORD2(v55);
                                              *(unsigned char *)(v54 + v43) = a6;
                                              return sub_10001BCBC(233, v54, BYTE4(v55), a10, (uint64_t)sub_1000260B4, v39, v40, v41);
                                            }
                                            unsigned __int16 v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_74:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3425, v50);
                                          }
                                        }
                                        unsigned __int16 v50 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_74;
                                      }
                                      unsigned __int16 v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_70:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3424, v49);
                                    }
                                    unsigned __int16 v49 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_70;
                                  }
                                  unsigned __int16 v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                }
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3423, v48);
                              }
                              uint64_t v47 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3422, v47);
                          }
                          uint64_t v46 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3421, v46);
                      }
                      unsigned __int16 v45 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3420, v45);
                  }
                  uint64_t v44 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3419, v44);
                }
                uint64_t v44 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
                goto LABEL_54;
              }
            }
            uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_85:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3414, v23);
          }
          if (HIBYTE(v55))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            unsigned int v21 = WORD2(v55);
            if (WORD1(v55) > WORD2(v55))
            {
              if (BYTE6(v55) == 2)
              {
                char v22 = 3;
                goto LABEL_20;
              }
              unsigned int v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3416, v53);
            }
          }
          unsigned int v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_89;
        }
        uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_82:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3410, v52);
      }
    }
    uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_82;
  }
  return result;
}

uint64_t sub_1001C2AF4(_WORD *a1, char a2, char a3, uint64_t a4)
{
  uint64_t v20 = 0;
  uint64_t v21 = 0;
  uint64_t result = sub_100059D70(&v20);
  if (!result)
  {
    if (HIBYTE(v21))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v12 = WORD2(v21);
      if (WORD1(v21) > WORD2(v21))
      {
        if (BYTE6(v21) == 2)
        {
          ++WORD2(v21);
          *(unsigned char *)(v20 + v12) = 48;
          if (HIBYTE(v21))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v13 = WORD2(v21);
            if (WORD1(v21) > WORD2(v21))
            {
              if (BYTE6(v21) == 2)
              {
                ++WORD2(v21);
                *(unsigned char *)(v20 + v13) = a2;
                if (HIBYTE(v21))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v21) - WORD2(v21) > 1)
                {
                  if (BYTE6(v21) == 2)
                  {
                    *(_WORD *)(v20 + WORD2(v21)) = *a1;
                    __int16 v14 = WORD2(v21);
                    unsigned __int16 v15 = WORD2(v21) + 2;
                    WORD2(v21) += 2;
                    if (HIBYTE(v21))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v21) > v15)
                    {
                      if (BYTE6(v21) == 2)
                      {
                        WORD2(v21) = v14 + 3;
                        *(unsigned char *)(v20 + v15) = a3;
                        return sub_10001BCBC(233, v20, BYTE4(v21), a4, (uint64_t)sub_1000260B4, v9, v10, v11);
                      }
                      unsigned int v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3442, v19);
                    }
                    unsigned int v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_31;
                  }
                  uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3441, v18);
                }
                uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_27;
              }
              int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3440, v17);
            }
          }
          int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3439, v16);
      }
    }
    uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C2D68(uint64_t a1, char a2, uint64_t a3)
{
  uint64_t v19 = 0;
  uint64_t v20 = 0;
  uint64_t result = sub_100059D70(&v19);
  if (!result)
  {
    if (HIBYTE(v20))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v7 = WORD2(v20);
      if (WORD1(v20) > WORD2(v20))
      {
        if (BYTE6(v20) == 2)
        {
          ++WORD2(v20);
          *(unsigned char *)(v19 + v7) = 12;
          v18[0] = BYTE5(a1);
          v18[1] = BYTE4(a1);
          uint64_t v18[2] = BYTE3(a1);
          v18[3] = BYTE2(a1);
          v18[4] = BYTE1(a1);
          v18[5] = a1;
          if (HIBYTE(v20))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v20) - WORD2(v20) > 5)
          {
            if (BYTE6(v20) == 2)
            {
              sub_100008A18(v19 + WORD2(v20), (uint64_t)v18, 6uLL);
              __int16 v11 = WORD2(v20);
              unsigned __int16 v12 = WORD2(v20) + 6;
              WORD2(v20) += 6;
              if (HIBYTE(v20))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v20) > v12)
              {
                if (BYTE6(v20) == 2)
                {
                  WORD2(v20) = v11 + 7;
                  *(unsigned char *)(v19 + v12) = BYTE6(a1);
                  if (HIBYTE(v20))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  }
                  else
                  {
                    uint64_t v13 = WORD2(v20);
                    if (WORD1(v20) > WORD2(v20))
                    {
                      if (BYTE6(v20) == 2)
                      {
                        ++WORD2(v20);
                        *(unsigned char *)(v19 + v13) = a2;
                        return sub_10001BCBC(233, v19, BYTE4(v20), a3, (uint64_t)sub_1001A6A84, v8, v9, v10);
                      }
                      int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3479, v17);
                    }
                  }
                  int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                  goto LABEL_31;
                }
                uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3478, v16);
              }
              uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_27;
            }
            unsigned __int16 v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3477, v15);
          }
          unsigned __int16 v15 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_23;
        }
        __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3474, v14);
      }
    }
    __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C2FFC(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 30;
          return sub_10001BCBC(233, v8, BYTE4(v9), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3717, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001C30D4(uint64_t a1, uint64_t a2)
{
  uint64_t v26 = 0;
  uint64_t v27 = 0;
  uint64_t result = sub_100059D70(&v26);
  if (!result)
  {
    if (HIBYTE(v27))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v27);
      if (WORD1(v27) > WORD2(v27))
      {
        if (BYTE6(v27) == 2)
        {
          ++WORD2(v27);
          *(unsigned char *)(v26 + v5) = 52;
          if (HIBYTE(v27))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v6 = WORD2(v27);
            if (WORD1(v27) > WORD2(v27))
            {
              if (BYTE6(v27) == 2)
              {
                char v7 = *(unsigned char *)(a1 + 20);
                ++WORD2(v27);
                *(unsigned char *)(v26 + v6) = v7;
                if (HIBYTE(v27))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v27) - WORD2(v27) > 5)
                {
                  if (BYTE6(v27) == 2)
                  {
                    sub_100008A18(v26 + WORD2(v27), *(void *)a1, 6uLL);
                    unsigned __int16 v11 = WORD2(v27) + 6;
                    WORD2(v27) += 6;
                    if (HIBYTE(v27))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v27) - v11 > 1)
                    {
                      if (BYTE6(v27) == 2)
                      {
                        *(unsigned char *)(v26 + v11) = *(unsigned char *)(a1 + 8);
                        *(unsigned char *)(v26 + WORD2(v27) + 1) = *(unsigned char *)(a1 + 9);
                        unsigned __int16 v12 = WORD2(v27) + 2;
                        WORD2(v27) += 2;
                        if (HIBYTE(v27))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v27) - v12 > 1)
                        {
                          if (BYTE6(v27) == 2)
                          {
                            *(unsigned char *)(v26 + v12) = *(unsigned char *)(a1 + 10);
                            *(unsigned char *)(v26 + WORD2(v27) + 1) = *(unsigned char *)(a1 + 11);
                            unsigned __int16 v13 = WORD2(v27) + 2;
                            WORD2(v27) += 2;
                            if (HIBYTE(v27))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else if (WORD1(v27) - v13 > 1)
                            {
                              if (BYTE6(v27) == 2)
                              {
                                *(unsigned char *)(v26 + v13) = *(unsigned char *)(a1 + 12);
                                *(unsigned char *)(v26 + WORD2(v27) + 1) = *(unsigned char *)(a1 + 13);
                                unsigned __int16 v14 = WORD2(v27) + 2;
                                WORD2(v27) += 2;
                                if (HIBYTE(v27))
                                {
                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }
                                else if (WORD1(v27) - v14 > 1)
                                {
                                  if (BYTE6(v27) == 2)
                                  {
                                    *(unsigned char *)(v26 + v14) = *(unsigned char *)(a1 + 14);
                                    *(unsigned char *)(v26 + WORD2(v27) + 1) = *(unsigned char *)(a1 + 15);
                                    unsigned __int16 v15 = WORD2(v27) + 2;
                                    WORD2(v27) += 2;
                                    if (HIBYTE(v27))
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }
                                    else if (WORD1(v27) - v15 > 1)
                                    {
                                      if (BYTE6(v27) == 2)
                                      {
                                        *(unsigned char *)(v26 + v15) = *(unsigned char *)(a1 + 16);
                                        *(unsigned char *)(v26 + WORD2(v27) + 1) = *(unsigned char *)(a1 + 17);
                                        unsigned __int16 v16 = WORD2(v27) + 2;
                                        WORD2(v27) += 2;
                                        if (HIBYTE(v27))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else if (WORD1(v27) - v16 > 1)
                                        {
                                          if (BYTE6(v27) == 2)
                                          {
                                            *(unsigned char *)(v26 + v16) = *(unsigned char *)(a1 + 18);
                                            *(unsigned char *)(v26 + WORD2(v27) + 1) = *(unsigned char *)(a1 + 19);
                                            WORD2(v27) += 2;
                                            return sub_10001BCBC(233, v26, BYTE4(v27), a2, (uint64_t)sub_1000260B4, v8, v9, v10);
                                          }
                                          unsigned __int16 v25 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3739, v25);
                                        }
                                        unsigned __int16 v25 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                        goto LABEL_66;
                                      }
                                      uint64_t v24 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3738, v24);
                                    }
                                    uint64_t v24 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                    goto LABEL_62;
                                  }
                                  uint64_t v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3737, v23);
                                }
                                uint64_t v23 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                                goto LABEL_58;
                              }
                              char v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3736, v22);
                            }
                            char v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                            goto LABEL_54;
                          }
                          uint64_t v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_50:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3735, v21);
                        }
                        uint64_t v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                        goto LABEL_50;
                      }
                      uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_46:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3734, v20);
                    }
                    uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_46;
                  }
                  uint64_t v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_42:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3733, v19);
                }
                uint64_t v19 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_42;
              }
              uint64_t v18 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3732, v18);
            }
          }
          uint64_t v18 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_38;
        }
        int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3731, v17);
      }
    }
    int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_34;
  }
  return result;
}

uint64_t sub_1001C3648(uint64_t a1, uint64_t a2)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(unsigned char *)(v16 + v5) = 53;
          if (HIBYTE(v17))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v6 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                ++WORD2(v17);
                *(unsigned char *)(v16 + v6) = 0;
                if (HIBYTE(v17))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v7 = WORD2(v17);
                  if (WORD1(v17) > WORD2(v17))
                  {
                    if (BYTE6(v17) == 2)
                    {
                      ++WORD2(v17);
                      *(unsigned char *)(v16 + v7) = BYTE6(a1);
                      v15[0] = BYTE5(a1);
                      v15[1] = BYTE4(a1);
                      void v15[2] = BYTE3(a1);
                      v15[3] = BYTE2(a1);
                      v15[4] = BYTE1(a1);
                      v15[5] = a1;
                      if (HIBYTE(v17))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else if (WORD1(v17) - WORD2(v17) > 5)
                      {
                        if (BYTE6(v17) == 2)
                        {
                          sub_100008A18(v16 + WORD2(v17), (uint64_t)v15, 6uLL);
                          WORD2(v17) += 6;
                          return sub_10001BCBC(233, v16, BYTE4(v17), a2, (uint64_t)sub_1000260B4, v8, v9, v10);
                        }
                        unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3760, v14);
                      }
                      unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                      goto LABEL_31;
                    }
                    unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3756, v13);
                  }
                }
                unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_27;
              }
              unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3755, v12);
            }
          }
          unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3754, v11);
      }
    }
    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C38D0(uint64_t a1, uint64_t a2)
{
  uint64_t v16 = 0;
  uint64_t v17 = 0;
  uint64_t result = sub_100059D70(&v16);
  if (!result)
  {
    if (HIBYTE(v17))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v17);
      if (WORD1(v17) > WORD2(v17))
      {
        if (BYTE6(v17) == 2)
        {
          ++WORD2(v17);
          *(unsigned char *)(v16 + v5) = 53;
          if (HIBYTE(v17))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v6 = WORD2(v17);
            if (WORD1(v17) > WORD2(v17))
            {
              if (BYTE6(v17) == 2)
              {
                ++WORD2(v17);
                *(unsigned char *)(v16 + v6) = 1;
                if (HIBYTE(v17))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else
                {
                  uint64_t v7 = WORD2(v17);
                  if (WORD1(v17) > WORD2(v17))
                  {
                    if (BYTE6(v17) == 2)
                    {
                      ++WORD2(v17);
                      *(unsigned char *)(v16 + v7) = BYTE6(a1);
                      v15[0] = BYTE5(a1);
                      v15[1] = BYTE4(a1);
                      void v15[2] = BYTE3(a1);
                      v15[3] = BYTE2(a1);
                      v15[4] = BYTE1(a1);
                      v15[5] = a1;
                      if (HIBYTE(v17))
                      {
                        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      }
                      else if (WORD1(v17) - WORD2(v17) > 5)
                      {
                        if (BYTE6(v17) == 2)
                        {
                          sub_100008A18(v16 + WORD2(v17), (uint64_t)v15, 6uLL);
                          WORD2(v17) += 6;
                          return sub_10001BCBC(233, v16, BYTE4(v17), a2, (uint64_t)sub_1000260B4, v8, v9, v10);
                        }
                        unsigned __int16 v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3781, v14);
                      }
                      unsigned __int16 v14 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                      goto LABEL_31;
                    }
                    unsigned __int16 v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3777, v13);
                  }
                }
                unsigned __int16 v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                goto LABEL_27;
              }
              unsigned __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3776, v12);
            }
          }
          unsigned __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_23;
        }
        unsigned __int16 v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_19:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3775, v11);
      }
    }
    unsigned __int16 v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_19;
  }
  return result;
}

uint64_t sub_1001C3B5C(uint64_t a1)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v6) = 53;
          if (HIBYTE(v11))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v7 = WORD2(v11);
            if (WORD1(v11) > WORD2(v11))
            {
              if (BYTE6(v11) == 2)
              {
                ++WORD2(v11);
                *(unsigned char *)(v10 + v7) = 2;
                return sub_10001BCBC(233, v10, BYTE4(v11), a1, (uint64_t)sub_1000260B4, v3, v4, v5);
              }
              uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3797, v9);
            }
          }
          uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }
        uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3796, v8);
      }
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001C3CB0(const void *a1, int a2, const void *a3, int a4, char a5, char a6, int a7, char a8, char a9, char a10, char a11, char a12, char a13, char a14, __int16 a15, char a16, char a17, char a18, uint64_t a19)
{
  uint64_t v67 = 0;
  uint64_t v68 = 0;
  uint64_t result = sub_100059D70(&v67);
  if (!result)
  {
    if (a7)
    {
      if (HIBYTE(v68))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else
      {
        unsigned int v28 = WORD2(v68);
        if (WORD1(v68) > WORD2(v68))
        {
          if (BYTE6(v68) == 2)
          {
            char v29 = 55;
            goto LABEL_11;
          }
          uint64_t v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_97:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3813, v64);
        }
      }
      uint64_t v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_97;
    }
    if (HIBYTE(v68))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v28 = WORD2(v68);
      if (WORD1(v68) > WORD2(v68))
      {
        if (BYTE6(v68) == 2)
        {
          char v29 = 56;
LABEL_11:
          WORD2(v68) = v28 + 1;
          *(unsigned char *)(v67 + v28) = v29;
          if (HIBYTE(v68))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v30 = WORD2(v68);
            if (WORD1(v68) > WORD2(v68))
            {
              if (BYTE6(v68) == 2)
              {
                ++WORD2(v68);
                *(unsigned char *)(v67 + v30) = a8;
                v66[0] = a14;
                v66[1] = a13;
                v66[2] = a12;
                v66[3] = a11;
                v66[4] = a10;
                v66[5] = a9;
                if (HIBYTE(v68))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v68) - WORD2(v68) > 5)
                {
                  if (BYTE6(v68) == 2)
                  {
                    sub_100008A18(v67 + WORD2(v68), (uint64_t)v66, 6uLL);
                    unsigned __int16 v31 = WORD2(v68) + 6;
                    WORD2(v68) += 6;
                    uint64_t v32 = v67;
                    if (HIBYTE(v68))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v33 = 0;
                    }
                    else
                    {
                      int v33 = WORD1(v68) - v31;
                    }
                    if (v33 < a2)
                    {
                      uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                    }
                    else
                    {
                      if (BYTE6(v68) == 2)
                      {
                        memmove((void *)(v32 + v31), a1, a2);
                        unsigned __int16 v34 = WORD2(v68) + a2;
                        WORD2(v68) += a2;
                        uint64_t v35 = v67;
                        if (HIBYTE(v68))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v36 = 0;
                        }
                        else
                        {
                          int v36 = WORD1(v68) - v34;
                        }
                        int v37 = 22 - a2;
                        if (v36 < v37)
                        {
                          int v56 = "ByteStream_NumReadBytesAvail(bs) >= (22 - dataLen)";
                        }
                        else
                        {
                          if (BYTE6(v68) == 2)
                          {
                            bzero((void *)(v35 + v34), v37);
                            unsigned __int16 v38 = WORD2(v68) + v37;
                            WORD2(v68) = v38;
                            uint64_t v39 = v67;
                            if (HIBYTE(v68))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v40 = 0;
                            }
                            else
                            {
                              int v40 = WORD1(v68) - v38;
                            }
                            if (v40 < a4)
                            {
                              unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                            }
                            else
                            {
                              if (BYTE6(v68) == 2)
                              {
                                memmove((void *)(v39 + v38), a3, a4);
                                unsigned __int16 v41 = WORD2(v68) + a4;
                                WORD2(v68) += a4;
                                uint64_t v42 = v67;
                                if (HIBYTE(v68))
                                {
                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                  int v43 = 0;
                                }
                                else
                                {
                                  int v43 = WORD1(v68) - v41;
                                }
                                int v44 = 22 - a4;
                                if (v43 < v44)
                                {
                                  uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= (22 - maskLen)";
                                }
                                else
                                {
                                  if (BYTE6(v68) == 2)
                                  {
                                    bzero((void *)(v42 + v41), v44);
                                    unsigned __int16 v48 = WORD2(v68) + v44;
                                    WORD2(v68) += v44;
                                    if (HIBYTE(v68))
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }
                                    else if (WORD1(v68) > v48)
                                    {
                                      if (BYTE6(v68) == 2)
                                      {
                                        WORD2(v68) = v48 + 1;
                                        *(unsigned char *)(v67 + v48) = a5;
                                        if (HIBYTE(v68))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else
                                        {
                                          uint64_t v49 = WORD2(v68);
                                          if (WORD1(v68) > WORD2(v68))
                                          {
                                            if (BYTE6(v68) == 2)
                                            {
                                              ++WORD2(v68);
                                              *(unsigned char *)(v67 + v49) = a6;
                                              if (HIBYTE(v68))
                                              {
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }
                                              else
                                              {
                                                uint64_t v50 = WORD2(v68);
                                                if (WORD1(v68) > WORD2(v68))
                                                {
                                                  if (BYTE6(v68) == 2)
                                                  {
                                                    ++WORD2(v68);
                                                    *(unsigned char *)(v67 + v50) = a16;
                                                    if (HIBYTE(v68))
                                                    {
                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }
                                                    else
                                                    {
                                                      uint64_t v51 = WORD2(v68);
                                                      if (WORD1(v68) > WORD2(v68))
                                                      {
                                                        if (BYTE6(v68) == 2)
                                                        {
                                                          ++WORD2(v68);
                                                          *(unsigned char *)(v67 + v51) = a17;
                                                          if (HIBYTE(v68))
                                                          {
                                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }
                                                          else
                                                          {
                                                            uint64_t v52 = WORD2(v68);
                                                            if (WORD1(v68) > WORD2(v68))
                                                            {
                                                              if (BYTE6(v68) == 2)
                                                              {
                                                                ++WORD2(v68);
                                                                *(unsigned char *)(v67 + v52) = a18;
                                                                return sub_10001BCBC(233, v67, BYTE4(v68), a19, (uint64_t)sub_1000260B4, v45, v46, v47);
                                                              }
                                                              int v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_93:
                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3830, v63);
                                                            }
                                                          }
                                                          int v63 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                          goto LABEL_93;
                                                        }
                                                        int v62 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3829, v62);
                                                      }
                                                    }
                                                    int v62 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_89;
                                                  }
                                                  uint64_t v61 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_85:
                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3828, v61);
                                                }
                                              }
                                              uint64_t v61 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_85;
                                            }
                                            uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_81:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3827, v60);
                                          }
                                        }
                                        uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_81;
                                      }
                                      int v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_77:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3826, v59);
                                    }
                                    int v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_77;
                                  }
                                  uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                }
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3825, v58);
                              }
                              unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3824, v57);
                          }
                          int v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3823, v56);
                      }
                      uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3822, v55);
                  }
                  uint64_t v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3821, v54);
                }
                uint64_t v54 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_61;
              }
              unsigned int v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3818, v53);
            }
          }
          unsigned int v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_57;
        }
        unsigned int v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_101:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3815, v65);
      }
    }
    unsigned int v65 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_101;
  }
  return result;
}

uint64_t sub_1001C440C(const void *a1, int a2, const void *a3, int a4, char a5, char a6, int a7, char a8, char a9, char a10, char a11, char a12, char a13, char a14, __int16 a15, char a16, char a17, char a18, uint64_t a19)
{
  uint64_t v67 = 0;
  uint64_t v68 = 0;
  uint64_t result = sub_100059D70(&v67);
  if (!result)
  {
    if (a7)
    {
      if (HIBYTE(v68))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else
      {
        unsigned int v28 = WORD2(v68);
        if (WORD1(v68) > WORD2(v68))
        {
          if (BYTE6(v68) == 2)
          {
            char v29 = 55;
            goto LABEL_11;
          }
          uint64_t v64 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_97:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3845, v64);
        }
      }
      uint64_t v64 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_97;
    }
    if (HIBYTE(v68))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v28 = WORD2(v68);
      if (WORD1(v68) > WORD2(v68))
      {
        if (BYTE6(v68) == 2)
        {
          char v29 = 56;
LABEL_11:
          WORD2(v68) = v28 + 1;
          *(unsigned char *)(v67 + v28) = v29;
          if (HIBYTE(v68))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v30 = WORD2(v68);
            if (WORD1(v68) > WORD2(v68))
            {
              if (BYTE6(v68) == 2)
              {
                ++WORD2(v68);
                *(unsigned char *)(v67 + v30) = a8;
                v66[0] = a14;
                v66[1] = a13;
                v66[2] = a12;
                v66[3] = a11;
                v66[4] = a10;
                v66[5] = a9;
                if (HIBYTE(v68))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v68) - WORD2(v68) > 5)
                {
                  if (BYTE6(v68) == 2)
                  {
                    sub_100008A18(v67 + WORD2(v68), (uint64_t)v66, 6uLL);
                    unsigned __int16 v31 = WORD2(v68) + 6;
                    WORD2(v68) += 6;
                    uint64_t v32 = v67;
                    if (HIBYTE(v68))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v33 = 0;
                    }
                    else
                    {
                      int v33 = WORD1(v68) - v31;
                    }
                    if (v33 < a2)
                    {
                      uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                    }
                    else
                    {
                      if (BYTE6(v68) == 2)
                      {
                        memmove((void *)(v32 + v31), a1, a2);
                        unsigned __int16 v34 = WORD2(v68) + a2;
                        WORD2(v68) += a2;
                        uint64_t v35 = v67;
                        if (HIBYTE(v68))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v36 = 0;
                        }
                        else
                        {
                          int v36 = WORD1(v68) - v34;
                        }
                        int v37 = 22 - a2;
                        if (v36 < v37)
                        {
                          int v56 = "ByteStream_NumReadBytesAvail(bs) >= (22 - dataLen)";
                        }
                        else
                        {
                          if (BYTE6(v68) == 2)
                          {
                            bzero((void *)(v35 + v34), v37);
                            unsigned __int16 v38 = WORD2(v68) + v37;
                            WORD2(v68) = v38;
                            uint64_t v39 = v67;
                            if (HIBYTE(v68))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v40 = 0;
                            }
                            else
                            {
                              int v40 = WORD1(v68) - v38;
                            }
                            if (v40 < a4)
                            {
                              unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                            }
                            else
                            {
                              if (BYTE6(v68) == 2)
                              {
                                memmove((void *)(v39 + v38), a3, a4);
                                unsigned __int16 v41 = WORD2(v68) + a4;
                                WORD2(v68) += a4;
                                uint64_t v42 = v67;
                                if (HIBYTE(v68))
                                {
                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                  int v43 = 0;
                                }
                                else
                                {
                                  int v43 = WORD1(v68) - v41;
                                }
                                int v44 = 22 - a4;
                                if (v43 < v44)
                                {
                                  uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= (22 - maskLen)";
                                }
                                else
                                {
                                  if (BYTE6(v68) == 2)
                                  {
                                    bzero((void *)(v42 + v41), v44);
                                    unsigned __int16 v48 = WORD2(v68) + v44;
                                    WORD2(v68) += v44;
                                    if (HIBYTE(v68))
                                    {
                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/"
                                                             "Stack/vsc/bcm/bcm_vsc.c");
                                    }
                                    else if (WORD1(v68) > v48)
                                    {
                                      if (BYTE6(v68) == 2)
                                      {
                                        WORD2(v68) = v48 + 1;
                                        *(unsigned char *)(v67 + v48) = a5;
                                        if (HIBYTE(v68))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else
                                        {
                                          uint64_t v49 = WORD2(v68);
                                          if (WORD1(v68) > WORD2(v68))
                                          {
                                            if (BYTE6(v68) == 2)
                                            {
                                              ++WORD2(v68);
                                              *(unsigned char *)(v67 + v49) = a6;
                                              if (HIBYTE(v68))
                                              {
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }
                                              else
                                              {
                                                uint64_t v50 = WORD2(v68);
                                                if (WORD1(v68) > WORD2(v68))
                                                {
                                                  if (BYTE6(v68) == 2)
                                                  {
                                                    ++WORD2(v68);
                                                    *(unsigned char *)(v67 + v50) = a16;
                                                    if (HIBYTE(v68))
                                                    {
                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }
                                                    else
                                                    {
                                                      uint64_t v51 = WORD2(v68);
                                                      if (WORD1(v68) > WORD2(v68))
                                                      {
                                                        if (BYTE6(v68) == 2)
                                                        {
                                                          ++WORD2(v68);
                                                          *(unsigned char *)(v67 + v51) = a17;
                                                          if (HIBYTE(v68))
                                                          {
                                                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources"
                                                                                   "/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                          }
                                                          else
                                                          {
                                                            uint64_t v52 = WORD2(v68);
                                                            if (WORD1(v68) > WORD2(v68))
                                                            {
                                                              if (BYTE6(v68) == 2)
                                                              {
                                                                ++WORD2(v68);
                                                                *(unsigned char *)(v67 + v52) = a18;
                                                                return sub_10001BCBC(233, v67, BYTE4(v68), a19, (uint64_t)sub_1001A31B4, v45, v46, v47);
                                                              }
                                                              int v63 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_93:
                                                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3862, v63);
                                                            }
                                                          }
                                                          int v63 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                          goto LABEL_93;
                                                        }
                                                        int v62 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_89:
                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3861, v62);
                                                      }
                                                    }
                                                    int v62 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_89;
                                                  }
                                                  uint64_t v61 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_85:
                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3860, v61);
                                                }
                                              }
                                              uint64_t v61 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_85;
                                            }
                                            uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_81:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3859, v60);
                                          }
                                        }
                                        uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_81;
                                      }
                                      int v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_77:
                                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3858, v59);
                                    }
                                    int v59 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                    goto LABEL_77;
                                  }
                                  uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                                }
                                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3857, v58);
                              }
                              unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3856, v57);
                          }
                          int v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3855, v56);
                      }
                      uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3854, v55);
                  }
                  uint64_t v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3853, v54);
                }
                uint64_t v54 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_61;
              }
              unsigned int v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3850, v53);
            }
          }
          unsigned int v53 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_57;
        }
        unsigned int v65 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_101:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3847, v65);
      }
    }
    unsigned int v65 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_101;
  }
  return result;
}

uint64_t sub_1001C4B68(uint64_t a1)
{
  uint64_t v8 = 0;
  uint64_t v9 = 0;
  uint64_t result = sub_100059D70(&v8);
  if (!result)
  {
    if (HIBYTE(v9))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v6 = WORD2(v9);
      if (WORD1(v9) > WORD2(v9))
      {
        if (BYTE6(v9) == 2)
        {
          ++WORD2(v9);
          *(unsigned char *)(v8 + v6) = 57;
          return sub_10001BCBC(233, v8, BYTE4(v9), a1, (uint64_t)sub_1001A3074, v3, v4, v5);
        }
        uint64_t v7 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3897, v7);
      }
    }
    uint64_t v7 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001C4C40(char a1, const void *a2, int a3, const void *a4, int a5, uint64_t a6)
{
  uint64_t v38 = 0;
  uint64_t v39 = 0;
  uint64_t result = sub_100059D70(&v38);
  if (!result)
  {
    if (HIBYTE(v39))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v13 = WORD2(v39);
      if (WORD1(v39) > WORD2(v39))
      {
        if (BYTE6(v39) == 2)
        {
          ++WORD2(v39);
          *(unsigned char *)(v38 + v13) = 91;
          if (HIBYTE(v39))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v14 = WORD2(v39);
            if (WORD1(v39) > WORD2(v39))
            {
              if (BYTE6(v39) == 2)
              {
                ++WORD2(v39);
                *(unsigned char *)(v38 + v14) = a1;
                uint64_t v15 = v38;
                uint64_t v16 = WORD2(v39);
                if (HIBYTE(v39))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                  int v17 = 0;
                }
                else
                {
                  int v17 = WORD1(v39) - WORD2(v39);
                }
                if (v17 < a3)
                {
                  unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= (dataLen)";
                }
                else
                {
                  if (BYTE6(v39) == 2)
                  {
                    memmove((void *)(v15 + v16), a2, a3);
                    unsigned __int16 v18 = WORD2(v39) + a3;
                    WORD2(v39) += a3;
                    uint64_t v19 = v38;
                    if (HIBYTE(v39))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                      int v20 = 0;
                    }
                    else
                    {
                      int v20 = WORD1(v39) - v18;
                    }
                    int v21 = 3 - a3;
                    if (v20 < v21)
                    {
                      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= (3 - dataLen)";
                    }
                    else
                    {
                      if (BYTE6(v39) == 2)
                      {
                        bzero((void *)(v19 + v18), v21);
                        unsigned __int16 v22 = WORD2(v39) + v21;
                        WORD2(v39) = v22;
                        uint64_t v23 = v38;
                        if (HIBYTE(v39))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          int v24 = 0;
                        }
                        else
                        {
                          int v24 = WORD1(v39) - v22;
                        }
                        if (v24 < a5)
                        {
                          int v36 = "ByteStream_NumReadBytesAvail(bs) >= (maskLen)";
                        }
                        else
                        {
                          if (BYTE6(v39) == 2)
                          {
                            memmove((void *)(v23 + v22), a4, a5);
                            unsigned __int16 v25 = WORD2(v39) + a5;
                            WORD2(v39) += a5;
                            uint64_t v26 = v38;
                            if (HIBYTE(v39))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                              int v27 = 0;
                            }
                            else
                            {
                              int v27 = WORD1(v39) - v25;
                            }
                            int v28 = 3 - a5;
                            if (v27 < v28)
                            {
                              int v37 = "ByteStream_NumReadBytesAvail(bs) >= (3 - maskLen)";
                            }
                            else
                            {
                              if (BYTE6(v39) == 2)
                              {
                                bzero((void *)(v26 + v25), v28);
                                WORD2(v39) += v28;
                                return sub_10001BCBC(233, v38, BYTE4(v39), a6, (uint64_t)sub_1000260B4, v29, v30, v31);
                              }
                              int v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                            }
                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3882, v37);
                          }
                          int v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                        }
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3881, v36);
                      }
                      uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    }
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3880, v35);
                  }
                  unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                }
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3879, v34);
              }
              int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_37:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3878, v33);
            }
          }
          int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_37;
        }
        uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_33:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3877, v32);
      }
    }
    uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_33;
  }
  return result;
}

uint64_t sub_1001C5008(char a1, int a2, uint64_t a3)
{
  uint64_t v15 = 0;
  uint64_t v16 = 0;
  uint64_t result = sub_100059D70(&v15);
  if (!result)
  {
    if (HIBYTE(v16))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v10 = WORD2(v16);
      if (WORD1(v16) > WORD2(v16))
      {
        if (BYTE6(v16) == 2)
        {
          ++WORD2(v16);
          *(unsigned char *)(v15 + v10) = a1;
          if (a2 != 1)
          {
            __int16 v12 = 571;
            return sub_10001BCBC(v12, v15, BYTE4(v16), a3, (uint64_t)sub_1001A6DE4, v7, v8, v9);
          }
          if (HIBYTE(v16))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v11 = WORD2(v16);
            if (WORD1(v16) > WORD2(v16))
            {
              if (BYTE6(v16) == 2)
              {
                ++WORD2(v16);
                *(unsigned char *)(v15 + v11) = 0;
                __int16 v12 = 583;
                return sub_10001BCBC(v12, v15, BYTE4(v16), a3, (uint64_t)sub_1001A6DE4, v7, v8, v9);
              }
              uint64_t v14 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3917, v14);
            }
          }
          uint64_t v14 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }
        uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3912, v13);
      }
    }
    uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001C5174(char a1, char a2, uint64_t a3)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v10 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(unsigned char *)(v14 + v10) = a1;
          if (HIBYTE(v15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v11 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                ++WORD2(v15);
                *(unsigned char *)(v14 + v11) = a2;
                return sub_10001BCBC(583, v14, BYTE4(v15), a3, (uint64_t)sub_1000260B4, v7, v8, v9);
              }
              uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_17:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3932, v13);
            }
          }
          uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_17;
        }
        __int16 v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_13:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3931, v12);
      }
    }
    __int16 v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_13;
  }
  return result;
}

uint64_t sub_1001C52D0(char a1, uint64_t a2, char a3, uint64_t a4)
{
  uint64_t v19 = 0;
  uint64_t v20 = 0;
  uint64_t result = sub_100059D70(&v19);
  if (!result)
  {
    if (HIBYTE(v20))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v9 = WORD2(v20);
      if (WORD1(v20) > WORD2(v20))
      {
        if (BYTE6(v20) == 2)
        {
          ++WORD2(v20);
          *(unsigned char *)(v19 + v9) = a1;
          v18[0] = BYTE5(a2);
          v18[1] = BYTE4(a2);
          uint64_t v18[2] = BYTE3(a2);
          v18[3] = BYTE2(a2);
          v18[4] = BYTE1(a2);
          v18[5] = a2;
          if (HIBYTE(v20))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else if (WORD1(v20) - WORD2(v20) > 5)
          {
            if (BYTE6(v20) == 2)
            {
              sub_100008A18(v19 + WORD2(v20), (uint64_t)v18, 6uLL);
              __int16 v13 = WORD2(v20);
              unsigned __int16 v14 = WORD2(v20) + 6;
              WORD2(v20) += 6;
              if (HIBYTE(v20))
              {
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
              }
              else if (WORD1(v20) > v14)
              {
                if (BYTE6(v20) == 2)
                {
                  WORD2(v20) = v13 + 7;
                  *(unsigned char *)(v19 + v14) = a3;
                  return sub_10001BCBC(555, v19, BYTE4(v20), a4, (uint64_t)sub_1000260B4, v10, v11, v12);
                }
                int v17 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3951, v17);
              }
              int v17 = "ByteStream_NumReadBytesAvail(bs) >= 1";
              goto LABEL_24;
            }
            uint64_t v16 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3950, v16);
          }
          uint64_t v16 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
          goto LABEL_20;
        }
        uint64_t v15 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3947, v15);
      }
    }
    uint64_t v15 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001C54E8(uint64_t a1, unsigned int a2, char a3, char a4, uint64_t a5)
{
  uint64_t v36 = 0;
  uint64_t v37 = 0;
  uint64_t result = sub_100059D70(&v36);
  if (!result)
  {
    if (HIBYTE(v37))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v11 = WORD2(v37);
      if (WORD1(v37) > WORD2(v37))
      {
        if (BYTE6(v37) == 2)
        {
          ++WORD2(v37);
          *(unsigned char *)(v36 + v11) = 77;
          if (HIBYTE(v37))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v12 = WORD2(v37);
            if (WORD1(v37) > WORD2(v37))
            {
              if (BYTE6(v37) == 2)
              {
                ++WORD2(v37);
                *(unsigned char *)(v36 + v12) = a2;
                if (!a2)
                {
LABEL_18:
                  uint64_t v20 = a2;
                  uint64_t v21 = a1 - a2 + 8 * a2 + 1;
                  uint64_t v22 = v20 - 8;
                  while (!HIBYTE(v37))
                  {
                    uint64_t v23 = WORD2(v37);
                    if (WORD1(v37) <= WORD2(v37)) {
                      goto LABEL_36;
                    }
                    if (BYTE6(v37) != 2)
                    {
                      int v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                      goto LABEL_38;
                    }
                    char v24 = *(unsigned char *)(v21 - 1);
                    ++WORD2(v37);
                    *(unsigned char *)(v36 + v23) = v24;
                    if (HIBYTE(v37))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_40:
                      uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_42:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3974, v29);
                    }
                    if (WORD1(v37) - WORD2(v37) <= 5) {
                      goto LABEL_40;
                    }
                    if (BYTE6(v37) != 2)
                    {
                      uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                      goto LABEL_42;
                    }
                    sub_100008A18(v36 + WORD2(v37), v21, 6uLL);
                    WORD2(v37) += 6;
                    v21 += 7;
                    if (__CFADD__(v22++, 1)) {
                      goto LABEL_27;
                    }
                  }
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_36:
                  int v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_38:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3973, v28);
                }
                uint64_t v13 = a2;
                uint64_t v14 = a1 + 1;
                while (!HIBYTE(v37))
                {
                  uint64_t v15 = WORD2(v37);
                  if (WORD1(v37) <= WORD2(v37)) {
                    goto LABEL_44;
                  }
                  if (BYTE6(v37) != 2)
                  {
                    uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    goto LABEL_46;
                  }
                  char v16 = *(unsigned char *)(v14 - 1);
                  ++WORD2(v37);
                  *(unsigned char *)(v36 + v15) = v16;
                  if (HIBYTE(v37))
                  {
                    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_48:
                    uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
LABEL_50:
                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3970, v31);
                  }
                  if (WORD1(v37) - WORD2(v37) <= 5) {
                    goto LABEL_48;
                  }
                  if (BYTE6(v37) != 2)
                  {
                    uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
                    goto LABEL_50;
                  }
                  sub_100008A18(v36 + WORD2(v37), v14, 6uLL);
                  WORD2(v37) += 6;
                  v14 += 7;
                  if (!--v13)
                  {
                    if (a2 <= 7) {
                      goto LABEL_18;
                    }
LABEL_27:
                    if (HIBYTE(v37))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else
                    {
                      uint64_t v26 = WORD2(v37);
                      if (WORD1(v37) > WORD2(v37))
                      {
                        if (BYTE6(v37) == 2)
                        {
                          ++WORD2(v37);
                          *(unsigned char *)(v36 + v26) = a3;
                          if (HIBYTE(v37))
                          {
                            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                          }
                          else
                          {
                            uint64_t v27 = WORD2(v37);
                            if (WORD1(v37) > WORD2(v37))
                            {
                              if (BYTE6(v37) == 2)
                              {
                                ++WORD2(v37);
                                *(unsigned char *)(v36 + v27) = a4;
                                return sub_10001BCBC(233, v36, BYTE4(v37), a5, (uint64_t)sub_1000260B4, v17, v18, v19);
                              }
                              uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_66:
                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3977, v35);
                            }
                          }
                          uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                          goto LABEL_66;
                        }
                        unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_62:
                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3976, v34);
                      }
                    }
                    unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_62;
                  }
                }
                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_44:
                uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_46:
                sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3969, v30);
              }
              int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_58:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3967, v33);
            }
          }
          int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_58;
        }
        uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_54:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3966, v32);
      }
    }
    uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_54;
  }
  return result;
}

uint64_t sub_1001C59A0(char a1, uint64_t a2)
{
  uint64_t v10 = 0;
  uint64_t v11 = 0;
  uint64_t result = sub_100059D70(&v10);
  if (!result)
  {
    if (HIBYTE(v11))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v8 = WORD2(v11);
      if (WORD1(v11) > WORD2(v11))
      {
        if (BYTE6(v11) == 2)
        {
          ++WORD2(v11);
          *(unsigned char *)(v10 + v8) = a1;
          return sub_10001BCBC(554, v10, BYTE4(v11), a2, (uint64_t)sub_1000260B4, v5, v6, v7);
        }
        uint64_t v9 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_10:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3991, v9);
      }
    }
    uint64_t v9 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_10;
  }
  return result;
}

uint64_t sub_1001C5A78(unsigned __int8 *a1, uint64_t a2)
{
  uint64_t v39 = 0;
  uint64_t v40 = 0;
  uint64_t result = sub_100059D70(&v39);
  if (!result)
  {
    int v5 = *a1;
    if (v5 != 3)
    {
      if (v5 == 1)
      {
        if (HIBYTE(v40))
        {
          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
        }
        else
        {
          unsigned int v6 = WORD2(v40);
          if (WORD1(v40) > WORD2(v40))
          {
            if (BYTE6(v40) == 2)
            {
              char v7 = 74;
              goto LABEL_16;
            }
            unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_75:
            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4007, v34);
          }
        }
        unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
        goto LABEL_75;
      }
      if (HIBYTE(v40))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
      }
      else
      {
        unsigned int v6 = WORD2(v40);
        if (WORD1(v40) > WORD2(v40))
        {
          if (BYTE6(v40) == 2) {
            goto LABEL_15;
          }
          uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_82:
          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4011, v35);
        }
      }
      uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
      goto LABEL_82;
    }
    if (HIBYTE(v40))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      unsigned int v6 = WORD2(v40);
      if (WORD1(v40) > WORD2(v40))
      {
        if (BYTE6(v40) == 2)
        {
LABEL_15:
          char v7 = 92;
LABEL_16:
          WORD2(v40) = v6 + 1;
          *(unsigned char *)(v39 + v6) = v7;
          if (HIBYTE(v40))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v9 = WORD2(v40);
            if (WORD1(v40) > WORD2(v40))
            {
              if (BYTE6(v40) == 2)
              {
                unsigned __int8 v10 = a1[16];
                ++WORD2(v40);
                *(unsigned char *)(v39 + v9) = v10;
                if (HIBYTE(v40))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v40) - WORD2(v40) > 5)
                {
                  if (BYTE6(v40) == 2)
                  {
                    sub_100008A18(v39 + WORD2(v40), *((void *)a1 + 1), 6uLL);
                    __int16 v14 = WORD2(v40);
                    unsigned __int16 v15 = WORD2(v40) + 6;
                    WORD2(v40) += 6;
                    if (HIBYTE(v40))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v40) > v15)
                    {
                      if (BYTE6(v40) == 2)
                      {
                        unsigned __int8 v16 = a1[17];
                        WORD2(v40) = v14 + 7;
                        *(unsigned char *)(v39 + v15) = v16;
                        if (HIBYTE(v40))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v40) > WORD2(v40))
                        {
                          if (BYTE6(v40) == 2)
                          {
                            *(unsigned char *)(v39 + WORD2(v40)) = a1[18];
                            __int16 v17 = WORD2(v40);
                            unsigned __int16 v18 = ++WORD2(v40);
                            if (HIBYTE(v40))
                            {
                              sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                            }
                            else if (WORD1(v40) > v18)
                            {
                              if (BYTE6(v40) == 2)
                              {
                                unsigned __int8 v19 = a1[19];
                                WORD2(v40) = v17 + 2;
                                *(unsigned char *)(v39 + v18) = v19;
                                if (*a1 < 2u) {
                                  return sub_10001BCBC(233, v39, BYTE4(v40), a2, (uint64_t)sub_1000260B4, v11, v12, v13);
                                }
                                if (HIBYTE(v40))
                                {
                                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stac"
                                                         "k/vsc/bcm/bcm_vsc.c");
                                }
                                else
                                {
                                  uint64_t v20 = WORD2(v40);
                                  if (WORD1(v40) > WORD2(v40))
                                  {
                                    if (BYTE6(v40) == 2)
                                    {
                                      unsigned __int8 v21 = a1[20];
                                      ++WORD2(v40);
                                      *(unsigned char *)(v39 + v20) = v21;
                                      if (*a1 == 3)
                                      {
                                        if (HIBYTE(v40))
                                        {
                                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_b"
                                                                 "ase/Stack/vsc/bcm/bcm_vsc.c");
                                        }
                                        else
                                        {
                                          uint64_t v22 = WORD2(v40);
                                          if (WORD1(v40) > WORD2(v40))
                                          {
                                            if (BYTE6(v40) == 2)
                                            {
                                              unsigned __int8 v23 = a1[21];
                                              ++WORD2(v40);
                                              *(unsigned char *)(v39 + v22) = v23;
                                              if (HIBYTE(v40))
                                              {
                                                sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluet"
                                                                       "ooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                              }
                                              else
                                              {
                                                uint64_t v24 = WORD2(v40);
                                                if (WORD1(v40) > WORD2(v40))
                                                {
                                                  if (BYTE6(v40) == 2)
                                                  {
                                                    unsigned __int8 v25 = a1[22];
                                                    ++WORD2(v40);
                                                    *(unsigned char *)(v39 + v24) = v25;
                                                    if (HIBYTE(v40))
                                                    {
                                                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/Mobil"
                                                                             "eBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                                                    }
                                                    else
                                                    {
                                                      uint64_t v26 = WORD2(v40);
                                                      if (WORD1(v40) > WORD2(v40))
                                                      {
                                                        if (BYTE6(v40) == 2)
                                                        {
                                                          unsigned __int8 v27 = a1[23];
                                                          ++WORD2(v40);
                                                          *(unsigned char *)(v39 + v26) = v27;
                                                          return sub_10001BCBC(233, v39, BYTE4(v40), a2, (uint64_t)sub_1000260B4, v11, v12, v13);
                                                        }
                                                        uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_94:
                                                        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4024, v38);
                                                      }
                                                    }
                                                    uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                                    goto LABEL_94;
                                                  }
                                                  uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_90:
                                                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4023, v37);
                                                }
                                              }
                                              uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                              goto LABEL_90;
                                            }
                                            uint64_t v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_86:
                                            sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4022, v36);
                                          }
                                        }
                                        uint64_t v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                        goto LABEL_86;
                                      }
                                      return sub_10001BCBC(233, v39, BYTE4(v40), a2, (uint64_t)sub_1000260B4, v11, v12, v13);
                                    }
                                    int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_71:
                                    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4019, v33);
                                  }
                                }
                                int v33 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                                goto LABEL_71;
                              }
                              uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_67:
                              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4017, v32);
                            }
                            uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                            goto LABEL_67;
                          }
                          uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_63:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4016, v31);
                        }
                        uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= (1)";
                        goto LABEL_63;
                      }
                      uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_59:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4015, v30);
                    }
                    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                    goto LABEL_59;
                  }
                  uint64_t v29 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_55:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4014, v29);
                }
                uint64_t v29 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_55;
              }
              int v28 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_51:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4013, v28);
            }
          }
          int v28 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_51;
        }
        uint64_t v8 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_78:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4009, v8);
      }
    }
    uint64_t v8 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_78;
  }
  return result;
}

uint64_t sub_1001C60CC(uint64_t a1, uint64_t a2)
{
  uint64_t v14 = 0;
  uint64_t v15 = 0;
  uint64_t result = sub_100059D70(&v14);
  if (!result)
  {
    if (HIBYTE(v15))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v5 = WORD2(v15);
      if (WORD1(v15) > WORD2(v15))
      {
        if (BYTE6(v15) == 2)
        {
          ++WORD2(v15);
          *(unsigned char *)(v14 + v5) = 75;
          if (HIBYTE(v15))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v6 = WORD2(v15);
            if (WORD1(v15) > WORD2(v15))
            {
              if (BYTE6(v15) == 2)
              {
                char v7 = *(unsigned char *)(a1 + 8);
                ++WORD2(v15);
                *(unsigned char *)(v14 + v6) = v7;
                if (HIBYTE(v15))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v15) - WORD2(v15) > 5)
                {
                  if (BYTE6(v15) == 2)
                  {
                    sub_100008A18(v14 + WORD2(v15), *(void *)a1, 6uLL);
                    WORD2(v15) += 6;
                    return sub_10001BCBC(233, v14, BYTE4(v15), a2, (uint64_t)sub_1001A7DCC, v8, v9, v10);
                  }
                  uint64_t v13 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_24:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4041, v13);
                }
                uint64_t v13 = "ByteStream_NumReadBytesAvail(bs) >= OI_BD_ADDR_BYTE_SIZE";
                goto LABEL_24;
              }
              uint64_t v12 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_20:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4040, v12);
            }
          }
          uint64_t v12 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_20;
        }
        uint64_t v11 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_16:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4039, v11);
      }
    }
    uint64_t v11 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_16;
  }
  return result;
}

uint64_t sub_1001C62B0(char a1, __int16 a2, __int16 a3, char a4, uint64_t a5)
{
  uint64_t v24 = 0;
  uint64_t v25 = 0;
  uint64_t result = sub_100059D70(&v24);
  if (!result)
  {
    if (HIBYTE(v25))
    {
      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    }
    else
    {
      uint64_t v14 = WORD2(v25);
      if (WORD1(v25) > WORD2(v25))
      {
        if (BYTE6(v25) == 2)
        {
          ++WORD2(v25);
          *(unsigned char *)(v24 + v14) = 76;
          if (HIBYTE(v25))
          {
            sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
          }
          else
          {
            uint64_t v15 = WORD2(v25);
            if (WORD1(v25) > WORD2(v25))
            {
              if (BYTE6(v25) == 2)
              {
                ++WORD2(v25);
                *(unsigned char *)(v24 + v15) = a1;
                if (HIBYTE(v25))
                {
                  sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                }
                else if (WORD1(v25) - WORD2(v25) > 1)
                {
                  if (BYTE6(v25) == 2)
                  {
                    *(_WORD *)(v24 + WORD2(v25)) = a2;
                    unsigned __int16 v16 = WORD2(v25) + 2;
                    WORD2(v25) += 2;
                    if (HIBYTE(v25))
                    {
                      sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                    }
                    else if (WORD1(v25) - v16 > 1)
                    {
                      if (BYTE6(v25) == 2)
                      {
                        *(unsigned char *)(v24 + v16) = a3;
                        *(unsigned char *)(v24 + WORD2(v25) + 1) = HIBYTE(a3);
                        __int16 v17 = WORD2(v25);
                        unsigned __int16 v18 = WORD2(v25) + 2;
                        WORD2(v25) += 2;
                        if (HIBYTE(v25))
                        {
                          sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
                        }
                        else if (WORD1(v25) > v18)
                        {
                          if (BYTE6(v25) == 2)
                          {
                            WORD2(v25) = v17 + 3;
                            *(unsigned char *)(v24 + v18) = a4;
                            return sub_10001BCBC(233, v24, BYTE4(v25), a5, (uint64_t)sub_1000260B4, v11, v12, v13);
                          }
                          unsigned __int8 v23 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_38:
                          sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4060, v23);
                        }
                        unsigned __int8 v23 = "ByteStream_NumReadBytesAvail(bs) >= 1";
                        goto LABEL_38;
                      }
                      uint64_t v22 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_34:
                      sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4059, v22);
                    }
                    uint64_t v22 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                    goto LABEL_34;
                  }
                  unsigned __int8 v21 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_30:
                  sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4058, v21);
                }
                unsigned __int8 v21 = "ByteStream_NumReadBytesAvail(bs) >= 2";
                goto LABEL_30;
              }
              uint64_t v20 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_26:
              sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4057, v20);
            }
          }
          uint64_t v20 = "ByteStream_NumReadBytesAvail(bs) >= 1";
          goto LABEL_26;
        }
        unsigned __int8 v19 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_22:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 4056, v19);
      }
    }
    unsigned __int8 v19 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_22;
  }
  return result;
}

uint64_t sub_1001C65C0(uint64_t a1, unsigned int a2, unsigned int a3, char a4, char a5, char a6, uint64_t a7)
{
  uint64_t v39 = 0;
  uint64_t v40 = 0;
  uint64_t result = sub_100059D70(&v39);
  if (result) {
    return result;
  }
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_43;
  }
  uint64_t v18 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_43:
    uint64_t v31 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_45;
  }
  if (BYTE6(v40) != 2)
  {
    uint64_t v31 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3272, v31);
  }
  ++WORD2(v40);
  *(unsigned char *)(v39 + v18) = 80;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_47;
  }
  uint64_t v19 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_47:
    uint64_t v32 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_49;
  }
  if (BYTE6(v40) != 2)
  {
    uint64_t v32 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_49:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3274, v32);
  }
  ++WORD2(v40);
  *(unsigned char *)(v39 + v19) = a3;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_51;
  }
  if (WORD1(v40) - WORD2(v40) <= 5)
  {
LABEL_51:
    int v33 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
    goto LABEL_53;
  }
  if (BYTE6(v40) != 2)
  {
    int v33 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_53:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3275, v33);
  }
  uint64_t v20 = v39 + WORD2(v40);
  *(_WORD *)(v20 + 4) = 0;
  *(_DWORD *)uint64_t v20 = 0;
  __int16 v21 = WORD2(v40);
  unsigned __int16 v22 = WORD2(v40) + 6;
  WORD2(v40) += 6;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_55;
  }
  if (WORD1(v40) <= v22)
  {
LABEL_55:
    unsigned __int16 v34 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_57;
  }
  if (BYTE6(v40) != 2)
  {
    unsigned __int16 v34 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_57:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3276, v34);
  }
  WORD2(v40) = v21 + 7;
  *(unsigned char *)(v39 + v22) = 2;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_59;
  }
  uint64_t v23 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_59:
    uint64_t v35 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_61;
  }
  if (BYTE6(v40) != 2)
  {
    uint64_t v35 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_61:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3277, v35);
  }
  ++WORD2(v40);
  *(unsigned char *)(v39 + v23) = 0;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_63;
  }
  uint64_t v24 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_63:
    uint64_t v36 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_65;
  }
  if (BYTE6(v40) != 2)
  {
    uint64_t v36 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_65:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3279, v36);
  }
  ++WORD2(v40);
  *(unsigned char *)(v39 + v24) = a4;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_67;
  }
  uint64_t v25 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_67:
    uint64_t v37 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_69;
  }
  if (BYTE6(v40) != 2)
  {
    uint64_t v37 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_69:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3280, v37);
  }
  ++WORD2(v40);
  *(unsigned char *)(v39 + v25) = a5;
  if (HIBYTE(v40))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_71;
  }
  uint64_t v26 = WORD2(v40);
  if (WORD1(v40) <= WORD2(v40))
  {
LABEL_71:
    uint64_t v38 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_73;
  }
  if (BYTE6(v40) != 2)
  {
    uint64_t v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_73:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3281, v38);
  }
  ++WORD2(v40);
  *(unsigned char *)(v39 + v26) = a6;
  if (a3 <= 1)
  {
    if (a2 == 2 || a2 == 16) {
      goto LABEL_31;
    }
    sub_10025B8C0();
  }
  if (a2)
  {
LABEL_31:
    uint64_t v27 = a2;
    while (!HIBYTE(v40))
    {
      uint64_t v28 = WORD2(v40);
      if (WORD1(v40) <= WORD2(v40)) {
        goto LABEL_39;
      }
      if (BYTE6(v40) != 2)
      {
        uint64_t v30 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_41;
      }
      char v29 = *(unsigned char *)(a1 - 1 + v27--);
      ++WORD2(v40);
      *(unsigned char *)(v39 + v28) = v29;
      if ((unint64_t)(v27 + 1) <= 1) {
        return sub_10001BCBC(233, v39, BYTE4(v40), a7, (uint64_t)sub_1000260B4, v15, v16, v17);
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_39:
    uint64_t v30 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_41:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3288, v30);
  }
  return sub_10001BCBC(233, v39, BYTE4(v40), a7, (uint64_t)sub_1000260B4, v15, v16, v17);
}

uint64_t sub_1001C6AD8(uint64_t a1, unsigned int a2, unsigned int a3, char a4, char a5, char a6, unsigned int a7, uint64_t a8, uint64_t a9, uint64_t a10)
{
  uint64_t v61 = 0;
  uint64_t v62 = 0;
  uint64_t result = sub_100059D70(&v61);
  if (result) {
    return result;
  }
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_77;
  }
  uint64_t v19 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_77:
    uint64_t v51 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_79;
  }
  if (BYTE6(v62) != 2)
  {
    uint64_t v51 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_79:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3303, v51);
  }
  ++WORD2(v62);
  *(unsigned char *)(v61 + v19) = 97;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_81;
  }
  uint64_t v20 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_81:
    uint64_t v52 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_83;
  }
  if (BYTE6(v62) != 2)
  {
    uint64_t v52 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_83:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3305, v52);
  }
  ++WORD2(v62);
  *(unsigned char *)(v61 + v20) = a3;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_85;
  }
  if (WORD1(v62) - WORD2(v62) <= 5)
  {
LABEL_85:
    unsigned int v53 = "ByteStream_NumReadBytesAvail(bs) >= (6)";
    goto LABEL_87;
  }
  if (BYTE6(v62) != 2)
  {
    unsigned int v53 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_87:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3306, v53);
  }
  uint64_t v21 = v61 + WORD2(v62);
  *(_WORD *)(v21 + 4) = 0;
  *(_DWORD *)uint64_t v21 = 0;
  __int16 v22 = WORD2(v62);
  unsigned __int16 v23 = WORD2(v62) + 6;
  WORD2(v62) += 6;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_89;
  }
  if (WORD1(v62) <= v23)
  {
LABEL_89:
    uint64_t v54 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_91;
  }
  if (BYTE6(v62) != 2)
  {
    uint64_t v54 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_91:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3307, v54);
  }
  WORD2(v62) = v22 + 7;
  *(unsigned char *)(v61 + v23) = 2;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_93;
  }
  uint64_t v24 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_93:
    uint64_t v55 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_95;
  }
  if (BYTE6(v62) != 2)
  {
    uint64_t v55 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_95:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3308, v55);
  }
  ++WORD2(v62);
  *(unsigned char *)(v61 + v24) = 0;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_97;
  }
  uint64_t v25 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_97:
    int v56 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_99;
  }
  if (BYTE6(v62) != 2)
  {
    int v56 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_99:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3310, v56);
  }
  ++WORD2(v62);
  *(unsigned char *)(v61 + v25) = a4;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_101;
  }
  uint64_t v26 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_101:
    unsigned __int16 v57 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_103;
  }
  if (BYTE6(v62) != 2)
  {
    unsigned __int16 v57 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_103:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3311, v57);
  }
  ++WORD2(v62);
  *(unsigned char *)(v61 + v26) = a5;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    goto LABEL_105;
  }
  uint64_t v27 = WORD2(v62);
  if (WORD1(v62) <= WORD2(v62))
  {
LABEL_105:
    uint64_t v58 = "ByteStream_NumReadBytesAvail(bs) >= 1";
    goto LABEL_107;
  }
  if (BYTE6(v62) != 2)
  {
    uint64_t v58 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_107:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3312, v58);
  }
  ++WORD2(v62);
  *(unsigned char *)(v61 + v27) = a6;
  if (a3 <= 1 && a2 != 2 && a2 != 16) {
    sub_10025B8C0();
  }
  if (a8 && a7)
  {
    uint64_t v28 = 0;
    while (!HIBYTE(v62))
    {
      uint64_t v29 = WORD2(v62);
      if (WORD1(v62) <= WORD2(v62)) {
        goto LABEL_69;
      }
      if (BYTE6(v62) != 2)
      {
        uint64_t v49 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_71;
      }
      char v30 = *(unsigned char *)(a8 + v28);
      ++WORD2(v62);
      *(unsigned char *)(v61 + v29) = v30;
      if (++v28 >= (unint64_t)a7) {
        goto LABEL_37;
      }
    }
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_69:
    uint64_t v49 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_71:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3319, v49);
  }
LABEL_37:
  uint64_t v31 = v61;
  uint64_t v32 = WORD2(v62);
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    int v33 = 0;
  }
  else
  {
    int v33 = WORD1(v62) - WORD2(v62);
  }
  int v34 = 27 - a7;
  if (v33 < (int)(27 - a7))
  {
    int v59 = "ByteStream_NumReadBytesAvail(bs) >= ((27) - blobLen)";
    goto LABEL_110;
  }
  if (BYTE6(v62) != 2)
  {
    int v59 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_110:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3321, v59);
  }
  bzero((void *)(v31 + v32), v34);
  unsigned __int16 v35 = WORD2(v62) + v34;
  WORD2(v62) += v34;
  if (a9 && a7)
  {
    unint64_t v36 = 0;
    do
    {
      if (HIBYTE(v62))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_73:
        uint64_t v50 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_75:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3324, v50);
      }
      uint64_t v37 = WORD2(v62);
      if (WORD1(v62) <= WORD2(v62)) {
        goto LABEL_73;
      }
      if (BYTE6(v62) != 2)
      {
        uint64_t v50 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_75;
      }
      char v38 = *(unsigned char *)(a9 + v36);
      ++WORD2(v62);
      *(unsigned char *)(v61 + v37) = v38;
      ++v36;
    }
    while (v36 < a7);
    unsigned __int16 v35 = WORD2(v62);
  }
  uint64_t v39 = v61;
  if (HIBYTE(v62))
  {
    sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
    int v40 = 0;
  }
  else
  {
    int v40 = WORD1(v62) - v35;
  }
  if (v40 < v34)
  {
    uint64_t v60 = "ByteStream_NumReadBytesAvail(bs) >= ((27) - blobLen)";
    goto LABEL_113;
  }
  if (BYTE6(v62) != 2)
  {
    uint64_t v60 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_113:
    sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3326, v60);
  }
  bzero((void *)(v39 + v35), v34);
  unsigned __int8 v44 = BYTE4(v62) + v34;
  WORD2(v62) += v34;
  if (a2)
  {
    uint64_t v45 = a2;
    do
    {
      if (HIBYTE(v62))
      {
        sub_10025A794((uint64_t)"/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c");
LABEL_65:
        unsigned __int16 v48 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_67:
        sub_10014327C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/vsc/bcm/bcm_vsc.c", 3329, v48);
      }
      uint64_t v46 = WORD2(v62);
      if (WORD1(v62) <= WORD2(v62)) {
        goto LABEL_65;
      }
      if (BYTE6(v62) != 2)
      {
        unsigned __int16 v48 = "(bs).__RWFlag == BYTESTREAM_WRITE";
        goto LABEL_67;
      }
      char v47 = *(unsigned char *)(a1 - 1 + v45--);
      ++WORD2(v62);
      *(unsigned char *)(v61 + v46) = v47;
    }
    while ((unint64_t)(v45 + 1) > 1);
    unsigned __int8 v44 = BYTE4(v62);
  }
  return sub_10001BCBC(233, v61, v44, a10, (uint64_t)sub_1000260B4, v41, v42, v43);
}